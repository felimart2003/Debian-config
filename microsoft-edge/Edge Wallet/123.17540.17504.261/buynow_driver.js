!function(){"use strict";let e,i,t,o=!1;!function(e){e.IsBuyNowReady="IsBuyNowReady",e.BuyNowSubscribeNow="BuyNowSubscribeNow",e.BuyNowQuickAuthFinished="BuyNowQuickAuthFinished",e.BuyNowQuickAuthFailed="BuyNowQuickAuthFailed",e.LoadLocalCards="LoadLocalCards",e.BuyNowIsReady="BuyNowIsReady",e.BuyNowStartQuickAuth="BuyNowStartQuickAuth",e.BuyNowCheckoutFinished="BuyNowCheckoutFinished",e.LoadLocalCardsFinished="LoadLocalCardsFinished"}(i||(i={})),function(e){e.EntryPointReady="EntryPointReady",e.StartBuyNow="StartBuyNow",e.VisitPublisher="VisitPublisher",e.MerchantAuthSucceeded="MerchantAuthSucceeded",e.MerchantAuthFailed="MerchantAuthFailed",e.LoadLocalCards="LoadLocalCards"}(t||(t={}));const s="BuyNowRuntime";window[s]=new class{notifyHostPage(e,i){window.dispatchEvent(new CustomEvent(e,{detail:i}))}listenOnHostPageEvent(e,i){window.addEventListener(e,(e=>{i(e)}))}handleQuickAuthFinished(e){if(e.detail){const i=JSON.parse(e.detail);"skipped"===i.type?window[s].postMessageToHost(t.MerchantAuthFailed,[]):"display"!==i.type||i.displayed?"dismissed"===i.type&&"credential_returned"===i.reason&&window[s].postMessageToHost(t.MerchantAuthSucceeded,[]):window[s].postMessageToHost(t.MerchantAuthFailed,[])}}handleQuickAuthFailed(e){window[s].postMessageToHost(t.MerchantAuthFailed,[])}handleIsBuyNowReady(){window[s].notifyHostPage(i.BuyNowIsReady,"Ready"),window[s].postMessageToHost(t.EntryPointReady,[])}handleBuyNowSubscribeNow(i){e=JSON.parse(i.detail),e&&e.originalSubLink&&window.open(e.originalSubLink,"_blank").focus()}handleLoadLocalCards(){window[s].postMessageToHost(t.LoadLocalCards,[])}raiseMessageFromHost(t){const o=t.shift(),a=JSON.parse(t[0]).event;if(o&&"StartMerchantAuth"===o)this.listenOnHostPageEvent(i.BuyNowQuickAuthFinished,this.handleQuickAuthFinished),this.listenOnHostPageEvent(i.BuyNowQuickAuthFailed,this.handleQuickAuthFailed),this.notifyHostPage(i.BuyNowStartQuickAuth,a);else if(o&&"VisitPublisher"===o){if(e&&e.plans){if(e.originalSubLink)return void window.open(e.originalSubLink,"_blank").focus();let i=0;for(let t=0;t<e.length;t+=1)if(e.plans[t].isPromotion){i=t;break}if(e.plans[i].url){const t=new URL(e.plans[i].url);window.open(t.origin,"_blank").focus()}}}else o&&"CheckoutFinished"===o?window[s].notifyHostPage(i.BuyNowCheckoutFinished,a):o&&"LocalCardsFinished"==o&&window[s].notifyHostPage(i.LoadLocalCardsFinished,a)}postMessageToHost(e,i){try{walletBuyNowNativeHandler&&walletBuyNowNativeHandler.sendMessageToHost(e,i)}catch(e){}}initialize(e){return o||(this.listenOnHostPageEvent(i.IsBuyNowReady,this.handleIsBuyNowReady),this.listenOnHostPageEvent(i.BuyNowSubscribeNow,this.handleBuyNowSubscribeNow),this.listenOnHostPageEvent(i.LoadLocalCards,this.handleLoadLocalCards),o=!0),!0}}}();