import{f as u,o as c,q as _,w as p,Q as y,i as f,c as w,j as d,r as T,bf as A,bX as V,di as B,n as F,k,g as C,l as O,a_ as U,Y as x,t as D,$ as L,F as G,N as I,aV as R,ay as P,as as j,z as S}from"./defineAppConfig-bSouF0-Z.js";import{a as h,_ as q}from"./DurationPreference.vue_vue_type_script_setup_true_lang-7YqzPxZB.js";import{l as H,j as M,b as z}from"./useAddAppToIgnoreListDialogStore-3TvFnIDf.js";import{i as Q,B as X,E as Y,m as J}from"./recent-apps-provider-So7C9hQg.js";const K=u({name:"ButtonPreference",__name:"ButtonPreference",props:{pref:{}},setup(t){return(e,o)=>(c(),_(h,{pref:e.pref},{"right-content":p(()=>[f("button",{class:"btn btn-primary",onClick:o[0]||(o[0]=r=>e.pref.onClick())},y(e.pref.buttonText),1)]),_:1},8,["pref"]))}}),W={class:"text-base-content text-opacity-primary text-2xl font-light pr-4"},Z=u({name:"ClickablePreference",__name:"ClickablePreference",props:{pref:{}},setup(t){const e=t,o=w(()=>{var r;return(r=e.pref.label)==null?void 0:r.value});return(r,s)=>(c(),_(h,{pref:r.pref,class:"cursor-pointer clickable rounded",onClick:r.pref.onClick},{"right-content":p(()=>[f("p",W,y(d(o)),1)]),_:1},8,["pref","onClick"]))}}),ee={class:"relative overflow-hidden"},re=["accept"],te=u({name:"FileUploadPreference",__name:"FileUploadPreference",props:{pref:{}},setup(t){const e=t,o=T();function r(){var n;(n=o.value)==null||n.click()}const s=w(()=>{const n=e.pref.acceptExtensions;if(!(n==null||n.length===0))return n.join(" ")});function m(){const n=new FileReader,[a,g,v]=B();return n.onload=()=>{g(n.result)},n.onerror=()=>v(n.error),[n,a]}async function l(n){var $;const a=n.target,g=($=a==null?void 0:a.files)==null?void 0:$[0];if(g==null){A("[file-upload-preference] Selected file cleared");return}const[v,b]=m();v.readAsDataURL(g);const i=await b;if(i==null)V("File contents were null");else if(typeof i=="string"){const N=i.slice(i.indexOf(",")+1);await e.pref.onFileContents(N),a.value=""}else V("File contents were a BufferArray, not a string;")}return(n,a)=>(c(),_(h,{pref:n.pref},{"right-content":p(()=>[f("div",ee,[f("input",{ref_key:"input",ref:o,class:"absolute inset-0 h-full w-full opacity-0 min-w-0",type:"file",accept:d(s),onChange:l},null,40,re),f("button",{class:"btn btn-primary relative",onClick:r},y(n.$t("chooseFile")),1)])]),_:1},8,["pref"]))}}),ne={class:"pr-4"},oe=u({name:"LinkPreference",__name:"LinkPreference",props:{pref:{}},setup(t){const e=t;return(o,r)=>{const s=F("router-link");return c(),_(s,{class:"group",style:{"text-decoration":"none"},to:o.pref.href},{default:p(()=>[k(h,{pref:e.pref,class:"cursor-pointer clickable rounded"},{"right-content":p(()=>[f("div",ne,[k(d(H),{class:"icon-lg text-base-content text-opacity-50 group-hover:text-primary group-hover:text-opacity-100"})])]),_:1},8,["pref"])]),_:1},8,["to"])}}}),se={key:0,class:"pref-section"},ae={class:"pref-section-title"},ie=u({name:"PreferenceGroup",__name:"PreferenceGroup",props:{group:{}},setup(t){const e=t,o=w(()=>!e.group.when||e.group.when.value);return(r,s)=>(c(),_(U,{name:"fade-down"},{default:p(()=>[d(o)?(c(),C("section",se,[f("h2",ae,y(r.group.name),1),k(d(E),{preferences:r.group.preferences},null,8,["preferences"])])):O("v-if",!0)]),_:1}))}}),ce=["value"],le=u({name:"SelectPreference",__name:"SelectPreference",props:{pref:{}},setup(t){const e=t,{t:o}=x(),{reportEvent:r}=D(),s=e.pref.useValue();function m(){r("CHANGED_SETTING",{id:e.pref.id,value:s.value})}return(l,n)=>(c(),_(h,{pref:l.pref},{"right-content":p(()=>[k(Q,{id:"theme",class:"pr-4 w-48",placeholder:l.pref.placeholder,"select-helper-text":d(o)("selectOne"),modelValue:d(s),"onUpdate:modelValue":n[0]||(n[0]=a=>L(s)?s.value=a:null)},{default:p(()=>[(c(!0),C(G,null,I(l.pref.options,a=>(c(),C("option",{key:a.value,value:a.value,onClick:m},y(a.display),9,ce))),128))]),_:1},8,["placeholder","select-helper-text","modelValue"])]),_:1},8,["pref"]))}}),pe={class:"pr-4"},ue=u({name:"SwitchPreference",__name:"SwitchPreference",props:{pref:{}},setup(t){const e=t,{reportEvent:o}=D(),r=e.pref.useValue();function s(){o("CHANGED_SETTING",{id:e.pref.id,value:r.value})}return(m,l)=>(c(),_(h,{pref:m.pref},{"right-content":p(()=>[f("div",pe,[k(X,{"data-testid":`switch-${m.pref.id}`,modelValue:d(r),"onUpdate:modelValue":l[0]||(l[0]=n=>L(r)?r.value=n:null),onClick:s},null,8,["data-testid","modelValue"])])]),_:1},8,["pref"]))}}),fe=["checked"],de=u({name:"OptionPreference",__name:"OptionPreference",props:{pref:{}},setup(t){const e=t,o=T(e.pref.radioValue);return(r,s)=>(c(),_(h,{class:"cursor-pointer clickable rounded",pref:r.pref,"data-testid":e.pref.testId,onClick:r.pref.onClick},{icon:p(()=>[f("input",{type:"radio",class:"radio radio-secondary radio-sm",checked:d(o),onClick:s[0]||(s[0]=R(()=>{},["prevent"]))},null,8,fe)]),_:1},8,["pref","data-testid","onClick"]))}}),me={button:K,"file-upload":te,click:Z,link:oe,switch:ue,select:le,duration:q,option:de},E=u({name:"PreferenceList",props:{preferences:{type:Array,required:!0}},render(){return this.preferences.map(t=>t.type==="group"?t.preferences.length>0?P(ie,{group:t}):null:P(me[t.type],{pref:t}))}});function _e(t=Y()){return e=>{const[o,r,s]=B();return t.show({initialTimeOfDay:e,onDismiss:()=>s(void 0),onPick:r}),o}}function ye(t){return u({name:"PreferenceListDefinition",setup(){const{t:e}=x(),o=M(),r=i=>o.show({message:i}),s=z(),m=()=>s.show(S.Loading),l=()=>s.hide(S.Loading),n=J(),a=i=>{n.show({title:i.title,message:i.message,positiveButtonText:i.positiveButtonText??e("preferences.resetButton"),negativeButtonText:i.negativeButtonText??e("cancel"),destructive:!0,async onClickPositive(){return await i.onConfirm(),!0}})},g=j(),v=_e();return{preferences:t({t:e,showAlert:r,showLoading:m,hideLoading:l,confirmDestroy:a,prefs:g,pickTimeOfDay:v})}},render(){return P(E,{preferences:this.preferences})}})}export{ye as d};
