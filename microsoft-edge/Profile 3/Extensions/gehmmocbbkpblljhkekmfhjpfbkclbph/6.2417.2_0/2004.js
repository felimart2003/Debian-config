"use strict";(globalThis.webpackChunk_dashlane_leeloo=globalThis.webpackChunk_dashlane_leeloo||[]).push([[2004],{515400:(e,t,i)=>{i.r(t),i.d(t,{IdCardEditPanel:()=>c,IdGroupTab:()=>l}),i(696832);var a=i(382706),n=i(762428),s=i(697764),o=i(524130);const r={HEADER_DESCRIPTION:"webapp_id_edition_idcard_header_description",DIALOG_DELETE_TITLE:"webapp_id_edition_idcard_dialog_delete_title",ALERT_DELETE:"webapp_id_edition_idcard_alert_delete",ALERT_EDIT:"webapp_id_edition_idcard_alert_edit",COPY_SUCCESS:"webapp_id_copy_success_id_card_number"};let l=function(e){return e[e.DETAILS=0]="DETAILS",e[e.ATTACHMENTS=1]="ATTACHMENTS",e}({});const c=({listRoute:e,id:t,setDialogActive:i,lee:l,hasUnsavedData:c,setHasUnsavedData:d})=>t?(0,o.tZ)(s.y,{listRoute:e,id:`{${t}}`,setDialogActive:i,lee:l,hasUnsavedData:c,setHasUnsavedData:d,ID_TYPE:a.U.IdCard,I18N_KEYS:r,children:({handleCopy:e,values:t})=>(0,o.tZ)(n.P,{variant:"edit",handleCopy:e,country:t.country})}):null},697764:(e,t,i)=>{i.d(t,{y:()=>k});var a=i(696832),n=i(148038),s=i(488203),o=i(566219),r=i(799852),l=i(382706),c=i(448430);const d={[l.U.DriversLicense]:"driversLicensesResult",[l.U.FiscalId]:"fiscalIdsResult",[l.U.IdCard]:"idCardsResult",[l.U.Passport]:"passportsResult",[l.U.SocialSecurityId]:"socialSecurityIdsResult"};var u=i(926897),m=i(692077),_=i(45272),p=i(974910),D=i(682994),h=i(104586),b=i(515400),g=i(65255),T=i(377377);const f=e=>`id-edit-panel-${e}`;var S,C,E=i(364438),I=i(573623),A=i(482598),L=i(58363),v=i(310789),w=i(524130);const y=({formId:e,handleCancel:t,handleDelete:i,hasDataBeenModified:a,isSubmitting:n,focusAttachmentTab:o})=>{const{translate:r}=(0,s.Z)();return(0,w.BX)(v.Ejs,{sx:{padding:"24px"},as:"footer",justifyContent:"flex-start",flexDirection:"row",flexWrap:"nowrap",children:[(0,w.BX)(v.zxk,{nature:"secondary",onClick:i,type:"button",disabled:n,sx:{marginRight:"16px"},children:[S||(S=(0,w.tZ)(v.XHJ,{})),r("webapp_panel_edition_generic_delete")]}),!!o&&(0,w.BX)(v.zxk,{nature:"secondary",onClick:o,type:"button",children:[C||(C=(0,w.tZ)(v.FKb,{})),r("webapp_secure_notes_add_attachment_action_name")]},"attach"),a?(0,w.BX)(v.Ejs,{flexDirection:"row",flexWrap:"nowrap",sx:{marginLeft:"auto"},children:[(0,w.tZ)(v.zxk,{type:"submit",form:e,disabled:n,children:r("webapp_panel_edition_generic_save_changes")}),(0,w.tZ)(v.zxk,{sx:{marginLeft:"16px"},nature:"secondary",onClick:t,type:"button",children:r("webapp_panel_edition_generic_cancel_changes")})]}):(0,w.tZ)(v.zxk,{nature:"secondary",onClick:t,type:"button",sx:{marginLeft:"auto"},children:r("webapp_panel_edition_generic_close")})]})};var U=i(386962);const Z="id-edit-form",R=({itemId:e,type:t,openConfirmDeleteDialog:i,editAlertTranslation:n,reportError:o,initialValues:r,hasUnsavedData:d,setHasUnsavedData:m,setCurrentCountry:p,copySuccessKey:D,hasTabs:h,focusAttachment:b,children:g,showListView:T})=>{const{translate:f}=(0,s.Z)(),[S,C]=(0,a.useState)(!1),{updateVaultItem:v}=(0,A.u)(c.L),R=(0,a.useRef)((e=>{if(null!==e){const{dirty:t,isSubmitting:i,values:a}=e;m(t),C(i),p(a.country)}})),{showToast:N}=(0,E.pm)(),P=(i,a)=>{(0,_.Kz)(new u.UserCopyVaultItemFieldEvent({itemType:L.L[t],field:L.H[t],itemId:e,isProtected:!1})),i&&N({description:f(D)}),a&&"function"==typeof o&&o(a,"[id-form] Unable to copy to clipboard")},k=()=>{N({description:f("_common_generic_error"),mood:"danger",isManualDismiss:!0})};return(0,w.BX)(w.HY,{children:[(0,w.tZ)(U.P,{formId:Z,formRef:R.current,handleSubmit:async(i,{setSubmitting:a,setFieldError:s})=>{const r=t===l.U.FiscalId?"fiscalNumber":"idNumber";if(!i[r])return s(r,"");try{a(!0);const s=await v({vaultItemType:t,content:i,id:e});(0,I.d6)(s)?(N({description:f(n)}),T()):(a(!1),k(),o(new Error("[ids][edit] Unable to update id"),s.error?.errorMessage))}catch(e){a(!1),k(),o(e,"[ids][edit] Unexpected exception while updating id")}},initialValues:r,variant:"edit",children:e=>g({handleCopy:P,values:e})}),(0,w.tZ)(y,{formId:Z,handleCancel:()=>{T()},handleDelete:i,hasDataBeenModified:d,isSubmitting:S,focusAttachmentTab:h?b:void 0})]})},N=({getDescription:e,title:t,...i})=>{const{translate:n}=(0,s.Z)(),{item:o,initialValues:r,type:c,children:d,showConfirmDelete:S,closeConfirmDeleteDialog:C,deleteDialogTitle:E,deleteAlertTranslation:I,listRoute:A}=i,{hasTabs:L,activeTab:v,tabs:y,focusAttachment:U,cleanActiveTab:Z}=function(e){var t;const i=(0,T.w)(g.w.TechweekWebAttachmentsForIdsV1),n=(0,a.useRef)(null),[o,r]=(0,a.useState)(null!=(t=(e=>{const t=window.sessionStorage.getItem(f(e));return t?parseInt(t,10):null})(e))?t:b.IdGroupTab.DETAILS),l=(0,a.useCallback)((t=>{window.sessionStorage.setItem(f(e),t.toString()),r(t)}),[e]),c=(0,a.useCallback)((()=>{window.sessionStorage.removeItem(f(e))}),[e]),d=(0,a.useCallback)((()=>l(b.IdGroupTab.ATTACHMENTS)),[l]),{translate:u}=(0,s.Z)(),m=(0,a.useMemo)((()=>[{active:o===b.IdGroupTab.DETAILS,label:u("webapp_secure_notes_addition_tab_title_details"),onClick:()=>l(b.IdGroupTab.DETAILS)},{active:o===b.IdGroupTab.ATTACHMENTS,label:u("webapp_secure_notes_edition_field_tab_title_attachments"),onClick:d}]),[o,d,u,l]);return(0,a.useEffect)((()=>{const e=e=>{n.current&&!n.current.contains(e.target)&&c()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[c,n]),{editPanelRef:n,hasTabs:i,activeTab:o,tabs:m,focusAttachment:d,cleanActiveTab:c}}(o.id),[N,P]=a.useState(r.country);a.useEffect((()=>{(0,h.w)()}),[]),a.useEffect((()=>{const e={[l.U.DriversLicense]:u.PageView.ItemDriverLicenceDetails,[l.U.FiscalId]:u.PageView.ItemFiscalStatementDetails,[l.U.IdCard]:u.PageView.ItemIdCardDetails,[l.U.Passport]:u.PageView.ItemPassportDetails,[l.U.SocialSecurityId]:u.PageView.ItemSocialSecurityStatementDetails};(0,_.Nc)(e[c])}),[c]);const k=a.useMemo((()=>({confirmDeleteConfirm:n("webapp_id_edition_dialog_delete_confirm"),confirmDeleteDismiss:n("webapp_id_edition_dialog_delete_dismiss"),confirmDeleteSubtitle:n("webapp_id_edition_dialog_delete_subtitle"),confirmDeleteTitle:n(E),deleteSuccessToast:n(I)})),[E,I,n]),H=()=>{Z(),(0,_.Nc)(u.PageView.ItemIdList),(0,m.uX)(A)},G=!L||b.IdGroupTab.DETAILS===v;return(0,w.BX)(w.HY,{children:[(0,w.tZ)(p.h,{country:N,description:e(N),title:t,type:c,tabs:L?y:void 0}),G?(0,w.tZ)(R,{...i,setCurrentCountry:P,hasTabs:L,focusAttachment:U,cleanActiveTab:Z,showListView:H,children:d}):null,(0,w.tZ)(D.s,{isVisible:S,itemId:o.id,closeConfirmDeleteDialog:C,onDeletionSuccess:H,translations:k,vaultItemType:l.U.PaymentCard})]})};function P(e,t){return e.hasOwnProperty(t)}const k=({ID_TYPE:e,I18N_KEYS:t,listRoute:i,id:l,setDialogActive:u,lee:m,hasUnsavedData:_,setHasUnsavedData:p,children:D})=>{const{translate:h}=(0,s.Z)(),{status:b,item:g}=function(e,t){const{status:i,data:a}=(0,r.k)(c.L,"query",{vaultItemTypes:[e],ids:[t]});return{status:i,item:a?.[d[e]].items[0]}}(e,l),{showConfirmDelete:T,openConfirmDeleteDialog:f,closeConfirmDeleteDialog:S}=function(e){const[t,i]=a.useState(!1);return{showConfirmDelete:t,openConfirmDeleteDialog:()=>{i(!0),e(!0)},closeConfirmDeleteDialog:()=>{i(!1),e(!1)}}}(u);return b===n.rq.Success&&void 0!==g?(0,w.tZ)(N,{itemId:l,item:g,copySuccessKey:t.COPY_SUCCESS,deleteAlertTranslation:t.ALERT_DELETE,deleteDialogTitle:t.DIALOG_DELETE_TITLE,editAlertTranslation:t.ALERT_EDIT,initialValues:g,listRoute:i,reportError:m.reportError,showConfirmDelete:T,openConfirmDeleteDialog:f,closeConfirmDeleteDialog:S,hasUnsavedData:_,setHasUnsavedData:p,type:e,getDescription:e=>(0,o.Il)(h(t.HEADER_DESCRIPTION),h.getLocale(),e),title:(C=g,P(C,"idName")?C.idName:P(C,"idNumber")?C.idNumber:C.fiscalNumber),children:D}):null;var C}},872055:(e,t,i)=>{i.d(t,{a:()=>n});var a=i(914662);const n=new Set([a.cH.AU,a.cH.GB,a.cH.IE,a.cH.NZ])},762428:(e,t,i)=>{i.d(t,{P:()=>p});var a,n=i(696832),s=i(488203),o=i(177650),r=i(321143),l=i(806697),c=i(872055),d=i(16792),u=i(865212),m=i(524130);const _={...d.k},p=n.memo((({variant:e,handleCopy:t,country:i})=>{const{translate:d}=(0,s.Z)(),{shouldShowFrozenStateDialog:p}=(0,l.Ub)(),D=n.useRef(null);return n.useEffect("add"===e?()=>{const e=setTimeout((()=>{D.current?.focus()}),o.sc);return()=>clearTimeout(e)}:()=>{},[]),(0,m.BX)(m.HY,{children:[(0,m.tZ)(u.YI,{name:"idName",label:d(_.NAME_LABEL),placeholder:d(_.NAME_PLACEHOLDER),ref:D,disabled:!!p}),(0,m.tZ)(u.G1,{name:"idNumber",label:d(_.ID_NUMBER_LABEL),placeholder:d(_.ID_NUMBER_PLACEHOLDER),handleCopy:"edit"===e?t:void 0,disabled:!!p}),(0,m.tZ)(u.Nn,{name:"issueDate",label:d(_.ISSUE_DATE_LABEL),disabled:!!p}),(0,m.tZ)(u.Nn,{name:"expirationDate",label:d(c.a.has(i)?_.EXPIRATION_DATE_LABEL_UK:_.EXPIRATION_DATE_LABEL_US),disabled:!!p}),(0,m.tZ)(u.Dz,{name:"country",label:d(_.COUNTRY_LABEL),disabled:!!p}),a||(a=(0,m.tZ)(r.c,{height:24})),(0,m.tZ)(u.A0,{name:"spaceId",disabled:!!p})]})}))},682994:(e,t,i)=>{i.d(t,{s:()=>p}),i(696832);var a=i(364438),n=i(482598),s=i(133354),o=i(448430),r=i(488203);let l=function(e){return e.LastAdmin="LastAdmin",e.GroupSharing="GroupSharing",e.CollectionSharing="CollectionSharing",e.Generic="Generic",e}({});var c=i(365580),d=i(524130);const u=({reason:e,translations:t,goToSharingAccess:i,closeCantDeleteDialog:n})=>{const{translate:s}=(0,r.Z)(),o=((e,t)=>{const{groupSharingTitle:i,lastAdminTitle:a,collectionSharingTitle:n,genericErrorTitle:s}=e;switch(t){case l.LastAdmin:return a;case l.GroupSharing:return i;case l.CollectionSharing:return n;case l.Generic:return s;default:return(0,c.U)(t)}})(t,e),u=((e,t)=>{const{groupSharingSubtitle:i,lastAdminSubtitle:a,collectionSharingSubtitle:n,genericErrorSubtitle:s}=e;switch(t){case l.LastAdmin:return a;case l.GroupSharing:return i;case l.CollectionSharing:return n;case l.Generic:return s;default:return(0,c.U)(t)}})(t,e);return(0,d.tZ)(a.Vq,{isOpen:!0,onClose:n,title:null!=o?o:"",closeActionLabel:s("_common_dialog_dismiss_button"),actions:e===l.LastAdmin||l.GroupSharing||l.CollectionSharing?{primary:{children:t.lastAdminActionLabel,onClick:()=>{i(),n()}}}:void 0,children:u})};var m=i(837527);const _=({closeConfirmDeleteDialog:e,onDeleteConfirm:t,translations:i})=>{const{translate:n}=(0,r.Z)(),{confirmDeleteSubtitle:s,confirmDeleteTitle:o,confirmDeleteDismiss:l,confirmDeleteConfirm:c}=i;return(0,d.tZ)(a.Vq,{title:o,onClose:e,isOpen:!0,dialogClassName:m.Ht,closeActionLabel:n("_common_dialog_dismiss_button"),isDestructive:!0,actions:{primary:{children:c,onClick:t,id:"deletion-dialog-confirm-button"},secondary:{children:l,onClick:e,autoFocus:!0,id:"deletion-dialog-dismiss-button"}},children:s})},p=({closeConfirmDeleteDialog:e,goToSharingAccess:t,isVisible:i,itemId:c,onDeletionSuccess:m,sharingStatus:p,translations:D,vaultItemType:h,isShared:b,isSharedViaUserGroup:g,isItemInCollection:T,isLastAdmin:f})=>{const{showToast:S}=(0,a.pm)(),{translate:C}=(0,r.Z)(),{deleteVaultItems:E}=(0,n.u)(o.L);if(!i)return null;let I;return(b||p?.isShared)&&(g&&(I=l.GroupSharing),f&&(I=l.LastAdmin),T&&(I=l.CollectionSharing)),I&&t?(0,d.tZ)(u,{reason:I,translations:D,goToSharingAccess:t,closeCantDeleteDialog:e}):(0,d.tZ)(_,{closeConfirmDeleteDialog:e,onDeleteConfirm:async()=>{try{var e;(await E({ids:[c],vaultItemType:h})).tag===s.rq.Success?(S({description:null!=(e=D.deleteSuccessToast)?e:C("webapp_personal_info_edition_delete_success_toast")}),m()):S({description:C("_common_generic_error"),mood:"danger",isManualDismiss:!0})}catch(e){S({description:C("_common_generic_error"),mood:"danger",isManualDismiss:!0})}},translations:D})}}}]);