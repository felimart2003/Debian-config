"use strict";(globalThis.webpackChunk_dashlane_leeloo=globalThis.webpackChunk_dashlane_leeloo||[]).push([[8636],{682994:(e,t,i)=>{i.d(t,{s:()=>m}),i(696832);var a=i(364438),n=i(482598),s=i(133354),r=i(448430),l=i(488203);let o=function(e){return e.LastAdmin="LastAdmin",e.GroupSharing="GroupSharing",e.CollectionSharing="CollectionSharing",e.Generic="Generic",e}({});var c=i(365580),d=i(524130);const u=({reason:e,translations:t,goToSharingAccess:i,closeCantDeleteDialog:n})=>{const{translate:s}=(0,l.Z)(),r=((e,t)=>{const{groupSharingTitle:i,lastAdminTitle:a,collectionSharingTitle:n,genericErrorTitle:s}=e;switch(t){case o.LastAdmin:return a;case o.GroupSharing:return i;case o.CollectionSharing:return n;case o.Generic:return s;default:return(0,c.U)(t)}})(t,e),u=((e,t)=>{const{groupSharingSubtitle:i,lastAdminSubtitle:a,collectionSharingSubtitle:n,genericErrorSubtitle:s}=e;switch(t){case o.LastAdmin:return a;case o.GroupSharing:return i;case o.CollectionSharing:return n;case o.Generic:return s;default:return(0,c.U)(t)}})(t,e);return(0,d.tZ)(a.Vq,{isOpen:!0,onClose:n,title:null!=r?r:"",closeActionLabel:s("_common_dialog_dismiss_button"),actions:e===o.LastAdmin||o.GroupSharing||o.CollectionSharing?{primary:{children:t.lastAdminActionLabel,onClick:()=>{i(),n()}}}:void 0,children:u})};var _=i(837527);const p=({closeConfirmDeleteDialog:e,onDeleteConfirm:t,translations:i})=>{const{translate:n}=(0,l.Z)(),{confirmDeleteSubtitle:s,confirmDeleteTitle:r,confirmDeleteDismiss:o,confirmDeleteConfirm:c}=i;return(0,d.tZ)(a.Vq,{title:r,onClose:e,isOpen:!0,dialogClassName:_.Ht,closeActionLabel:n("_common_dialog_dismiss_button"),isDestructive:!0,actions:{primary:{children:c,onClick:t,id:"deletion-dialog-confirm-button"},secondary:{children:o,onClick:e,autoFocus:!0,id:"deletion-dialog-dismiss-button"}},children:s})},m=({closeConfirmDeleteDialog:e,goToSharingAccess:t,isVisible:i,itemId:c,onDeletionSuccess:_,sharingStatus:m,translations:h,vaultItemType:g,isShared:S,isSharedViaUserGroup:b,isItemInCollection:f,isLastAdmin:C})=>{const{showToast:D}=(0,a.pm)(),{translate:T}=(0,l.Z)(),{deleteVaultItems:I}=(0,n.u)(r.L);if(!i)return null;let A;return(S||m?.isShared)&&(b&&(A=o.GroupSharing),C&&(A=o.LastAdmin),f&&(A=o.CollectionSharing)),A&&t?(0,d.tZ)(u,{reason:A,translations:h,goToSharingAccess:t,closeCantDeleteDialog:e}):(0,d.tZ)(p,{closeConfirmDeleteDialog:e,onDeleteConfirm:async()=>{try{var e;(await I({ids:[c],vaultItemType:g})).tag===s.rq.Success?(D({description:null!=(e=h.deleteSuccessToast)?e:T("webapp_personal_info_edition_delete_success_toast")}),_()):D({description:T("_common_generic_error"),mood:"danger",isManualDismiss:!0})}catch(e){D({description:T("_common_generic_error"),mood:"danger",isManualDismiss:!0})}},translations:h})}},762042:(e,t,i)=>{i.d(t,{_:()=>o});var a=i(926897),n=i(488203),s=i(301639),r=i(524130);const l=({sharing:e})=>{const{translate:t}=(0,n.Z)();return(0,r.tZ)(s.Z,{tooltipPlacement:"top-start",sharing:e,text:t("webapp_sharing_invite_share"),origin:a.Origin.ItemDetailView})},o=({id:e,isShared:t,isAdmin:i,isDiscontinuedUser:a,getSharing:n})=>t&&!i||a?null:(0,r.tZ)(l,{sharing:n(e)})},768636:(e,t,i)=>{i.r(t),i.d(t,{SecretEditPanel:()=>M});var a=i(696832),n=i(448430),s=i(382706),r=i(242714),l=i(133354),o=i(488203),c=i(615940),d=i(762042),u=i(682994),_=i(376452),p=i(99822),m=i(78047),h=i(620800),g=i(833090),S=i(806697),b=i(979808),f=i(482598),C=i(310789),D=i(86498),T=i(692077),I=i(45272),A=i(926897),w=i(773157),v=i(740300),y=i(899193),Z=i(296352),E=i(524130);const{CONTENT:U,SHARED_ACCESS:x,DOCUMENT_STORAGE:L}=c.SecretsTabs,O=({secret:e,isShared:t,isAdmin:i,isSharedViaUserGroup:O,isLastAdmin:F})=>{var V,G,N;const{translate:k}=(0,o.Z)(),{routes:q}=(0,T.Xo)(),{navigateBack:P}=(0,Z.u)(),[R,M]=(0,a.useState)(U),[B,H]=(0,a.useState)(!1),[X,z]=(0,a.useState)(!1),[Y,K]=(0,a.useState)(!1),[W,$]=(0,a.useState)(!1),[j,J]=(0,a.useState)(!1),[Q,ee]=(0,a.useState)({id:e.id,limitedPermissions:t&&!i,title:e.title,content:e.content,spaceId:null!=(V=e.spaceId)?V:"",secured:null!=(G=e.isSecured)&&G,attachments:null!=(N=e.attachments)?N:[]}),{data:te,status:ie}=(0,b.r)(e.id),ae=function(){const{translate:e}=(0,o.Z)(),{showAlert:t}=(0,D.V)(),{updateVaultItem:i}=(0,f.u)(n.L);return async(a,n)=>{try{await i({vaultItemType:s.U.Secret,content:a,id:n})}catch{t(e("_common_generic_error"),C.BLW.ERROR)}}}(),{shouldShowFrozenStateDialog:ne}=(0,S.Ub)(),se=(0,r.o)("ace_secrets_vault_attachment")||!!e.attachments&&e.attachments.length>0,re=t&&ie===l.rq.Success&&null!=(le=te?.count)?le:0;var le;const oe=()=>{P(q.userSecrets)};if(!e)return oe(),null;const ce=async(t=!0,i)=>{var a;$(!0),await ae({title:Q.title,content:Q.content,spaceId:null!=(a=Q.spaceId)?a:"",isSecured:Q.secured,attachments:i},e.id),$(!1),t&&oe()},de=()=>{J(!0)},ue=async e=>{if(J(!1),e.success){await v.C.commitSecureFile({secureFileInfo:e.secureFileInfo});const t=[...Q.attachments,(0,y.w)(e.secureFileInfo)];ee((e=>({...e,attachments:t}))),ce(!1,t)}},_e={confirmDeleteConfirm:k("webapp_secrets_edition_delete_confirm"),confirmDeleteDismiss:k("webapp_credential_edition_delete_dismiss"),confirmDeleteSubtitle:k("webapp_credential_edition_confirm_delete_subtitle"),confirmDeleteTitle:k("webapp_secrets_edition_delete_title"),lastAdminActionLabel:k("webapp_credential_edition_change_permissions"),lastAdminTitle:k("webapp_credential_edition_last_admin_title"),lastAdminSubtitle:k("webapp_credential_edition_last_admin_subtitle"),groupSharingTitle:k("webapp_secrets_edition_group_sharing_title"),groupSharingSubtitle:k("webapp_credential_edition_group_sharing_subtitle"),genericErrorTitle:"webapp_account_recovery_generic_error_title",genericErrorSubtitle:"webapp_account_recovery_generic_error_subtitle"};if(null===ne)return null;const pe=t||se?[{active:R===U,label:k("webapp_secrets_edition_field_tab_title_details"),onClick:()=>M(U)}]:[];return t?pe.push({active:R===x,label:`${k("webapp_secure_notes_edition_field_tab_title_shared_access")} (${re})`,onClick:()=>M(x)}):se&&pe.push({active:R===L,label:k("webapp_secrets_edition_field_tab_title_attachments"),onClick:()=>M(L)}),(0,E.BX)(_.zI,{isUsingNewDesign:!0,isViewingExistingItem:!0,itemHasBeenEdited:B,onSubmit:()=>ce(),submitPending:W,secondaryActions:(()=>{switch(R){case U:return[(a=e,!a||t&&!i||a.attachments?.length?null:(0,E.tZ)(d._,{id:e.id,isShared:t,isAdmin:i,isDiscontinuedUser:ne,getSharing:p.fl},"shareaction")),ne?null:(0,E.tZ)(g.q,{copyValue:Q.content,buttonText:k("webapp_credential_edition_field_generic_action_copy"),onCopyToClipboard:()=>(0,I.Kz)(new A.UserCopyVaultItemFieldEvent({itemId:e.id,itemType:A.ItemType.Secret,field:A.Field.Secret,isProtected:e.isSecured}))},"copyaction")];case L:return[(0,E.tZ)(w.d,{isQuotaReached:!1,onFileUploadStarted:de,onFileUploadDone:ue,isShared:t,itemId:e.id,dataType:"KWSecret",disabled:!!ne},"uploadAction")];default:return[]}var a})(),onNavigateOut:oe,onClickDelete:()=>z(!0),ignoreCloseOnEscape:X||Y,isSomeDialogOpen:X,formId:"edit_secret_panel",header:(0,E.tZ)(h.h,{title:Q.title,tabs:pe}),children:[(0,E.tZ)(m.e,{activeTab:R,isAdmin:i,isAttachmentUploading:j,secretValues:Q,handleChange:(t,i)=>{if("spaceId"===t&&i===Q.spaceId)return;const a={...Q,[t]:i},n=e.title!==a.title||e.content!==a.content||e.spaceId!==a.spaceId||e.isSecured!==a.secured;n!==B&&H(n),ee(a)},handleFileInfoDetached:e=>{const t=Q.attachments.filter((t=>t.id!==e));ee((e=>({...e,attachments:t}))),ce(!1,t)},onModalDisplayStateChange:K}),(0,E.tZ)(u.s,{isVisible:X,itemId:e.id,closeConfirmDeleteDialog:()=>z(!1),goToSharingAccess:()=>{M(c.SecretsTabs.SHARED_ACCESS)},onDeletionSuccess:oe,translations:_e,vaultItemType:s.U.Secret,isShared:t,isLastAdmin:F,isSharedViaUserGroup:O})]})};var F=i(995445),V=i(799852),G=i(348958),N=i(982466),k=i(830894),q=i(832971),P=i(15192);const R=e=>{const{secret:t}=e,i=(0,k.tY)();(0,a.useEffect)((()=>{(0,I.Nc)(A.PageView.ItemSecretDetails)}),[t]);const{getPermissionForItem:n,getSharingStatusForItem:s,getIsLastAdminForItem:r}=(0,F.Y)(G.X,{getPermissionForItem:{queryParam:{itemId:t.id}},getSharingStatusForItem:{queryParam:{itemId:t.id}},getIsLastAdminForItem:{queryParam:{itemId:t.id}}},[]);if(n.status!==l.rq.Success||s.status!==l.rq.Success||r.status!==l.rq.Success)return null;const{isShared:o,isSharedViaUserGroup:c}=s.data,{isLastAdmin:d}=r.data;return(0,E.tZ)(O,{...e,...i,isShared:o,isAdmin:o&&n.data.permission===N.y3.Admin,isSharedViaUserGroup:c,isLastAdmin:d})},M=e=>{const{routes:t}=(0,T.Xo)(),{data:i,status:a}=(0,V.k)(n.L,"query",{vaultItemTypes:[s.U.Secret],ids:[`{${e.match.params.uuid}}`]});return a===l.rq.Loading?null:i?.secretsResult.items.length?(0,E.tZ)(R,{...e,secret:i.secretsResult.items[0]}):e.location?.state?(0,E.tZ)(P.l_,{to:(0,q.rF)(e.location.state,t)}):(0,E.tZ)(P.l_,{to:t.userSecrets})}},615940:(e,t,i)=>{i.d(t,{SecretsTabs:()=>a});let a=function(e){return e[e.CONTENT=0]="CONTENT",e[e.SHARED_ACCESS=1]="SHARED_ACCESS",e[e.DOCUMENT_STORAGE=2]="DOCUMENT_STORAGE",e}({})},620800:(e,t,i)=>{i.d(t,{h:()=>l});var a,n=i(364438),s=i(376452),r=i(524130);const l=({title:e,tabs:t})=>(0,r.tZ)(s.V9,{icon:(0,r.tZ)("div",{sx:{width:"168px",height:"108px",borderStyle:"solid",borderWidth:"1px",borderRadius:"4px",borderColor:"ds.border.neutral.quiet.idle",display:"flex",justifyContent:"center",alignItems:"center"},children:a||(a=(0,r.tZ)(n.JO,{name:"ItemSecretOutlined",color:"ds.text.neutral.standard",size:"xlarge"}))}),title:e,tabs:t})},78047:(e,t,i)=>{i.d(t,{e:()=>I});var a=i(696832),n=i(364438),s=i(133354),r=i(980936),l=i(488203),o=i(555449),c=i(433988),d=i(154350),u=i(468037),_=i(167406),p=i(615940),m=i(806697),h=i(61014),g=i(926897),S=i(524130);const{CONTENT:b,SHARED_ACCESS:f,DOCUMENT_STORAGE:C}=p.SecretsTabs,D="webapp_secure_notes_edition_field_text_max_size_reached",T=1e4,I=({activeTab:e,isAdmin:t,isAttachmentUploading:i,secretValues:p,handleChange:I,handleFileInfoDetached:A,onModalDisplayStateChange:w})=>{const{translate:v}=(0,l.Z)(),[y,Z]=(0,a.useState)(""),{shouldShowFrozenStateDialog:E}=(0,m.Ub)(),U=(0,c.F)(),{isMPLessUser:x}=(0,d.Z)(),L=!U&&!x,O=(0,r.I)(),F=O.status===s.rq.Success&&!O.isDisabled,{id:V,limitedPermissions:G,title:N,content:k,spaceId:q,secured:P}=p;return null===E?null:(0,S.BX)(S.HY,{children:[e===b&&(0,S.BX)(S.HY,{children:[(0,S.BX)(u.u,{title:v("webapp_secrets_box_title_details"),children:[(0,S.tZ)(n.qo,{"data-name":"title",label:v("webapp_secrets_title_field"),value:N,onChange:e=>I("title",e.target.value),disabled:G,readOnly:E,sx:{marginBottom:"8px"}}),(0,S.tZ)(n.Kx,{"data-name":"content",label:v("webapp_secrets_content_field"),placeholder:v("webapp_secrets_content_field_placeholder"),value:k,onBeforeInput:e=>{const t=e.currentTarget.value;t.length>T&&(Z(v(D,{charLeft:T-(t.length-1)})),e.preventDefault())},onPaste:e=>{const t=e.clipboardData.getData("text/plain");e.currentTarget.value.length+t.length>T&&(Z(v(D,{charLeft:T-e.currentTarget.value.length})),e.preventDefault())},onChange:e=>{y&&Z(""),I("content",e.target.value)},disabled:G,readOnly:E,feedback:y?{text:y}:void 0,error:!!y})]}),F?(0,S.tZ)(u.u,{title:v("webapp_secrets_box_title_organization"),additionalSx:{marginTop:"16px"},children:(0,S.tZ)("div",{children:(0,S.tZ)(_.M,{disabled:E,isUsingNewDesign:!0,defaultSpaceId:null!=q?q:"",spaceId:null!=q?q:"",onChange:e=>I("spaceId",e)})})}):null,L?(0,S.tZ)(u.u,{title:v("webapp_secrets_box_title_preferences"),additionalSx:{marginTop:"16px"},children:(0,S.tZ)(n.XZ,{readOnly:E,label:v("webapp_secrets_preferences_mp_title"),description:v("webapp_secrets_preferences_mp_description"),checked:P,onChange:({target:e})=>I("secured",e.checked)})}):null]}),e===C&&(0,S.tZ)(h.P,{attachments:p.attachments,additionalProps:{itemId:V,itemType:g.ItemType.Secret,handleFileInfoDetached:e=>{A(e)},onModalDisplayStateChange:w,isUploading:i}}),e===f&&(0,S.tZ)(o.u,{isAdmin:t,id:V})]})}}}]);