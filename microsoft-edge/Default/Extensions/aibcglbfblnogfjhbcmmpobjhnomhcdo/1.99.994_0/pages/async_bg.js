let e=1;export const OnChrome=true;export const OnFirefox=!!0;export const OnEdge=!!0;export const OnSafari=!!0;let t,o,n=navigator.userAgentData,r=n&&n.brands;export const IsEdg_=r?!!r.find(e=>e.brand.includes("Edge")||e.brand.includes("Microsoft")):matchMedia("(-ms-high-contrast)").matches;export const CurCVer_=r&&(t=r.find(e=>e.brand.includes("Chromium")))&&parseInt(t.version)>82?parseInt(t.version):0|(navigator.userAgent.match(/\bChrom(?:e|ium)\/(\d+)/)||[0,998])[1];export let CurFFVer_=999;export let BrowserName_;export let PageOs_=9;export const setupPageOs_=e=>{PageOs_=e};export const browser_=chrome;export const isVApiReady_=new Promise(e=>{let t;o=new Promise(e=>{t=e}),addEventListener("VimiumC",()=>{k(t),nextTick_(e)},{once:true,capture:true})});let l=4,s={},i=new Map,a=null,c=null,p=null,u=Object.create(null),d=1,_=null;export let selfTabId_=-1;let x=e=>{if(_&&(c=0),false===e)return void alert("Can not send info to the background: not trusted");let t=u[e.i];delete u[e.i];for(let o=e.a,n=0;n<t.length;n++)t[n](o[n]);VApi&&_&&0===Object.keys(u).length&&h()},m=e=>{e="function"==typeof structuredClone?structuredClone(e):JSON.parse(JSON.stringify(e)),x(e)},f=()=>{_=0,console.log("[WARNING] the temp port is disconnected unexpectedly; need to replay messages using VApi"),c&&o.then(()=>{let e=c,t=e?Object.keys(u):[];c=0;for(let o of t){let t=u[o],n=e[o];n&&t&&(a=n,p=t,g(n.length))}})},g=e=>{if(!a)return;let t=VApi,o=a.length;if(o>(e||1))return void k(g.bind(null,o));if(t&&_&&0===Object.keys(u).length&&h(),0===e)return void(a=p=null);let n=d++;u[n]=p,p=null;let r=browser_.extension.getBackgroundPage,l=r&&r();l&&l.onPagesReq?l.onPagesReq({i:n,q:a}).then(x):t?t.r[0](40,{i:n,q:a},x):(null==_&&(_=browser_.runtime.connect({name:"128"}),_.onMessage.addListener(x),_.onDisconnect.addListener(f)),_&&_.postMessage({H:40,i:n,q:a}),0!==c&&((c||(c=Object.create(null)))[n]=a)),a=null};export const post_=(e,t)=>new Promise(o=>{a||b(),a.push({n:e,q:void 0!==t?t:null}),p.push(o)});let b=()=>{a||(a=[],p=[],k(g))};export{b as disconnect_};let h=()=>{let e=_;_=null,e&&(e.onDisconnect.removeListener(f),e.onMessage.removeListener(x),e.disconnect())},k=queueMicrotask;export const $=e=>document.querySelector(e);export const $$=(e,t)=>{let o=(t||document).querySelectorAll(e);return[].slice.call(o)};export const toggleDark_=e=>{let t=document.head.querySelector("meta[name=color-scheme]"),o=2===e?"light dark":1===e?"dark":"light";if(t.content!==o){t.content=o;let n=document.documentElement.classList;n.toggle("no-dark",!e),n.toggle("dark",1===e)}};export const toggleReduceMotion_=e=>{document.documentElement.classList.toggle("less-motion",e)};export let enableNextTick_;let w=null;export const nextTick_=(()=>{let e=()=>{let n=t.length;for(let e=0;e<n;e++)(0,t[e])();t.length>n?(t.splice(0,n),k(e)):(t.length=0,o=0)},t=[],o=0;return enableNextTick_=(t,o)=>{l=(l|t)&~(o||0),7===l&&k(e)},(o,n)=>{if(t.length<=0&&7===l&&k(e),9===n)t.unshift(o);else{let e=n?o.bind(null,n):o;t.push(e)}}})();export const import2_=e=>import(e);export const pageTrans_=(e,t)=>{let o=i.get(e);return null!=t&&o&&(o=o.replace(/\$\d/g,e=>t[+e[1]-1])),o};let O=(e,t)=>e&&e.split(" ").reduce((e,o)=>e||(o.includes("=")?o.startsWith(t)?o.slice(t.length+1):e:o),"");export const bTrans_=browser_.i18n.getMessage;let y=location.pathname.replace("/pages/","").split(".")[0],T=bTrans_("lang1");export const pageLangs_=O(bTrans_("i18n"),y)||T||"en";let V=!0,v=e=>{let t=i;for(let o of e.reverse()){if(!o)continue;let e=V?o.default:JSON.parse(o.slice(14));for(let o in e)t.set(o,e[o])}enableNextTick_(2)};export const onDicts_=V?v:0;export const curPagePath_=V?y:0;if("options"!==y&&"popup"!==y&&onDicts_(await Promise.all(pageLangs_.split(",").map(e=>import(`/i18n/${e}/${"show"===y?"popup":y}.js`)))),browser_.storage.local.get("autoDarkMode",e=>{let t=e&&e.autoDarkMode;return(false===t||1===t||0===t)&&toggleDark_(t?1:0),browser_.runtime.lastError}),T&&"popup"!==y){let e=bTrans_("v"+y);e&&(document.title="Vimium C "+e)}"options"===y&&isVApiReady_.then(()=>{VApi.r[0](40,{i:1,q:[{n:26,q:null}]},e=>{false!==e&&(selfTabId_=e.a[0])})});export const simulateClick_=(e,t)=>{let o;return t=t||{ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},o=new MouseEvent("click",{bubbles:true,cancelable:true,composed:!0,view:window,detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,button:0,buttons:1,relatedTarget:null}),e.dispatchEvent(o)};export const hasShift_=e=>e.shiftKey;export const isRepeated_=e=>e.repeat;export const prevent_=e=>{e.preventDefault();let t="keydown"===e.type?e.keyCode:0;!t||!PageOs_&&e.metaKey||VApi&&(VApi.a()[t]=1)};"undefined"==typeof VApi&&(globalThis.VApi=void 0);