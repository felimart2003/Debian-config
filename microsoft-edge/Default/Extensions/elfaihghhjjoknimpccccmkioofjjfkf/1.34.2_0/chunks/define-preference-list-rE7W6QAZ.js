import{f as u,o as l,q as _,w as p,Q as y,i as d,c as P,j as m,r as A,bf as E,bY as S,dj as x,n as F,k,g as C,l as O,a_ as U,Y as B,t as V,$ as D,F as j,N as G,ay as w,as as R,z as T}from"./defineAppConfig-GTQ5Bvuh.js";import{a as g,_ as I}from"./DurationPreference.vue_vue_type_script_setup_true_lang-NHMaeWMZ.js";import{l as q,j as z,b as H}from"./useAddAppToIgnoreListDialogStore-Ki2J31d-.js";import{i as Y,z as M,B as Q,m as J}from"./recent-apps-provider-OWite7eM.js";const K=u({name:"ButtonPreference",__name:"ButtonPreference",props:{pref:{}},setup(n){return(e,s)=>(l(),_(g,{pref:e.pref},{"right-content":p(()=>[d("button",{class:"btn btn-primary",onClick:s[0]||(s[0]=r=>e.pref.onClick())},y(e.pref.buttonText),1)]),_:1},8,["pref"]))}}),W={class:"text-base-content text-opacity-primary text-2xl font-light pr-4"},X=u({name:"ClickablePreference",__name:"ClickablePreference",props:{pref:{}},setup(n){const e=n,s=P(()=>{var r;return(r=e.pref.label)==null?void 0:r.value});return(r,o)=>(l(),_(g,{pref:r.pref,class:"cursor-pointer clickable rounded",onClick:r.pref.onClick},{"right-content":p(()=>[d("p",W,y(m(s)),1)]),_:1},8,["pref","onClick"]))}}),Z={class:"relative overflow-hidden"},ee=["accept"],te=u({name:"FileUploadPreference",__name:"FileUploadPreference",props:{pref:{}},setup(n){const e=n,s=A();function r(){var t;(t=s.value)==null||t.click()}const o=P(()=>{const t=e.pref.acceptExtensions;if(!(t==null||t.length===0))return t.join(" ")});function f(){const t=new FileReader,[a,h,v]=x();return t.onload=()=>{h(t.result)},t.onerror=()=>v(t.error),[t,a]}async function i(t){var $;const a=t.target,h=($=a==null?void 0:a.files)==null?void 0:$[0];if(h==null){E("[file-upload-preference] Selected file cleared");return}const[v,b]=f();v.readAsDataURL(h);const c=await b;if(c==null)S("File contents were null");else if(typeof c=="string"){const N=c.slice(c.indexOf(",")+1);await e.pref.onFileContents(N),a.value=""}else S("File contents were a BufferArray, not a string;")}return(t,a)=>(l(),_(g,{pref:t.pref},{"right-content":p(()=>[d("div",Z,[d("input",{ref_key:"input",ref:s,class:"absolute inset-0 h-full w-full opacity-0 min-w-0",type:"file",accept:m(o),onChange:i},null,40,ee),d("button",{class:"btn btn-primary relative",onClick:r},y(t.$t("chooseFile")),1)])]),_:1},8,["pref"]))}}),re={class:"pr-4"},ne=u({name:"LinkPreference",__name:"LinkPreference",props:{pref:{}},setup(n){const e=n;return(s,r)=>{const o=F("router-link");return l(),_(o,{class:"group",style:{"text-decoration":"none"},to:s.pref.href},{default:p(()=>[k(g,{pref:e.pref,class:"cursor-pointer clickable rounded"},{"right-content":p(()=>[d("div",re,[k(m(q),{class:"icon-lg text-base-content text-opacity-50 group-hover:text-primary group-hover:text-opacity-100"})])]),_:1},8,["pref"])]),_:1},8,["to"])}}}),se={key:0,class:"pref-section"},oe={class:"pref-section-title"},ae=u({name:"PreferenceGroup",__name:"PreferenceGroup",props:{group:{}},setup(n){const e=n,s=P(()=>!e.group.when||e.group.when.value);return(r,o)=>(l(),_(U,{name:"fade-down"},{default:p(()=>[m(s)?(l(),C("section",se,[d("h2",oe,y(r.group.name),1),k(m(L),{preferences:r.group.preferences},null,8,["preferences"])])):O("v-if",!0)]),_:1}))}}),ce=["value"],ie=u({name:"SelectPreference",__name:"SelectPreference",props:{pref:{}},setup(n){const e=n,{t:s}=B(),{reportEvent:r}=V(),o=e.pref.useValue();function f(){r("CHANGED_SETTING",{id:e.pref.id,value:o.value})}return(i,t)=>(l(),_(g,{pref:i.pref},{"right-content":p(()=>[k(Y,{id:"theme",class:"pr-4 w-48",placeholder:i.pref.placeholder,"select-helper-text":m(s)("selectOne"),modelValue:m(o),"onUpdate:modelValue":t[0]||(t[0]=a=>D(o)?o.value=a:null)},{default:p(()=>[(l(!0),C(j,null,G(i.pref.options,a=>(l(),C("option",{key:a.value,value:a.value,onClick:f},y(a.display),9,ce))),128))]),_:1},8,["placeholder","select-helper-text","modelValue"])]),_:1},8,["pref"]))}}),le={class:"pr-4"},pe=u({name:"SwitchPreference",__name:"SwitchPreference",props:{pref:{}},setup(n){const e=n,{reportEvent:s}=V(),r=e.pref.useValue();function o(){s("CHANGED_SETTING",{id:e.pref.id,value:r.value})}return(f,i)=>(l(),_(g,{pref:f.pref},{"right-content":p(()=>[d("div",le,[k(M,{"data-testid":`switch-${f.pref.id}`,modelValue:m(r),"onUpdate:modelValue":i[0]||(i[0]=t=>D(r)?r.value=t:null),onClick:o},null,8,["data-testid","modelValue"])])]),_:1},8,["pref"]))}}),ue={button:K,"file-upload":te,click:X,link:ne,switch:pe,select:ie,duration:I},L=u({name:"PreferenceList",props:{preferences:{type:Array,required:!0}},render(){return this.preferences.map(n=>n.type==="group"?n.preferences.length>0?w(ae,{group:n}):null:w(ue[n.type],{pref:n}))}});function fe(n=Q()){return e=>{const[s,r,o]=x();return n.show({initialTimeOfDay:e,onDismiss:()=>o(void 0),onPick:r}),s}}function ge(n){return u({name:"PreferenceListDefinition",setup(){const{t:e}=B(),s=z(),r=c=>s.show({message:c}),o=H(),f=()=>o.show(T.Loading),i=()=>o.hide(T.Loading),t=J(),a=c=>{t.show({title:c.title,message:c.message,positiveButtonText:c.positiveButtonText??e("preferences.resetButton"),negativeButtonText:c.negativeButtonText??e("cancel"),destructive:!0,async onClickPositive(){return await c.onConfirm(),!0}})},h=R(),v=fe();return{preferences:n({t:e,showAlert:r,showLoading:f,hideLoading:i,confirmDestroy:a,prefs:h,pickTimeOfDay:v})}},render(){return w(L,{preferences:this.preferences})}})}export{ge as d};
