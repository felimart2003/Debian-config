import{f as u,o as p,q as _,w as i,ad as x,U as y,T as V,k as m,c as P,j as d,i as g,r as F,bf as U,bY as T,cU as B,n as O,g as C,l as G,ak as R,a0 as D,t as L,a1 as A,F as I,Q as j,aB as w,au as q,A as S}from"./defineAppConfig-_73fm9CR.js";import{a as v,_ as H}from"./DurationPreference.vue_vue_type_script_setup_true_lang-w840PD0r.js";import{k as z,g as M,i as Q,b as Y}from"./useAddAppToIgnoreListDialogStore-gHGl-4Ba.js";import{_ as J}from"./new-tab-light-diPYHp27.js";import{z as K,m as W}from"./recent-apps-provider-H_KyoG2W.js";const X=u({name:"ButtonPreference",__name:"ButtonPreference",props:{pref:{}},setup(n){return(e,o)=>(p(),_(v,{pref:e.pref},{"right-content":i(()=>[m(x,{onClick:o[0]||(o[0]=t=>e.pref.onClick())},{default:i(()=>[V(y(e.pref.buttonText),1)]),_:1})]),_:1},8,["pref"]))}}),Z={class:"text-on-background text-opacity-primary text-2xl font-light pr-4"},ee=u({name:"ClickablePreference",__name:"ClickablePreference",props:{pref:{}},setup(n){const e=n,o=P(()=>{var t;return(t=e.pref.label)==null?void 0:t.value});return(t,s)=>(p(),_(v,{pref:t.pref,class:"cursor-pointer clickable rounded",onClick:t.pref.onClick},{"right-content":i(()=>[g("p",Z,y(d(o)),1)]),_:1},8,["pref","onClick"]))}}),re={class:"relative overflow-hidden"},te=["accept"],ne=u({name:"FileUploadPreference",__name:"FileUploadPreference",props:{pref:{}},setup(n){const e=n,o=F();function t(){var r;(r=o.value)==null||r.click()}const s=P(()=>{const r=e.pref.acceptExtensions;if(!(r==null||r.length===0))return r.join(" ")});function f(){const r=new FileReader,[a,h,k]=B();return r.onload=()=>{h(r.result)},r.onerror=()=>k(r.error),[r,a]}async function l(r){var b;const a=r.target,h=(b=a==null?void 0:a.files)==null?void 0:b[0];if(h==null){U("[file-upload-preference] Selected file cleared");return}const[k,$]=f();k.readAsDataURL(h);const c=await $;if(c==null)T("File contents were null");else if(typeof c=="string"){const E=c.slice(c.indexOf(",")+1);await e.pref.onFileContents(E),a.value=""}else T("File contents were a BufferArray, not a string;")}return(r,a)=>(p(),_(v,{pref:r.pref},{"right-content":i(()=>[g("div",re,[g("input",{ref_key:"input",ref:o,class:"absolute inset-0 h-full w-full opacity-0 min-w-0",type:"file",accept:d(s),onChange:l},null,40,te),m(x,{class:"relative",onClick:t},{default:i(()=>[V(y(r.$t("chooseFile")),1)]),_:1})])]),_:1},8,["pref"]))}}),oe={class:"pr-4"},se=u({name:"LinkPreference",__name:"LinkPreference",props:{pref:{}},setup(n){const e=n;return(o,t)=>{const s=O("router-link");return p(),_(s,{class:"group",style:{"text-decoration":"none"},to:o.pref.href},{default:i(()=>[m(v,{pref:e.pref,class:"cursor-pointer clickable rounded"},{"right-content":i(()=>[g("div",oe,[m(d(z),{class:"icon-lg text-on-background text-opacity-50 group-hover:text-primary group-hover:text-opacity-100"})])]),_:1},8,["pref"])]),_:1},8,["to"])}}}),ae={key:0,class:"pref-section"},ce={class:"pref-section-title"},ie=u({name:"PreferenceGroup",__name:"PreferenceGroup",props:{group:{}},setup(n){const e=n,o=P(()=>!e.group.when||e.group.when.value);return(t,s)=>(p(),_(R,{name:"fade-down"},{default:i(()=>[d(o)?(p(),C("section",ae,[g("h2",ce,y(t.group.name),1),m(d(N),{preferences:t.group.preferences},null,8,["preferences"])])):G("v-if",!0)]),_:1}))}}),le=["value"],pe=u({name:"SelectPreference",__name:"SelectPreference",props:{pref:{}},setup(n){const e=n,{t:o}=D(),{reportEvent:t}=L(),s=e.pref.useValue();function f(){t("CHANGED_SETTING",{id:e.pref.id,value:s.value})}return(l,r)=>(p(),_(v,{pref:l.pref},{"right-content":i(()=>[m(M,{id:"theme",class:"pr-4 w-48",placeholder:l.pref.placeholder,"select-helper-text":d(o)("selectOne"),modelValue:d(s),"onUpdate:modelValue":r[0]||(r[0]=a=>A(s)?s.value=a:null)},{default:i(()=>[(p(!0),C(I,null,j(l.pref.options,a=>(p(),C("option",{key:a.value,value:a.value,onClick:f},y(a.display),9,le))),128))]),_:1},8,["placeholder","select-helper-text","modelValue"])]),_:1},8,["pref"]))}}),ue={class:"pr-4"},fe=u({name:"SwitchPreference",__name:"SwitchPreference",props:{pref:{}},setup(n){const e=n,{reportEvent:o}=L(),t=e.pref.useValue();function s(){o("CHANGED_SETTING",{id:e.pref.id,value:t.value})}return(f,l)=>(p(),_(v,{pref:f.pref},{"right-content":i(()=>[g("div",ue,[m(J,{"data-testid":`switch-${f.pref.id}`,modelValue:d(t),"onUpdate:modelValue":l[0]||(l[0]=r=>A(t)?t.value=r:null),onClick:s},null,8,["data-testid","modelValue"])])]),_:1},8,["pref"]))}}),de={button:X,"file-upload":ne,click:ee,link:se,switch:fe,select:pe,duration:H},N=u({name:"PreferenceList",props:{preferences:{type:Array,required:!0}},render(){return this.preferences.map(n=>n.type==="group"?n.preferences.length>0?w(ie,{group:n}):null:w(de[n.type],{pref:n}))}});function me(n=K()){return e=>{const[o,t,s]=B();return n.show({initialTimeOfDay:e,onDismiss:()=>s(void 0),onPick:t}),o}}function ye(n){return u({name:"PreferenceListDefinition",setup(){const{t:e}=D(),o=Q(),t=c=>o.show({message:c}),s=Y(),f=()=>s.show(S.Loading),l=()=>s.hide(S.Loading),r=W(),a=c=>{r.show({title:c.title,message:c.message,positiveButtonText:c.positiveButtonText??e("preferences.resetButton"),negativeButtonText:c.negativeButtonText??e("cancel"),destructive:!0,async onClickPositive(){return await c.onConfirm(),!0}})},h=q(),k=me();return{preferences:n({t:e,showAlert:t,showLoading:f,hideLoading:l,confirmDestroy:a,prefs:h,pickTimeOfDay:k})}},render(){return w(N,{preferences:this.preferences})}})}export{ye as d};
