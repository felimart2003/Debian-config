import{o as n,g as v,i as o,f as q,a5 as X,N,a0 as ee,x as ie,t as ne,aT as ce,c as b,r as L,b7 as I,y as w,ar as pe,a as te,n as ae,U as i,j as e,l as p,k as T,w as S,a1 as O,q as M,I as Y,ad as Z,aX as se,Y as x,F as oe,Q as ue,T as R,D as H,bT as de,aS as G,b0 as me,b1 as ve,bh as fe,aR as ye,bU as _e,ah as he,aM as ge,S as F,aj as be,E as xe,s as V,aD as Ie,p as Se,m as Ae,_ as ke,b5 as De,ax as Q,bV as Te}from"./defineAppConfig-_73fm9CR.js";import{n as Fe,r as Me,g as j,J as $e,q as we,A as Ce,_ as Ue,l as Pe}from"./useAddAppToIgnoreListDialogStore-gHGl-4Ba.js";import{u as Ve}from"./useVibrantColor-SQN7_oFR.js";import{u as Ee}from"./useAddIgnoredAppMutation-CH2IvljW.js";import{g as Le}from"./useGetSessionSummaries-MLl_K4v8.js";const Re={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},He=o("path",{fill:"currentColor",d:"M6 13h12v-2H6M3 6v2h18V6M10 18h4v-2h-4v2Z"},null,-1),Be=[He];function Ne(l,t){return n(),v("svg",Re,Be)}const It={name:"mdi-filter-variant",render:Ne},Oe=["onSubmit"],Ge={key:0,class:"text-lg text-adaptive text-opacity-secondary"},Qe=["value"],je=["value"],qe=["value"],ze=["value"],Ke=["value"],We=["value"],Je=["value"],Xe={key:2,class:"space-y-1"},Ye=["value"],Ze={key:3,class:"flex flex-row-reverse gap-4"},E="all",St=q({name:"SessionsFilterForm",__name:"SessionsFilterForm",props:X({hideTitle:{type:Boolean},autoApply:{type:Boolean}},{primaryMetric:{required:!0},installIds:{},platformFilter:{}}),emits:X(["submit","cancel"],["update:primaryMetric","update:installIds","update:platformFilter"]),setup(l,{emit:t}){var J;const u=l,c=N(l,"primaryMetric"),m=N(l,"installIds"),f=N(l,"platformFilter"),{t:a}=ee(),{remoteConfig:k}=ie(),{reportEvent:A}=ne(),{deviceGroup:D}=ce(Fe()),{data:C}=Me(D),y=b(()=>D.value!=null),d=L(((J=m.value)==null?void 0:J[0])??E),g=L(c.value),s=L(f.value??I.All);w(c,r=>{A("UPDATE_FILTER",{primaryMetric:r}),g.value=r}),w(m,r=>{A("UPDATE_FILTER",{installIds:r}),d.value=(r==null?void 0:r[0])??E}),w(f,r=>{A("UPDATE_FILTER",{filterPlatform:r}),s.value=r||I.All});const U=b(()=>g.value===x.Ads);let P=d.value,z=s.value,B=!1;w(g,r=>{r===x.Ads&&y.value?(P=d.value,z=s.value,B=!0,d.value=W.value,s.value=I.Web):r!==x.Ads&&B&&(d.value=P,s.value=z,B=!1)});function K(){const r=d.value!==E?[d.value]:void 0;de(m.value,G(r))||(m.value=r);const _=g.value;c.value!==G(_)&&(c.value=_);const $=s.value;f.value!==G($)&&(f.value=$===I.All?void 0:$),t("submit")}const W=pe();w([g,d,s],function(){u.autoApply&&K()});const re=te("Advertisements");return(r,_)=>{const $=ae("router-link");return n(),v("form",{class:"space-y-4",onSubmit:se(K,["prevent"])},[r.hideTitle?p("v-if",!0):(n(),v("h3",Ge,i(e(a)("filter")),1)),T(j,{id:"usage-metric",modelValue:e(g),"onUpdate:modelValue":_[0]||(_[0]=h=>O(g)?g.value=h:null),placeholder:e(a)("usageMetric"),"select-helper-text":e(a)("selectOne")},{default:S(()=>[o("option",{value:e(x).UsageTime},i(e(a)("usageTime")),9,Qe),o("option",{value:e(x).Sessions},i(e(a)("sessions")),9,je),e(re)?(n(),v("option",{key:0,value:e(x).Ads},i(e(a)("advertisements")),9,qe)):p("v-if",!0)]),_:1},8,["modelValue","placeholder","select-helper-text"]),e(y)?(n(),M(j,{key:1,id:"app-type",modelValue:e(s),"onUpdate:modelValue":_[1]||(_[1]=h=>O(s)?s.value=h:null),placeholder:e(a)("appType"),"select-helper-text":e(a)("selectOne"),disabled:e(U)},{default:S(()=>[o("option",{value:e(I).All},i(e(a)("devices.platform.all")),9,ze),o("option",{value:e(I).Web},i(e(a)("devices.platform.web")),9,Ke),o("option",{value:e(I).Android},i(e(a)("devices.platform.android")),9,We),o("option",{value:e(I).Desktop},i(e(a)("devices.platform.desktop")),9,Je)]),_:1},8,["modelValue","placeholder","select-helper-text","disabled"])):p("v-if",!0),e(k).crossPlatform?(n(),v("div",Xe,[T(j,{id:"devices",modelValue:e(d),"onUpdate:modelValue":_[2]||(_[2]=h=>O(d)?d.value=h:null),placeholder:e(a)("devices.title"),"select-helper-text":e(a)("allDevices"),"enable-helper-text":"","helper-text-value":E,disabled:!e(y)||e(U)},{default:S(()=>[e(D)?(n(!0),v(oe,{key:0},ue(e(C),h=>(n(),v("option",{key:h.install_id,value:h.install_id},i(h.install_id===e(W)?e(a)("devices.thisDevice"):h.name.trim()||e(a)("devices.unknownDeviceName")),9,Ye))),128)):p("v-if",!0)]),_:1},8,["modelValue","placeholder","select-helper-text","disabled"]),e(y)?p("v-if",!0):(n(),M(Y,{key:0,keypath:"devices.installCta",tag:"p",class:"text-sm text-adaptive text-opacity-secondary"},{default:S(()=>[T($,{to:e(H).devices},{default:S(()=>[R(i(e(a)("learnMore")),1)]),_:1},8,["to"])]),_:1})),e(y)&&e(U)?(n(),M(Y,{key:1,keypath:"devices.disableDeviceText",tag:"p",class:"text-sm text-adaptive text-opacity-secondary"})):p("v-if",!0)])):p("v-if",!0),r.autoApply?p("v-if",!0):(n(),v("div",Ze,[T(Z,{class:"flex-grow",type:"submit"},{default:S(()=>[R(i(e(a)("apply")),1)]),_:1}),T(Z,{class:"flex-grow",color:"transparent",onClick:_[3]||(_[3]=h=>t("cancel"))},{default:S(()=>[R(i(e(a)("cancel")),1)]),_:1})]))],40,Oe)}}}),et=8,tt=13,le="hourly-usage";function At(l,t=ye()){const{state:u}=me(),c=b(()=>u.value==ve.Hour24),{state:m}=$e();return we([le,l,m],t.getChartData,{keepPreviousData:!0,placeholderData:{labels:fe(tt,f=>{const a=(et+f)*he;return _e(a,{is24HourFormat:c.value})}),series:[]}})}const at=["onClick"],st=q({name:"AddAppToIgnoreList",__name:"AddAppToIgnoreList",props:{appName:{},appId:{},platform:{}},setup(l){const t=l,{t:u}=ee(),c=ge(),{mutate:m}=Ee();function f(){t.platform!==F.Category&&m({appId:t.appId,platform:t.platform})}async function a(){await c.invalidateQueries({queryKey:`remote-${le}`}),await c.invalidateQueries({queryKey:`remote-${Le}`})}const k=Ce();function A(){k.show({appName:t.appName,addAppToIgnoreList:f,onSubmit:a})}return(D,C)=>(n(),v("button",{class:"ms-1 text-primary py-0 px-1 border-2 text-xs rounded-md inline-block align-text-top",onClick:se(A,["prevent"])},i(e(u)("hide")),9,at))}});function ot(){return be(xe.IsPopup,!1)}const lt=l=>(Se("data-v-26748ebd"),l=l(),Ae(),l),rt={class:"mr-4 flex-shrink-0 w-10 h-10"},it={key:1,class:"animated-spinner absolute inset-0 rounded-full"},nt={class:"flex-1 flex flex-col min-w-0"},ct={class:"flex flex-row space-x-4 justify-between items-end"},pt={class:"font-medium text-on-background text-opacity-primary truncate"},ut={class:"font-mono text-opacity-primary pb-0.5 text-sm flex-shrink-0"},dt={class:"flex flex-row space-x-2 items-center"},mt={class:"relative h-1 flex-1 bg-black bg-opacity-[0.15] theme-dark:bg-opacity-30 rounded-sm"},vt={class:"flex items-center gap-2 text-on-background text-opacity-secondary text-xs"},ft=lt(()=>o("span",null,"â€¢",-1)),yt=q({name:"SessionSummaryListItem",__name:"SessionSummaryListItem",props:{appId:{},displayName:{},iconUrl:{},primaryMetricValue:{},primaryMetric:{},primaryMetricIntegerPercent:{},secondaryMetric:{},tertiaryMetric:{},active:{type:Boolean},platform:{},showPlatformIcon:{type:Boolean},parentGroupId:{},selected:{type:Boolean}},setup(l){const t=l,u=b(()=>t.displayName===void 0?t.appId:t.displayName),c=L(),m=s=>{c.value=s},{isVibrantLoaded:f,vibrantColor:a}=Ve(c,{disableDarkModifier:!0}),k=b(()=>f?a.value??"rgb(var(--color-secondary))":"transparent"),A=b(()=>`background-color: ${k.value}; right: ${100-(f.value?t.primaryMetricIntegerPercent:0)}%`),D=b(()=>{if(t.platform===F.AppGroup)return H.groupDetailsFor(t.appId);if(t.platform===F.Category)throw Error("detailsHref categories not implemented yet");return t.parentGroupId&&typeof t.parentGroupId=="number"?H.groupAppDetailsFor(t.parentGroupId,t.platform,t.appId):H.appDetailsFor(t.platform,t.appId)}),C=te("Advertisements"),y=b(()=>t.platform===F.Web||c.value==null),d=ot(),g=b(()=>t.platform!==F.Category&&!d);return(s,U)=>{const P=ae("router-link");return n(),v("li",{class:V(["px-4 rounded-md ring-hover group",{"bg-on-background bg-opacity-divider":s.selected}])},[T(P,{class:"flex flex-row py-2 items-center relative no-underline",to:e(D)},{default:S(()=>[o("div",rt,[p(" Small icon with activity circle "),o("div",{class:V({"bg-on-background bg-opacity-divider rounded-full p-2 relative":e(y),"p-1":!e(y)})},[s.platform!==e(F).Category?(n(),M(Ue,{key:0,class:V({icon:e(y),"rounded-md object-contain w-full h-full":!e(y)}),src:t,platform:s.platform,onUrlChanged:m},null,8,["class","src","platform"])):p("v-if",!0),s.active&&e(y)?(n(),v("div",it)):p("v-if",!0)],2)]),o("div",nt,[o("div",ct,[o("span",pt,[R(i(e(u))+" ",1),e(g)?(n(),M(st,{key:0,class:"opacity-0 group-hover:opacity-100 transition-opacity","app-name":e(u),"app-id":t.appId,platform:t.platform},null,8,["app-name","app-id","platform"])):p("v-if",!0)]),o("p",ut,i(s.primaryMetric),1)]),o("div",dt,[o("div",mt,[o("div",{class:"absolute left-0 top-0 bottom-0 rounded-sm transition-all ease-linear bg-secondary",style:Ie(e(A))},null,4)]),o("p",{class:V(["text-opacity-secondary opacity-0 transition-opacity font-mono w-9 text-right text-sm",{"opacity-100":!!e(k)}])},i(s.$t("percent",{integer:Math.floor(s.primaryMetricIntegerPercent)})),3)]),o("p",vt,[s.showPlatformIcon?(n(),M(Pe,{key:0,class:"icon-sm inline opacity-secondary",platform:s.platform},null,8,["platform"])):p("v-if",!0),o("span",null,i(s.secondaryMetric),1),e(C)?(n(),v(oe,{key:1},[p(" eslint-disable-next-line @intlify/vue-i18n/no-raw-text "),ft,o("span",null,i(s.tertiaryMetric),1)],64)):p("v-if",!0)])])]),_:1},8,["to"])],2)}}}),kt=ke(yt,[["__scopeId","data-v-26748ebd"]]),Dt=De("selected-filters",()=>{const l=Q("selected-metric",x.UsageTime),t=Q("selected-platform",null),u=Q("selected-device",null,{serializer:Te.object});function c(){l.value=x.UsageTime,t.value=void 0,u.value=void 0}const m=b(()=>l.value!==x.UsageTime||t.value!==void 0&&t.value!==null||u.value!==void 0&&u.value!==null);return{reset:c,isFiltering:m,selectedMetric:l,platformFilter:t,selectedDevices:u}});export{It as I,kt as S,St as _,At as a,Dt as u};
