import{a as B}from"../chunks/chunk-6OCQJS5B.js";import{a as P}from"../chunks/chunk-2MCFUH3Z.js";import{c as D}from"../chunks/chunk-EHJWBWMG.js";import"../chunks/chunk-BWSZUVAY.js";import{a as s}from"../chunks/chunk-5Q7VJYCY.js";import"../chunks/chunk-P4L2RRIA.js";import{a as T}from"../chunks/chunk-DGHEKRNY.js";import{a as q}from"../chunks/chunk-VGIBV4EV.js";import"../chunks/chunk-IYAFYZRF.js";import"../chunks/chunk-F2BE3OL5.js";import{a as I}from"../chunks/chunk-65VGUSSD.js";import"../chunks/chunk-O7OTS7RM.js";import{a as A}from"../chunks/chunk-2SFZECRB.js";import{a as K}from"../chunks/chunk-D2CCZ3BJ.js";import{a as d}from"../chunks/chunk-7YV4JAJK.js";import"../chunks/chunk-KZL57NC7.js";import{a as C,b as H,c as w,t as E,v as M}from"../chunks/chunk-R5NGUZ66.js";import{a as S}from"../chunks/chunk-O4TFJKJQ.js";import{c,k,m as N,u as y}from"../chunks/chunk-JJTF2C25.js";import"../chunks/chunk-6LTHT6DZ.js";import"../chunks/chunk-NYTRMFGH.js";import"../chunks/chunk-HY2GWXPO.js";import"../chunks/chunk-JV3JVBWM.js";import{a as z}from"../chunks/chunk-3HBOA5LN.js";import"../chunks/chunk-4NTWQHWX.js";import"../chunks/chunk-YHJJDH4X.js";import{e as b}from"../chunks/chunk-3GYLW4KZ.js";var u=b(z());var Y=b(C()),R=b(C()),l=b(K());var _=b(z());var L=b(S());var t=b(w()),O="activateMirageNotification",p,f,m=class extends R.Component{constructor(...i){super(...i),this.state={hideNotification:!0}}componentDidMount(){let i=_.default.get(this.props.view,"actions",[]);_.default.each(i,e=>{_.default.get(e,"type")==="openUrl"&&(p=_.default.get(e,"props.domain"),f=_.default.get(e,"props.vendorMetaId"))}),y("page","mirageNotification",{view:"mirageNotification",type:"notification",destDomain:p,vendorMetaId:f}),setTimeout(()=>{this.setState({hideNotification:!1})},1e3)}render(){let{hideNotification:i}=this.state,{image:e,heading:o,subheading:n,cta:a}=this.props.view,x=!0,v=N("ext_notif_appear_no_transition");return i||y("page","mirageNotificationShown",{view:"mirageNotification",type:"notification",destDomain:p,vendorMetaId:f}),(0,t.jsx)("div",{className:i?"disabled mirage-notification":"mirage-notification",style:{top:"0",bottom:"auto",left:x?"auto":"0",right:x?"0":"auto"},children:(0,t.jsx)(l.Motion,{style:{opacity:v?(0,l.spring)(i?0:1,{stiffness:400,damping:25}):(0,l.spring)(i?0:1,{stiffness:180,damping:20}),y:v?i?-100:0:(0,l.spring)(i?-100:0,{stiffness:180,damping:20})},children:({opacity:W,y:V})=>(0,t.jsxs)("div",{className:"mirage-notification-content",style:{transform:`translate3d(0,${V}%,0)`,opacity:`${W}`},children:[(0,t.jsxs)("header",{children:[(0,t.jsx)(A,{}),(0,t.jsx)(I,{onClick:this.onClosePopup.bind(this,"x")})]}),(0,t.jsxs)("section",{children:[_.default.get(e,"src")?(0,t.jsx)("div",{className:"notification-image-wrapper",style:_.default.get(e,"wrapperStyle"),children:(0,t.jsx)("div",{className:"notification-image",style:{backgroundImage:`url("${_.default.get(e,"src")}")`,..._.default.get(e,"style",{})}})}):null,(0,t.jsx)("h2",{style:_.default.get(o,"style"),children:_.default.get(o,"value")}),(0,t.jsx)("h4",{style:_.default.get(n,"style"),children:_.default.get(n,"value","")}),(0,t.jsx)("div",{className:"button-wrapper",children:(0,t.jsx)("button",{className:"primary-btn-large",style:_.default.get(a,"style"),onClick:this.onClickCTA.bind(this),children:_.default.get(a,"value")})})]})]})})})}async onClickCTA(){let{clickId:i,redirectId:e}=T();_.default.map(_.default.get(this.props.view,"actions"),o=>{let n=_.default.get(o,"props.vendorMetaId")||this.props.view.vendorMetaId;if(o.type==="openUrl"&&_.default.get(o,"props.href")){let a=this.getRedirectUrl(o,e,n);window.open(a)}else if(o.type==="track")y("trackClick",o.event||O,"",_.default.assign({clickId:i,redirectId:e,vendorMetaId:n},o.props));else if(o.type==="click")(0,L.default)(o.selector).click();else if(o.type==="pinnedTab"){let a=this.getRedirectUrl(o,e,n);this.pinnedTab(i,a)}}),this.setState({hideNotification:!0}),this.throttleNotif()}onClosePopup(i){this.setState({hideNotification:!0}),y("trackClick","dismissMirageNotification",i),this.throttleNotif()}throttleNotif(){let i=k();d({domain:i,message:"throttle"})}async pinnedTab(i,e){try{B({url:e})}catch{}}getRedirectUrl(i,e,o){let n=_.default.get(i,"props.channel","cashback");return q({params:{channel:n,clickEvent:O,credits:n==="cashback"||n==="cashback-ims",destUrl:_.default.get(i,"props.href"),destDomain:_.default.get(i,"props.destDomain")||_.default.get(i,"props.domain"),redirectId:e,subExperience:"mirage_notification",vendorMetaId:o},isWbPublisher:!0})}},g=H({view:["mirageNotification"],events:["events"],session:["session"]},m);var j=b(S());var $=b(w());window.__wb_timing.mirageNoteRequireAt=performance.now();var h;async function U(r){if(!r)return;let i=document;if(i.deweyParser=j.default,i.html=document.documentElement.innerHTML,await s.evaluateIdentifierTree(r,i))return!0}async function G(r){if(h)return;let i=await D({deweyResult:r}),e=u.default.get(i,"throttleDurationMs");await d({domain:k(),message:"checkThrottled",throttleDurationMs:e})||h||(h=!0,i&&!i.error&&(u.default.get(i,"heading.value")||u.default.get(i,"subheading.value")||u.default.get(i,"cta.value"))&&(c.set("mirageNotification",i),M({initialRoute:"/mirageNotification",cssUrl:"mirageNotification.css",route:(0,$.jsx)(E,{path:"mirageNotification",component:g})})))}async function F(){try{let{siteData:r}=await P(),i=c.get(["deweyResult"]),e=await U(u.default.get(r,"mirageNotification.identifiers"));i&&e?await G(i):X(r)}catch(r){console.log(r)}}function X(r){s.emitter.on("result",async i=>{await U(u.default.get(r,"mirageNotification.identifiers"))&&await G(i)})}document.readyState!=="loading"?F():document.addEventListener("DOMContentLoaded",F);
