import{a as d}from"../chunks/chunk-J6ZEYYTG.js";import{ka as q}from"../chunks/chunk-XRJW3LFT.js";import"../chunks/chunk-5LUD7HVS.js";import"../chunks/chunk-K3HP5COO.js";import"../chunks/chunk-ZL5H3TML.js";import"../chunks/chunk-523WHQDT.js";import"../chunks/chunk-6OCQJS5B.js";import{a as S}from"../chunks/chunk-2MCFUH3Z.js";import"../chunks/chunk-5Q7VJYCY.js";import"../chunks/chunk-X7CFCWZC.js";import"../chunks/chunk-XEDCPNRR.js";import"../chunks/chunk-BCG2KUGW.js";import"../chunks/chunk-YZTZIJSB.js";import"../chunks/chunk-YU5QULAP.js";import{a as s}from"../chunks/chunk-DGHEKRNY.js";import"../chunks/chunk-VGIBV4EV.js";import"../chunks/chunk-IYAFYZRF.js";import"../chunks/chunk-F2BE3OL5.js";import{a as z}from"../chunks/chunk-65VGUSSD.js";import"../chunks/chunk-O7OTS7RM.js";import{a as C}from"../chunks/chunk-2SFZECRB.js";import{a as F}from"../chunks/chunk-D2CCZ3BJ.js";import"../chunks/chunk-7YV4JAJK.js";import"../chunks/chunk-KZL57NC7.js";import{a as c,b as N,c as k,t as H,v as P}from"../chunks/chunk-R5NGUZ66.js";import{a as W}from"../chunks/chunk-O4TFJKJQ.js";import{c as v,m as a,q as w,u as l}from"../chunks/chunk-JJTF2C25.js";import"../chunks/chunk-6LTHT6DZ.js";import"../chunks/chunk-NYTRMFGH.js";import"../chunks/chunk-HY2GWXPO.js";import"../chunks/chunk-JV3JVBWM.js";import{Q as x,R as I,a as h}from"../chunks/chunk-3HBOA5LN.js";import"../chunks/chunk-4NTWQHWX.js";import"../chunks/chunk-YHJJDH4X.js";import{e as r}from"../chunks/chunk-3GYLW4KZ.js";var n=r(h()),hi=r(c());var oi=r(c()),B=r(c()),y=r(F());var A=i=>w("engageCustomNotification",i);function p(){A()}var u=r(h());I();var t=r(k()),f=class extends B.Component{constructor(...o){super(...o);let _,e=u.default.get(u.default.find(this.props.customNotificationData,"displaySequence"),"displaySequence",[]);e.length?_=e[0]:_=this.props.customNotificationData[0].display,this.state={rightOffset:a("coup_shift_left")?310:0,notification:0,hideNotification:!0,dismiss:!1,progress:!1,displaySequence:e,..._}}componentDidMount(){l("page","customNotification",{view:"customNotification",type:"notification",offerSignUp:u.default.get(this.props.view,"offerSignUp"),qualified:u.default.get(this.props.view,"qualified",!1),balance:u.default.get(this.props.view,"balance",0)}),setTimeout(()=>{document.querySelector("#honeyContainer")&&this.setState({compNotifLoaded:!0,rightOffset:"300px"}),(document.querySelector(".ebates-notification")||document.querySelector(".ebates-hover.ebates-hover-top"))&&this.setState({compNotifLoaded:!0,rightOffset:"410px"}),this.setState({hideNotification:!1})},500)}render(){let{hideNotification:o,rightOffset:_}=this.state,e=!0,b=!0,M=a("n_or_1")&&this.state.compNotifLoaded||a("coup_shift_left"),g;return this.state.cta&&(g=(0,t.jsx)("div",{className:"button-wrapper",children:(0,t.jsx)("button",{className:"primary-btn-large",onClick:this.onClick.bind(this),children:this.state.cta})})),(0,t.jsx)("div",{className:o?"disabled follow-page":"follow-page",style:{top:e?"0":"auto",bottom:e?"auto":"0",left:b?"auto":"0",right:M?_:b?"0":"auto"},children:(0,t.jsx)(y.Motion,{style:{opacity:a("ext_notif_appear_no_transition")?(0,y.spring)(o?0:1,{stiffness:400,damping:25}):(0,y.spring)(o?0:1,{stiffness:180,damping:20}),y:a("ext_notif_appear_no_transition")?o?e?-100:100:0:(0,y.spring)(o?e?-100:100:0,{stiffness:180,damping:20})},children:({opacity:j,y:U})=>(0,t.jsxs)("div",{className:"custom-notification",style:{transform:`translate3d(0,${U}%,0)`,opacity:`${j}`},children:[(0,t.jsxs)("header",{children:[(0,t.jsx)(C,{}),(0,t.jsx)(z,{onClick:this.onClosePopup.bind(this,"x")})]}),(0,t.jsxs)("section",{children:[(0,t.jsx)("h2",{children:this.state.title}),this.state.progress?(0,t.jsx)(d,{estimatedDuration:5e3}):null,this.state.subtitle?(0,t.jsx)("h4",{className:"bold",children:this.state.subtitle}):null,g]})]})})})}onClick(){let{clickId:o}=s();if(this.state.dropCookie&&q(o),this.state.sendMetric&&l("track","noCouponsNotify",{clickId:o,currentLocation:u.default.pick(window.location,["hash","host","hostname","href","origin","pathname","port","search"])}),this.state.notification<this.state.displaySequence.length-1){let _=this.state.notification+1,e=this.state.displaySequence[_],b=()=>{this.setState({notification:_,...e}),this.state.timeout&&e.timeout===void 0&&this.setState({timeout:void 0}),_===this.state.displaySequence.length-1&&e.timeout&&setTimeout(()=>{this.onClosePopup()},this.state.timeout)};this.setState({progress:!!this.state.timeout}),setTimeout(()=>{b(),this.setState({progress:!1})},this.state.timeout*2||0)}else if(this.props.customNotificationData.url){p();let{clickId:_}=s(),e={destUrl:this.props.customNotificationData.url,redirectId:_},b=x({params:e});window.open(b,"_blank"),l("trackClick","customNotificationClick","",{view:"customNotification",pageLocation:"notification",clickId:_})}else setTimeout(()=>{this.onClosePopup()},this.state.timeout||0)}onClosePopup(o){p(),this.setState({hideNotification:!0}),l("trackClick","dismissCustomNotification",o)}},m=N({view:["customView"],customNotificationData:["customNotificationData"],events:["events"],session:["session"]},f);var D=()=>w("getCustomNotification");var R=r(W()),T=r(k());function L(i){if(i.type==="url")return!!document.URL.match(i.value);if(i.type==="title")return document.title.match(i.value);if(i.type==="selector")return!!(0,R.default)(i.value).length}function $(i){if(i.and)return(0,n.default)(i.and).map(_=>L(_)).filter().value().length===i.and.length;if(i.or)return!!(0,n.default)(i.or).map(_=>L(_)).filter().value().length}function G(i){return n.default.find(i,o=>$(o.identifiers))}function V(i,o){if(n.default.has(o,"runWithCoupons")){let _=!n.default.get(i,"coupons.ignoreSite");return!!(_&&o.runWithCoupons!==!1||!_)}return!0}async function O(){try{let i=await D();if(i&&i.engaged)return!1;let{siteData:o}=await S(),_=n.default.filter(o.notifications,b=>b.enabled!==!1&&V(o,b));G(_)&&_.length&&(v.set("customNotificationData",_),P({initialRoute:"/customNotification",cssUrl:"customNotification.css",route:(0,T.jsx)(H,{path:"customNotification",component:m})}))}catch{}}document.readyState!=="loading"?O():document.addEventListener("DOMContentLoaded",O);
