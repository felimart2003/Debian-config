"use strict";(globalThis.webpackChunk_dashlane_leeloo=globalThis.webpackChunk_dashlane_leeloo||[]).push([[3217],{766490:(e,t,a)=>{a.r(t),a.d(t,{NoteAddPanel:()=>L});var s=a(696832),o=a(799852),n=a(133354),i=a(448430),c=a(700033),r=a(148038),l=a(361607),u=a(482598),d=a(287279),S=a(310789),p=a(382706),h=a(45272),g=a(692077),m=a(740300),y=a(108403),N=a(114943),C=a(806697),I=a(276376),b=a(302268),T=a(376452),f=a(86541),_=a(899193),w=a(773157),A=a(420684),E=a(671785),v=a(413368),D=a(326239),F=a(619122),O=a(86498),R=a(488203),P=a(285163),V=a(803322);const{CONTENT:k,DOCUMENT_STORAGE:U}=f.SecureNoteTabs,Z=({noteCategories:e})=>{var t;const{routes:a}=(0,I.Xo)(),o=(0,E.aV)(),n=(0,N.Y)(),{openPaywall:f}=(0,y.nL)(),Z=(0,g.k6)(),{openDialog:L,shouldShowFrozenStateDialog:B}=(0,C.Ub)(),[q,G]=(0,s.useState)(k),[M,Y]=(0,s.useState)(!1),[z,H]=(0,s.useState)(!1),[Q,W]=(0,s.useState)([]),{currentSpaceId:X}=(0,F.fV)(),x=(0,l._)(),K=(0,O.V)(),{translate:j}=(0,R.Z)(),{addNoteToCollections:J}=(0,P.Q)(),[$,ee]=(0,s.useState)(!1),[te,ae]=(0,s.useState)(!1),[se,oe]=(0,s.useState)(""),[ne,ie]=(0,s.useState)(""),[ce,re]=(0,s.useState)("GRAY"),[le,ue]=(0,s.useState)(X),[de,Se]=(0,s.useState)(!1),{createVaultItem:pe}=(0,u.u)(i.L),[he,ge]=(0,s.useState)([]),[me,ye]=(0,s.useState)(!1),[Ne,Ce]=(0,s.useState)({category:"noCategory",type:"GRAY",spaceId:null!=X?X:"",secured:!1}),Ie=Boolean(x.data?.sharingVault_web_Secure_Notes_Revamp_dev),be={attachments:Q.map(_.w),id:"",limitedPermissions:!1,content:se,title:ne,...Ne};if((0,s.useEffect)((()=>{(0,h.Nc)(c.PageView.ItemSecureNoteCreate)}),[]),(0,s.useEffect)((()=>{B&&L()}),[B]),n.status!==r.rq.Success||!n?.data)return null;const Te=(0,v.n6)(v.Co.SecureNotes,n.data?.capabilities),fe=()=>K.showAlert(j("_common_generic_error"),S.BLW.ERROR),_e=()=>{(0,h.Nc)(c.PageView.ItemSecureNoteList),(0,A.P)(),(0,g.uX)(a.userSecureNotes)},we=()=>Y(!0),Ae=e=>t=>{we(),e(t)},Ee=Ae(ue),ve=Ae(re),De=Ae(ie),Fe=Ae(oe),Oe=Ae(Se);return Te&&(f(v.qd.SecureNote),Z.push("/secure-notes")),(0,V.tZ)(T.zI,{isViewingExistingItem:!1,itemHasBeenEdited:M,submitPending:z,onSubmit:async()=>{if(!z){H(!0);try{await(async()=>{const e=Ie?{spaceId:null!=le?le:"",type:ce,category:"noCategory",secured:de}:Ne;try{const t=await pe({vaultItemType:p.U.SecureNote,content:{...e,content:se,title:ne,attachments:be.attachments}});if(!(0,d.d6)(t))return void fe();const a=(0,d.db)(t).id;await J(a,he)}catch(e){fe()}W([])})()}catch{H(!1)}_e()}},secondaryActions:q===U?[t||(t=(0,V.tZ)(w.d,{isQuotaReached:!1,isShared:!1,onFileUploadStarted:()=>{ee(!0)},onFileUploadDone:async e=>{ee(!1),e.success&&(await m.C.commitSecureFile({secureFileInfo:e.secureFileInfo}),W([...Q,e.secureFileInfo]),Y(!0))},dataType:"KWSecureNote"},"uploadAction"))]:[],primaryActions:[],onNavigateOut:()=>{Q.forEach((async e=>{const{Id:t}=e;await m.C.deleteSecureFile({id:t})})),(0,A.P)(),W([]),_e()},isSomeDialogOpen:me,formId:"add_securenote_panel",header:(0,V.tZ)(D.h,{activeTab:q,backgroundColor:be.type,displayDocumentStorage:!he.length,displaySharedAccess:!1,displayMoreOptions:!1,setActiveTab:G,title:ne,setTitle:e=>{we(),ie(e)}}),children:(0,V.tZ)(b.T,{activeTab:q,data:be,content:se,title:ne,color:ce,spaceId:null!=le?le:"",setSpaceId:Ee,setColor:ve,setTitle:De,setContent:Fe,setIsSecured:Oe,handleFileInfoDetached:e=>{W(Q.filter((t=>t.Id!==e)))},hasAttachment:!!Q.length,isSecured:de,isAdmin:!1,isDisabled:!!B,isSecureNoteAttachmentEnabled:o,isShared:!1,isUploading:$,noteCategories:e,onModifyData:we,saveSecureNoteOptions:Ce,isEditing:te,isSecureNoteRevampEnabled:Ie,setIsEditing:ae,setCollectionsToUpdate:ge,setHasDialogsOpenedByChildren:ye})})},L=()=>{const e=(0,o.k)(i.L,"secureNoteCategory",{});return e.status!==n.rq.Success?null:(0,V.tZ)(Z,{noteCategories:e.data})}}}]);