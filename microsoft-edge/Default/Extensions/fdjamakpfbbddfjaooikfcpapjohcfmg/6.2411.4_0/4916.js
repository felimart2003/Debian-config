"use strict";(globalThis.webpackChunk_dashlane_leeloo=globalThis.webpackChunk_dashlane_leeloo||[]).push([[4916],{682994:(e,t,i)=>{i.d(t,{s:()=>g}),i(696832);var s=i(782579),a=i(482598),n=i(133354),o=i(448430),r=i(488203);let c=function(e){return e.LastAdmin="LastAdmin",e.GroupSharing="GroupSharing",e.CollectionSharing="CollectionSharing",e.Generic="Generic",e}({});var l=i(365580),u=i(803322);const d=({reason:e,translations:t,goToSharingAccess:i,closeCantDeleteDialog:a})=>{const{translate:n}=(0,r.Z)(),o=((e,t)=>{const{groupSharingTitle:i,lastAdminTitle:s,collectionSharingTitle:a,genericErrorTitle:n}=e;switch(t){case c.LastAdmin:return s;case c.GroupSharing:return i;case c.CollectionSharing:return a;case c.Generic:return n;default:return(0,l.U)(t)}})(t,e),d=((e,t)=>{const{groupSharingSubtitle:i,lastAdminSubtitle:s,collectionSharingSubtitle:a,genericErrorSubtitle:n}=e;switch(t){case c.LastAdmin:return s;case c.GroupSharing:return i;case c.CollectionSharing:return a;case c.Generic:return n;default:return(0,l.U)(t)}})(t,e);return(0,u.tZ)(s.Vq,{isOpen:!0,onClose:a,title:null!=o?o:"",closeActionLabel:n("_common_dialog_dismiss_button"),actions:e===c.LastAdmin||c.GroupSharing||c.CollectionSharing?{primary:{children:t.lastAdminActionLabel,onClick:()=>{i(),a()}}}:void 0,children:d})};var m=i(837527);const S=({closeConfirmDeleteDialog:e,onDeleteConfirm:t,translations:i})=>{const{translate:a}=(0,r.Z)(),{confirmDeleteSubtitle:n,confirmDeleteTitle:o,confirmDeleteDismiss:c,confirmDeleteConfirm:l}=i;return(0,u.tZ)(s.Vq,{title:o,onClose:e,isOpen:!0,dialogClassName:m.Ht,closeActionLabel:a("_common_dialog_dismiss_button"),isDestructive:!0,actions:{primary:{children:l,onClick:t,id:"deletion-dialog-confirm-button"},secondary:{children:c,onClick:e,autoFocus:!0,id:"deletion-dialog-dismiss-button"}},children:n})},g=({closeConfirmDeleteDialog:e,goToSharingAccess:t,isVisible:i,itemId:l,onDeletionSuccess:m,sharingStatus:g,translations:h,vaultItemType:p,isShared:_,isSharedViaUserGroup:b,isItemInCollection:C,isLastAdmin:I})=>{const{showToast:y}=(0,s.pm)(),{translate:D}=(0,r.Z)(),{deleteVaultItems:A}=(0,a.u)(o.L);if(!i)return null;let T;return(_||g?.isShared)&&(b&&(T=c.GroupSharing),I&&(T=c.LastAdmin),C&&(T=c.CollectionSharing)),T&&t?(0,u.tZ)(d,{reason:T,translations:h,goToSharingAccess:t,closeCantDeleteDialog:e}):(0,u.tZ)(S,{closeConfirmDeleteDialog:e,onDeleteConfirm:async()=>{try{var e;(await A({ids:[l],vaultItemType:p})).tag===n.rq.Success?(y({description:null!=(e=h.deleteSuccessToast)?e:D("webapp_personal_info_edition_delete_success_toast")}),m()):y({description:D("_common_generic_error"),mood:"danger",isManualDismiss:!0})}catch(e){y({description:D("_common_generic_error"),mood:"danger",isManualDismiss:!0})}},translations:h})}},64676:(e,t,i)=>{i.r(t),i.d(t,{SecureNotesEdit:()=>z});var s=i(696832),a=i(700033),n=i(45272),o=i(692077),r=i(995445),c=i(799852),l=i(133354),u=i(348958),d=i(982466),m=i(361607),S=i(482598),g=i(310789),h=i(287279),p=i(448430),_=i(382706),b=i(207149),C=i(740300),I=i(488203),y=i(806697),D=i(86498),A=i(376452),T=i(682994),f=i(86541),w=i(326239),N=i(302268),v=i(99822),E=i(830894),L=i(773157),U=i(899193),V=i(671785),O=i(420684),F=i(979808),G=i(301639),Z=i(296352),q=i(285163),k=i(812027),P=i(803322);const{CONTENT:R,DOCUMENT_STORAGE:M,MORE_OPTIONS:B,SHARED_ACCESS:H}=f.SecureNoteTabs,X=(0,E.DP)((({note:e,noteCategories:t,isShared:i,isAdmin:r,isSharedViaUserGroup:c,isLastAdmin:u})=>{var d;const{translate:E}=(0,I.Z)(),{routes:X}=(0,o.Xo)(),x=(0,m._)(),z=(0,o.TH)(),Q=(0,V.aV)(),{updateVaultItem:W}=(0,S.u)(p.L),{navigateBack:K}=(0,Z.u)(),{showAlert:Y}=(0,D.V)(),{shouldShowFrozenStateDialog:$}=(0,y.Ub)(),{addNoteToCollections:j}=(0,q.Q)(),{allCollections:J}=(0,k.b)(),[ee,te]=(0,s.useState)(R),[ie,se]=(0,s.useState)(!1),[ae]=(0,s.useState)(null),[ne,oe]=(0,s.useState)(!1),[re,ce]=(0,s.useState)(!1),[le,ue]=(0,s.useState)(!1),[de,me]=(0,s.useState)(!1),[Se,ge]=(0,s.useState)(!1),[he,pe]=(0,s.useState)(e.isSecured),[_e,be]=(0,s.useState)(e.content),[Ce,Ie]=(0,s.useState)(e.title),[ye,De]=(0,s.useState)(e.color),[Ae,Te]=(0,s.useState)(e.spaceId),[fe,we]=(0,s.useState)([]),[Ne,ve]=(0,s.useState)(!1),{data:Ee,status:Le}=(0,F.r)(e.id),Ue=Boolean(x.data?.sharingVault_web_Secure_Notes_Revamp_dev),Ve=()=>Y(E("_common_generic_error"),g.BLW.ERROR),Oe=()=>{(0,O.P)(),z.pathname.includes(X.userSecureNotes)&&(0,n.Nc)(a.PageView.ItemSecureNoteList),K(X.userSecureNotes)},Fe=async(t=!0)=>{ue(!0);const i=null!=ae?ae:{spaceId:Ae,type:ye,category:e.categoryId,secured:he};try{var s;const t=await W({vaultItemType:_.U.SecureNote,content:{content:_e,title:Ce,id:e.id,attachments:[...null!=(s=e.attachments)?s:[]],...i},id:e.id});j(e.id,fe),(0,h.hx)(t)&&Ve()}catch(e){Ve()}ue(!1),t?Oe():(ge(!1),se(!1))},Ge=()=>{me(!0)},Ze=async t=>{me(!1),t.success&&(await C.C.commitSecureFile({secureFileInfo:t.secureFileInfo}),e.attachments?.push((0,U.w)(t.secureFileInfo)),Fe(!1))},qe=()=>se(!0),ke=J.filter((t=>t.vaultItems.some((t=>t.id===e.id)))),Pe=ke.length||fe.length,Re=!!e.attachments&&e.attachments.length>0,Me=!Pe&&(Q||Re),Be=Ue?[R]:[R,B];i?Be.push(H):Me&&Be.push(M);const He={confirmDeleteConfirm:E("webapp_secure_notes_edition_delete_confirm"),confirmDeleteDismiss:E("webapp_credential_edition_delete_dismiss"),confirmDeleteSubtitle:E("webapp_credential_edition_confirm_delete_subtitle"),confirmDeleteTitle:E("webapp_secure_notes_edition_delete_title"),lastAdminActionLabel:E("webapp_credential_edition_change_permissions"),lastAdminTitle:E("webapp_credential_edition_last_admin_title"),lastAdminSubtitle:E("webapp_credential_edition_last_admin_subtitle"),groupSharingTitle:E("webapp_secure_notes_edition_group_sharing_title"),groupSharingSubtitle:E("webapp_credential_edition_group_sharing_subtitle"),collectionSharingTitle:E("webapp_credential_edition_collection_sharing_title"),collectionSharingSubtitle:E("webapp_credential_edition_collection_sharing_subtitle"),genericErrorTitle:"webapp_account_recovery_generic_error_title",genericErrorSubtitle:"webapp_account_recovery_generic_error_subtitle"},Xe={attachments:null!=(d=e.attachments)?d:[],category:e.categoryId?e.categoryId:"noCategory",content:e.content,id:e.id,limitedPermissions:i&&!r,secured:e.isSecured,spaceId:e.spaceId,title:e.title,type:e.color},xe=e=>t=>{qe(),e(t)},ze=xe(Te),Qe=xe(De),We=xe(Ie),Ke=xe(be),Ye=xe(pe),$e=i&&Le===l.rq.Success&&null!=(je=Ee?.count)?je:0;var je;const Je=ke.filter((e=>e.isShared)).length>0;return(0,P.BX)(A.zI,{isViewingExistingItem:!0,itemHasBeenEdited:ie,onSubmit:()=>{Fe()},isUsingNewDesign:Ue,submitPending:le,secondaryActions:(()=>{switch(ee){case R:return[(s=e,!s||i&&!r||s.attachments?.length?null:(0,P.tZ)(G.Z,{tooltipPlacement:"top-start",sharing:(t=e.id,(0,v.A1)(t)),text:E("webapp_sharing_invite_share"),origin:a.Origin.ItemDetailView},"shareaction"))];case M:return[(0,P.tZ)(L.d,{isQuotaReached:!1,onFileUploadStarted:Ge,onFileUploadDone:Ze,isShared:i,itemId:e.id,dataType:"KWSecureNote",disabled:!!$},"uploadAction")];default:return[]}var t,s})(),onNavigateOut:Oe,onClickDelete:()=>oe(!0),ignoreCloseOnEscape:ne||re,isSomeDialogOpen:ne||Ne,formId:"edit_securenote_panel",header:(0,P.tZ)(w.h,{activeTab:ee,backgroundColor:Xe.type,displayDocumentStorage:Be.includes(M),displaySharedAccess:Be.includes(H),displayMoreOptions:Be.includes(B),recipientsCount:$e,setActiveTab:te,disabled:i&&!r,title:Ce,setTitle:We}),children:[(0,P.tZ)(N.T,{activeTab:ee,data:Xe,content:null!=_e?_e:"",title:Ce,color:ye,spaceId:Ae,isDisabled:!!$,isSecured:he,setSpaceId:ze,setColor:Qe,setTitle:We,setContent:Ke,setIsSecured:Ye,handleFileInfoDetached:t=>{e.attachments=e.attachments?.filter((e=>e.id!==t)),Fe(!1)},hasAttachment:Re,isAdmin:r,isSecureNoteRevampEnabled:Ue,isSecureNoteAttachmentEnabled:Q,isShared:i,isUploading:de,isEditing:Se,setIsEditing:ge,noteCategories:t,onModifyData:qe,onModalDisplayStateChange:ce,saveSecureNoteOptions:async t=>{const{category:i,spaceId:s,type:a,secured:n}=t;ue(!0);const o={...e,spaceId:null!=s?s:"",type:b.L[a],category:i,secured:n};try{const t=await W({vaultItemType:_.U.SecureNote,content:o,id:e.id});(0,h.hx)(t)&&Ve(),ue(!1)}catch(e){Ve()}},setCollectionsToUpdate:we,setHasDialogsOpenedByChildren:ve}),(0,P.tZ)(T.s,{isVisible:ne,itemId:e.id,closeConfirmDeleteDialog:()=>oe(!1),goToSharingAccess:()=>{te(f.SecureNoteTabs.SHARED_ACCESS)},onDeletionSuccess:async()=>{e.attachments?.forEach((async e=>{const{id:t}=e;await C.C.deleteSecureFile({id:t})})),Oe()},isLastAdmin:u,isShared:i,isSharedViaUserGroup:c,isItemInCollection:Je,translations:He,vaultItemType:_.U.SecureNote})]})})),x=({note:e})=>{const{getPermissionForItem:t,getSharingStatusForItem:i,getIsLastAdminForItem:s}=(0,r.Y)(u.X,{getPermissionForItem:{queryParam:{itemId:e.id}},getSharingStatusForItem:{queryParam:{itemId:e.id}},getIsLastAdminForItem:{queryParam:{itemId:e.id}}},[]),a=(0,c.k)(p.L,"secureNoteCategory",{});if(t.status!==l.rq.Success||i.status!==l.rq.Success||s.status!==l.rq.Success||a.status!==l.rq.Success)return null;const{isShared:n,isSharedViaUserGroup:o}=i.data,{permission:m}=t.data,{isLastAdmin:S}=s.data,g=n&&m===d.y3.Admin;return(0,P.tZ)(X,{note:e,noteCategories:a.data,isShared:n,isAdmin:g,isSharedViaUserGroup:o,isLastAdmin:S})},z=()=>{const{routes:e}=(0,o.Xo)(),t=(0,o.UO)(),i=`{${t?.uuid}}`,r=(0,c.k)(p.L,"query",{vaultItemTypes:[_.U.SecureNote],ids:[i]}),u=s.useCallback((()=>r.status===l.rq.Success&&!r.data?.secureNotesResult.items&&((0,o.uX)(e.userSecureNotes),!0)),[r,e.userSecureNotes]);return s.useEffect((()=>{u()||(0,n.Nc)(a.PageView.ItemSecureNoteDetails)}),[u]),s.useEffect((()=>{u()}),[u,r]),r.status!==l.rq.Success?null:r.data?.secureNotesResult?.items?.length?(0,P.tZ)(x,{note:r.data.secureNotesResult.items[0]}):null}}}]);