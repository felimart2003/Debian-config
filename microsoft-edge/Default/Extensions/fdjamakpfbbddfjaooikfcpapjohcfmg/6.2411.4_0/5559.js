"use strict";(globalThis.webpackChunk_dashlane_leeloo=globalThis.webpackChunk_dashlane_leeloo||[]).push([[5559],{905559:(e,t,i)=>{i.r(t),i.d(t,{SecretAddPanelComponent:()=>w});var n=i(696832),s=i(482598),r=i(133354),a=i(448430),l=i(382706),o=i(310789),c=i(86498),d=i(488203),p=i(114943),u=i(376452),m=i(615940),_=i(619122),h=i(620800),g=i(78047),b=i(692077),I=i(45272),S=i(700033),x=i(803322);const{CONTENT:v}=m.SecretsTabs,w=()=>{const{routes:e}=(0,b.Xo)(),t=(0,p.Y)(),[i,m]=(0,n.useState)(!1),[w,f]=(0,n.useState)(!1),{currentSpaceId:C,teamId:Z}=(0,_.fV)(),[y,P]=(0,n.useState)({id:"",limitedPermissions:!1,title:"",content:"",spaceId:null!=C?C:Z?String(Z):"",secured:!1}),{createVaultItem:T}=(0,s.u)(a.L),D=(0,c.V)(),{translate:E}=(0,d.Z)();if((0,n.useEffect)((()=>{(0,I.Nc)(S.PageView.ItemSecretCreate)}),[]),t.status!==r.rq.Success||!t?.data)return null;const k=()=>(0,b.uX)(e.userSecrets);return(0,x.tZ)(u.zI,{isUsingNewDesign:!0,isViewingExistingItem:!1,itemHasBeenEdited:i,submitPending:w,onSubmit:async()=>{w||(f(!0),await(async()=>{try{var e;await T({vaultItemType:l.U.Secret,content:{title:y.title,content:y.content,spaceId:null!=(e=y.spaceId)?e:"",isSecured:y.secured}})}catch(e){f(!1),D.showAlert(E("_common_generic_error"),o.BLW.ERROR)}})(),k())},onNavigateOut:()=>{k()},formId:"add_secret_panel",header:(0,x.tZ)(h.h,{title:y.title?y.title:E("webapp_secrets_title_field"),titleColor:"ds.text.neutral.quiet"}),children:(0,x.tZ)(g.e,{activeTab:v,isAdmin:!1,secretValues:y,handleChange:(e,t)=>{if("spaceId"===e&&t===y.spaceId)return;const n={...y,[e]:t},s=!!(n.title||n.content||n.spaceId||n.secured);s!==i&&m(s),P(n)}})})}},615940:(e,t,i)=>{i.d(t,{SecretsTabs:()=>n});let n=function(e){return e[e.CONTENT=0]="CONTENT",e[e.SHARED_ACCESS=1]="SHARED_ACCESS",e}({})},620800:(e,t,i)=>{i.d(t,{h:()=>l});var n,s=i(782579),r=i(376452),a=i(803322);const l=({title:e,titleColor:t,tabs:i})=>(0,a.tZ)(r.V9,{icon:(0,a.tZ)("div",{sx:{width:"168px",height:"108px",borderStyle:"solid",borderWidth:"1px",borderRadius:"4px",borderColor:"ds.border.neutral.quiet.idle",display:"flex",justifyContent:"center",alignItems:"center"},children:n||(n=(0,a.tZ)(s.JO,{name:"ItemSecretOutlined",color:"ds.text.neutral.standard",size:"xlarge"}))}),title:e,titleColor:t,tabs:i})},78047:(e,t,i)=>{i.d(t,{e:()=>x});var n=i(696832),s=i(782579),r=i(133354),a=i(980936),l=i(488203),o=i(555449),c=i(433988),d=i(154350),p=i(468037),u=i(167406),m=i(615940),_=i(806697),h=i(803322);const{CONTENT:g,SHARED_ACCESS:b}=m.SecretsTabs,I="webapp_secure_notes_edition_field_text_max_size_reached",S=1e4,x=({activeTab:e,isAdmin:t,secretValues:i,handleChange:m})=>{const{translate:x}=(0,l.Z)(),[v,w]=(0,n.useState)(""),{shouldShowFrozenStateDialog:f}=(0,_.Ub)(),C=(0,c.F)(),{isMPLessUser:Z}=(0,d.Z)(),y=!C&&!Z,P=(0,a.I)(),T=P.status===r.rq.Success&&!P.isDisabled,{id:D,limitedPermissions:E,title:k,content:A,spaceId:V,secured:B}=i;return null===f?null:(0,h.BX)(h.HY,{children:[e===g&&(0,h.BX)(h.HY,{children:[(0,h.BX)(p.u,{title:x("webapp_secrets_box_title_details"),children:[(0,h.tZ)(s.qo,{"data-name":"title",label:x("webapp_secrets_title_field"),value:k,onChange:e=>m("title",e.target.value),disabled:E,readOnly:f,sx:{marginBottom:"8px"}}),(0,h.tZ)(s.Kx,{"data-name":"content",label:x("webapp_secrets_content_field"),placeholder:x("webapp_secrets_content_field_placeholder"),value:A,onBeforeInput:e=>{const t=e.currentTarget.value;t.length>S&&(w(x(I,{charLeft:S-(t.length-1)})),e.preventDefault())},onPaste:e=>{const t=e.clipboardData.getData("text/plain");e.currentTarget.value.length+t.length>S&&(w(x(I,{charLeft:S-e.currentTarget.value.length})),e.preventDefault())},onChange:e=>{v&&w(""),m("content",e.target.value)},disabled:E,readOnly:f,feedback:v?{text:v}:void 0,error:!!v})]}),T?(0,h.tZ)(p.u,{title:x("webapp_secrets_box_title_organization"),additionalSx:{marginTop:"16px"},children:(0,h.tZ)("div",{children:(0,h.tZ)(u.M,{disabled:f,isUsingNewDesign:!0,defaultSpaceId:null!=V?V:"",spaceId:null!=V?V:"",onChange:e=>m("spaceId",e)})})}):null,y?(0,h.tZ)(p.u,{title:x("webapp_secrets_box_title_preferences"),additionalSx:{marginTop:"16px"},children:(0,h.tZ)(s.XZ,{readOnly:f,label:x("webapp_secrets_preferences_mp_title"),description:x("webapp_secrets_preferences_mp_description"),checked:B,onChange:({target:e})=>m("secured",e.checked)})}):null]}),e===b&&(0,h.tZ)(o.u,{isAdmin:t,id:D})]})}},979808:(e,t,i)=>{i.d(t,{r:()=>r});var n=i(799852),s=i(348958);const r=e=>(0,n.k)(s.X,"sharedAccessForItem",{itemId:e})},555449:(e,t,i)=>{i.d(t,{u:()=>V});var n,s,r=i(696832),a=i(310789),l=i(361607),o=i(482598),c=i(133354),d=i(172721),p=i(982466),u=i(287279),m=i(740300),_=i(488203),h=i(343194),g=i(448263),b=i(782579),I=i(232814),S=i(904967),x=i(873670),v=i(989572),w=i(58037),f=i(803322);const C=({cancelStatus:e,itemGroupId:t,setCancelStatus:i,recipientId:l})=>{const{translate:o}=(0,_.Z)(),c=e===g.V.Loading,d={type:"user",alias:l};(0,r.useEffect)((()=>{let t;return e===g.V.Failure&&(t=window.setTimeout((()=>i(null)),2e3)),()=>{clearTimeout(t)}}),[e,i]);const p=e?()=>i(null):()=>i(g.V.Confirm);return e===g.V.Failure?(0,f.BX)("div",{sx:{color:"ds.text.danger.standard",display:"flex",alignItems:"center"},children:[n||(n=(0,f.tZ)(a.aNP,{color:"ds.text.danger.standard"})),"Â ",o("webapp_shared_access_cancel_failure")]}):(0,f.BX)("div",{children:[(0,f.tZ)(b.zx,{intensity:e?"quiet":"supershy",disabled:c,onClick:p,size:"small",children:o(e?"webapp_shared_access_cancel":"webapp_shared_access_cancel_invitation")}),e?(0,f.tZ)(b.zx,{mood:"danger",intensity:"catchy",sx:{ml:"16px"},disabled:c,size:"small",onClick:()=>(async()=>{i(g.V.Loading);const e=await(async()=>{try{const{success:e}=await m.C.revokeSharing({itemGroupId:t,recipient:d});return e}catch(e){return!1}})();i(e?g.V.Success:g.V.Failure)})(),children:c?s||(s=(0,f.tZ)(a.HoD,{})):o("webapp_shared_access_confirm")}):null]})};var Z;const y="webapp_sharing_permissions_full_rights",P="webapp_sharing_permissions_limited_rights",T=e=>{const{status:t,permission:i}=e;return"pending"===t?"webapp_shared_access_pending_invitation":"accepted"===t?"admin"===i?y:P:""},D=({itemGroupId:e,onUserSelected:t,openEditPermissionsDialog:i,member:n,isAdmin:s,isItemPermissionsEnabled:a=!1})=>{const[l,o]=(0,r.useState)(null),c=(0,w.j)()?.login,{translate:d}=(0,_.Z)();if(l===g.V.Success)return null;const{permission:u,status:m,recipientType:h}=n,D=c===n.recipientId,E=s&&c!==n.recipientId,k="pending"===m?(0,f.tZ)(C,{recipientId:n.recipientId,itemGroupId:e,cancelStatus:l,setCancelStatus:o}):(0,f.tZ)(x.M,{disabled:a&&!s||!a&&n.recipientType===p.IP.Collection,icon:"ActionEditOutlined",layout:"iconLeading",intensity:"supershy",onClick:()=>{t&&t(n.recipientId),i(n,u,h)},content:d("webapp_sharing_collection_access_description_tooltip"),tooltipSx:{textWrap:"wrap",maxWidth:"240px"},size:"small",children:d("webapp_shared_access_edit_permissions")});return(0,f.tZ)("li",{sx:{alignItems:"center",display:"flex",minHeight:"48px",position:"relative"},children:(0,f.tZ)(S.r,{infoAction:E?k:null,logo:n.recipientType===p.IP.Group?Z||(Z=(0,f.tZ)(v.Z,{})):(0,f.tZ)(I.q,{email:n.recipientName,size:36}),text:a?void 0:T(n)?d(T(n)):d("webapp_shared_permissions_dialog_revoke_success_title"),title:n.recipientName,permissionBadge:a?(0,f.tZ)(b.Ct,{mood:"admin"===u?"brand":"danger",label:d("admin"===u?y:P)}):void 0,disabled:l===g.V.Loading,titleLogo:D?(0,f.tZ)(b.Ct,{label:d("webapp_shared_access_you_badge").toUpperCase(),layout:"labelOnly",sx:{marginLeft:"4px"}}):null})},n.recipientId)};var E=i(979808),k=i(468037),A=i(814341);const V=({id:e,isAdmin:t})=>{const{translate:i}=(0,_.Z)(),[n,s]=(0,r.useState)(!1),[b,I]=(0,r.useState)(null),[S,x]=(0,r.useState)(void 0),v=(0,l._)(),{data:w,status:C}=(0,E.r)(e),{updatePermissionForCollectionItem:Z,removeItemFromCollections:y}=(0,o.u)(d.a),P=Boolean(v.data?.sharingVault_web_Collection_Item_Permissions_dev)||Boolean(v.data?.sharingVault_web_Collection_Item_Permissions_prod);if(C!==c.rq.Success)return(0,f.tZ)(a.HoD,{color:"ds.container.expressive.brand.catchy.idle",size:50,sx:{alignSelf:"center",m:"20px"}});if(!w)return null;const{itemGroupId:T,users:V,groups:B,collections:N}=w,O=e=>{b&&I({...b,step:e})},z=async()=>{if(!b)return;const{recipient:t,permission:i,recipientType:n}=b;s(!0);const r="revoke"===i?await(async(t,i)=>{try{if(i===p.IP.Collection){const i=await y({collectionIds:[t.recipientId],itemId:e});return!!(0,u.d6)(i)}const{success:n}=await m.C.revokeSharing({itemGroupId:null!=T?T:"",recipient:(0,A.d)(t)});return n}catch(e){return!1}})(t,n):await(async(e,t,i)=>{try{if(i===p.IP.Collection){const i=await Z({groupId:T,collection:{collectionId:e.recipientId,permission:t}});return!!(0,u.d6)(i)}{const{success:i}=await m.C.updateSharingPermission({itemGroupId:null!=T?T:"",recipient:(0,A.d)(e),permission:t});return i}}catch(e){return!1}})(t,i,n);if(r){const e="revoke"===i?g.PermissionDialogStep.RevokeSuccess:g.PermissionDialogStep.Success;O(e)}else O(g.PermissionDialogStep.Failure);s(!1)},R=(e,t,i)=>{const n={recipient:e,recipientType:i,permission:t,originPermission:t,step:g.PermissionDialogStep.Permission,name:e.recipientName};I(n)},G=B?.length>0,L=N?.length>0,X=V?.length>0,F=!(S&&V.find((e=>e.recipientId!==S&&e.permission===p.y3.Admin)))&&b?.recipient.recipientType===p.IP.User,H="collection"===b?.recipientType;return(0,f.BX)("div",{sx:{flex:"1",overflowY:"auto"},children:[(0,f.BX)("ul",{sx:{flex:"1"},children:[L?(0,f.tZ)(k.u,{title:i("webapp_shared_access_collections"),additionalSx:{marginBottom:"16px"},children:N.map((e=>(0,f.tZ)(D,{isItemPermissionsEnabled:P,isAdmin:t,member:e,itemGroupId:null!=T?T:"",openEditPermissionsDialog:R},e.recipientId)))}):null,G?(0,f.tZ)(k.u,{title:i("webapp_shared_access_groups_card_title"),additionalSx:{marginBottom:"16px"},children:B.map((e=>(0,f.tZ)(D,{isAdmin:t,member:e,itemGroupId:null!=T?T:"",openEditPermissionsDialog:R},e.recipientId)))}):null,X?(0,f.tZ)(k.u,{title:i("webapp_shared_access_individuals_card_title"),children:V.map((e=>(0,f.tZ)(D,{isAdmin:t,member:e,onUserSelected:e=>x(e),itemGroupId:null!=T?T:"",openEditPermissionsDialog:R},e.recipientId)))}):null]}),b&&(0,f.tZ)(h.E,{isOpen:!0,isCollectionItemPermission:H,shouldRevokeBeDisabled:F||void 0,loading:n,onCancelRevoke:()=>{b&&I({...b,step:g.PermissionDialogStep.Permission})},onConfirmRevoke:z,onDismiss:()=>I(null),onSelectPermission:e=>{b&&I({...b,permission:e})},onValidatePermission:()=>{"revoke"===b?.permission?I({...b,step:g.PermissionDialogStep.ConfirmRevoke}):z()},permission:b.permission,recipient:b.recipient,step:b.step})]})}}}]);