"use strict";(globalThis.webpackChunk_dashlane_leeloo=globalThis.webpackChunk_dashlane_leeloo||[]).push([[3830],{155328:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fetchABTestingVersionDetails=void 0;const a=r(795623),o=r(550884);t.fetchABTestingVersionDetails=(e,t)=>{const r=e.storeService,n={capacity:"",language:r.getPlatform().info.lang,platform:"real_website"};return t?.abTestForcedVersion&&(n.forceVersion3=t.abTestForcedVersion),e.wsService.premium.getABTestingVersionDetails(n).then((e=>{r.dispatch((0,o.saveABTestingInfo)(e))})).catch((e=>{a.default.error("Carbon init - Error while calling getABTestingVersionDetails: ",e)}))}},35673:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(692082),o=r(572525),n=r(862627);t.config={commands:{participateToUserABTest:{handler:o.participateToUserABTest}},queries:{getUserABTestVariant:{selector:n.userABTestVariantSelector}},liveQueries:{liveUserABTestVariant:{operator:a.userABTestVariant$}}}},550884:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveABTestingInfo=t.SAVE_ABTESTING_INFO=void 0,t.SAVE_ABTESTING_INFO="SAVE_ABTESTING_INFO",t.saveABTestingInfo=e=>({type:t.SAVE_ABTESTING_INFO,data:Object.assign({},e)})},634007:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyABTesting=void 0;const a=r(550884);t.default=(e={details:[],version:"control2016_all",success:null},t)=>t.type===a.SAVE_ABTESTING_INFO?Object.assign({},e,{...t.data}):e,t.getEmptyABTesting=function(){return{details:[],version:"control2016_all",success:null}}},580755:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const a=r(35673);t.bootstrap=e=>{e.register(a.config)}},808481:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshUserABTest=void 0;const a=r(632626),o=r(241075),n=r(670252),s=r(130913),i=r(46298),c=r(843416),l=r(109272),d=r(825899);t.refreshUserABTest=async function(e,t,r){try{const a=(0,s.abTestsNamesSelector)(e.getState());if(0===a.length)return;const n=await(0,o.getAndEvaluateForUser)(e,r,{abtests:a});if((0,i.isApiError)(n))throw new Error(`Failed to refresh user AB tests: ${n}`);const u=(0,l.mapGetUserABServerResponse)(a,n.abtests);e.dispatch((0,c.refreshedUserABTests)(u)),(0,d.persistUserTests)(t,e)}catch(e){const t=new Error(`[ABTests] - refreshUserABTest: ${e}`);(0,n.sendExceptionLog)({error:t,code:a.ExceptionCriticality.WARNING})}}},121587:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(580755);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},692082:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.userABTestVariant$=void 0;const a=r(518948),o=r(903343),n=r(862627);t.userABTestVariant$=e=>(0,a.pipe)((0,o.map)((t=>(0,n.userABTestVariantSelector)(t,e))),(0,o.distinctUntilChanged)())},109272:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mapGetUserABServerResponse=t.NOT_PARTICIPATING=void 0,t.NOT_PARTICIPATING="not-participating",t.mapGetUserABServerResponse=function(e,r){return e.reduce(((e,a)=>{const o=r.find((e=>a===e.name));return e[a]=o?{variant:o.variant,version:o.abtestVersion}:{variant:t.NOT_PARTICIPATING},e}),{})}},572525:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.participateToUserABTest=void 0;const a=r(862627),o=r(109272),n=r(825899);t.participateToUserABTest=async function(e,t){const r=(0,a.userABTestSelector)(e.storeService.getState(),t);r&&o.NOT_PARTICIPATING!==r.variant&&(0,n.persistUserTests)(e.localStorageService.getInstance(),e.storeService)}},825899:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.persistUserTests=void 0;const a=r(25576),o=r(862627);t.persistUserTests=async function(e,t){if(t.getAccountInfo().persistData===a.PersistData.PERSIST_DATA_NO)return Promise.resolve();e&&await e.storeUserABTests((0,o.userABTestsSelector)(t.getState()))}},352346:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const a=r(718216),o=r(155328),n=r(509486);t.setupSubscriptions=function(e,t){e.appInitialized.on((async e=>{if(e.initMode===a.InitMode.FirstInit){await(0,o.fetchABTestingVersionDetails)(t,{abTestForcedVersion:e.abTestForcedVersion});const r=t.storeService.getABTesting();(0,n.triggerABTestingChanged)(r)}}))}},339811:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(395667),o=r(188544),n=r(271594);t.config={commands:{editContactInfo:{handler:a.editContactInfoHandler}},queries:{getContactInfo:{selector:o.contactInfoSelector}},liveQueries:{liveContactInfo:{operator:n.contactInfo$}}}},301463:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const a=r(339811);t.bootstrap=e=>{e.register(a.config)}},866650:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.editContactInfoHandler=void 0;const a=r(632626),o=r(46298),n=r(416593),s=r(405464),i={contact_email_required:a.EditContactInfoErrorCode.EMPTY_EMAIL,contact_phone_required:a.EditContactInfoErrorCode.UNKNOWN_ERROR,invalid_contact_email:a.EditContactInfoErrorCode.INVALID_EMAIL};t.editContactInfoHandler=async function(e,t){const{storeService:r,wsService:c,sessionService:l}=e,d=r.getState(),u=(0,n.userLoginSelector)(d);if(!r.isAuthenticated())return{success:!1,error:{code:a.EditContactInfoErrorCode.UNKNOWN_ERROR}};try{const e=await(0,o.updateContactInfo)(r,u,t);return(0,o.isApiError)(e)?{success:!1,error:{code:i[e.code]??a.EditContactInfoErrorCode.UNKNOWN_ERROR}}:(await(0,s.getAndTriggerRefreshAccountInfo)(r,l,c),{success:!0})}catch(e){return{success:!1,error:{code:a.EditContactInfoErrorCode.UNKNOWN_ERROR}}}}},395667:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(866650),t)},564369:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(301463);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},271594:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contactInfo$=void 0;const a=r(518948),o=r(903343),n=r(188544);t.contactInfo$=()=>(0,a.pipe)((0,o.map)(n.contactInfoSelector),(0,o.distinctUntilChanged)())},188544:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contactInfoSelector=void 0,t.contactInfoSelector=e=>e.userSession.accountContactInfo},871703:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeAccountCreationController=t.encryptSettings=t.checkLogin=void 0;const a=r(632626),o=r(670252),n=r(232074),s=r(839362),i=r(736513),c=r(43461),l=r(595551),d=r(958639),u=r(807624),p=r(816356),S=r(861259),g=r(795623),m=r(65675),y=r(316038),h=r(46298);async function f(e,t){g.default.log("AccountCreationController.checkLogin");const r=await(0,h.requestAccountCreation)(e,{login:t});if((0,h.isApiError)(r)){if("SSO_BLOCKED"===r.code)return{accountCreationCode:a.AccountCreationCode.USER_DOESNT_EXIST_SSO_NON_PROVISIONED};throw new Error(`[AccountCreationController] - checkLogin: ${r.message} (${r.code})`)}if(r.ssoServiceProviderUrl)return e.dispatch((0,u.storeSSOSettings)({serviceProviderUrl:r.ssoServiceProviderUrl,isNitroProvider:r.ssoIsNitroProvider})),r.ssoIsNitroProvider?{accountCreationCode:a.AccountCreationCode.USER_NITRO_SSO_PROVISIONED,isProposedExpired:r.isProposedExpired,isUserProposed:r.isProposed,isUserAccepted:r.isAccepted}:((0,S.triggerServiceProviderUrlRedirect)(e.getState(),t),{accountCreationCode:a.AccountCreationCode.USER_SSO_PROVISIONED,isProposedExpired:r.isProposedExpired,isUserProposed:r.isProposed,isUserAccepted:r.isAccepted});switch(r.exists){case h.AccountExistsStatus.AccountExists:return{accountCreationCode:a.AccountCreationCode.USER_EXISTS,isProposedExpired:r.isProposedExpired,isUserProposed:r.isProposed,isUserAccepted:r.isAccepted};case h.AccountExistsStatus.AccountDoesntExistInvalid:return{accountCreationCode:a.AccountCreationCode.USER_DOESNT_EXIST_INVALID_MX,isProposedExpired:r.isProposedExpired,isUserProposed:r.isProposed,isUserAccepted:r.isAccepted};case h.AccountExistsStatus.AccountDoesntExistUnlikely:return{accountCreationCode:a.AccountCreationCode.USER_DOESNT_EXIST_UNLIKELY_MX,isProposedExpired:r.isProposedExpired,isUserProposed:r.isProposed,isUserAccepted:r.isAccepted};case h.AccountExistsStatus.AccountDoesntExist:default:return{accountCreationCode:a.AccountCreationCode.USER_DOESNT_EXIST,isProposedExpired:r.isProposedExpired,isUserProposed:r.isProposed,isUserAccepted:r.isAccepted}}}function v(e,t,r){return Promise.resolve().then((()=>{const a=e.getStore(),o=n.encryptSettings(e,t,r);a.dispatch((0,c.saveAccountSettings)(o));const s=(0,i.makeCryptoService)(),u={cryptoConfig:(0,m.parsePayload)(o.personalSettings.CryptoUserPayload).cryptoConfig,forceSalt:(0,y.base64ToBuffer)(o.personalSettings.CryptoFixedSalt)},p={promise:(0,l.generateRsaKeys)(t,s,u)};e.dispatch((0,c.saveAccountKeys)(p));const S={encryptSettingsRequest:r,valid:!0};return d.sendEncryptSettingsResult(S),S})).catch((e=>{const t=new Error(`[AccountCreation] - encryptSettings: ${e}`);throw g.default.error(t),(0,o.sendExceptionLog)({error:t}),t}))}t.checkLogin=f,t.encryptSettings=v,t.makeAccountCreationController=function(e){return{checkLogin:t=>f(e.storeService,t),createAccount:t=>(e.storeService.dispatch((0,c.accountCreationStarted)({isSSO:!1})),e.sessionService.close().then((()=>{e.masterPasswordEncryptorService.setInstance({raw:t.password},"");const{storeService:r,masterPasswordEncryptorService:a}=e;return v(r,a,t)}))),confirmAccountCreation:t=>function(e,t){return Promise.resolve().then((()=>{const r=e.storeService.getStore().getState().userSession.accountCreation.settings.personalSettings,a=e.storeService.getAccountCreation(),o=a.settings.promise;if(null===o)throw new Error("createAccount should be call before confirmAccountCreation");const n=a.accountKey.promise;if(null===n)throw new Error("createAccount should be call before confirmAccountCreation");return s.createAccount(e,t,o,r,n).then((t=>(d.sendConfirmCreateAccountResult(t),e.storeService.dispatch((0,p.updateIsFirstSessionAfterAccountCreation)()),t)))})).catch((e=>{const t=new Error(`[AccountCreation] - confirmAccountCreation: ${e}`);throw g.default.error(t),(0,o.sendExceptionLog)({error:t}),t}))}(e,t)}}},985591:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(347542);t.config={commands:{},queries:{},liveQueries:{liveAccountCreated:{subject:a.getAccountCreated$}}}},281867:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const a=r(985591);t.bootstrap=e=>{e.register(a.config)}},807502:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(281867);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},347542:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.emitAccountCreated=t.getAccountCreated$=void 0;const a=new(r(518948).Subject);t.getAccountCreated$=()=>a,t.emitAccountCreated=()=>a.next()},232074:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.encryptSettings=void 0;const a=r(463713),o=r(875270),n=r(956668),s=r(791301),i=r(316038),c=r(655623),l=r(812706),d=r(895648),u=r(278320),p=r(500053);t.encryptSettings=function(e,t,r){const S=(0,u.generateItemUuid)(),g=(0,p.getUnixTimestamp)(),m=(0,c.getRandomValues)(16),y=e.getState(),h=(0,l.isSSOAccountCreationSelector)(y)?s.CRYPTO_NODERIVATION_HMAC64:n.ARGON2_DEFAULT_PAYLOAD,f={...(0,d.makeBasePersonalSettings)(),AnonymousUserId:r.anonymousUserId,UsagelogToken:S,Format:r.format,Language:r.language,SecurityEmail:r.login,RealLogin:r.login,accountCreationDatetime:g,SyncBackup:!0,CryptoFixedSalt:(0,i.bufferToBase64)(m),CryptoUserPayload:h},v=(0,o.getTransactionXml)(f),T={time:(0,p.getUnixTimestamp)(),backupDate:0,type:"SETTINGS",action:"BACKUP_EDIT",identifier:"SETTINGS_userId",content:v},A={forceSalt:m};return{personalSettings:f,promise:a.encryptSingleTransaction(t,T,A)}}},751:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSSOAccount=t.prepareRemoteDataEncryptionServices=void 0;const a=r(735088),o=r(632626),n=r(871703),s=r(839362),i=r(656915),c=r(956668),l=r(316038),d=r(164910),u=r(133769),p=r(869530),S=r(46298),g=r(670252),m=r(861259),y=r(816356),h=r(43461);t.prepareRemoteDataEncryptionServices=async(e,t)=>{const r=(0,a.v4)(),{remoteDataEncryptorService:o,masterPasswordEncryptorService:n}=e,s=await(0,p.generate64BytesKey)(),i=(0,l.base64BufferToText)(s),S=await(0,p.generate64BytesKey)(),g=(0,l.bufferToBase64)(S),m=(0,l.base64ToBuffer)(t),h=(0,u.getEncryptionKeyBuffer)(m,S,{skipDerivation:!0}),f=(0,l.arrayBufferToText)(h),v=(0,d.getNoDerivationCryptoConfig)();n.setInstance({raw:f},"",v);const T=(0,c.utf16ToDeflatedUtf8)(i,{skipUtf8Encoding:!0,skipDeflate:!0}),A=await n.getInstance().encrypt(T);return o.setInstance({raw:i},"",v),e.storeService.dispatch((0,y.updateRemoteKey)(i)),{remoteKey:{uuid:r,key:A,type:"sso"},serverKeyBase64:g}},t.createSSOAccount=async function(e,r){const{sessionService:a,storeService:c,remoteDataEncryptorService:l}=e,{consents:d,deviceName:u,login:p,ssoServiceProviderKey:g,ssoToken:m,anonymousUserId:v}=r,{appVersion:T,country:A,lang:P,platformName:w}=(0,i.platformInfoSelector)(c.getState());await a.close(),c.dispatch((0,h.accountCreationStarted)({isSSO:!0}));const{remoteKey:b,serverKeyBase64:I}=await(0,t.prepareRemoteDataEncryptionServices)(e,g),E={anonymousUserId:v,deviceName:u,format:A,language:P,login:p,password:g,subscribe:d.find((({consentType:e})=>"emailsOffersAndTips"===e)).status||!1};await(0,n.encryptSettings)(c,l,E);const C=c.getAccountCreation(),{content:_,time:D}=await C.settings.promise,O=await C.accountKey.promise,M=(0,S.makeSafeCountry)(c.getLocation().country||A);if("server_carbon_unknown"===w)throw new Error("Unexpected uninitialized platform info");const N={login:p,contactEmail:p,appVersion:T,sdkVersion:"1.0.0.0",platform:w,settings:{content:_,time:D},consents:d,deviceName:u,country:M,osCountry:M,language:(0,S.makeSafeLanguage)(P),osLanguage:(0,S.makeSafeLanguage)(P),remoteKeys:[b],ssoServerKey:I,ssoToken:m,sharingKeys:{publicKey:O.keys.publicKey,privateKey:O.encryptedPrivateKey},temporaryDevice:!0},F=await(0,S.createUserWithSSO)(c,N);if((0,S.isApiError)(F))return f(F);const U={createAccountResult:{encryptSettingsRequest:E,valid:!0},options:{flowIndicator:"memberAccount"},isStandAlone:!1,consents:d};return await(0,s.firstSync)(e,U,F,{useRemoteKey:!0}),e.storeService.dispatch((0,y.updateAnalyticsIds)(F.userAnalyticsId,F.deviceAnalyticsId)),{success:!0,code:o.LoginViaSsoCode.SUCCESS}};const f=e=>{const{code:t,message:r}=e;switch(v(t),t){case S.DomainNotValidForTeam:case S.InvalidUser:case S.InvalidSsoToken:case S.NotProposedNeitherAccepted:case S.NoFreeSlot:return(0,m.makeReturnErrorObject)(o.LoginViaSsoCode.SSO_VERIFICATION_FAILED,r);default:return(0,m.makeReturnErrorObject)(o.LoginViaSsoCode.UNKNOWN_ERROR,r)}},v=e=>{const t=new Error(`[createSSOAccount] - createUserWithSSO: ${e}`);(0,g.sendExceptionLog)({error:t})}},839362:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.firstSync=t.createAccount=void 0;const a=r(632626),o=r(700033),n=r(525963),s=r(737898),i=r(25576),c=r(188610),l=r(816356),d=r(278320),u=r(501347),p=r(827517),S=r(719399),g=r(358582),m=r(60946),y=r(441007),h=r(417936),f=r(992221),v=r(46298),T=r(492215),A=r(347542),P=r(751064);async function w(e,t,r,l={useRemoteKey:!1}){const p=t.createAccountResult,{login:v}=p.encryptSettingsRequest,A=(0,d.generateItemUuid)(),w=(0,u.getEmptyPersonalDataState)();w.emails.push({AnonId:(0,d.generateItemUuid)(),Email:v,EmailName:"Email 1",Id:A,kwType:"KWEmail",LastBackupTime:0,LocaleFormat:a.Country.UNIVERSAL,SpaceId:"",Type:"PERSO"}),w.changesToUpload.push((0,P.createUploadChange)({action:"EDIT",itemId:A,kwType:"KWEmail"}));const{monitor:b,getSyncEvent:I}=(0,y.makeEventLoggerSyncMonitor)(e.eventLoggerService,{sendLogOnSyncComplete:!1}),E=(0,m.setupProbe)(b,(0,h.makeDiagnosticReportMonitor)(),(0,f.makeSyncLoggerMonitor)()),C={accessKey:r.deviceAccessKey,secretKey:r.deviceSecretKey},_=(0,T.convertDeviceKeysToUki)(C),D=l.useRemoteKey?e.remoteDataEncryptorService:e.masterPasswordEncryptorService,O=Date.now(),M=s.SyncType.FULL_SYNC,N={storeService:e.storeService,dataEncryptorService:D,login:v,uki:_,lastSyncTimestamp:O,personalData:w,syncType:M,needsKeys:!1,ws:e.wsService,announce:E};let F=null;try{E(g.announcements.syncStarted(o.Trigger.AccountCreation,M),g.announcements.chronologicalSyncStarted(w)),F=await(0,n.sync)(N),E(g.announcements.chronologicalSyncFinished(F.summary),g.announcements.syncFinished())}catch(e){throw E(g.announcements.chronologicalSyncFailed(e),g.announcements.syncFailed(e)),e}if(t.isStandAlone){const t=(0,c.makeLoginController)(e);await t.loadAccountCreationInfos(v,p.encryptSettingsRequest.password,(0,S.secureDeviceName)(p.encryptSettingsRequest.deviceName),C,F.lastSyncTimestamp,i.PersistData.PERSIST_DATA_YES),await t.openSession(v,{password:p.encryptSettingsRequest.password})}const U=async function(e,t){return await e.logSync(new o.UserSyncEvent({duration:t.duration,error:t.error,extent:t.extent,fullBackupSize:t.fullBackupSize,incomingDeleteCount:t.incomingDeleteCount,incomingUpdateCount:t.incomingUpdateCount,outgoingDeleteCount:t.outgoingDeleteCount,outgoingUpdateCount:t.outgoingUpdateCount,timestamp:t.timestamp,trigger:t.trigger,treatProblem:t.treatProblem})),e.flushEventQueue()}(e.eventLoggerService,I());t.isStandAlone||await U}t.createAccount=async function(e,t,r,a,o){const n=e.storeService.getPlatform().info;if(!t.createAccountResult.valid)throw new Error("Account creation: Will not perform API request for invalidated settings promise");const[s,i]=await Promise.all([r,o]),c=await async function(e,t,r,a,o,n){const{storeService:s}=e,{createAccountResult:i}=r,c=e.storeService.getABTesting().version;let d=r.consents;Array.isArray(d)||(d=[{consentType:"emailsOffersAndTips",status:i.encryptSettingsRequest.subscribe}]);const u=i.encryptSettingsRequest.login;if("server_carbon_unknown"===t.platformName)throw new Error("Unexpected uninitialized platform info");const g={abTestingVersion:c,askM2dToken:!0,country:(0,v.makeSafeCountry)(e.storeService.getLocation().country||t.country),deviceName:(0,v.makeSafeDeviceName)((0,S.secureDeviceName)(i.encryptSettingsRequest.deviceName)),language:(0,v.makeSafeLanguage)(t.lang),login:u,osCountry:(0,v.makeSafeCountry)(t.country),osLanguage:(0,v.makeSafeLanguage)(t.lang),platform:t.platformName,settings:{content:o.content,time:o.time},appVersion:t.appVersion,contactEmail:u,consents:d,sharingKeys:{publicKey:n.keys.publicKey,privateKey:n.encryptedPrivateKey},temporaryDevice:!r.isStandAlone},m=await(0,v.createUser)(s,g);if((0,v.isApiError)(m))throw new Error(`[AccountCreation] - createAccountOnServer : ${m.message} (${m.code})`);return e.storeService.dispatch((0,l.updateKeyPair)({publicKey:n.keys.publicKey,privateKey:n.keys.privateKey})),e.storeService.dispatch((0,p.loadStoredPersonalSettings)(a)),e.storeService.dispatch((0,l.updateAnalyticsIds)(m.userAnalyticsId,m.deviceAnalyticsId)),m}(e,n,t,a,s,i);await w(e,t,c);const d=(0,T.convertDeviceKeysToUki)({accessKey:c.deviceAccessKey,secretKey:c.deviceSecretKey});return t.isStandAlone&&t.createAccountResult.valid&&(0,A.emitAccountCreated)(),{m2dToken:c.token,abtestingversion:c.abTestingVersion,uki:d,origin:c.origin,openSession:t.isStandAlone}},t.firstSync=w},585902:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(422021),o=r(134913);t.config={commands:{},queries:{getSubscriptionCode:{selector:a.subscriptionCodeSelector}},liveQueries:{liveSubscriptionCode:{operator:o.subscriptionCode$}}}},68904:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const a=r(585902);t.bootstrap=e=>{e.register(a.config)}},293820:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(68904);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},134913:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscriptionCode$=void 0;const a=r(518948),o=r(903343),n=r(422021);t.subscriptionCode$=()=>(0,a.pipe)((0,o.map)(n.subscriptionCodeSelector),(0,o.distinctUntilChanged)())},422021:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscriptionCodeSelector=void 0,t.subscriptionCodeSelector=e=>e.userSession.account.subscriptionCode},875903:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AntiPhishingConfig=void 0;const a=r(48331);t.AntiPhishingConfig={commands:{},queries:{},liveQueries:{livePhishingURLList:{operator:a.antiPhishingURLList$}}}},526404:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateAntiPhishingURLList=t.UPDATE_ANTI_PHISHING_URL_LIST=void 0,t.UPDATE_ANTI_PHISHING_URL_LIST="UPDATE_ANTI_PHISHING_URL_LIST",t.updateAntiPhishingURLList=e=>({type:t.UPDATE_ANTI_PHISHING_URL_LIST,phishingURLList:e})},356666:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const a=r(875903);t.bootstrap=e=>{e.register(a.AntiPhishingConfig)}},977820:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.REMOTE_PHISHING_FILE=void 0,t.REMOTE_PHISHING_FILE="phishing_urls_test.json"},125560:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(356666);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},48331:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.antiPhishingURLList$=void 0;const a=r(518948),o=r(903343),n=r(768769);t.antiPhishingURLList$=()=>(0,a.pipe)((0,o.map)(n.antiPhishingURLListSelector),(0,o.distinctUntilChanged)())},869018:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AntiPhishingReducer=t.getEmptyAntiPhishingState=void 0;const a=r(164658),o=r(526404);t.getEmptyAntiPhishingState=()=>new Set([]),t.AntiPhishingReducer=(e=(0,t.getEmptyAntiPhishingState)(),r)=>r.type===o.UPDATE_ANTI_PHISHING_URL_LIST?(0,a.areSetsEqual)(r.phishingURLList,e)?e:r.phishingURLList:e},768769:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.antiPhishingURLListSelector=void 0,t.antiPhishingURLListSelector=e=>e.device.antiPhishing},646564:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const a=r(285318);t.setupSubscriptions=async function(e,t){e.remoteFileChanged.on((e=>(0,a.triggerUpdatePhishingURLFile)(t,e)))}},285318:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.triggerUpdatePhishingURLFile=void 0;const a=r(670252),o=r(496405),n=r(526404),s=r(977820),i=async e=>{const t=await(0,o.fileContentStrSelector)(e,s.REMOTE_PHISHING_FILE),r=t?JSON.parse(t):[];if(1!==(n=r).fileFormat||!Array.isArray(n.domains)){const e=new Error("[Anti-Phishing]: File format is invalid");return(0,a.sendExceptionLog)(e),null}var n;return{domains:new Set(r.domains),fileFormat:r.fileFormat}};t.triggerUpdatePhishingURLFile=async function(e,t){const{storeService:r}=e,a=r.getState();if(t===s.REMOTE_PHISHING_FILE){const e=await i(a);e&&r.dispatch((0,n.updateAntiPhishingURLList)(e.domains))}}},407036:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.connectLazySlot=void 0;const a=r(504939),o=["API","Live"];t.connectLazySlot=(e,t,r=!1)=>{const n=new Map;return e.lazy((s=>{r&&(0,a.logInfo)({message:`${e.slotName} subscribed on param ${s}`,tag:o});const i=t(s),c=((e,t,r,n)=>e?e=>((0,a.logInfo)({message:`Emitting on ${t.slotName} with param ${r}`,tag:o,details:{event:e}}),n(e)):n)(r,e,s,(t=>e(s,t).catch((()=>{})))),l=i.subscribe(c);n.set(s,l)}),(t=>{const s=n.get(t);s?(r&&(0,a.logInfo)({message:`${e.slotName} unsubscribed on param ${t}`,tag:o}),s.unsubscribe(),n.delete(t)):r&&(0,a.logWarn)({message:`Cannot unsubscribe from ${e.slotName} on param ${t}: subscription not found.`,tag:o})}))}},802246:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSyncAppSetting=t.setDataDEBUGONLY=t.decipherApplicationSettings=t.loadAppSettings=t.getCommonAppSettings=t.getCommonAppSetting=t.storeCommonAppSetting=t.getUsersWithPublicSettings=t.deleteUsersPublicSettings=t.getUserPublicSetting=t.storeUserPublicSetting=t.initApplicationSettings=void 0;const a=r(795623),o=r(72365),n=r(956668),s=r(501860),i=r(380722),c=r(402356),l=r(130913),d=r(718216);let u=null,p=null,S=null;function g(){if(!S)throw new Error("ApplicationSettings not initialized");return(0,l.commonApplicationSettingsSelector)(S.getState())||{}}t.initApplicationSettings=function(e,t,r,a){return u=e,p=a&&a.dataEncryptorService||(0,s.makeKeyDataEncryptorService)(),S=t,(0,o.setObfuscatingKey)(p),r===d.InitMode.FirstInit?(a?.settings&&t.dispatch((0,c.storeApplicationSettings)(a.settings)),h()):Promise.resolve()},t.storeUserPublicSetting=function(e,t,r){if(!S)throw new Error("ApplicationSettings not initialized");return S.dispatch((0,c.storeUserPublicSetting)(e,{[t]:r})),y()},t.getUserPublicSetting=function(e,t){if(!S)throw new Error("ApplicationSettings not initialized");const r=(0,l.userPublicSettingsSelector)(S.getState(),e);return r&&r.hasOwnProperty(t)?r[t]:null},t.deleteUsersPublicSettings=async function(e){if(!S)throw new Error("ApplicationSettings not initialized");return S.dispatch((0,c.deleteUserPublicSettings)(e)),y()},t.getUsersWithPublicSettings=function(){if(!S)throw new Error("ApplicationSettings not initialized");return Object.keys((0,l.publicUsersSettingsSelector)(S.getState()))},t.storeCommonAppSetting=function(e,t){return g()[e]=t,y()},t.getCommonAppSetting=function(e){const t=g();return t.hasOwnProperty(e)?(t[e],t[e]):null},t.getCommonAppSettings=g;const m="ApplicationSettings.cdata";function y(){if(!S||!u||!p)throw new Error("ApplicationSettings not initialized");const e=u.getLocalStorage(),t={publicUsersSettings:(0,l.publicUsersSettingsSelector)(S.getState()),commonApplicationSettings:(0,l.commonApplicationSettingsSelector)(S.getState())||{}},r=JSON.stringify(t),a=(0,n.utf16ToDeflatedUtf8)(r);return p.getInstance().encrypt(a).then((t=>e.writeItem(m,t))).then((()=>{}))}function h(){if(!u||!p)throw new Error("ApplicationSettings not initialized");a.default.log("loadApplicationSettings");const e=u.getLocalStorage();return e.itemExists(m).then((t=>(a.default.log("loadApplicationSettings "+t),t?e.readItem(m).then((e=>{if(a.default.log("appSettings read"),a.default.log(e),null==e)throw new Error("storing empty or null value is not authorized");if("string"!=typeof e)throw new Error("value of ApplicationSettings.cdata is expected to be a string");return f(p,e).then((e=>JSON.parse(e))).then((e=>{v(e)}))})):v({publicUsersSettings:{},commonApplicationSettings:{}})))).catch((e=>{a.default.error(e,"loadAppSettings"),v({publicUsersSettings:{},commonApplicationSettings:{}})}))}function f(e,t){return e.getInstance().decrypt(t).then((e=>(0,n.deflatedUtf8ToUtf16)(e))).catch((()=>{const e=(0,o.makeDataEncryptorService)((0,i.makeStoreService)());return(0,o.setObfuscatingKey)(e),e.getInstance().decrypt(t).then((e=>(0,n.deflatedUtf8ToUtf16)(e)))}))}function v(e){if(!S)throw new Error("ApplicationSettings not initialized");a.default.log(`ApplicationSettings loaded for deviceId: ${e.commonApplicationSettings.deviceId}`),S.dispatch((0,c.storeApplicationSettings)(e))}t.loadAppSettings=h,t.decipherApplicationSettings=f,t.setDataDEBUGONLY=function(e){if(!S)throw new Error("ApplicationSettings not initialized");S.dispatch((0,c.storeApplicationSettings)(e))},t.getSyncAppSetting=function(e){const t=function(){if(!S)throw new Error("ApplicationSettings not initialized");return S.getState().device.application.settings.sync}();return t.hasOwnProperty(e)?t[e]:null}},230096:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.appSessionIdInitialized=t.APP_SESSION_ID_INITIALIZED=void 0,t.APP_SESSION_ID_INITIALIZED="APP_SESSION_ID_INITIALIZED",t.appSessionIdInitialized=e=>({type:t.APP_SESSION_ID_INITIALIZED,appSessionId:e})},510319:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applicationReducer=t.getEmptyApplicationSessionState=void 0;const a=r(182422),o=r(859600),n=r(230096);t.getEmptyApplicationSessionState=()=>({appSessionId:void 0}),t.applicationReducer=(0,a.combineReducers)({appSession:(e=(0,t.getEmptyApplicationSessionState)(),r)=>r.type===n.APP_SESSION_ID_INITIALIZED?{...e,appSessionId:r.appSessionId}:e,settings:o.default})},128486:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.appSessionIdSelector=void 0,t.appSessionIdSelector=e=>e.device.application.appSession.appSessionId},402356:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteUserPublicSettings=t.storeUserPublicSetting=t.storeApplicationSettings=t.DELETE_USER_PUBLIC_SETTINGS=t.STORE_USER_PUBLIC_SETTING=t.STORE_APPLICATION_SETTINGS=void 0,t.STORE_APPLICATION_SETTINGS="STORE_APPLICATION_SETTINGS",t.STORE_USER_PUBLIC_SETTING="STORE_USER_PUBLIC_SETTING",t.DELETE_USER_PUBLIC_SETTINGS="DELETE_USER_PUBLIC_SETTINGS",t.storeApplicationSettings=e=>({type:t.STORE_APPLICATION_SETTINGS,settings:e}),t.storeUserPublicSetting=(e,r)=>({type:t.STORE_USER_PUBLIC_SETTING,login:e,userSettings:r}),t.deleteUserPublicSettings=e=>({type:t.DELETE_USER_PUBLIC_SETTINGS,logins:e})},859600:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyApplicationSettings=void 0;const a=r(402356);t.getEmptyApplicationSettings=()=>({sync:{syncWithLocalClients:!1},userABTestNames:[],migratedToSAEX:void 0,desktopLogin:void 0,publicUsersSettings:void 0,commonApplicationSettings:void 0}),t.default=(e=(0,t.getEmptyApplicationSettings)(),r)=>{switch(r.type){case a.STORE_APPLICATION_SETTINGS:return{...e,...r.settings||{}};case a.STORE_USER_PUBLIC_SETTING:{const t=r.login,a=e.publicUsersSettings??{},o={...a,[t]:{...a[t]??{},...r.userSettings}};return{...e,publicUsersSettings:o}}case a.DELETE_USER_PUBLIC_SETTINGS:{const t=r.logins,a=Object.keys(e.publicUsersSettings??{}),o=t.filter((e=>a.includes(e.trim())));return 0===o.length||o.forEach((t=>{const r=t.trim();delete e.publicUsersSettings[r]})),{...e}}default:return e}}},130913:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.commonApplicationSettingsSelector=t.publicUsersSettingsSelector=t.userPublicSettingsSelector=t.migratedToSAEXSelector=t.abTestsNamesSelector=void 0;const r={};t.abTestsNamesSelector=e=>e.device.application.settings.userABTestNames,t.migratedToSAEXSelector=e=>e.device.application.settings.migratedToSAEX,t.userPublicSettingsSelector=(e,t)=>e.device.application.settings.publicUsersSettings?.[t],t.publicUsersSettingsSelector=e=>e.device.application.settings.publicUsersSettings??r,t.commonApplicationSettingsSelector=e=>e.device.application.settings.commonApplicationSettings},487855:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ensureDeviceId=t.initAuthenticatedCarbonApplication=void 0;const a=r(735088),o=r(802246),n=r(795623),s=r(17338),i=r(433007),c=r(670252),l=r(57366),d=r(786056),u=r(375125),p=r(869530),S=r(316038),g=r(578671),m=r(217644),y=r(718216);async function h(e,t,r,{platformInfo:s,settings:i}){n.default.log("initCarbonApplication"),(0,u.initializeAppSessionId)(e),(0,d.setPlatformInfo)(s),await(0,o.initApplicationSettings)(t,e,r,{settings:i}),await function(){if(!(0,o.getCommonAppSetting)("anonymousComputerId"))return(0,o.storeCommonAppSetting)("anonymousComputerId",(0,a.v4)())}(),await((0,o.getCommonAppSetting)("installationId")?Promise.resolve():(0,o.storeCommonAppSetting)("installationId",(0,a.v4)())),await async function(){if(!(0,o.getCommonAppSetting)("eventLoggerQueueKey")){const e=await(0,p.generate64BytesKey)(),t=(0,S.base64BufferToText)(e);return(0,o.storeCommonAppSetting)("eventLoggerQueueKey",t)}}()}t.default=h,t.initAuthenticatedCarbonApplication=async(e,t,r)=>{r===y.InitMode.FirstInit&&await f(e,t);const{storageService:a,storeService:o}=(0,s.getCoreServices)(t);return await h(o,a,r,e),await v(o,a),t},t.ensureDeviceId=async function(){let e=(0,o.getCommonAppSetting)("deviceId");return e||(await(0,o.storeCommonAppSetting)("deviceId",(0,a.v4)().replace(/-/g,"")),e=(0,o.getCommonAppSetting)("deviceId")),e};const f=async(e,t)=>{try{const r=(0,s.getCoreServices)(t),{storeService:a}=r;e.anonymousPartnerId&&a.dispatch((0,i.loadAnonymousPartnerId)(e.anonymousPartnerId)),await(0,l.initAuthentication)(r,e.keys)}catch(e){const t=new Error(`[Application] - setSdkAuthentication: ${e}`);(0,c.sendExceptionLog)({error:t})}},v=async(e,t)=>{const r=await(0,g.getGlobalExtensionSettings)({storeService:e,storageService:t});e.dispatch((0,m.setGlobalExtensionSettingsState)(r))}},786056:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setPlatformInfo=t.getPlatformInfo=void 0;const a=r(509149);let o=Object.assign({},a.defaultPlatformInfo);t.getPlatformInfo=function(){return o},t.setPlatformInfo=function(e){o=Object.assign({},a.defaultPlatformInfo,e)}},375125:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getApplicationSessionId=t.initializeAppSessionId=void 0;const a=r(596997),o=r(128486),n=r(230096);function s(e){return(0,o.appSessionIdSelector)(e.getState())}t.initializeAppSessionId=function(e){s(e)||function(e,t){e.dispatch((0,n.appSessionIdInitialized)(t))}(e,(0,a.default)())},t.getApplicationSessionId=s},502646:(e,t)=>{let r;Object.defineProperty(t,"__esModule",{value:!0}),t.getPublicPath=t.setPublicPath=void 0,t.setPublicPath=e=>{if("string"!=typeof e)throw new Error("[Assets] - setPublicPath: provided public path is not a string.");r=e},t.getPublicPath=()=>{if(!r)throw new Error("[Assets] - getPublicPath: trying to access public path before it was set.");return r}},803158:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(891178),o=r(453325),n=r(281404),s=r(236592),i=r(254622),c=r(921107),l=r(656915),d=r(503914),u=r(355636),p=r(763229);t.config={commands:{registerDevice:{handler:u.registerDeviceHandler},requestExtraDeviceToken:{handler:c.requestExtraDeviceToken},requestEmailToken:{handler:c.requestEmailToken},requestPaymentUpdateAuthenticationToken:{handler:c.requestPaymentUpdateAuthenticationToken},setReactivationStatus:{handler:d.setReactivationStatusHandler},disableAutologin:{handler:p.disableAutologin},...a.config.commands,...o.config.commands,...n.config.commands,...s.config.commands},queries:{getHasOtp2Type:{selector:l.hasOtp2TypeSelector},getUserOtpType:{selector:l.otpTypeSelector},getLocalAccounts:{selector:l.localAccountsListSelector},getReactivationStatus:{selector:l.reactivationStatusSelector},getAvailableUserVerificationMethods:{selector:l.availableUserVerificationMethodsSelector},...a.config.queries,...o.config.queries,...n.config.queries,...s.config.queries},liveQueries:{liveReactivationStatus:{operator:i.reactivationStatus$},...a.config.liveQueries,...o.config.liveQueries,...n.config.liveQueries,...s.config.liveQueries}}},693553:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isExtraDeviceToken=t.requestExtraDeviceToken=void 0;const a=r(46298);t.requestExtraDeviceToken=async(e,t)=>{if(!e())return{type:"userNotAuthenticated",message:"No authenticated user"};const r=await t();if((0,a.isApiError)(r))return r;const n=r.token;return o(n)};const o=e=>"string"!=typeof e||0===e.length?{type:"invalidExtraDeviceTokenSentByServer",message:"Invalid extra device token sent by server"}:{type:"extraDeviceToken",extraDeviceToken:e};t.isExtraDeviceToken=e=>"extraDeviceToken"===e.type},763229:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableAutologin=void 0;const a=r(798226),o=r(656915),n=r(361740);t.disableAutologin=async function({storeService:e,localStorageService:t}){return"autologin"!==(0,o.rememberMeTypeSelector)(e.getState())||(await t.getInstance().cleanAuthenticationKey(),await(0,n.persistLocalAccountRememberMeType)(e,"disabled"),e.dispatch((0,a.setRememberMeTypeAction)("disabled"))),Promise.resolve()}},275226:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLocalAccounts=void 0;const a=r(802246),o=r(656915),n=r(963739),s=r(361740);t.getLocalAccounts=async function(e,t){const r=(0,a.getUsersWithPublicSettings)(),i={},c=["localSettings","personalData","personalSettings"];return Promise.all(r.map((async r=>{const a=(0,o.getUserDeviceWasRegisteredWithDeviceKeysSelector)(e.getState(),r),s=[...c,...a?["authentication"]:[]],l=(await Promise.all(s.map((e=>(0,n.isDataStored)(t,r,e))))).every((e=>e));i[r]=l}))).then((()=>r.filter((e=>i[e])))).then((e=>{const t=e.map((e=>({login:e,lastLoginTime:(0,a.getUserPublicSetting)(e,"lastSuccessfulLoginTime")||0}))).sort(((e,t)=>{const r=e.lastLoginTime,a=t.lastLoginTime;return r>a?-1:r<a?1:0}))[0];return e.map((e=>({login:e,hasLoginOtp:(0,a.getUserPublicSetting)(e,"otp2")||!1,isLastSuccessfulLogin:t&&t.login===e,rememberMeType:(0,s.getLocalAccountRememberMeType)(e)??void 0,shouldAskMasterPassword:(0,s.shouldAskMasterPassword)(e)}))).sort(((e,t)=>{const r=e.login.toLowerCase(),a=t.login.toLowerCase();return r.localeCompare(a)}))}))}},937864:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTokenForKwUser=void 0;const a=r(46298);t.getTokenForKwUser=async(e,t)=>{const{storeService:r}=e,o=await(0,a.getTokens)(r);if((0,a.isApiError)(o))throw new Error(`Error: ${o.code}`);const{tokens:n}=o,s=n.find((e=>e.login===t));if(!s)throw new Error("Email token not found for "+t);return s.token}},921107:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestPaymentUpdateAuthenticationToken=t.requestEmailToken=t.requestExtraDeviceToken=void 0;var a=r(561336);Object.defineProperty(t,"requestExtraDeviceToken",{enumerable:!0,get:function(){return a.requestExtraDeviceToken}});var o=r(895626);Object.defineProperty(t,"requestEmailToken",{enumerable:!0,get:function(){return o.requestEmailToken}});var n=r(217717);Object.defineProperty(t,"requestPaymentUpdateAuthenticationToken",{enumerable:!0,get:function(){return n.requestPaymentUpdateAuthenticationToken}})},57366:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initAuthentication=void 0;const a=r(795623),o=r(433007),n=r(769763),s=r(46298),i=r(656915),c=r(428445);t.initAuthentication=async(e,t)=>{l(e,t),d(e,t),await(0,n.loadLocalUsersAuthenticationDataFromStorage)(e),await u(e,(0,c.checkOrigin)(self))};const l=(e,t)=>{const{storeService:r}=e;r.dispatch((0,o.saveAppKeys)({accessKey:t.appAccess,secretKey:t.appSecret}))},d=(e,t)=>{const{storeService:r}=e;r.dispatch((0,o.saveStyxKeys)({accessKey:t.styxAccess,secretKey:t.styxSecret}))},u=async(e,t)=>{const{storeService:r}=e;try{const e=(0,i.platformInfoSelector)(r.getState()),a=await(0,s.getRemoteTime)(r,"server_tac"!==e.platformName&&"server_leeloo"!==e.platformName||!t?void 0:{tz:(new Date).getTimezoneOffset().toString()});if((0,s.isApiError)(a))throw a;r.dispatch((0,o.saveDashlaneServerDeltaTimestamp)(a.timestamp))}catch(e){(0,a.logDebug)({tag:["Auth"],message:"Error while calling getRemoteTime",details:{error:e}})}}},514498:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadRememberMeTypeToStore=void 0;const a=r(798226),o=r(361740),n=r(416593);t.loadRememberMeTypeToStore=function(e){const{storeService:t}=e,r=(0,n.userLoginSelector)(t.getState()),s=(0,o.getLocalAccountRememberMeType)(r);s&&t.dispatch((0,a.setRememberMeTypeAction)(s))}},355636:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.registerDeviceHandler=void 0;const a=r(770414);t.registerDeviceHandler=async function({storeService:e},t){return await(0,a.registerDevice)(e,t),Promise.resolve()}},561336:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestExtraDeviceToken=void 0;const a=r(46298),o=r(693553),n=r(416593);t.requestExtraDeviceToken=async e=>{const{storeService:t}=e,r=t.isAuthenticated,s=(0,n.userLoginSelector)(t.getState());if(!s||!r)throw new Error("[Authentication] - requestExtraDeviceToken: User is not authenticated");const i=await(0,o.requestExtraDeviceToken)(r,(()=>(0,a.requestExtraDeviceRegistration)(t,s)));if((0,o.isExtraDeviceToken)(i))return i.extraDeviceToken;throw new Error(i.message)}},217717:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestPaymentUpdateAuthenticationToken=void 0;const a=r(290622),o=r(46298),n=r(416593),s=r(727885),i=r(432924),c=r(201577);t.requestPaymentUpdateAuthenticationToken=async function(e){try{const{storeService:t}=e,r=t.getState(),l=(0,n.userLoginSelector)(r);if(!(0,n.isAuthenticatedSelector)(r))return{success:!1};const d=await(0,i.getAuthenticationTokenForCardUpdate)(t,l);if((0,o.isApiError)(d))return{success:!1};const u=(0,s.getCurrentTeamId)(r.userSession.spaceData),p=(0,s.isTeamAdminInCurrentSpace)(r.userSession.spaceData),S=(0,s.isBillingAdminInCurrentSpace)(r.userSession.spaceData),g={login:l,uki:(0,a.ukiSelector)(r),teamId:u};let m,y={};if(u&&(p||S)){const e={name:"teamPlans",version:1};if(m=await(0,c.NewCardToken)(g,e),200!==m.code)return{success:!1};y={customerId:m.content.customerId,tokenId:m.content.tokenId}}let h={};const f={name:"premium",version:3},v=await(0,c.NewCardToken)(g,f);return 200!==v.code?{success:!1}:(h={customerId:v.content.customerId,tokenId:v.content.tokenId},{success:!0,accessKey:d.accessKey,creationDateUnix:d.creationDateUnix,expirationDateUnix:d.expirationDateUnix,secretKey:d.secretKey,livemode:d.livemode,b2bPaymentTokens:y,b2cPaymentTokens:h})}catch(e){return{success:!1}}}},895626:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestEmailToken=void 0;const a=r(632626),o=r(416593);t.requestEmailToken=async function(e){try{const{storeService:t,wsService:r}=e,a=t.getState(),n=(0,o.userLoginSelector)(a);if(!n)throw new Error("[emailToken] - askServerToSendToken: no current authenticated user");await r.authentication.askServerToSendToken({login:n})}catch(e){return{success:!1,error:{code:a.EmailTokenApiError,message:e.message}}}return{success:!0}}},503914:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setReactivationStatusHandler=void 0;const a=r(409344);t.setReactivationStatusHandler=function({storeService:e},{reactivationStatus:t}){return e.dispatch((0,a.reactivationStatusUpdated)(t)),Promise.resolve()}},706231:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.persistUserAuthenticationData=t.loadUserAuthenticationData=void 0;const a=r(656915),o=r(798226),n=r(739408);t.loadUserAuthenticationData=async(e,t)=>{let r;try{const t=e.getInstance();if(!await t.hasAuthenticationData())return Promise.resolve({type:"success"});r=await t.getAuthenticationData()}catch(e){return Promise.resolve({type:"failed",message:n.FailedToReadParseOrValidateAuthenticationData,error:e})}try{t.dispatch((0,o.rehydrateUserAuthenticationData)(r))}catch(e){return Promise.resolve({type:"failed",message:n.FailedToRehydrateAuthenticationData,error:e})}return Promise.resolve({type:"success"})},t.persistUserAuthenticationData=async(e,t)=>{const r=(0,a.userAuthenticationDataSelector)(t.getState()),o=e.getInstance();await o.storeAuthenticationData(r)}},769763:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadLocalUsersAuthenticationDataFromStorage=t.persistLocalUsersAuthenticationData=void 0;const a=r(72365),o=r(150058),n=r(670252),s=r(795623),i=r(392263),c=r(656915),l=r(316038),d=r(501860),u=r(956668),p=r(493513),S="authentication.localusers";t.persistLocalUsersAuthenticationData=async(e,t)=>{try{const r=e.getLocalStorage(),o=(0,d.makeKeyDataEncryptorService)();(0,a.setObfuscatingKey)(o);const n=(0,c.localUsersAuthenticationDataSelector)(t.getState()),s=JSON.stringify(n),i=(0,l.utf8ChunkEncode)(s),g=p.encode(i),m=(0,u.utf16ToDeflatedUtf8)(g,{skipUtf8Encoding:!0}),y=await o.getInstance().encrypt(m);await r.writeItem(S,y)}catch(e){const t="Auth",r=i.CarbonError.fromAnyError(e).addContextInfo(t,"persistLocalUsersAuthenticationData");(0,s.logError)({tag:[t],message:`${r}`,details:{error:e}}),(0,n.sendExceptionLog)({error:r})}},t.loadLocalUsersAuthenticationDataFromStorage=async e=>{try{const{storageService:t,storeService:r}=e,n=t.getLocalStorage(),s=(0,a.makeDataEncryptorService)(r);(0,a.setObfuscatingKey)(s);const i=await n.readItem(S);if(!i)return;if("string"!=typeof i)throw new Error("value of authentication.localusers is expected to be a string");const c=await s.getInstance().decrypt(i),d=(0,u.deflatedUtf8ToUtf16)(c,{skipUtf8Decoding:!0}),g=p.decode(d);let m=g;try{m=(0,l.utf8ChunkDecode)(g)}catch(e){}const y=JSON.parse(m);r.dispatch((0,o.loadLocalUsersAuthenticationData)(y))}catch(e){const t="Auth",r=i.CarbonError.fromAnyError(e).addContextInfo(t,"loadLocalUsersAuthenticationDataFromStorage");(0,s.logError)({tag:[t],message:`${r}`,details:{error:e}}),(0,n.sendExceptionLog)({error:r})}}},739408:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isLoadAuthenticationSuccess=t.FailedToRehydrateAuthenticationData=t.FailedToReadParseOrValidateAuthenticationData=void 0,t.FailedToReadParseOrValidateAuthenticationData="Failed to read, parse or validate persisted data",t.FailedToRehydrateAuthenticationData="Failed to rehydrate",t.isLoadAuthenticationSuccess=e=>"object"==typeof e&&"success"===e.type},643739:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deviceRegistered=t.makeDeviceRegistrationKeys=t.makeLegacyDeviceRegistrationKey=t.DEVICE_REGISTERED=void 0,t.DEVICE_REGISTERED="DEVICE_REGISTERED",t.makeLegacyDeviceRegistrationKey=e=>({type:"uki",uki:e}),t.makeDeviceRegistrationKeys=(e,t)=>({type:"deviceKeys",deviceAccessKey:e,deviceSecretKey:t}),t.deviceRegistered=(e,r,a)=>({type:t.DEVICE_REGISTERED,registrationType:e,persistData:r,login:a})},798226:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setRememberMeTypeAction=t.rehydrateUserAuthenticationData=t.SET_REMEMBER_ME_TYPE=t.REHYDRATE_USER_AUTHENTICATION_DATA=void 0,t.REHYDRATE_USER_AUTHENTICATION_DATA="REHYDRATE_USER_AUTHENTICATION_DATA",t.SET_REMEMBER_ME_TYPE="SET_REMEMBER_ME_TYPE",t.rehydrateUserAuthenticationData=e=>({type:t.REHYDRATE_USER_AUTHENTICATION_DATA,data:e}),t.setRememberMeTypeAction=e=>({type:t.SET_REMEMBER_ME_TYPE,rememberMeType:e})},199932:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyCurrentUserAuthentication=t.currentUserAuthenticationReducer=void 0;const a=r(448313),o=r(798226),n=r(643739);t.currentUserAuthenticationReducer=(e=(0,t.getEmptyCurrentUserAuthentication)(),r)=>{switch(r.type){case a.CLOSE_SESSION:return(0,t.getEmptyCurrentUserAuthentication)();case n.DEVICE_REGISTERED:if("deviceKeys"===r.registrationType.type){const{deviceAccessKey:t,deviceSecretKey:a}=r.registrationType;return{...e,deviceKeys:{accessKey:t,secretKey:a}}}return e;case o.REHYDRATE_USER_AUTHENTICATION_DATA:return{...e,...r.data};case o.SET_REMEMBER_ME_TYPE:return{...e,rememberMeType:r.rememberMeType};default:return e}},t.getEmptyCurrentUserAuthentication=()=>({deviceKeys:null,rememberMeType:null})},552653:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.authenticationReducer=t.updateLocalUserInfo=t.makeDeviceRegistrationKeys=t.makeLegacyDeviceRegistrationKey=t.deviceRegistered=void 0;var a=r(643739);Object.defineProperty(t,"deviceRegistered",{enumerable:!0,get:function(){return a.deviceRegistered}}),Object.defineProperty(t,"makeLegacyDeviceRegistrationKey",{enumerable:!0,get:function(){return a.makeLegacyDeviceRegistrationKey}}),Object.defineProperty(t,"makeDeviceRegistrationKeys",{enumerable:!0,get:function(){return a.makeDeviceRegistrationKeys}});var o=r(150058);Object.defineProperty(t,"updateLocalUserInfo",{enumerable:!0,get:function(){return o.updateLocalUserInfo}});var n=r(957334);Object.defineProperty(t,"authenticationReducer",{enumerable:!0,get:function(){return n.authenticationReducer}})},409344:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reactivationStatusUpdated=t.localAccountsListUpdated=void 0;const a=r(252968);t.localAccountsListUpdated=e=>({type:a.LOCAL_ACCOUNTS_LIST_UPDATED,localAccounts:e}),t.reactivationStatusUpdated=e=>({type:a.REACTIVATION_STATUS_UPDATED,reactivationStatus:e})},583803:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.localAccountsAuthenticationReducer=t.getEmptyLocalAccountsAuthenticationState=void 0;const a=r(252968);t.getEmptyLocalAccountsAuthenticationState=()=>({accountsList:[],accountsListInitialized:!1,reactivationStatus:a.ReactivationStatus.CLASSIC}),t.localAccountsAuthenticationReducer=(e=(0,t.getEmptyLocalAccountsAuthenticationState)(),r)=>{switch(r.type){case a.LOCAL_ACCOUNTS_LIST_UPDATED:return{...e,accountsList:r.localAccounts,accountsListInitialized:!0};case a.REACTIVATION_STATUS_UPDATED:return{...e,reactivationStatus:r.reactivationStatus};default:return e}}},252968:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.REACTIVATION_STATUS_UPDATED=t.LOCAL_ACCOUNTS_LIST_UPDATED=t.ReactivationStatus=void 0,function(e){e.DISABLED="DISABLED",e.CLASSIC="CLASSIC",e.WEBAUTHN="WEBAUTHN"}(t.ReactivationStatus||(t.ReactivationStatus={})),t.LOCAL_ACCOUNTS_LIST_UPDATED="LOCAL_ACCOUNTS_LIST_UPDATED",t.REACTIVATION_STATUS_UPDATED="REACTIVATION_STATUS_UPDATED"},150058:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isLocalUserAuthenticationAction=t.updateLocalUserInfo=t.loadLocalUsersAuthenticationData=t.UPDATE_LOCAL_USER_INFO=t.LOAD_LOCAL_USERS_AUTH_DATA_FROM_STORAGE=void 0;const a=r(643739);t.LOAD_LOCAL_USERS_AUTH_DATA_FROM_STORAGE="LOAD_LOCAL_USERS_AUTH_DATA_FROM_STORAGE",t.UPDATE_LOCAL_USER_INFO="UPDATE_LOCAL_USER_INFO",t.loadLocalUsersAuthenticationData=e=>({type:t.LOAD_LOCAL_USERS_AUTH_DATA_FROM_STORAGE,data:e}),t.updateLocalUserInfo=(e,r)=>({type:t.UPDATE_LOCAL_USER_INFO,login:e,data:r}),t.isLocalUserAuthenticationAction=e=>e.type===a.DEVICE_REGISTERED},376156:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyLocalUsersAuthentication=t.localUsersAuthenticationReducer=void 0;const a=r(401067),o=r(150058),n=r(643739),s=r(17825);t.localUsersAuthenticationReducer=(e=(0,t.getEmptyLocalUsersAuthentication)(),r)=>{if((0,o.isLocalUserAuthenticationAction)(r)){const t=i(e[r.login],r);return t?{...e,[r.login]:t}:(0,a.omit)([r.login],e)}switch(r.type){case o.LOAD_LOCAL_USERS_AUTH_DATA_FROM_STORAGE:return{...e,...r.data};case o.UPDATE_LOCAL_USER_INFO:const t=c();return{...e,[r.login]:{...t,...e[r.login],...r.data}};default:return e}},t.getEmptyLocalUsersAuthentication=()=>({});const i=(e,t)=>{const r=e||c();if(t.type!==n.DEVICE_REGISTERED)return e;{const{registrationType:e}=t;switch(e.type){case"deviceKeys":{const{deviceAccessKey:t}=e;return{...r,deviceAccessKey:t,deviceRegisteredWithLegacyKey:!1}}case"uki":return{...r,deviceRegisteredWithLegacyKey:!0};default:(0,s.assertUnreachable)(e)}}},c=()=>({deviceAccessKey:null,deviceRegisteredWithLegacyKey:!1,ssoActivatedUser:!1})},957334:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.authenticationReducer=t.getEmptyAuthenticationState=void 0;const a=r(182422),o=r(199932),n=r(583803),s=r(376156),i=r(482677),c=r(796171),l=r(888272);t.getEmptyAuthenticationState=()=>({currentUser:(0,o.getEmptyCurrentUserAuthentication)(),localAccounts:(0,n.getEmptyLocalAccountsAuthenticationState)(),localUsers:(0,s.getEmptyLocalUsersAuthentication)(),u2f:(0,i.getEmptyU2FAuthenticationState)(),webAuthnAuthentication:(0,l.getEmptyWebAuthnAuthentication)(),twoFactorAuthentication:(0,c.getEmptyTwoFactorAuthenticationState)()}),t.authenticationReducer=(0,a.combineReducers)({currentUser:o.currentUserAuthenticationReducer,localAccounts:n.localAccountsAuthenticationReducer,localUsers:s.localUsersAuthenticationReducer,u2f:i.u2fAuthenticationReducer,webAuthnAuthentication:l.webAuthnAuthenticationReducer,twoFactorAuthentication:c.TwoFactorAuthenticationReducer})},372355:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.u2fDevicesUpdated=t.U2F_DEVICES_UPDATED=void 0,t.U2F_DEVICES_UPDATED="U2F_DEVICES_UPDATED",t.u2fDevicesUpdated=e=>({type:t.U2F_DEVICES_UPDATED,devices:e})},482677:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.u2fAuthenticationReducer=t.getEmptyU2FAuthenticationState=void 0;const a=r(372355);t.getEmptyU2FAuthenticationState=()=>({u2fDevices:[]}),t.u2fAuthenticationReducer=(e=(0,t.getEmptyU2FAuthenticationState)(),r)=>r.type===a.U2F_DEVICES_UPDATED?{...e,u2fDevices:r.devices}:e},608246:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.webAuthnAvailableAuthenticatorsListUpdated=t.webAuthnAuthenticatorsListUpdated=t.webAuthnAuthenticatorRemoved=t.webAuthnAuthenticatorAdded=t.webAuthnUserIdUpdated=t.WEBAUTHN_AVAILABLE_AUTHENTICATORS_LIST_UPDATED=t.WEBAUTHN_AUTHENTICATORS_LIST_UPDATED=t.WEBAUTHN_AUTHENTICATOR_REMOVED=t.WEBAUTHN_AUTHENTICATOR_ADDED=t.WEBAUTHN_USERID_UPDATED=void 0,t.WEBAUTHN_USERID_UPDATED="WEBAUTHN_USERID_UPDATED",t.WEBAUTHN_AUTHENTICATOR_ADDED="WEBAUTHN_AUTHENTICATOR_ADDED",t.WEBAUTHN_AUTHENTICATOR_REMOVED="WEBAUTHN_AUTHENTICATOR_REMOVED",t.WEBAUTHN_AUTHENTICATORS_LIST_UPDATED="WEBAUTHN_AUTHENTICATORS_LIST_UPDATED",t.WEBAUTHN_AVAILABLE_AUTHENTICATORS_LIST_UPDATED="WEBAUTHN_AVAILABLE_AUTHENTICATORS_LIST_UPDATED",t.webAuthnUserIdUpdated=e=>({type:t.WEBAUTHN_USERID_UPDATED,webAuthnUserId:e}),t.webAuthnAuthenticatorAdded=e=>({type:t.WEBAUTHN_AUTHENTICATOR_ADDED,authenticator:e}),t.webAuthnAuthenticatorRemoved=e=>({type:t.WEBAUTHN_AUTHENTICATOR_REMOVED,credentialId:e}),t.webAuthnAuthenticatorsListUpdated=e=>({type:t.WEBAUTHN_AUTHENTICATORS_LIST_UPDATED,authenticatorsList:e}),t.webAuthnAvailableAuthenticatorsListUpdated=e=>({type:t.WEBAUTHN_AVAILABLE_AUTHENTICATORS_LIST_UPDATED,availableAuthenticatorsList:e})},888272:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.webAuthnAuthenticationReducer=t.getEmptyWebAuthnAuthentication=void 0;const a=r(608246);t.getEmptyWebAuthnAuthentication=()=>({webAuthnUserId:null,authenticators:[]}),t.webAuthnAuthenticationReducer=(e=(0,t.getEmptyWebAuthnAuthentication)(),r)=>{switch(r.type){case a.WEBAUTHN_USERID_UPDATED:return{...e,webAuthnUserId:r.webAuthnUserId};case a.WEBAUTHN_AUTHENTICATOR_ADDED:return{...e,authenticators:[...e.authenticators,r.authenticator]};case a.WEBAUTHN_AUTHENTICATOR_REMOVED:{const t=e.authenticators.filter((e=>e.credentialId!==r.credentialId));return{...e,authenticators:t}}case a.WEBAUTHN_AUTHENTICATORS_LIST_UPDATED:return{...e,authenticators:r.authenticatorsList};case a.WEBAUTHN_AVAILABLE_AUTHENTICATORS_LIST_UPDATED:{const t=r.availableAuthenticatorsList.map((e=>e.credentialId)),a=e.authenticators.map((e=>t.includes(e.credentialId)?{...e,canOpenSession:!0}:{...e,canOpenSession:!1}));return{...e,authenticators:a}}default:return e}}},236592:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(343037),o=r(805689),n=r(24797),s=r(487463);t.config={commands:{refreshTwoFactorAuthenticationInfo:{handler:n.refreshTwoFactorAuthenticationInfoHandler},...s.config.commands},queries:{getTwoFactorAuthenticationInfo:{selector:o.twoFactorAuthenticationInfoSelector},...s.config.queries},liveQueries:{liveTwoFactorAuthenticationInfo:{operator:a.twoFactorAuthenticationInfo$},...s.config.liveQueries}}},281404:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(154120),o=r(18099),n=r(795475);t.config={commands:{startTwoFactorAuthenticationDisableFlow:{handler:a.startTwoFactorAuthenticationDisableFlow},continueTwoFactorAuthenticationDisableFlow:{handler:a.continueTwoFactorAuthenticationDisableFlow},backTwoFactorAuthenticationDisableFlow:{handler:a.backTwoFactorAuthenticationDisableFlow},stopTwoFactorAuthenticationDisableFlow:{handler:a.stopTwoFactorAuthenticationDisableFlow}},queries:{getTwoFactorAuthenticationDisableStage:{selector:o.getTwoFactorAuthenticationDisableStageData}},liveQueries:{liveTwoFactorAuthenticationDisableStage:{operator:n.twoFactorAuthenticationDisableFlow$}}}},944787:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.stopTwoFactorAuthenticationStage=t.updateTwoFactorAuthenticationStage=void 0;const a=r(904478);t.updateTwoFactorAuthenticationStage=e=>({type:a.UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE,data:e}),t.stopTwoFactorAuthenticationStage=()=>({type:a.UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE,data:{stage:void 0}})},904478:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.STOP_TWO_FACTOR_AUTHENTICATION_DISABLE_FLOW=t.UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE=void 0,t.UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE="UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE",t.STOP_TWO_FACTOR_AUTHENTICATION_DISABLE_FLOW="STOP_TWO_FACTOR_AUTHENTICATION_DISABLE_FLOW"},351554:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationDisableFlow=t.stopTwoFactorAuthenticationStage=t.updateTwoFactorAuthenticationStage=void 0;var a=r(944787);Object.defineProperty(t,"updateTwoFactorAuthenticationStage",{enumerable:!0,get:function(){return a.updateTwoFactorAuthenticationStage}}),Object.defineProperty(t,"stopTwoFactorAuthenticationStage",{enumerable:!0,get:function(){return a.stopTwoFactorAuthenticationStage}});var o=r(698259);Object.defineProperty(t,"twoFactorAuthenticationDisableFlow",{enumerable:!0,get:function(){return o.twoFactorAuthenticationDisableFlow}})},698259:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationDisableFlow=t.getEmptyTwoFactorAuthenticationDisable=void 0;const a=r(904478);t.getEmptyTwoFactorAuthenticationDisable=()=>({stage:void 0}),t.twoFactorAuthenticationDisableFlow=(e=(0,t.getEmptyTwoFactorAuthenticationDisable)(),r)=>r.type===a.UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE?{...e,...r.data}:e},18099:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTwoFactorAuthenticationDisableFlowData=t.getTwoFactorAuthenticationDisableStageData=void 0;const a=r(846474);t.getTwoFactorAuthenticationDisableStageData=e=>{const{stage:t}=e.userSession.twoFactorAuthenticationDisableFlow,r=a.TwoFactorAuthenticationDisableFlowConfig?.[t]?.viewMapper;return{stage:t,viewData:r?r(e):void 0}},t.getTwoFactorAuthenticationDisableFlowData=e=>{const{flowData:t}=e.userSession.twoFactorAuthenticationDisableFlow;return t}},846474:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwoFactorAuthenticationDisableFlowStages=t.TwoFactorAuthenticationDisableFlowConfig=void 0;const a=r(632626),o=r(173714),n=r(924216),s=r(518747),i=r(846796);t.TwoFactorAuthenticationDisableFlowConfig={start:{storeMapper:o.startTwoFactorAuthenticationDisableStoreMapper},stop:{currentHandler:i.endTwoFactorAuthenticationHandler,storeMapper:o.endTwoFactorAuthenticationDisableStoreMapper},end:{currentHandler:i.endTwoFactorAuthenticationHandler,storeMapper:o.endTwoFactorAuthenticationDisableStoreMapper},[a.TwoFactorAuthenticationDisableStages.AUTHENTICATION_CODE]:{currentHandler:n.disableTwoFactorAuthenticationCodeHandler,viewMapper:s.disableTwoFactorAuthenticationCodeViewMapper},[a.TwoFactorAuthenticationDisableStages.BACKUP_CODE]:{currentHandler:n.disableTwoFactorAuthenticationCodeHandler,viewMapper:s.disableTwoFactorAuthenticationBackupCodeViewMapper},[a.TwoFactorAuthenticationDisableStages.LOGOUT_REQUIRED]:{currentHandler:n.disableTwoFactorAuthenticationLogoutRequiredHandler}},t.TwoFactorAuthenticationDisableFlowStages=[{stage:a.TwoFactorAuthenticationDisableStages.CONFIRMATION},{stage:a.TwoFactorAuthenticationDisableStages.AUTHENTICATION_CODE},{stage:a.TwoFactorAuthenticationDisableStages.FINALIZING_CHANGES},{stage:a.TwoFactorAuthenticationDisableStages.SUCCESS}]},154120:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.backTwoFactorAuthenticationDisableFlow=t.continueTwoFactorAuthenticationDisableFlow=t.stopTwoFactorAuthenticationDisableFlow=t.startTwoFactorAuthenticationDisableFlow=void 0;const a=r(846474),o=r(351554),n=e=>{const{stage:t}=e.getState().userSession.twoFactorAuthenticationDisableFlow;return{currentIndex:a.TwoFactorAuthenticationDisableFlowStages.findIndex((e=>e.stage===t)),currentStage:t}};t.startTwoFactorAuthenticationDisableFlow=({storeService:e})=>{const{storeMapper:t}=a.TwoFactorAuthenticationDisableFlowConfig.start,r=t?t(e):void 0,n=(0,o.updateTwoFactorAuthenticationStage)({...r,stage:a.TwoFactorAuthenticationDisableFlowStages[0].stage});return e.dispatch(n),Promise.resolve({success:!0})},t.stopTwoFactorAuthenticationDisableFlow=e=>{const{storeService:t}=e;t.dispatch((0,o.stopTwoFactorAuthenticationStage)());const{currentHandler:r,storeMapper:n}=a.TwoFactorAuthenticationDisableFlowConfig.stop,s=n?n(t):void 0;return r?r(e,s):Promise.resolve({success:!0})};const s=(e,t,r,a)=>{const{storeService:o}=e;return t(e,r?r(o):void 0,a)},i=({storeService:e},t)=>{const{currentIndex:r}=n(e);if(r!==a.TwoFactorAuthenticationDisableFlowStages.length-1){const n=(0,o.updateTwoFactorAuthenticationStage)({...t,stage:a.TwoFactorAuthenticationDisableFlowStages[r+1].stage});e.dispatch(n)}return Promise.resolve({success:!0})},c=({storeService:e},t)=>{const{currentIndex:r}=n(e);if(0!==r){const n=(0,o.updateTwoFactorAuthenticationStage)({...t,stage:a.TwoFactorAuthenticationDisableFlowStages[r-1].stage});e.dispatch(n)}return Promise.resolve({success:!0})},l=e=>{const{currentStage:t}=n(e);let r,o=i,s=c;if(a.TwoFactorAuthenticationDisableFlowConfig[t]){const e=a.TwoFactorAuthenticationDisableFlowConfig[t];s=e.backHandler||s,o=e.currentHandler||o,r=e.storeMapper}return{currentHandler:o,backHandler:s,storeMapper:r}};t.continueTwoFactorAuthenticationDisableFlow=(e,t)=>{const{storeService:r}=e,{currentHandler:a,storeMapper:o}=l(r);return s(e,a,o,t)},t.backTwoFactorAuthenticationDisableFlow=(e,t)=>{const{storeService:r}=e,{backHandler:a,storeMapper:o}=l(r);return s(e,a,o,t)}},795475:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationDisableFlow$=void 0;const a=r(518948),o=r(903343),n=r(18099);t.twoFactorAuthenticationDisableFlow$=()=>(0,a.pipe)((0,o.map)(n.getTwoFactorAuthenticationDisableStageData),(0,o.distinctUntilChanged)())},924216:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableTwoFactorAuthenticationLogoutRequiredHandler=t.disableTwoFactorAuthenticationCodeHandler=void 0;const a=r(632626),o=r(351554),n=r(846796),s=r(805689),i=r(471291),c=r(18099),l=r(416593),d=r(301965),u={[a.TwoFactorAuthenticationType.DEVICE_REGISTRATION]:{handler:n.disableTwoFactorAuthenticationTOTP1Handler,showLoading:!1},[a.TwoFactorAuthenticationType.LOGIN]:{handler:n.disableTwoFactorAuthenticationTOTP2Handler,showLoading:!0}};t.disableTwoFactorAuthenticationCodeHandler=async(e,t,r)=>{const l=r.target;if(l){const{storeService:r}=e,a=(0,o.updateTwoFactorAuthenticationStage)({...t,stage:l,stageData:void 0});return r.dispatch(a),{success:!0}}return await(async(e,t,r)=>{const{storeService:l}=e,d=e=>{const t=(0,o.updateTwoFactorAuthenticationStage)({...e});l.dispatch(t)};try{const p=(0,c.getTwoFactorAuthenticationDisableFlowData)(l.getState()),S=(0,s.twoFactorAuthenticationInfoSelector)(l.getState());if(S.status===a.TwoFactorAuthenticationInfoRequestStatus.READY){const{type:s}=S,{authenticationCode:c}=r,g=await(0,i.performTotpVerificationService)(e,c);if(g.success){const{authTicket:r}=g;if(u[s]){const{handler:i,showLoading:c}=u[s];c&&d({...t,stage:a.TwoFactorAuthenticationDisableStages.FINALIZING_CHANGES});const S=await i(e,r);if(S.success)if(S.logoutRequired){const e={...p,logoutRequired:S.logoutRequired};d({...t,stage:a.TwoFactorAuthenticationDisableStages.LOGOUT_REQUIRED,flowData:e})}else await(0,n.refreshTwoFactorAuthenticationInfoHandler)(e),d({...t,stage:a.TwoFactorAuthenticationDisableStages.SUCCESS}),l.dispatch((0,o.stopTwoFactorAuthenticationStage)());else d({...t,stage:a.TwoFactorAuthenticationDisableStages.GENERIC_ERROR,stageData:{...S}})}else d({...t,stage:a.TwoFactorAuthenticationDisableStages.GENERIC_ERROR,stageData:{success:!1,error:{code:a.AuthenticationCode.UNEXPECTED_OTP_TYPE}}})}else d({...t,stageData:g})}else d({...t,stage:a.TwoFactorAuthenticationDisableStages.GENERIC_ERROR,stageData:{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}}})}catch(e){d({...t,stageData:{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}}})}return{success:!0}})(e,t,r)},t.disableTwoFactorAuthenticationLogoutRequiredHandler=async e=>{const{storeService:t,storageService:r,sessionService:a,applicationModulesAccess:n}=e,s=(0,l.userLoginSelector)(t.getState());return t.dispatch((0,o.stopTwoFactorAuthenticationStage)()),s&&await(0,d.wipeOutLocalAccounts)(r,n,[s]),await a.close(),{success:!0}}},173714:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.endTwoFactorAuthenticationDisableStoreMapper=t.startTwoFactorAuthenticationDisableStoreMapper=void 0;const a=r(656915);t.startTwoFactorAuthenticationDisableStoreMapper=e=>{const t=e.getState();return{stage:void 0,stageData:void 0,flowData:{otpType:(0,a.otpTypeSelector)(t)}}},t.endTwoFactorAuthenticationDisableStoreMapper=()=>({stage:void 0,stageData:void 0,flowData:void 0})},518747:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableTwoFactorAuthenticationBackupCodeViewMapper=t.disableTwoFactorAuthenticationCodeViewMapper=void 0;const a=r(632626);t.disableTwoFactorAuthenticationCodeViewMapper=e=>{const{stageData:t}=e.userSession.twoFactorAuthenticationDisableFlow;if(t&&!t.success){const{error:e}=t;return{success:!1,error:e}}},t.disableTwoFactorAuthenticationBackupCodeViewMapper=e=>{const{stageData:t}=e.userSession.twoFactorAuthenticationDisableFlow;if(t&&!t.success){const{error:e}=t;return e.code===a.AuthenticationCode.OTP_NOT_VALID?{success:!1,error:{code:a.AuthenticationCode.BACKUP_CODE_NOT_VALID}}:{success:!1,error:e}}}},453325:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(217303),o=r(369631),n=r(166574);t.config={commands:{startTwoFactorAuthenticationEnableFlow:{handler:a.startTwoFactorAuthenticationEnableFlow},continueTwoFactorAuthenticationEnableFlow:{handler:a.continueTwoFactorAuthenticationEnableFlow},backTwoFactorAuthenticationEnableFlow:{handler:a.backTwoFactorAuthenticationEnableFlow},stopTwoFactorAuthenticationEnableFlow:{handler:a.stopTwoFactorAuthenticationEnableFlow}},queries:{getTwoFactorAuthenticationEnableStage:{selector:o.getTwoFactorAuthenticationEnableStageData}},liveQueries:{liveTwoFactorAuthenticationEnableStage:{operator:n.twoFactorAuthenticationEnableFlow$}}}},644527:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationBackupCodesHandler=void 0;const a=r(632626),o=r(415441),n=r(369631);t.enableTwoFactorAuthenticationBackupCodesHandler=async(e,t)=>{const{storeService:r}=e,s=(0,n.getTwoFactorAuthenticationEnableFlowData)(r.getState());return(0,o.updateStore)(e,{...t,stage:s.logoutRequired?a.TwoFactorAuthenticationEnableStages.LOGOUT_REQUIRED:a.TwoFactorAuthenticationEnableStages.SUCCESS}),{success:!0}}},172387:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationBackupPhoneHandler=void 0;const a=r(632626),o=r(46298),n=r(415441),s=r(369631),i=r(471291);t.enableTwoFactorAuthenticationBackupPhoneHandler=async(e,t,r)=>{const{storeService:c}=e;let l=(0,s.getTwoFactorAuthenticationEnableFlowData)(c.getState());const d=await(0,i.requestTOTPActivationService)(e,{...r,country:(0,o.makeSafeCountry)(r.countryCode)});if(d.success){const{seed:o,uri:s,recoveryKeys:i,serverKey:c}=d,{authenticationType:u}=l;u===a.TwoFactorAuthenticationType.LOGIN&&(l[a.TwoFactorAuthenticationType.LOGIN].serverKey=c),l={...l,seed:o,uri:s,recoveryKeys:i},(0,n.updateStore)(e,{...t,stageData:{...d},flowData:{...l,savedValues:{...l?.savedValues,savedCountryCode:r.countryCode,savedPhoneNumber:r.phoneNumber}},stage:a.TwoFactorAuthenticationEnableStages.QR_CODE})}else(0,n.updateStore)(e,{...t,stageData:{...d}});return Promise.resolve({success:!0})}},414732:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationCodeHandler=void 0;const a=r(632626),o=r(415441),n=r(369631),s=r(886370),i=r(652284),c=r(846796),l=r(471291),d={[a.TwoFactorAuthenticationType.DEVICE_REGISTRATION]:{handler:s.enableTwoFactorAuthenticationTOTP1Handler,showLoading:!1},[a.TwoFactorAuthenticationType.LOGIN]:{handler:i.enableTwoFactorAuthenticationTOTP2Handler,showLoading:!0,errorStage:a.TwoFactorAuthenticationEnableStages.GENERIC_ERROR}};t.enableTwoFactorAuthenticationCodeHandler=async(e,t,{authenticationCode:r})=>{const{storeService:s}=e;try{const i=(0,n.getTwoFactorAuthenticationEnableFlowData)(s.getState()),{authenticationType:u}=i,p=await(0,l.performTotpVerificationService)(e,r,!0);if(!p.success)return(0,o.updateStore)(e,{...t,stageData:p}),{success:!1};if(d[u]){const{authTicket:r}=p,n=i[u],{handler:s,showLoading:l,errorStage:S}=d[u];l&&(0,o.updateStore)(e,{...t,stage:a.TwoFactorAuthenticationEnableStages.FINALIZING_CHANGES});const g=await s(e,r,n);if(g.success){g.logoutRequired||await(0,c.refreshTwoFactorAuthenticationInfoHandler)(e);const r={...i,logoutRequired:g.logoutRequired};(0,o.updateStore)(e,{...t,stage:a.TwoFactorAuthenticationEnableStages.BACKUP_CODES,flowData:r})}else(0,o.updateStore)(e,{...t,stage:S?a.TwoFactorAuthenticationEnableStages.GENERIC_ERROR:a.TwoFactorAuthenticationEnableStages.AUTHENTICATION_CODE,stageData:{...g}})}else(0,o.updateStore)(e,{...t,stage:a.TwoFactorAuthenticationEnableStages.GENERIC_ERROR,stageData:{success:!1}});return{success:!0}}catch(r){return(0,o.updateStore)(e,{...t,stageData:{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}}}),{success:!1}}}},668513:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationLogoutRequiredHandler=void 0;const a=r(416593),o=r(301965),n=r(319546);t.enableTwoFactorAuthenticationLogoutRequiredHandler=async e=>{const{storeService:t,storageService:r,sessionService:s,applicationModulesAccess:i}=e,c=(0,a.userLoginSelector)(t.getState());return t.dispatch((0,n.stopTwoFactorAuthenticationStage)()),c&&await(0,o.wipeOutLocalAccounts)(r,i,[c]),await s.close(),{success:!0}}},333778:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationTypeHandler=void 0;const a=r(632626),o=r(357903),n=r(319546),s=r(369631),i=r(415441),c=r(216194),l=r(416593),d=r(46298),u=r(761984),p=r(700033),S=r(632626);t.enableTwoFactorAuthenticationTypeHandler=async(e,t,{authenticationType:r})=>{const{storeService:g}=e,m=(0,s.getTwoFactorAuthenticationEnableFlowData)(g.getState());if(r===S.TwoFactorAuthenticationType.LOGIN)try{const s=(0,n.updateTwoFactorAuthenticationStage)({...t,stage:a.TwoFactorAuthenticationEnableStages.LOADING});g.dispatch(s);const{eventLoggerService:y}=e,h=g.getState(),f=(0,l.userLoginSelector)(h);if(!f)return(0,i.updateStore)(e,{...t,stage:a.TwoFactorAuthenticationEnableStages.GENERIC_ERROR}),Promise.resolve({success:!1});if(!await(0,o.waitUntilSyncComplete)(g))return(0,i.updateStore)(e,{...t,stage:a.TwoFactorAuthenticationEnableStages.GENERIC_ERROR}),Promise.resolve({success:!1});g.dispatch((0,c.changeMPStart)());const v=await(0,d.getDataForMasterPasswordChange)(g,f,{});if((0,d.isApiError)(v))(0,u.logChangeMasterPasswordError)(y,p.ChangeMasterPasswordError.DownloadError),g.dispatch((0,c.changeMPDone)()),(0,i.updateStore)(e,{...t,stage:a.TwoFactorAuthenticationEnableStages.GENERIC_ERROR});else{const{data:{transactions:e,sharingKeys:o},timestamp:s}=v,i=(0,n.updateTwoFactorAuthenticationStage)({...t,flowData:{...m,authenticationType:r,[S.TwoFactorAuthenticationType.LOGIN]:{transactions:e,sharingKeys:o,timestamp:s,serverKey:""},savedValues:{...m?.savedValues,savedAuthenticationType:r}},stage:a.TwoFactorAuthenticationEnableStages.BACKUP_PHONE});g.dispatch(i)}}catch(r){g.dispatch((0,c.changeMPDone)()),(0,i.updateStore)(e,{...t,stage:a.TwoFactorAuthenticationEnableStages.GENERIC_ERROR})}else{const e=(0,n.updateTwoFactorAuthenticationStage)({...t,flowData:{...m,authenticationType:r,savedValues:{...m?.savedValues,savedAuthenticationType:r}},stage:a.TwoFactorAuthenticationEnableStages.BACKUP_PHONE});g.dispatch(e)}return Promise.resolve({success:!0})}},346667:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(414732),t),o(r(172387),t),o(r(333778),t),o(r(644527),t),o(r(668513),t)},248277:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.stopTwoFactorAuthenticationStage=t.updateTwoFactorAuthenticationStage=t.UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE=void 0,t.UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE="UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE",t.updateTwoFactorAuthenticationStage=e=>({type:t.UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE,data:e}),t.stopTwoFactorAuthenticationStage=()=>({type:t.UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE,data:{stage:void 0}})},319546:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationEnableFlow=t.stopTwoFactorAuthenticationStage=t.updateTwoFactorAuthenticationStage=void 0;var a=r(248277);Object.defineProperty(t,"updateTwoFactorAuthenticationStage",{enumerable:!0,get:function(){return a.updateTwoFactorAuthenticationStage}}),Object.defineProperty(t,"stopTwoFactorAuthenticationStage",{enumerable:!0,get:function(){return a.stopTwoFactorAuthenticationStage}});var o=r(815896);Object.defineProperty(t,"twoFactorAuthenticationEnableFlow",{enumerable:!0,get:function(){return o.twoFactorAuthenticationEnableFlow}})},815896:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationEnableFlow=t.getEmptyTwoFactorAuthenticationEnable=void 0;const a=r(248277);t.getEmptyTwoFactorAuthenticationEnable=()=>({stage:void 0}),t.twoFactorAuthenticationEnableFlow=(e=(0,t.getEmptyTwoFactorAuthenticationEnable)(),r)=>r.type===a.UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE?{...e,...r.data}:e},369631:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTwoFactorAuthenticationEnableFlowData=t.getTwoFactorAuthenticationEnableStageData=void 0;const a=r(613610);t.getTwoFactorAuthenticationEnableStageData=e=>{const{stage:t}=e.userSession.twoFactorAuthenticationEnableFlow,r=a.TwoFactorAuthenticationEnableFlowConfig?.[t]?.viewMapper,o=e.userSession.twoFactorAuthenticationEnableFlow?.flowData?.savedValues;return{stage:t,viewData:r?r(e):void 0,savedValues:o}},t.getTwoFactorAuthenticationEnableFlowData=e=>{const{flowData:t}=e.userSession.twoFactorAuthenticationEnableFlow;return t}},613610:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwoFactorAuthenticationEnableFlowStages=t.TwoFactorAuthenticationEnableFlowConfig=void 0;const a=r(632626),o=r(562669),n=r(158206),s=r(346667),i=r(846796);t.TwoFactorAuthenticationEnableFlowConfig={start:{storeMapper:o.startTwoFactorAuthenticationEnableStoreMapper},stop:{currentHandler:i.endTwoFactorAuthenticationHandler,storeMapper:o.endTwoFactorAuthenticationEnableStoreMapper},end:{currentHandler:i.endTwoFactorAuthenticationHandler,storeMapper:o.endTwoFactorAuthenticationEnableStoreMapper},[a.TwoFactorAuthenticationEnableStages.AUTHENTICATION_TYPE]:{currentHandler:s.enableTwoFactorAuthenticationTypeHandler,viewMapper:n.enableTwoFactorAuthenticationTypeViewMapper},[a.TwoFactorAuthenticationEnableStages.BACKUP_PHONE]:{currentHandler:s.enableTwoFactorAuthenticationBackupPhoneHandler,viewMapper:n.enableTwoFactorAuthenticationBackupPhoneViewMapper},[a.TwoFactorAuthenticationEnableStages.QR_CODE]:{viewMapper:n.enableTwoFactorAuthenticationQRCodeViewMapper},[a.TwoFactorAuthenticationEnableStages.AUTHENTICATION_CODE]:{currentHandler:s.enableTwoFactorAuthenticationCodeHandler,viewMapper:n.enableTwoFactorAuthenticationCodeViewMapper},[a.TwoFactorAuthenticationEnableStages.BACKUP_CODES]:{currentHandler:s.enableTwoFactorAuthenticationBackupCodesHandler,viewMapper:n.enableTwoFactorAuthenticationBackupCodesViewMapper},[a.TwoFactorAuthenticationEnableStages.LOGOUT_REQUIRED]:{currentHandler:s.enableTwoFactorAuthenticationLogoutRequiredHandler}},t.TwoFactorAuthenticationEnableFlowStages=[{stage:a.TwoFactorAuthenticationEnableStages.AUTHENTICATION_TYPE},{stage:a.TwoFactorAuthenticationEnableStages.BACKUP_PHONE},{stage:a.TwoFactorAuthenticationEnableStages.QR_CODE},{stage:a.TwoFactorAuthenticationEnableStages.AUTHENTICATION_CODE},{stage:a.TwoFactorAuthenticationEnableStages.FINALIZING_CHANGES},{stage:a.TwoFactorAuthenticationEnableStages.BACKUP_CODES},{stage:a.TwoFactorAuthenticationEnableStages.SUCCESS}]},217303:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.backTwoFactorAuthenticationEnableFlow=t.continueTwoFactorAuthenticationEnableFlow=t.stopTwoFactorAuthenticationEnableFlow=t.startTwoFactorAuthenticationEnableFlow=void 0;const a=r(613610),o=r(319546),n=e=>e.userSession.twoFactorAuthenticationEnableFlow,s=e=>{const{stage:t}=n(e.getState());return{currentIndex:a.TwoFactorAuthenticationEnableFlowStages.findIndex((e=>e.stage===t)),currentStage:t}};t.startTwoFactorAuthenticationEnableFlow=({storeService:e})=>{const{storeMapper:t}=a.TwoFactorAuthenticationEnableFlowConfig.start,r=t?t(e):void 0,n=(0,o.updateTwoFactorAuthenticationStage)({...r,stage:a.TwoFactorAuthenticationEnableFlowStages[0].stage});return e.dispatch(n),Promise.resolve({success:!0})},t.stopTwoFactorAuthenticationEnableFlow=e=>{const{storeService:t}=e;t.dispatch((0,o.stopTwoFactorAuthenticationStage)());const{currentHandler:r,storeMapper:n}=a.TwoFactorAuthenticationEnableFlowConfig.stop,s=n?n(t):void 0;return r?r(e,s):Promise.resolve({success:!0})};const i=(e,t,r,a)=>{const{storeService:o}=e;return t(e,r?r(o):void 0,a)},c=({storeService:e},t)=>{const{currentIndex:r}=s(e);if(r!==a.TwoFactorAuthenticationEnableFlowStages.length-1){const n=(0,o.updateTwoFactorAuthenticationStage)({...t,stage:a.TwoFactorAuthenticationEnableFlowStages[r+1].stage});e.dispatch(n)}return Promise.resolve({success:!0})},l=({storeService:e},t)=>{const{currentIndex:r}=s(e);if(0!==r){const n=(0,o.updateTwoFactorAuthenticationStage)({...t,stage:a.TwoFactorAuthenticationEnableFlowStages[r-1].stage});e.dispatch(n)}return Promise.resolve({success:!0})},d=e=>{const{currentStage:t}=s(e);let r,o=c,n=l;if(a.TwoFactorAuthenticationEnableFlowConfig[t]){const e=a.TwoFactorAuthenticationEnableFlowConfig[t];n=e.backHandler||n,o=e.currentHandler||o,r=e.storeMapper}return{currentHandler:o,backHandler:n,storeMapper:r}};t.continueTwoFactorAuthenticationEnableFlow=(e,t)=>{const{storeService:r}=e,{currentHandler:a,storeMapper:o}=d(r);return i(e,a,o,t)},t.backTwoFactorAuthenticationEnableFlow=(e,t)=>{const{storeService:r}=e,{backHandler:a,storeMapper:s}=d(r);return(e=>{const t=n(e.getState()),r=(0,o.updateTwoFactorAuthenticationStage)({...t,stageData:void 0});e.dispatch(r)})(r),i(e,a,s,t)}},415441:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateStore=void 0;const a=r(319546);t.updateStore=({storeService:e},t)=>{const r=(0,a.updateTwoFactorAuthenticationStage)({...t});e.dispatch(r)}},166574:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationEnableFlow$=void 0;const a=r(518948),o=r(903343),n=r(369631);t.twoFactorAuthenticationEnableFlow$=()=>(0,a.pipe)((0,o.map)(n.getTwoFactorAuthenticationEnableStageData),(0,o.distinctUntilChanged)())},562669:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.endTwoFactorAuthenticationEnableStoreMapper=t.startTwoFactorAuthenticationEnableStoreMapper=void 0,t.startTwoFactorAuthenticationEnableStoreMapper=()=>({stage:void 0,stageData:void 0,flowData:void 0}),t.endTwoFactorAuthenticationEnableStoreMapper=()=>({stage:void 0,stageData:void 0,flowData:void 0})},158206:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationBackupCodesViewMapper=t.enableTwoFactorAuthenticationCodeViewMapper=t.enableTwoFactorAuthenticationQRCodeViewMapper=t.enableTwoFactorAuthenticationBackupPhoneViewMapper=t.enableTwoFactorAuthenticationTypeViewMapper=void 0;const a=r(46298);t.enableTwoFactorAuthenticationTypeViewMapper=()=>({currentStep:1,totalSteps:5}),t.enableTwoFactorAuthenticationBackupPhoneViewMapper=e=>{const t=(0,a.makeSafeCountry)(e.device.platform.location.country),{stageData:r}=e.userSession.twoFactorAuthenticationEnableFlow;return{currentStep:2,totalSteps:5,countryCode:t,...r}},t.enableTwoFactorAuthenticationQRCodeViewMapper=e=>{const{uri:t,seed:r}=e.userSession.twoFactorAuthenticationEnableFlow.flowData;return{currentStep:3,totalSteps:5,uri:t,seed:r}},t.enableTwoFactorAuthenticationCodeViewMapper=e=>{const{stageData:t}=e.userSession.twoFactorAuthenticationEnableFlow;if(t){const{error:t}=e.userSession.twoFactorAuthenticationEnableFlow.stageData;return{currentStep:4,totalSteps:5,error:t}}return{currentStep:4,totalSteps:5}},t.enableTwoFactorAuthenticationBackupCodesViewMapper=e=>{const{recoveryKeys:t}=e.userSession.twoFactorAuthenticationEnableFlow.flowData;return{currentStep:5,totalSteps:5,recoveryKeys:t}}},606836:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwoFactorAuthStatusError=t.TwoFactorAuthStatusRequested=t.TwoFactorAuthStatusUpdated=t.TWO_FACTOR_AUTHENTICATION_INFO_ERROR=t.TWO_FACTOR_AUTHENTICATION_INFO_REQUESTED=t.TWO_FACTOR_AUTHENTICATION_INFO_UPDATED=void 0,t.TWO_FACTOR_AUTHENTICATION_INFO_UPDATED="TWO_FACTOR_AUTHENTICATION_INFO_UPDATED",t.TWO_FACTOR_AUTHENTICATION_INFO_REQUESTED="TWO_FACTOR_AUTHENTICATION_INFO_REQUESTED",t.TWO_FACTOR_AUTHENTICATION_INFO_ERROR="TWO_FACTOR_AUTHENTICATION_INFO_ERROR",t.TwoFactorAuthStatusUpdated=e=>({type:t.TWO_FACTOR_AUTHENTICATION_INFO_UPDATED,info:e}),t.TwoFactorAuthStatusRequested=()=>({type:t.TWO_FACTOR_AUTHENTICATION_INFO_REQUESTED}),t.TwoFactorAuthStatusError=()=>({type:t.TWO_FACTOR_AUTHENTICATION_INFO_ERROR})},796171:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwoFactorAuthenticationReducer=t.getEmptyTwoFactorAuthenticationState=void 0;const a=r(632626),o=r(606836),n=r(716478);t.getEmptyTwoFactorAuthenticationState=()=>({status:a.TwoFactorAuthenticationInfoRequestStatus.UNKNOWN}),t.TwoFactorAuthenticationReducer=(e=(0,t.getEmptyTwoFactorAuthenticationState)(),r)=>{const s=r?.info?.type;switch(r.type){case o.TWO_FACTOR_AUTHENTICATION_INFO_REQUESTED:return{status:a.TwoFactorAuthenticationInfoRequestStatus.PENDING};case o.TWO_FACTOR_AUTHENTICATION_INFO_ERROR:return{status:a.TwoFactorAuthenticationInfoRequestStatus.ERROR};case o.TWO_FACTOR_AUTHENTICATION_INFO_UPDATED:return{...r.info,isTwoFactorAuthenticationEnabled:n.TwoFactorAuthenticationEnabled.includes(s),status:a.TwoFactorAuthenticationInfoRequestStatus.READY};default:return e}}},487463:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(40970),o=r(170245),n=r(60262),s=r(24217);t.config={commands:{removeU2FAuthenticator:{handler:a.removeU2FAuthenticatorHandler},refreshU2FDevicesList:{handler:o.refreshU2FDevicesListHandler}},queries:{getU2FDevicesList:{selector:s.listU2FDevicesSelector}},liveQueries:{liveU2FDevicesList:{operator:n.listU2FDevices$}}}},170245:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshU2FDevicesListHandler=void 0;const a=r(632626),o=r(46298),n=r(416593),s=r(372355);t.refreshU2FDevicesListHandler=async e=>{try{const{storeService:t}=e,r=t.isAuthenticated,i=(0,n.userLoginSelector)(t.getState());if(!i||!r)return{success:!1,error:{code:a.RefreshU2FErrorCode.UNKNOWN_ERROR}};const c=await(0,o.getU2FDevices)(t,i);return(0,o.isApiError)(c)?{success:!1,error:{code:a.RefreshU2FErrorCode.UNKNOWN_ERROR}}:(t.dispatch((0,s.u2fDevicesUpdated)(c.u2fDevices)),{success:!0})}catch(e){return{success:!1,error:{code:a.RefreshU2FErrorCode.UNKNOWN_ERROR}}}}},40970:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeU2FAuthenticatorHandler=void 0;const a=r(632626),o=r(314656),n=r(392263),s=r(46298),i=r(670252),c=r(416593),l=r(628287),d=r(170245);t.removeU2FAuthenticatorHandler=async(e,t)=>{try{const{storeService:r}=e,o=r.getState(),n=r.isAuthenticated,i=(0,c.userLoginSelector)(o);if(!i||!n)return{success:!1,error:{code:a.RemoveU2FAuthenticatorError.UNKNOWN_ERROR}};const{authenticationCode:u,keyHandle:p}=t,S=await(0,s.performTotpVerification)(r,{login:i,otp:u});if((0,s.isApiError)(S))return(0,l.handlePerformValidationError)(S,!0);const{authTicket:g}=S,m=await(0,s.removeU2FAuthenticator)(r,i,{authTicket:g,keyHandle:p});return(0,s.isApiError)(m)?{success:!1,error:{code:a.RemoveU2FAuthenticatorError.UNKNOWN_ERROR}}:(await(0,d.refreshU2FDevicesListHandler)(e),{success:!0})}catch(e){const t=n.CarbonError.fromAnyError(e).addContextInfo("U2F","removeU2FAuthenticatorHandler");return(0,i.sendExceptionLog)({error:t}),{success:!1,error:{code:(0,n.isCarbonError)(e)&&e.errorCode===o.HttpErrorCode.NETWORK_ERROR?a.AuthenticationCode.NETWORK_ERROR:a.RemoveU2FAuthenticatorError.UNKNOWN_ERROR}}}}},60262:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listU2FDevices$=void 0;const a=r(518948),o=r(903343),n=r(24217);t.listU2FDevices$=()=>(0,a.pipe)((0,o.map)(n.listU2FDevicesSelector),(0,o.distinctUntilChanged)())},24217:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listU2FDevicesSelector=void 0,t.listU2FDevicesSelector=e=>e.authentication.u2f.u2fDevices},716478:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ENFORCE_2FA_POLICY_REFRESH_TIMER_INTERVAL=t.TwoFactorAuthenticationEnabled=void 0;const a=r(632626);t.TwoFactorAuthenticationEnabled=[a.TwoFactorAuthenticationType.DEVICE_REGISTRATION,a.TwoFactorAuthenticationType.LOGIN,a.TwoFactorAuthenticationType.SSO],t.ENFORCE_2FA_POLICY_REFRESH_TIMER_INTERVAL=36e5},609819:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableTwoFactorAuthenticationTOTP1Handler=void 0;const a=r(632626),o=r(46298);t.disableTwoFactorAuthenticationTOTP1Handler=async(e,t)=>{const{storeService:r}=e,{login:n}=r.getAccountInfo(),s=await(0,o.deactivateTotpVerification)(r,n,{authTicket:t});return(0,o.isApiError)(s)?{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}}:{success:!0}}},599445:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableTwoFactorAuthenticationTOTP2Handler=void 0;const a=r(632626),o=r(361740),n=r(46298),s=r(433740),i=r(357903),c=r(216194),l=r(416593),d=r(816356),u=r(747820);t.disableTwoFactorAuthenticationTOTP2Handler=async(e,t)=>{const{applicationModulesAccess:r,storeService:p,masterPasswordEncryptorService:S,sessionService:g,storageService:m}=e,y=p.getState(),h=(0,l.userLoginSelector)(y);try{if(!h)throw new Error("2FA Disable Flow - Login not available");if((0,l.isRemoteKeyActivatedSelector)(y))throw console.error("Disable 2FA unavailable: RK account"),new Error("2FA Disable Flow - Unavailable due to RemoteKey Account");if(!await(0,i.waitUntilSyncComplete)(p))return{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_SYNC_ERROR}};p.dispatch((0,c.changeMPStart)());const f=r.createClients();await f.session.commands.prepareLocalDataFlush();const v=await(0,n.getDataForMasterPasswordChange)(p,h,{});if((0,n.isApiError)(v))throw new Error("2FA Disable Flow - Unable to getDataForMasterPasswordChange");const T=(0,l.serverKeySelector)(y);if(!(0,s.isOtpStatusValid)(v.otpStatus,T))throw new Error("2FA Disable Flow - OTP status is invalid");const{timestamp:A}=v,{transactions:P,sharingKeys:w}=v.data,b=await(0,s.deCipherAllTransactions)(g,S,P,!1),I=p.getUserSession().masterPassword,E=e.localStorageService.getInstance(),C=await E.doesLocalKeyExist();let _=null;C&&(_=await E.getLocalKey());const{publicKey:D}=w,O=await(0,s.decipherPrivateKey)(p,S,w);await(0,o.cleanRememberMeStorageData)(p,m);const M="",N=(0,s.returnProperCryptoConfig)(p);S.setInstance({raw:I},M,N),p.dispatch((0,d.updateServerKey)(M)),await e.applicationModulesAccess.createClients().session.commands.updateUserSessionKey({email:(0,l.userLoginSelector)(p.getState()),sessionKey:{type:"mp",masterPassword:(0,l.masterPasswordSelector)(p.getState()),secondaryKey:M}});const F={type:"email_token"};p.dispatch((0,d.updateRemoteKey)(null));const U=await(0,s.cipherTransactionWithNewMP)(p,g,S,b,null,!1),L=await(0,s.cipherPrivateKey)(S,O),k={timestamp:A,transactions:(0,s.formatTransaction)(U),updateVerification:F,sharingKeys:{publicKey:D,privateKey:L},authTicket:t},R=await(0,n.uploadDataForMasterPasswordChange)(p,h,k);if((0,n.isApiError)(R))throw(0,s.revertOnError)(e,S,{currentPassword:I,serverKey:T}),new Error("2FA Disable Flow - Unable to uploadDataForMasterPasswordChange");_&&await g.getInstance().user.persistLocalKey(_),await f.session.commands.flushLocalData(),await(0,u.storeSessionCredentialForRecovery)(p,e.localStorageService)}catch(e){return p.dispatch((0,c.changeMPDone)()),{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}}}let f=!0;try{const e=await(0,n.confirmMasterPasswordChangeDone)(p,h,{});if((0,n.isApiError)(e))throw new Error("2FA Disable Flow - Failed to confirmMasterPasswordChangeDone");f=!1}catch(e){throw new Error("2FA Disable Flow - Failed to confirmMasterPasswordChangeDone")}return p.dispatch((0,c.changeMPDone)()),{success:!0,logoutRequired:f}}},886370:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationTOTP1Handler=void 0;const a=r(35823);t.enableTwoFactorAuthenticationTOTP1Handler=async(e,t)=>await(0,a.completeTotpActivationHandler)(e,t)},652284:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationTOTP2Handler=void 0;const a=r(632626),o=r(361740),n=r(46298),s=r(433740),i=r(416593),c=r(747820),l=r(216194),d=r(816356);t.enableTwoFactorAuthenticationTOTP2Handler=async(e,t,r)=>{const{timestamp:u,transactions:p,sharingKeys:S,serverKey:g}=r;if(!g)throw new Error("[2FA - Enable] - Empty server key");const{applicationModulesAccess:m,storeService:y,masterPasswordEncryptorService:h,sessionService:f,storageService:v}=e,T=y.getState();if((0,i.isRemoteKeyActivatedSelector)(T))return console.error("Enable 2FA unavailable: RK account"),{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}};const A=m.createClients();await A.session.commands.prepareLocalDataFlush();const P=(0,i.userLoginSelector)(T);if(!P)return{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}};const w=e.localStorageService.getInstance();let b=null;await w.doesLocalKeyExist()&&(b=await w.getLocalKey());try{const r=await(0,s.deCipherAllTransactions)(f,h,p,!1),{publicKey:a}=S,l=await(0,s.decipherPrivateKey)(y,h,S);await(0,o.cleanRememberMeStorageData)(y,v);const m={type:"totp_login",serverKey:g},T=(0,s.returnProperCryptoConfig)(y),w=y.getUserSession().masterPassword;h.setInstance({raw:w},g,T);const I=await(0,s.cipherTransactionWithNewMP)(y,f,h,r,null,!1),E=await(0,s.cipherPrivateKey)(h,l),C={timestamp:u,transactions:(0,s.formatTransaction)(I),updateVerification:m,sharingKeys:{publicKey:a,privateKey:E},authTicket:t},_=await(0,n.uploadDataForMasterPasswordChange)(y,P,C);if((0,n.isApiError)(_))throw new Error("2FA Enable Flow - Unable to uploadDataForMasterPasswordChange");y.dispatch((0,d.updateServerKey)(g)),await e.applicationModulesAccess.createClients().session.commands.updateUserSessionKey({email:(0,i.userLoginSelector)(y.getState()),sessionKey:{type:"mp",masterPassword:(0,i.masterPasswordSelector)(y.getState()),secondaryKey:g}}),b&&await f.getInstance().user.persistLocalKey(b),await A.session.commands.flushLocalData(),await(0,c.storeSessionCredentialForRecovery)(y,e.localStorageService)}catch(t){return(e=>{const{storeService:t,masterPasswordEncryptorService:r,remoteDataEncryptorService:a}=e,o=t.getState(),n=(0,i.isRemoteKeyActivatedSelector)(o)?a:r,c=t.getUserSession().masterPassword;(0,s.revertOnError)(e,n,{currentPassword:c,serverKey:""})})(e),y.dispatch((0,l.changeMPDone)()),{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}}}let I=!0;try{const e=await(0,n.confirmMasterPasswordChangeDone)(y,P,{});if((0,n.isApiError)(e))throw new Error("2FA Enable Flow - Failed to confirmMasterPasswordChangeDone");I=!1}catch(e){}return y.dispatch((0,l.changeMPDone)()),{success:!0,logoutRequired:I}}},35823:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.completeTotpActivationHandler=void 0;const a=r(632626),o=r(46298),n=r(416593),s=r(434569);t.completeTotpActivationHandler=async(e,t)=>{const{storeService:r}=e,i=r.getState(),c=(0,n.userLoginSelector)(i);if(!c)return{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}};const l=await(0,s.completeTotpActivation)(r,c,{authTicket:t});return(0,o.isApiError)(l)?{success:!1,error:{code:l.code}}:{success:!0}}},549109:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.endTwoFactorAuthenticationHandler=void 0;const a=r(700033),o=r(216194);t.endTwoFactorAuthenticationHandler=async({sessionService:e,storeService:t})=>(t.dispatch((0,o.changeMPDone)()),await e.getInstance().user.attemptSync(a.Trigger.SettingsChange),{success:!0})},846796:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.endTwoFactorAuthenticationHandler=t.disableTwoFactorAuthenticationTOTP1Handler=t.disableTwoFactorAuthenticationTOTP2Handler=t.refreshTwoFactorAuthenticationInfoHandler=void 0;var a=r(24797);Object.defineProperty(t,"refreshTwoFactorAuthenticationInfoHandler",{enumerable:!0,get:function(){return a.refreshTwoFactorAuthenticationInfoHandler}});var o=r(599445);Object.defineProperty(t,"disableTwoFactorAuthenticationTOTP2Handler",{enumerable:!0,get:function(){return o.disableTwoFactorAuthenticationTOTP2Handler}});var n=r(609819);Object.defineProperty(t,"disableTwoFactorAuthenticationTOTP1Handler",{enumerable:!0,get:function(){return n.disableTwoFactorAuthenticationTOTP1Handler}});var s=r(549109);Object.defineProperty(t,"endTwoFactorAuthenticationHandler",{enumerable:!0,get:function(){return s.endTwoFactorAuthenticationHandler}})},24797:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshTwoFactorAuthenticationInfoHandler=void 0;const a=r(416593),o=r(606836),n=r(471291);t.refreshTwoFactorAuthenticationInfoHandler=async e=>{const{storeService:t,wsService:r}=e;try{const e=t.isAuthenticated,s=(0,a.userLoginSelector)(t.getState());return t.dispatch((0,o.TwoFactorAuthStatusRequested)()),s&&e?!1===(await(0,n.refreshTwoFactorAuthenticationInfoService)(t,r)).success?(t.dispatch((0,o.TwoFactorAuthStatusError)()),{success:!1}):{success:!0}:(t.dispatch((0,o.TwoFactorAuthStatusError)()),{success:!1})}catch(e){return t.dispatch((0,o.TwoFactorAuthStatusError)()),{success:!1}}}},343037:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationInfo$=void 0;const a=r(518948),o=r(903343),n=r(805689);t.twoFactorAuthenticationInfo$=()=>(0,a.pipe)((0,o.map)(n.twoFactorAuthenticationInfoSelector),(0,o.distinctUntilChanged)())},805689:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationInfoSelector=void 0,t.twoFactorAuthenticationInfoSelector=e=>e.authentication.twoFactorAuthentication},471291:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestTOTPActivationService=t.refreshTwoFactorAuthenticationInfoService=t.performTotpVerificationService=void 0;var a=r(314762);Object.defineProperty(t,"performTotpVerificationService",{enumerable:!0,get:function(){return a.performTotpVerificationService}});var o=r(471938);Object.defineProperty(t,"refreshTwoFactorAuthenticationInfoService",{enumerable:!0,get:function(){return o.refreshTwoFactorAuthenticationInfoService}});var n=r(856733);Object.defineProperty(t,"requestTOTPActivationService",{enumerable:!0,get:function(){return n.requestTOTPActivationService}})},314762:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.performTotpVerificationService=void 0;const a=r(632626),o=r(46298),n=r(392263),s=r(314656),i=r(628287),c=r(416593);t.performTotpVerificationService=async(e,t,r=!1)=>{const{storeService:l}=e,d=l.getState(),u=(0,c.userLoginSelector)(d);if(!u)return{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}};try{const e=await(0,o.performTotpVerification)(l,{login:u,otp:t,activationFlow:r});if((0,o.isApiError)(e))return(0,i.handlePerformValidationError)(e,!0);const{authTicket:a}=e;return{success:!0,authTicket:a}}catch(e){return{success:!1,error:{code:(0,n.isCarbonError)(e)&&e.errorCode===s.HttpErrorCode.NETWORK_ERROR?a.AuthenticationCode.NETWORK_ERROR:a.AuthenticationCode.UNKNOWN_ERROR}}}}},471938:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshTwoFactorAuthenticationInfoService=void 0;const a=r(46298),o=r(416593),n=r(716478),s=r(656915),i=r(606836),c=r(632626),l={email_token:c.TwoFactorAuthenticationType.EMAIL_TOKEN,totp_login:c.TwoFactorAuthenticationType.LOGIN,totp_device_registration:c.TwoFactorAuthenticationType.DEVICE_REGISTRATION,sso:c.TwoFactorAuthenticationType.SSO};t.refreshTwoFactorAuthenticationInfoService=async(e,t)=>{try{const r=(0,o.userLoginSelector)(e.getState()),d=await(0,a.getTwoFactorAuthenticationStatus)(e,r);if((0,a.isApiError)(d))return{success:!1};const u=l[d.type],p=n.TwoFactorAuthenticationEnabled.includes(u);let S=!1;const g=await t.premium.status({login:(0,o.userLoginSelector)(e.getState()),uki:(0,s.ukiSelector)(e.getState()),spaces:!0}),{spaces:m}=g;m&&(S=m.some((e=>{const{info:{twoFAEnforced:t}}=e;return c.ENFORCE_TWO_FACTOR_AUTHENTICATION_ENABLED_VALUES.includes(t)})));const y=!p&&S,h={...d,isTwoFactorAuthenticationEnabled:p,isTwoFactorAuthenticationEnforced:S,shouldEnforceTwoFactorAuthentication:y,type:u};return e.dispatch((0,i.TwoFactorAuthStatusUpdated)(h)),{success:!0,info:h}}catch(e){return{success:!1}}}},856733:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestTOTPActivationService=void 0;const a=r(632626),o=r(46298),n=r(392263),s=r(314656),i=r(416593);t.requestTOTPActivationService=async(e,{phoneNumber:t,country:r})=>{try{const{storeService:n}=e,s=n.getState(),c=(0,i.userLoginSelector)(s);if(!c)return{success:!1,error:{code:a.AuthenticationCode.UNKNOWN_ERROR}};const l=await(0,o.requestTOTPActivation)(n,c,{phoneNumber:t,country:r});return(0,o.isApiError)(l)?{success:!1,error:{code:l.code}}:{success:!0,...l}}catch(e){return{success:!1,error:{code:(0,n.isCarbonError)(e)&&e.errorCode===s.HttpErrorCode.NETWORK_ERROR?a.AuthenticationCode.NETWORK_ERROR:a.AuthenticationCode.UNKNOWN_ERROR}}}}},891178:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(941762),o=r(752198),n=r(29010),s=r(3433),i=r(322770),c=r(49904),l=r(656915),d=r(352056),u=r(689805),p=r(392694),S=r(933088),g=r(222170),m=r(282862);t.config={commands:{enableWebAuthnAuthentication:{handler:p.enableWebAuthnAuthentication},initEnableWebAuthnAuthentication:{handler:u.initEnableWebAuthnAuthentication},initRegisterWebAuthnAuthenticator:{handler:a.initRegisterWebAuthnAuthenticator},registerWebAuthnAuthenticator:{handler:o.registerWebAuthnAuthenticator},refreshWebAuthnAuthenticators:{handler:s.refreshWebAuthnAuthenticators},refreshAvailableWebAuthnAuthenticators:{handler:n.refreshAvailableWebAuthnAuthenticators},initOpenSessionWithWebAuthnAuthenticator:{handler:i.initOpenSessionWithWebAuthnAuthenticator},openSessionWithWebAuthnAuthenticator:{handler:c.openSessionWithWebAuthnAuthenticator},disableWebAuthnAuthentication:{handler:S.disableWebAuthnAuthentication},removeWebAuthnAuthenticator:{handler:m.removeWebAuthnAuthenticator},initUserVerificationWithWebAuthn:{handler:g.initUserVerificationWithWebAuthn}},queries:{getWebAuthnAuthenticators:{selector:l.authenticatorsSelector},getWebAuthnAuthenticationOptedIn:{selector:l.webAuthnAuthenticationOptedInSelector}},liveQueries:{liveWebAuthnAuthenticators:{operator:d.webAuthnAuthenticators$},liveWebAuthnAuthenticationOptedIn:{operator:d.webAuthnAuthenticationOptedIn$}}}},179842:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PUBKEY_ALGORITHM_RSA_PKCS1256=t.PUBKEY_ALGORITHM_ECDSA256=void 0,t.PUBKEY_ALGORITHM_ECDSA256=-7,t.PUBKEY_ALGORITHM_RSA_PKCS1256=-257},826942:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildAssertionPublicKeyOptions=t.buildAttestationPublicKeyOptions=void 0;const a=r(179842);t.buildAttestationPublicKeyOptions=function(e,t,r,o,n,s){return{rp:{id:e,name:"Dashlane"},user:{id:t,name:r,displayName:r},challenge:o,timeout:n,pubKeyCredParams:[{alg:a.PUBKEY_ALGORITHM_ECDSA256,type:"public-key"},{alg:a.PUBKEY_ALGORITHM_RSA_PKCS1256,type:"public-key"}],excludeCredentials:s,authenticatorSelection:{userVerification:"discouraged"}}},t.buildAssertionPublicKeyOptions=function(e,t,r,a){return{rpId:e,challenge:t,timeout:r,allowCredentials:a,userVerification:"discouraged"}}},352056:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.webAuthnAuthenticationOptedIn$=t.webAuthnAuthenticators$=void 0;const a=r(518948),o=r(903343),n=r(656915);t.webAuthnAuthenticators$=()=>(0,a.pipe)((0,o.map)(n.authenticatorsSelector),(0,o.distinctUntilChanged)()),t.webAuthnAuthenticationOptedIn$=()=>(0,a.pipe)((0,o.map)(n.webAuthnAuthenticationOptedInSelector),(0,o.distinctUntilChanged)())},933088:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableWebAuthnAuthentication=void 0;const a=r(632626),o=r(416593),n=r(886903);t.disableWebAuthnAuthentication=async function(e){const{webAuthnAuthenticationService:t,storeService:r}=e,s=(0,o.userLoginSelector)(r.getState());if(!s)return{success:!1,error:{code:a.DisableWebAuthnAuthenticationError.MISSING_LOGIN}};try{return await t.deactivate(s)?((0,n.sendUserSettingsLog)(e),{success:!0}):{success:!1,error:{code:a.DisableWebAuthnAuthenticationError.WEBAUTHN_SERVICE_DEACTIVATE_FAILED}}}catch(e){return{success:!1,error:{code:a.DisableWebAuthnAuthenticationError.WEBAUTHN_SERVICE_DEACTIVATE_FAILED}}}}},392694:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableWebAuthnAuthentication=void 0;const a=r(632626),o=r(656915),n=r(416593),s=r(886903),i={UNKNOWN_ERROR:{success:!1,error:{code:a.EnableWebAuthnAuthenticationError.UNKNOWN_ERROR}},WEBAUTHN_SERVICE_INIT_FAILED:{success:!1,error:{code:a.EnableWebAuthnAuthenticationError.WEBAUTHN_SERVICE_INIT_FAILED}},USER_HAS_OTP:{success:!1,error:{code:a.EnableWebAuthnAuthenticationError.USER_HAS_OTP}}};t.enableWebAuthnAuthentication=async function(e,t){const{webAuthnAuthenticationService:r,storeService:c}=e,{authenticationType:l,credential:d,isRoaming:u}=t,p=(0,n.userLoginSelector)(c.getState());if((0,o.hasOtp2TypeSelector)(c.getState()))return i.USER_HAS_OTP;try{switch(l){case a.WebAuthnCallTypes.CREATE:{const t=await async function(e,t,r,a){const o=t.response,n={authenticationType:"webauthn.create",name:e,isRoaming:r,credential:{id:t.id,type:t.type,rawId:t.rawId,response:o}};return await a.initialize(n)?{success:!0}:i.WEBAUTHN_SERVICE_INIT_FAILED}(p,d,u,r);return t.success&&(0,s.sendUserSettingsLog)(e),t}case a.WebAuthnCallTypes.GET:{const t=await async function(e,t){const r=e.response,a={authenticationType:"webauthn.get",credential:{id:e.id,type:e.type,rawId:e.rawId,response:r}};return await t.initialize(a)?{success:!0}:i.WEBAUTHN_SERVICE_INIT_FAILED}(d,r);return t.success&&(0,s.sendUserSettingsLog)(e),t}default:return i.UNKNOWN_ERROR}}catch(e){return i.UNKNOWN_ERROR}}},689805:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initEnableWebAuthnAuthentication=void 0;const a=r(735088),o=r(632626),n=r(46298),s=r(416593),i=r(656915),c=r(608246),l=r(3433),d=r(826942);t.initEnableWebAuthnAuthentication=async function(e,t){const{storeService:r}=e,{relyingPartyId:u}=t,p=r.getState(),S=(0,s.userLoginSelector)(r.getState());let g=(0,i.webAuthnUserIdSelector)(p);g||(g=(0,a.v4)(),r.dispatch((0,c.webAuthnUserIdUpdated)(g)));let m=(0,i.authenticatorsAsCredentialSelector)(p);m&&0!==m.length||(await(0,l.refreshWebAuthnAuthenticators)(e),m=(0,i.authenticatorsAsCredentialSelector)(r.getState()));const y=m?.length>0?o.WebAuthnCallTypes.GET:o.WebAuthnCallTypes.CREATE;try{const e=await(0,n.requestWebauthnRegistration)(r,S);if((0,n.isApiError)(e))return{success:!1,error:{code:o.InitEnableWebAuthnAuthenticationError.UNKNOWN_ERROR}};const{challenge:t,expirationDateUnix:a}=e;let s;return s=y===o.WebAuthnCallTypes.CREATE?(0,d.buildAttestationPublicKeyOptions)(u,g,S,t,a,m):(0,d.buildAssertionPublicKeyOptions)(u,t,a,m),{success:!0,response:{publicKeyOptions:s,webAuthnType:y}}}catch(e){return{success:!1,error:{code:o.InitEnableWebAuthnAuthenticationError.UNKNOWN_ERROR}}}}},322770:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initOpenSessionWithWebAuthnAuthenticator=void 0;const a=r(700033),o=r(632626),n=r(868299),s=r(38945),i=r(200658);t.initOpenSessionWithWebAuthnAuthenticator=async function(e,t){const{relyingPartyId:r,login:c}=t,{webAuthnAuthenticationService:l}=e;try{if(!await l.shouldTrigger(c))return{success:!1,error:{code:o.InitOpenSessionWithWebAuthnAuthenticatorError.CANNOT_TRIGGER_WEBAUTHN_AUTHENTICATION}};(0,i.sendAskBiometricAuthenticationEventLog)(e,a.VerificationMode.None);const t=await(0,n.startWebAuthnAuthentication)(e,c,r);if(!1===t.success){let e=o.InitOpenSessionWithWebAuthnAuthenticatorError.UNKNOWN_ERROR;return t.error.code===s.StartWebAuthnAuthenticationError.CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS&&(e=o.InitOpenSessionWithWebAuthnAuthenticatorError.UNAVAILABLE_AUTHENTICATORS),{success:!1,error:{code:e}}}return{success:!0,response:{publicKeyOptions:t.response.publicKeyOptions,authenticatorsInfo:t.response.authenticatorsInfo.map((({credentialId:e,isRoaming:t})=>({credentialId:e,isRoaming:t})))}}}catch(e){return{success:!1,error:{code:o.InitOpenSessionWithWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}}},941762:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initRegisterWebAuthnAuthenticator=void 0;const a=r(735088),o=r(632626),n=r(46298),s=r(608246),i=r(416593),c=r(656915),l=r(826942),d=r(3433);t.initRegisterWebAuthnAuthenticator=async function(e,t){const{storeService:r}=e,{relyingPartyId:u}=t,p=(0,i.userLoginSelector)(r.getState());let S=(0,c.webAuthnUserIdSelector)(r.getState());S||(S=(0,a.v4)(),r.dispatch((0,s.webAuthnUserIdUpdated)(S)));let g=(0,c.authenticatorsAsCredentialSelector)(r.getState());g&&0!==g.length||(await(0,d.refreshWebAuthnAuthenticators)(e),g=(0,c.authenticatorsAsCredentialSelector)(r.getState()));try{const e=await(0,n.requestWebauthnRegistration)(r,p);if((0,n.isApiError)(e))return{success:!1,error:{code:o.InitRegisterWebAuthnAuthenticatorError.UNKNOWN_ERROR}};const{challenge:t,expirationDateUnix:a}=e;return{success:!0,response:{publicKeyOptions:(0,l.buildAttestationPublicKeyOptions)(u,S,p,t,a,g)}}}catch(e){return{success:!1,error:{code:o.InitRegisterWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}}},222170:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initUserVerificationWithWebAuthn=void 0;const a=r(632626),o=r(868299),n=r(38945),s=r(416593),i={[n.StartWebAuthnAuthenticationError.CANNOT_FETCH_WEBAUTHN_CHALLENGE]:a.InitUserVerificationWithWebAuthnError.CANNOT_FETCH_WEBAUTHN_CHALLENGE,[n.StartWebAuthnAuthenticationError.CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS]:a.InitUserVerificationWithWebAuthnError.CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS};t.initUserVerificationWithWebAuthn=async function(e,t){try{const{storeService:r}=e,n=r.getState();if(!(0,s.isAuthenticatedSelector)(n))return{success:!1,error:{code:a.InitUserVerificationWithWebAuthnError.LOGGED_OUT}};const c=(0,s.userLoginSelector)(n),l=await(0,o.startWebAuthnAuthentication)(e,c,t.relyingPartyId);return!1===l.success?{success:!1,error:{code:i[l.error.code]??a.InitUserVerificationWithWebAuthnError.UNKNOWN_ERROR}}:{success:!0,response:{publicKeyOptions:l.response.publicKeyOptions}}}catch(e){return{success:!1,error:{code:a.InitUserVerificationWithWebAuthnError.UNKNOWN_ERROR}}}}},49904:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.openSessionWithWebAuthnAuthenticator=void 0;const a=r(632626),o=r(188610),n=r(200658);t.openSessionWithWebAuthnAuthenticator=async function(e,t){const{credential:r,login:s,isRoamingAuthenticator:i}=t,{storeService:c,webAuthnAuthenticationService:l}=e;try{const t={authenticationType:"webauthn.get",credential:{id:r.id,type:r.type,rawId:r.rawId,response:r.response}};await l.process(s,t);const d=c.getUserSession().masterPassword;if(!d)return(0,n.sendBiometricLoginErrorLog)(e),{success:!1,error:{code:a.OpenSessionWithWebAuthnAuthenticatorError.MP_MISSING_IN_SESSION_ERROR}};const u=(0,o.makeLoginController)(e);return await u.openSessionWithMasterPassword(s,d,{triggeredByRememberMeType:"webauthn",isWebAuthnAuthenticatorRoaming:i,loginType:"Biometric"}),{success:!0}}catch(t){return(0,n.sendBiometricLoginErrorLog)(e),{success:!1,error:{code:a.OpenSessionWithWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}}},29010:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshAvailableWebAuthnAuthenticators=void 0;const a=r(632626),o=r(656915),n=r(46298),s=r(608246);t.refreshAvailableWebAuthnAuthenticators=async function(e,t){const{storeService:r}=e,{login:i}=t;if(!(0,o.sessionKeysSelector)(r.getState()))return{success:!1,error:{code:a.RefreshAvailableWebAuthnAuthenticatorsError.MISSING_SESSION_KEYS_IN_STORE}};try{const e=await(0,n.getAvailableWebAuthnAuthenticators)(r,i);if((0,n.isApiError)(e))return{success:!1,error:{code:a.RefreshAvailableWebAuthnAuthenticatorsError.UNKNOWN_ERROR}};const t=e.authenticators.map((e=>({...e,canOpenSession:!0})));return r.dispatch((0,s.webAuthnAvailableAuthenticatorsListUpdated)(t)),{success:!0,response:{authenticators:t}}}catch(e){return{success:!1,error:{code:a.RefreshAvailableWebAuthnAuthenticatorsError.UNKNOWN_ERROR}}}}},3433:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshWebAuthnAuthenticators=void 0;const a=r(632626),o=r(46298),n=r(416593),s=r(608246);t.refreshWebAuthnAuthenticators=async function(e){const{storeService:t}=e,r=(0,n.userLoginSelector)(t.getState());try{const e=await(0,o.getWebAuthnAuthenticators)(t,r);if((0,o.isApiError)(e))return{success:!1,error:{code:a.RefreshWebAuthnAuthenticatorsError.UNKNOWN_ERROR}};const n=e.authenticators.map((e=>({...e,canOpenSession:!1})));return t.dispatch((0,s.webAuthnAuthenticatorsListUpdated)(n)),{success:!0,response:{authenticators:n}}}catch(e){return{success:!1,error:{code:a.RefreshWebAuthnAuthenticatorsError.UNKNOWN_ERROR}}}}},752198:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.registerWebAuthnAuthenticator=void 0;const a=r(632626),o=r(416593),n=r(46298),s=r(656915),i=r(608246);t.registerWebAuthnAuthenticator=async function(e,t){const{credential:r,isRoaming:c}=t,{storeService:l,webAuthnAuthenticationService:d}=e,u=l.getState(),p=(0,o.userLoginSelector)(u);if((0,s.hasOtp2TypeSelector)(u))return{success:!1,error:{code:a.RegisterWebAuthnAuthenticatorError.USER_HAS_OTP}};try{const e={authenticationType:"webauthn.create",name:p,isRoaming:c,credential:{id:r.id,type:r.type,rawId:r.rawId,response:r.response}};if((0,s.authenticatorsSelector)(u).length){const t=await(0,n.completeWebAuthnAuthenticatorRegistration)(l,p,{authenticator:e});if((0,n.isApiError)(t))return{success:!1,error:{code:a.RegisterWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}else await d.initialize(e);return l.dispatch((0,i.webAuthnAuthenticatorAdded)({name:e.name,isRoaming:e.isRoaming,credentialId:e.credential.id,canOpenSession:!0})),{success:!0}}catch(e){return{success:!1,error:{code:a.RegisterWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}}},282862:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeWebAuthnAuthenticator=void 0;const a=r(632626),o=r(416593),n=r(46298),s=r(656915),i=r(933088),c=r(608246);async function l(e,t,r){const o=await(0,n.deactivateWebAuthnAuthenticator)(e,t,{credentialId:r});return(0,n.isApiError)(o)?{success:!1,error:{code:a.RemoveWebAuthnAuthenticatorError.CANNOT_REMOVE_WEBAUTHN_AUTHENTICATOR}}:{success:!0}}t.removeWebAuthnAuthenticator=async function(e,t){const{credentialId:r}=t,{storeService:n}=e,d=n.getState(),u=(0,o.userLoginSelector)(d),p=(0,s.webAuthnAuthenticationOptedInSelector)(d),S=(0,s.authenticatorsSelector)(d);try{let t=null;return p&&1===S.length?(await(0,i.disableWebAuthnAuthentication)(e),t=await l(n,u,r)):t=await l(n,u,r),t.success&&n.dispatch((0,c.webAuthnAuthenticatorRemoved)(r)),t}catch(e){return{success:!1,error:{code:a.RemoveWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}}},868299:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.startWebAuthnAuthentication=void 0;const a=r(826942),o=r(29010),n=r(38945),s=r(46298);t.startWebAuthnAuthentication=async function(e,t,r){const{storeService:i}=e,c=await(0,o.refreshAvailableWebAuthnAuthenticators)(e,{login:t});if(!c.success)return{success:!1,error:{code:n.StartWebAuthnAuthenticationError.CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS}};const l=c.response.authenticators.map((e=>({id:e.credentialId,type:"public-key"}))),d=await(0,s.requestWebauthnOpenSession)(i,t);if((0,s.isApiError)(d))return{success:!1,error:{code:n.StartWebAuthnAuthenticationError.CANNOT_FETCH_WEBAUTHN_CHALLENGE}};const{challenge:u,expirationDateUnix:p}=d;return{success:!0,response:{publicKeyOptions:(0,a.buildAssertionPublicKeyOptions)(r,u,p,l),authenticatorsInfo:c.response.authenticators}}}},38945:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StartWebAuthnAuthenticationError=void 0,function(e){e.CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS="CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS",e.CANNOT_FETCH_WEBAUTHN_CHALLENGE="CANNOT_FETCH_WEBAUTHN_CHALLENGE"}(t.StartWebAuthnAuthenticationError||(t.StartWebAuthnAuthenticationError={}))},844740:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const a=r(803158);t.bootstrap=e=>{e.register(a.config)}},290622:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=t.getLocalAccounts=t.appKeysSelector=t.sessionKeysSelector=t.ukiSelector=t.deviceKeysSelector=t.authenticationReducer=void 0;var a=r(957334);Object.defineProperty(t,"authenticationReducer",{enumerable:!0,get:function(){return a.authenticationReducer}});var o=r(656915);Object.defineProperty(t,"deviceKeysSelector",{enumerable:!0,get:function(){return o.deviceKeysSelector}}),Object.defineProperty(t,"ukiSelector",{enumerable:!0,get:function(){return o.ukiSelector}}),Object.defineProperty(t,"sessionKeysSelector",{enumerable:!0,get:function(){return o.sessionKeysSelector}}),Object.defineProperty(t,"appKeysSelector",{enumerable:!0,get:function(){return o.appKeysSelector}});var n=r(275226);Object.defineProperty(t,"getLocalAccounts",{enumerable:!0,get:function(){return n.getLocalAccounts}});var s=r(844740);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return s.bootstrap}})},254622:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reactivationStatus$=void 0;const a=r(518948),o=r(903343),n=r(656915);t.reactivationStatus$=()=>(0,a.pipe)((0,o.map)(n.reactivationStatusSelector),(0,o.distinctUntilChanged)())},656915:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableUserVerificationMethodsSelector=t.reactivationStatusSelector=t.rememberMeFor14DaysOptedInSelector=t.webAuthnAuthenticationOptedInSelector=t.rememberMeTypeSelector=t.authenticatorsAsCredentialSelector=t.availableAuthenticatorsSelector=t.authenticatorsSelector=t.webAuthnUserIdSelector=t.webAuthnAuthenticationSelector=t.platformInfoSelector=t.hasOtp2TypeSelector=t.otpTypeSelector=t.userAuthenticationDataSelector=t.localUsersAuthenticationDataSelector=t.localAccountsListSelector=t.getUserDeviceWasRegisteredWithDeviceKeysSelector=t.sessionKeysSelector=t.getDeviceAccessKeySelector=t.getDeviceIdSelector=t.deviceKeysSelector=t.ukiSelector=t.dashlaneServerDeltaTimestampSelector=t.appKeysSelector=void 0;const a=r(632626),o=r(492215),n=r(802246),s=r(586797),i=r(538981),c=r(25421);t.appKeysSelector=e=>e.userSession.sdkAuthentication.appKeys,t.dashlaneServerDeltaTimestampSelector=e=>e.userSession.sdkAuthentication.dashlaneServerDeltaTimestamp,t.ukiSelector=e=>e.userSession.localSettings.uki||e.authentication.currentUser&&e.authentication.currentUser.deviceKeys&&(0,o.convertDeviceKeysToUki)(e.authentication.currentUser.deviceKeys)||null,t.deviceKeysSelector=e=>{if(e.authentication.currentUser&&e.authentication.currentUser.deviceKeys)return e.authentication.currentUser.deviceKeys;const t=e.userSession.localSettings.uki;return(0,o.convertUkiToDeviceKeys)(t)},t.getDeviceIdSelector=(e,t)=>{const r=e.authentication.localUsers[t];return r&&r.deviceAccessKey?r.deviceAccessKey:(0,n.getCommonAppSetting)("deviceId")||null},t.getDeviceAccessKeySelector=(e,r)=>(0,t.getDeviceIdSelector)(e,r),t.sessionKeysSelector=({userSession:{session:e}})=>Boolean(e.sessionKeys&&e.sessionKeys.accessKey&&e.sessionKeys.secretKey)?{...e.sessionKeys}:null,t.getUserDeviceWasRegisteredWithDeviceKeysSelector=(e,t)=>{const r=e.authentication.localUsers[t];return!!r&&!r.deviceRegisteredWithLegacyKey},t.localAccountsListSelector=e=>e.authentication.localAccounts.accountsList,t.localUsersAuthenticationDataSelector=e=>e.authentication.localUsers,t.userAuthenticationDataSelector=e=>e.authentication.currentUser,t.otpTypeSelector=e=>e.userSession?.account?e.userSession.account.otpType:null,t.hasOtp2TypeSelector=e=>(0,t.otpTypeSelector)(e)===s.OtpType.OTP_LOGIN,t.platformInfoSelector=e=>e.device.platform.info,t.webAuthnAuthenticationSelector=e=>e.authentication.webAuthnAuthentication,t.webAuthnUserIdSelector=e=>e.authentication.webAuthnAuthentication.webAuthnUserId,t.authenticatorsSelector=e=>e.authentication.webAuthnAuthentication.authenticators,t.availableAuthenticatorsSelector=e=>e.authentication.webAuthnAuthentication.authenticators.filter((e=>e.canOpenSession)),t.authenticatorsAsCredentialSelector=e=>(0,t.authenticatorsSelector)(e).map((e=>({id:e.credentialId,type:"public-key"}))),t.rememberMeTypeSelector=e=>e.authentication.currentUser.rememberMeType,t.webAuthnAuthenticationOptedInSelector=e=>"webauthn"===(0,t.rememberMeTypeSelector)(e),t.rememberMeFor14DaysOptedInSelector=e=>"autologin"===(0,t.rememberMeTypeSelector)(e),t.reactivationStatusSelector=e=>e.authentication.localAccounts.reactivationStatus,t.availableUserVerificationMethodsSelector=e=>{const r=[],o="masterPassword"!==(0,c.accountAuthenticationTypeSelector)(e);return(0,t.webAuthnAuthenticationOptedInSelector)(e)&&r.push(a.UserVerificationMethods.Webauthn),(0,i.isSSOUserSelector)(e)||o||r.push(a.UserVerificationMethods.MasterPassword),Promise.resolve(r)}},533045:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const a=r(514498);t.setupSubscriptions=async function(e,t){e.sessionOpened.on((()=>{(0,a.loadRememberMeTypeToStore)(t)}))}},76839:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(890351);t.config={commands:{},queries:{getSingleAddressForAutofill:{selector:a.autofillViewedAddressSelector},getMultipleAddressesForAutofill:{selector:a.autofillViewedQueriedAddressesSelector},getSingleBankAccountForAutofill:{selector:a.autofillViewedBankAccountSelector},getMultipleBankAccountsForAutofill:{selector:a.autofillViewedQueriedBankAccountsSelector},getSingleCompanyForAutofill:{selector:a.autofillViewedCompanySelector},getMultipleCompaniesForAutofill:{selector:a.autofillViewedQueriedCompaniesSelector},getSingleCredentialForAutofill:{selector:a.autofillViewedCredentialSelector},getMultipleCredentialsForAutofill:{selector:a.autofillViewedQueriedCredentialsByDomainSelector},getSingleDriverLicenseForAutofill:{selector:a.autofillViewedDriverLicenseSelector},getMultipleDriverLicensesForAutofill:{selector:a.autofillViewedQueriedDriverLicensesSelector},getSingleEmailForAutofill:{selector:a.autofillViewedEmailSelector},getMultipleEmailsForAutofill:{selector:a.autofillViewedQueriedEmailsSelector},getSingleFiscalIdForAutofill:{selector:a.autofillViewedFiscalIdSelector},getMultipleFiscalIdsForAutofill:{selector:a.autofillViewedQueriedFiscalIdsSelector},getSingleGeneratedPasswordForAutofill:{selector:a.autofillViewedGeneratedPasswordSelector},getMultipleGeneratedPasswordsForAutofill:{selector:a.autofillViewedQueriedGeneratedPasswordsSelector},getSingleIdCardForAutofill:{selector:a.autofillViewedIdCardSelector},getMultipleIdCardsForAutofill:{selector:a.autofillViewedQueriedIdCardsSelector},getSingleIdentityForAutofill:{selector:a.autofillViewedIdentitySelector},getMultipleIdentitiesForAutofill:{selector:a.autofillViewedQueriedIdentitiesSelector},getSingleNoteForAutofill:{selector:a.autofillViewedNoteSelector},getMultipleNotesForAutofill:{selector:a.autofillViewedQueriedNotesSelector},getSinglePasskeyForAutofill:{selector:a.autofillViewedPasskeySelector},getSinglePassportForAutofill:{selector:a.autofillViewedPassportSelector},getMultiplePassportsForAutofill:{selector:a.autofillViewedQueriedPassportsSelector},getSinglePaymentCardForAutofill:{selector:a.autofillViewedPaymentCardSelector},getMultiplePaymentCardsForAutofill:{selector:a.autofillViewedQueriedPaymentCardsSelector},getSinglePersonalWebsiteForAutofill:{selector:a.autofillViewedPersonalWebsiteSelector},getMultiplePersonalWebsitesForAutofill:{selector:a.autofillViewedQueriedPersonalWebsitesSelector},getSinglePhoneForAutofill:{selector:a.autofillViewedPhoneSelector},getMultiplePhonesForAutofill:{selector:a.autofillViewedQueriedPhonesSelector},getSingleSocialSecurityIdForAutofill:{selector:a.autofillViewedSocialSecurityIdSelector},getMultipleSocialSecurityIdsForAutofill:{selector:a.autofillViewedQueriedSocialSecurityIdsSelector},getAutofillSettingOnUrlForAutofill:{selector:a.getAutofillSettingOnUrlForAutofillSelector}},liveQueries:{}}},372227:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const a=r(76839);t.bootstrap=e=>{e.register(a.config)}},227923:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDomainMatchTypeForHermes=t.getAgeFromIdentity=t.defaultToZero=t.defaultToUS=t.defaultToEmptyString=void 0;const a=r(401067),o=r(632626),n=r(700033),s=r(672099),i=r(488083);t.defaultToEmptyString=(0,a.defaultTo)(""),t.defaultToUS=(0,a.defaultTo)(o.Country.US),t.defaultToZero=(0,a.defaultTo)(0),t.getAgeFromIdentity=e=>{const t=new Date(0).getUTCFullYear(),r=(0,s.epochToDate)((0,s.vaultDateToViewDate)(e.BirthDate)),a=new Date(Date.now()-r.getTime());return Math.abs(a.getUTCFullYear()-t)},t.getDomainMatchTypeForHermes=(e,t)=>{switch((0,i.getCredentialByDomainMatchType)(e,t)){case i.DomainMatchType.DashlaneDefinedLinkedWebsite:return n.MatchType.AssociatedWebsite;case i.DomainMatchType.UserDefinedLinkedWebsite:return n.MatchType.UserAssociatedWebsite;case i.DomainMatchType.None:case i.DomainMatchType.MainWebsite:default:return n.MatchType.Regular}}},574219:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(372227);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},890351:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAutofillSettingOnUrlForAutofillSelector=t.autofillViewedQueriedSocialSecurityIdsSelector=t.autofillViewedSocialSecurityIdSelector=t.autofillViewedQueriedPersonalWebsitesSelector=t.autofillViewedPersonalWebsiteSelector=t.autofillViewedQueriedPhonesSelector=t.autofillViewedPhoneSelector=t.autofillViewedQueriedPaymentCardsSelector=t.autofillViewedPaymentCardSelector=t.autofillViewedQueriedPassportsSelector=t.autofillViewedPassportSelector=t.autofillViewedPasskeySelector=t.autofillViewedQueriedNotesSelector=t.autofillViewedNoteSelector=t.autofillViewedQueriedIdentitiesSelector=t.autofillViewedIdentitySelector=t.autofillViewedQueriedIdCardsSelector=t.autofillViewedIdCardSelector=t.autofillViewedQueriedGeneratedPasswordsSelector=t.autofillViewedGeneratedPasswordSelector=t.autofillViewedQueriedFiscalIdsSelector=t.autofillViewedFiscalIdSelector=t.autofillViewedQueriedEmailsSelector=t.autofillViewedEmailSelector=t.autofillViewedQueriedDriverLicensesSelector=t.autofillViewedDriverLicenseSelector=t.autofillViewedQueriedCredentialsByDomainSelector=t.autofillViewedCredentialSelector=t.autofillViewedQueriedCompaniesSelector=t.autofillViewedCompanySelector=t.autofillViewedQueriedBankAccountsSelector=t.autofillViewedBankAccountSelector=t.autofillViewedQueriedAddressesSelector=t.autofillViewedAddressSelector=void 0;const a=r(401067),o=r(632626),n=r(421178),s=r(99281),i=r(516018),c=r(180624),l=r(719736),d=r(919325),u=r(841841),p=r(509774),S=r(326147),g=r(141092),m=r(992598),y=r(723437),h=r(381438),f=r(628074),v=r(865401),T=r(358235),A=r(381473),P=r(82439),w=r(727147),b=r(416593),I=r(563566),E=r(691210),C=r(352102),_=r(183687),D=r(355346),O=r(518665);t.autofillViewedAddressSelector=(e,t)=>{const r=(0,s.addressSelector)(e,t);return(0,D.addressAutofillView)(r)},t.autofillViewedQueriedAddressesSelector=(0,a.compose)((0,I.viewListResults)(D.addressListView),s.queryAddressesSelector),t.autofillViewedBankAccountSelector=(e,t)=>{const r=(0,i.bankAccountSelector)(e,t);return(0,D.bankAccountAutofillView)(r)},t.autofillViewedQueriedBankAccountsSelector=(0,a.compose)((0,I.viewListResults)(D.bankAccountListView),i.queryBankAccountsSelector),t.autofillViewedCompanySelector=(e,t)=>{const r=(0,c.companySelector)(e,t);return(0,D.companyAutofillView)(r)},t.autofillViewedQueriedCompaniesSelector=(0,a.compose)((0,I.viewListResults)(D.companyListView),c.queryCompaniesSelector),t.autofillViewedCredentialSelector=(e,{credentialId:t,rootDomain:r})=>{const a=(0,l.credentialSelector)(e,t),o=(0,E.limitedSharingItemsSelector)(e),n=(0,C.sharingDataSelector)(e),s=(0,b.userIdSelector)(e),i=(0,_.getSharingStatusDetail)(o,n,s)(t),c=i.isShared?{isShared:!0,hasAdminPermission:"admin"===i.permission}:{isShared:!1};return(0,D.credentialAutofillView)(r,a,c)},t.autofillViewedQueriedCredentialsByDomainSelector=(e,t)=>{const r=(0,E.limitedSharingItemsSelector)(e),a=(0,C.sharingDataSelector)(e),o=(0,b.userIdSelector)(e),n=(0,_.getSharingStatusDetail)(r,a,o),{domain:s,...i}=t,c=(s?(0,d.getQueryByDomainSelector)(s):u.querySelector)(e,i),l={...c,items:c.items.map((e=>{const t=n(e.Id),r=t.isShared?{isShared:!0,hasAdminPermission:"admin"===t.permission}:{isShared:!1};return{credential:e,domain:s,sharingStatus:r}}))};return(0,I.viewListResults)(D.credentialListView)(l)},t.autofillViewedDriverLicenseSelector=(e,t)=>{const r=(0,p.driverLicenseWithIdentitySelector)(e,t);return(0,D.driverLicenseAutofillView)(r)},t.autofillViewedQueriedDriverLicensesSelector=(0,a.compose)((0,I.viewListResults)(D.driverLicenseListView),p.queryDriverLicensesSelector),t.autofillViewedEmailSelector=(e,t)=>{const r=(0,S.emailSelector)(e,t);return(0,D.emailAutofillView)(r)},t.autofillViewedQueriedEmailsSelector=(0,a.compose)((0,I.viewListResults)(D.emailListView),S.queryEmailsSelector),t.autofillViewedFiscalIdSelector=(e,t)=>{const r=(0,g.fiscalIdSelector)(e,t);return(0,D.fiscalIdAutofillView)(r)},t.autofillViewedQueriedFiscalIdsSelector=(0,a.compose)((0,I.viewListResults)(D.fiscalIdListView),g.queryFiscalIdsSelector),t.autofillViewedGeneratedPasswordSelector=(e,t)=>{const r=(0,m.generatedPasswordSelector)(e,t);return(0,D.generatedPasswordAutofillView)(r)},t.autofillViewedQueriedGeneratedPasswordsSelector=(0,a.compose)((0,I.viewListResults)(D.generatedPasswordListView),m.queryGeneratedPasswordsSelector),t.autofillViewedIdCardSelector=(e,t)=>{const r=(0,y.idCardWithIdentitySelector)(e,t);return(0,D.idCardAutofillView)(r)},t.autofillViewedQueriedIdCardsSelector=(0,a.compose)((0,I.viewListResults)(D.idCardListView),y.queryIdCardsSelector),t.autofillViewedIdentitySelector=(e,t)=>{const r=(0,f.identitySelector)(e,t);return(0,D.identityAutofillView)(r)},t.autofillViewedQueriedIdentitiesSelector=(0,a.compose)((0,I.viewListResults)(D.identityListView),f.queryIdentitiesSelector),t.autofillViewedNoteSelector=(e,t)=>{const r=(0,h.noteSelector)(e,t);return(0,D.noteAutofillView)(r)},t.autofillViewedQueriedNotesSelector=(0,a.compose)((0,I.viewListResults)(D.noteListView),h.queryNotesSelector),t.autofillViewedPasskeySelector=(e,t)=>{const r=(0,O.passkeySelector)(e,t);return(0,D.passkeyAutofillView)(r)},t.autofillViewedPassportSelector=(e,t)=>{const r=(0,v.passportWithIdentitySelector)(e,t);return(0,D.passportAutofillView)(r)},t.autofillViewedQueriedPassportsSelector=(0,a.compose)((0,I.viewListResults)(D.passportListView),v.queryPassportsWithIdentitySelector),t.autofillViewedPaymentCardSelector=(e,t)=>{const r=(0,T.paymentCardSelector)(e,t);return(0,D.paymentCardAutofillView)(r)},t.autofillViewedQueriedPaymentCardsSelector=(0,a.compose)((0,I.viewListResults)(D.paymentCardListView),T.queryPaymentCardsSelector),t.autofillViewedPhoneSelector=(e,t)=>{const r=(0,P.phoneSelector)(e,t);return(0,D.phoneAutofillView)(r)},t.autofillViewedQueriedPhonesSelector=(0,a.compose)((0,I.viewListResults)(D.phoneListView),P.queryPhonesSelector),t.autofillViewedPersonalWebsiteSelector=(e,t)=>{const r=(0,A.personalWebsiteSelector)(e,t);return(0,D.personalWebsiteAutofillView)(r)},t.autofillViewedQueriedPersonalWebsitesSelector=(0,a.compose)((0,I.viewListResults)(D.personalWebsiteListView),A.queryPersonalWebsitesSelector),t.autofillViewedSocialSecurityIdSelector=(e,t)=>{const r=(0,w.socialSecurityIdWithIdentitySelector)(e,t);return(0,D.socialSecurityIdAutofillView)(r)},t.autofillViewedQueriedSocialSecurityIdsSelector=(0,a.compose)((0,I.viewListResults)(D.socialSecurityIdListView),w.querySocialSecurityIdsSelector),t.getAutofillSettingOnUrlForAutofillSelector=(e,t)=>{const r=new n.ParsedURL(t).getRootDomain(),a=(0,b.personalSettingsSelector)(e),s=a.DisabledUrlsList.includes(t);return a.DisabledDomainsList.includes(r)||s?o.AutofillOptions.ANALYSIS_ENABLED_ONLY_ON_LOGINS_AND_PASSWORDS:o.AutofillOptions.ANALYSIS_ENABLED_ON_ALL_FORMS}},355346:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.passkeyAutofillView=t.socialSecurityIdListView=t.socialSecurityIdAutofillView=t.phoneListView=t.phoneAutofillView=t.personalWebsiteListView=t.personalWebsiteAutofillView=t.paymentCardListView=t.paymentCardAutofillView=t.passportListView=t.passportAutofillView=t.noteListView=t.noteAutofillView=t.idCardListView=t.idCardAutofillView=t.identityListView=t.identityAutofillView=t.generatedPasswordListView=t.generatedPasswordAutofillView=t.fiscalIdListView=t.fiscalIdAutofillView=t.emailListView=t.emailAutofillView=t.driverLicenseListView=t.driverLicenseAutofillView=t.credentialListView=t.credentialAutofillView=t.companyListView=t.companyAutofillView=t.bankAccountListView=t.bankAccountAutofillView=t.addressListView=t.addressAutofillView=void 0;const a=r(929045),o=r(632626),n=r(401067),s=r(292882),i=r(442316),c=r(290073),l=r(672099),d=r(106205),u=r(338495),p=r(227923),S=r(532965),g=e=>({id:e.Id,lastUse:e.LastUse,localeFormat:e.LocaleFormat,spaceId:e.SpaceId});t.addressAutofillView=e=>({...g(e),vaultType:a.VaultSourceType.Address,addressFull:(0,p.defaultToEmptyString)(e.AddressFull),addressName:(0,p.defaultToEmptyString)(e.AddressName),building:(0,p.defaultToEmptyString)(e.Building),city:(0,p.defaultToEmptyString)(e.City),country:(0,p.defaultToEmptyString)(e.Country),digitCode:(0,p.defaultToEmptyString)(e.DigitCode),door:(0,p.defaultToEmptyString)(e.Door),floor:(0,p.defaultToEmptyString)(e.Floor),stairs:(0,p.defaultToEmptyString)(e.Stairs),state:(0,u.findStateName)((0,p.defaultToEmptyString)(e.State)),stateCode:(0,u.findStateCode)((0,p.defaultToEmptyString)(e.LocaleFormat),(0,p.defaultToEmptyString)(e.State)),stateLevel2:(0,u.findStateLevel2Name)((0,p.defaultToEmptyString)(e.StateLevel2)),streetName:(0,p.defaultToEmptyString)(e.StreetName),streetNumber:(0,p.defaultToEmptyString)(e.StreetNumber),streetTitle:(0,p.defaultToEmptyString)(e.StreetTitle),zipCode:(0,p.defaultToEmptyString)(e.ZipCode)}),t.addressListView=e=>e.map(t.addressAutofillView),t.bankAccountAutofillView=e=>{const t=(0,s.getBankInfoFromBankAccountData)(e);return{...g(e),vaultType:a.VaultSourceType.BankAccount,name:(0,p.defaultToEmptyString)(e.BankAccountName),owner:(0,p.defaultToEmptyString)(e.BankAccountOwner),IBAN:(0,p.defaultToEmptyString)(e.BankAccountIBAN),BIC:(0,p.defaultToEmptyString)(e.BankAccountBIC),bank:t.bank,country:(0,p.defaultToUS)(e.LocaleFormat),bankCode:t.bankCode}},t.bankAccountListView=e=>e.map(t.bankAccountAutofillView),t.companyAutofillView=e=>({...g(e),vaultType:a.VaultSourceType.Company,name:(0,p.defaultToEmptyString)(e.Name),jobTitle:(0,p.defaultToEmptyString)(e.JobTitle)}),t.companyListView=e=>e.map(t.companyAutofillView),t.credentialAutofillView=(e,t,r)=>({...g(t),vaultType:a.VaultSourceType.Credential,autoProtected:(0,n.defaultTo)(!1,t.AutoProtected),autoLogin:(0,n.defaultTo)(!1,t.AutoLogin),email:(0,p.defaultToEmptyString)(t.Email),hasOtp:Boolean(t.OtpSecret)||Boolean(t.OtpUrl),matchType:(0,p.getDomainMatchTypeForHermes)(e,t),login:(0,p.defaultToEmptyString)(t.Login),otpSecret:(0,p.defaultToEmptyString)(t.OtpSecret),otpUrl:(0,p.defaultToEmptyString)(t.OtpUrl),password:(0,p.defaultToEmptyString)(t.Password),subdomainOnly:t.SubdomainOnly||!1,sharingStatus:r,title:(0,p.defaultToEmptyString)(t.Title||(0,c.getDomainForCredential)(t)),secondaryLogin:t.SecondaryLogin,url:(0,p.defaultToEmptyString)(t.Url),userAddedLinkedWebsites:(0,d.getUserAddedLinkedWebsiteDomains)(t)}),t.credentialListView=e=>e.map((({domain:e,credential:r,sharingStatus:a})=>(0,t.credentialAutofillView)(e,r,a))),t.driverLicenseAutofillView=e=>{const t=(0,l.epochToDate)((0,l.vaultDateToViewDate)(e.ExpireDate)),r=(0,l.epochToDate)((0,l.vaultDateToViewDate)(e.DeliveryDate));return{...g(e),vaultType:a.VaultSourceType.DriverLicense,country:(0,l.vaultCountryToViewCountry)(e.LocaleFormat),creationDate:(0,p.defaultToZero)(e.CreationDatetime),expirationDay:t.getDate(),expirationMonth:t.getMonth()+l.ZERO_INDEX_BASED_MONTH_OFFSET,expirationYear:t.getFullYear(),expirationDateFull:`${t.getFullYear()}-${t.getMonth()+l.ZERO_INDEX_BASED_MONTH_OFFSET}-${t.getDate()}`,idNumber:(0,p.defaultToEmptyString)(e.Number),issueDay:r.getDate(),issueMonth:r.getMonth()+l.ZERO_INDEX_BASED_MONTH_OFFSET,issueYear:r.getFullYear(),issueDateFull:`${r.getFullYear()}-${r.getMonth()+l.ZERO_INDEX_BASED_MONTH_OFFSET}-${r.getDate()}`,name:(0,l.identityToName)(e.identity)||e.Fullname||"",spaceId:e.SpaceId,state:e.State}},t.driverLicenseListView=e=>e.map(t.driverLicenseAutofillView),t.emailAutofillView=e=>({...g(e),vaultType:a.VaultSourceType.Email,email:(0,p.defaultToEmptyString)(e.Email),name:(0,p.defaultToEmptyString)(e.EmailName),type:e.Type||"NO_TYPE"}),t.emailListView=e=>e.map(t.emailAutofillView),t.fiscalIdAutofillView=e=>({...g(e),vaultType:a.VaultSourceType.FiscalId,country:(0,l.vaultCountryToViewCountry)(e.LocaleFormat),idNumber:(0,p.defaultToEmptyString)(e.FiscalNumber),teledeclarantNumber:(0,p.defaultToEmptyString)(e.TeledeclarantNumber),creationDate:(0,p.defaultToZero)(e.CreationDatetime)}),t.fiscalIdListView=e=>e.map(t.fiscalIdAutofillView),t.generatedPasswordAutofillView=e=>({vaultType:a.VaultSourceType.GeneratedPassword,domain:(0,p.defaultToEmptyString)(e.Domain),generatedDate:e.GeneratedDate,password:e.Password,id:e.Id}),t.generatedPasswordListView=e=>e.map(t.generatedPasswordAutofillView),t.identityAutofillView=e=>({...g(e),vaultType:a.VaultSourceType.Identity,age:(0,p.getAgeFromIdentity)(e),birthDate:(0,p.defaultToEmptyString)(e.BirthDate),birthPlace:(0,p.defaultToEmptyString)(e.BirthPlace),firstName:(0,p.defaultToEmptyString)(e.FirstName),lastName2:(0,p.defaultToEmptyString)(e.LastName2),lastName:(0,p.defaultToEmptyString)(e.LastName),middleName:(0,p.defaultToEmptyString)(e.MiddleName),middleNameInitial:(0,p.defaultToEmptyString)(e.MiddleName),pseudo:(0,p.defaultToEmptyString)(e.Pseudo),title:e.Title}),t.identityListView=e=>e.map(t.identityAutofillView),t.idCardAutofillView=e=>{const t=(0,l.epochToDate)((0,l.vaultDateToViewDate)(e.ExpireDate)),r=(0,l.epochToDate)((0,l.vaultDateToViewDate)(e.DeliveryDate));return{...g(e),vaultType:a.VaultSourceType.IdCard,country:(0,l.vaultCountryToViewCountry)(e.LocaleFormat),creationDate:(0,p.defaultToZero)(e.CreationDatetime),expirationDay:t.getDate(),expirationMonth:t.getMonth()+l.ZERO_INDEX_BASED_MONTH_OFFSET,expirationYear:t.getFullYear(),expirationDateFull:`${t.getFullYear()}-${t.getMonth()+l.ZERO_INDEX_BASED_MONTH_OFFSET}-${t.getDate()}`,idNumber:(0,p.defaultToEmptyString)(e.Number),issueDay:r.getDate(),issueMonth:r.getMonth()+l.ZERO_INDEX_BASED_MONTH_OFFSET,issueYear:r.getFullYear(),issueDateFull:`${r.getFullYear()}-${r.getMonth()+l.ZERO_INDEX_BASED_MONTH_OFFSET}-${r.getDate()}`,name:(0,l.identityToName)(e.identity)||e.Fullname||"",spaceId:e.SpaceId}},t.idCardListView=e=>e.map(t.idCardAutofillView),t.noteAutofillView=e=>({...g(e),vaultType:a.VaultSourceType.Note}),t.noteListView=e=>e.map(t.noteAutofillView),t.passportAutofillView=e=>{const t=(0,l.epochToDate)((0,l.vaultDateToViewDate)(e.ExpireDate)),r=(0,l.epochToDate)((0,l.vaultDateToViewDate)(e.DeliveryDate));return{...g(e),vaultType:a.VaultSourceType.Passport,idNumber:(0,p.defaultToEmptyString)(e.Number),country:(0,l.vaultCountryToViewCountry)(e.LocaleFormat),expirationDay:t.getDate(),expirationMonth:t.getMonth()+l.ZERO_INDEX_BASED_MONTH_OFFSET,expirationYear:t.getFullYear(),expirationDateFull:`${t.getFullYear()}-${t.getMonth()+l.ZERO_INDEX_BASED_MONTH_OFFSET}-${t.getDate()}`,issueDay:r.getDate(),issueMonth:r.getMonth()+l.ZERO_INDEX_BASED_MONTH_OFFSET,issueYear:r.getFullYear(),issueDateFull:`${r.getFullYear()}-${r.getMonth()+l.ZERO_INDEX_BASED_MONTH_OFFSET}-${r.getDate()}`,name:(0,l.identityToName)(e.identity)||e.Fullname||"",deliveryPlace:(0,p.defaultToEmptyString)(e.DeliveryPlace),creationDate:(0,p.defaultToZero)(e.CreationDatetime)}},t.passportListView=e=>e.map(t.passportAutofillView),t.paymentCardAutofillView=e=>({...g(e),vaultType:a.VaultSourceType.PaymentCard,bank:(0,p.defaultToEmptyString)(e.Bank),cardNumber:(0,p.defaultToEmptyString)(e.CardNumber),cardNumberLastDigits:(0,i.getLastDigitsFromCardNumber)(e.CardNumber),color:e.Color||i.defaultColor,expireMonth:(0,p.defaultToEmptyString)(e.ExpireMonth),expireYear:(0,p.defaultToEmptyString)(e.ExpireYear),name:(0,p.defaultToEmptyString)(e.Name),ownerName:(0,p.defaultToEmptyString)(e.OwnerName),securityCode:(0,p.defaultToEmptyString)(e.SecurityCode),type:e.Type}),t.paymentCardListView=e=>e.map(t.paymentCardAutofillView),t.personalWebsiteAutofillView=e=>({...g(e),vaultType:a.VaultSourceType.PersonalWebsite,name:(0,p.defaultToEmptyString)(e.Name),website:(0,p.defaultToEmptyString)(e.Website)}),t.personalWebsiteListView=e=>e.map(t.personalWebsiteAutofillView);const m={[o.PhoneType.PHONE_TYPE_ANY]:S.PhoneType.Any,[o.PhoneType.PHONE_TYPE_FAX]:S.PhoneType.Fax,[o.PhoneType.PHONE_TYPE_LANDLINE]:S.PhoneType.Landline,[o.PhoneType.PHONE_TYPE_MOBILE]:S.PhoneType.Mobile,[o.PhoneType.PHONE_TYPE_WORK_FAX]:S.PhoneType.WorkFax,[o.PhoneType.PHONE_TYPE_WORK_LANDLINE]:S.PhoneType.WorkLandline,[o.PhoneType.PHONE_TYPE_WORK_MOBILE]:S.PhoneType.WorkMobile};t.phoneAutofillView=e=>({...g(e),vaultType:a.VaultSourceType.Phone,name:(0,p.defaultToEmptyString)(e.PhoneName),numberInternational:(0,p.defaultToEmptyString)(e.NumberNational),number:(0,p.defaultToEmptyString)(e.Number),type:m[e.Type]}),t.phoneListView=e=>e.map(t.phoneAutofillView),t.socialSecurityIdAutofillView=e=>({...g(e),vaultType:a.VaultSourceType.SocialSecurityId,name:(0,l.identityToName)(e.identity)||e.SocialSecurityFullname||"",idNumber:(0,p.defaultToEmptyString)(e.SocialSecurityNumber),country:(0,l.vaultCountryToViewCountry)(e.LocaleFormat),creationDate:(0,p.defaultToZero)(e.CreationDatetime)}),t.socialSecurityIdListView=e=>e.map(t.socialSecurityIdAutofillView),t.passkeyAutofillView=e=>({...g(e),credentialId:e.CredentialId,rpId:e.RpId,rpName:e.RpName,userDisplayName:e.UserDisplayName,userHandle:e.UserHandle,vaultType:a.VaultSourceType.Passkey,counter:e.Counter,keyAlgorithm:e.KeyAlgorithm})},707006:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(519083),o=r(350059);t.config={commands:{changeMasterPassword:{handler:a.changeMasterPassword}},queries:{},liveQueries:{liveChangeMasterPasswordStatus:{subject:o.getChangeMasterPasswordStatus$}}}},350059:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getChangeMasterPasswordStatus$=t.emitChangeMasterPasswordStatus=void 0;const a=new(r(518948).Subject);t.emitChangeMasterPasswordStatus=e=>a.next(e),t.getChangeMasterPasswordStatus$=()=>a},735186:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const a=r(707006);t.bootstrap=e=>{e.register(a.config)}},519083:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.changeMasterPassword=void 0;const a=r(632626),o=r(350059),n=r(433740),s=r(713141),i=r(937515),c=r(522018),l=r(841383),d=r(46298),u=r(188610),p=r(747820),S=r(416593),g=r(216194),m=r(361740),y=r(700033),h=r(761984),f=r(518948),v=r(419562),T=r(288205),A=r(392263),P=r(670252),w=r(461394),b=r(827517);t.changeMasterPassword=async(e,t)=>{const{applicationModulesAccess:r,storeService:I,masterPasswordEncryptorService:E,remoteDataEncryptorService:C,sessionService:_,localStorageService:D,storageService:O,eventLoggerService:M}=e,{queries:{isMasterPasswordLeaked:N,isMasterPasswordWeak:F},commands:{temporaryResetMasterPasswordLeaked:U}}=r.createClients().masterPasswordSecurity,{flow:L}=t,k=await(0,n.preValidationForChangeMP)(e,t);if(!1===k.success)return k;const R=I.getState(),B=await(0,T.makeFeatureFlipsSelectors)(r).featureFlipsSelector(),j=(0,S.isRemoteKeyActivatedSelector)(R)?C:E;(0,o.emitChangeMasterPasswordStatus)({type:a.ChangeMasterPasswordStepNeeded.DOWNLOAD,value:10});const V=(0,S.userLoginSelector)(R);if(!V)return(0,n.makeReturnErrorObject)(a.ChangeMasterPasswordCode.UNEXPECTED_STATE,L);let K;try{K=r.createClients(),await K.session.commands.prepareLocalDataFlush(),I.dispatch((0,g.changeMPStart)())}catch(e){const t=A.CarbonError.fromAnyError(e).addContextInfo("CHANGE_MASTER_PASSWORD","prepareLocalDataFlushError").addAdditionalInfo({comment:"Failed to prepare local data on graphene"});throw(0,P.sendExceptionLog)({error:t}),e}const H=await(0,d.getDataForMasterPasswordChange)(I,V,{});if((0,d.isApiError)(H))return(0,h.logChangeMasterPasswordError)(M,y.ChangeMasterPasswordError.DownloadError),I.dispatch((0,g.changeMPDone)()),(0,n.makeUnexpectedErrorObject)(H.message,L);const{serverKey:W}=I.getUserSession();if(!(0,n.isOtpStatusValid)(H.otpStatus,W))return(0,h.logChangeMasterPasswordError)(M,y.ChangeMasterPasswordError.LoginError),I.dispatch((0,g.changeMPDone)()),(0,n.makeReturnErrorObject)(a.ChangeMasterPasswordCode.OTP_PROBLEM,L);const{timestamp:x}=H,{transactions:G,sharingKeys:q}=H.data;try{const d=await(0,n.deCipherAllTransactions)(_,j,G),S=D.getInstance(),T=await S.doesLocalKeyExist();let E=null;T&&(E=await S.getLocalKey());const{publicKey:C}=q,k=await(0,n.decipherPrivateKey)(I,j,q);let R;switch(await(0,m.cleanRememberMeStorageData)(I,O),t.flow){case a.ChangeMPFlowPath.MP_TO_SSO:R=await(0,i.handleMigrationMPtoSso)(e,t,d,k,C,x);break;case a.ChangeMPFlowPath.SSO_TO_MP:R=await(0,c.handleMigrationSSOtoMP)(e,t,d,k,C,x);break;case a.ChangeMPFlowPath.TO_EMAIL_TOKEN:R=await(0,s.handleMigrationToEmailToken)(e,t,d,k,C,x);break;case a.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY:case a.ChangeMPFlowPath.ACCOUNT_RECOVERY_KEY:case a.ChangeMPFlowPath.USER_CHANGING_MP:default:R=await(0,l.handleUserChangingMP)(e,t,d,k,C,x)}if(!R.success)return(0,h.logChangeMasterPasswordError)(M,y.ChangeMasterPasswordError.UnknownError),I.dispatch((0,g.changeMPDone)()),R;await K.session.commands.flushLocalData();const H=Boolean(I.getPersonalSettings().AccountRecoveryKey);try{await r.createClients().pinCode.commands.deactivate()}catch(e){const t=A.CarbonError.fromAnyError(e).addContextInfo("CHANGE_MASTER_PASSWORD","deactivatePinCode").addAdditionalInfo({comment:"Failed to deactivate pin code after successful mp change"});await(0,P.sendExceptionLog)({error:t})}try{H&&(await(0,w.deactivateAccountRecoveryKey)(I,V,{reason:"VAULT_KEY_CHANGE"}),(0,h.logUserDeleteAccountRecoveryKey)(M),e.storeService.dispatch((0,b.editPersonalSettings)({AccountRecoveryKey:void 0,AccountRecoveryKeyId:void 0})))}catch(e){const t=A.CarbonError.fromAnyError(e).addContextInfo("CHANGE_MASTER_PASSWORD","deactivateRecoveryKey").addAdditionalInfo({comment:"Failed to deactivate recovery key after successful mp change"});await(0,P.sendExceptionLog)({error:t})}let W,$;E&&await _.getInstance().user.persistLocalKey(E),await(0,p.storeSessionCredentialForRecovery)(I,D),(0,o.emitChangeMasterPasswordStatus)({type:a.ChangeMasterPasswordStepNeeded.DONE,value:100}),await(0,n.resetMigrationState)(e,L),L===a.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY||L===a.ChangeMPFlowPath.MP_TO_SSO||L===a.ChangeMPFlowPath.SSO_TO_MP?await(0,u.sessionDidOpen)(e):H&&await e.sessionService.getInstance().user.attemptSync(y.Trigger.ChangeMasterPassword);try{W=await(0,f.firstValueFrom)(N())}catch(e){const t=A.CarbonError.fromAnyError(e).addContextInfo("CHANGE_MASTER_PASSWORD","isMasterPasswordLeakedError").addAdditionalInfo({comment:"Failed to retrieve value from isMasterPasswordLeaked"});throw(0,P.sendExceptionLog)({error:t}),e}try{$=B.ims_web_weak_mp_prod?await(0,f.firstValueFrom)(F()):null}catch(e){const t=A.CarbonError.fromAnyError(e).addContextInfo("CHANGE_MASTER_PASSWORD","isMasterPasswordWeakError").addAdditionalInfo({comment:"Failed to retrieve value from isMasterPasswordWeak"});throw(0,P.sendExceptionLog)({error:t}),e}const Q=!!(0,v.isSuccess)(W)&&W.data,Y=null===$?void 0:!!(0,v.isSuccess)($)&&$.data;if((0,h.logChangeMasterPasswordComplete)(M,Q,Y),I.dispatch((0,g.changeMPDone)()),U(void 0),B.ims_web_weak_mp_prod){const{commands:{temporarySendMasterPasswordChangedEvent:e}}=r.createClients().changeMasterPassword;e(void 0)}return{success:!0,response:{reason:a.ChangeMasterPasswordCode.SUCCESS}}}catch(r){if((0,h.logChangeMasterPasswordError)(M,y.ChangeMasterPasswordError.UnknownError),t.flow!==a.ChangeMPFlowPath.MP_TO_SSO&&t.flow!==a.ChangeMPFlowPath.SSO_TO_MP){const r=(0,n.extractCurrentPassword)(R,t);(0,n.revertOnError)(e,j,{currentPassword:r,serverKey:W})}else(0,n.logoutUserOnError)(e);return(0,n.makeUnexpectedErrorObject)(r.message,L)}}},713141:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleMigrationToEmailToken=void 0;const a=r(700033),o=r(632626),n=r(416593),s=r(350059),i=r(433740),c=r(46298),l=r(816356),d=r(761984);t.handleMigrationToEmailToken=async(e,t,r,u,p,S)=>{const{storeService:g,sessionService:m,masterPasswordEncryptorService:y,eventLoggerService:h}=e,{newPassword:f,flow:v,currentPassword:T}=t,{serverKey:A}=g.getUserSession(),P=g.getState(),w=(0,n.userLoginSelector)(P);if(!w)return(0,d.logChangeMasterPasswordError)(h,a.ChangeMasterPasswordError.LoginError),(0,i.makeReturnErrorObject)(o.ChangeMasterPasswordCode.UNEXPECTED_STATE,v);const b=(0,i.returnProperCryptoConfig)(g);y.setInstance({raw:f},"",b),g.dispatch((0,l.updateMasterPassword)(f)),g.dispatch((0,l.updateServerKey)("")),g.dispatch((0,l.updateRemoteKey)(null));const{authTicket:I}=(0,n.authTicketInfoSelector)(P),E=await(0,i.cipherTransactionWithNewMP)(g,m,y,r,v),C=await(0,i.cipherPrivateKey)(y,u),_={timestamp:S,transactions:(0,i.formatTransaction)(E),updateVerification:{type:"email_token"},sharingKeys:{publicKey:p,privateKey:C},authTicket:I};(0,s.emitChangeMasterPasswordStatus)({type:o.ChangeMasterPasswordStepNeeded.UPLOADING,value:95});const D=await(0,c.uploadDataForMasterPasswordChange)(g,w,_);if((0,c.isApiError)(D))return(0,d.logChangeMasterPasswordError)(h,a.ChangeMasterPasswordError.UploadError),(0,i.revertOnError)(e,y,{currentPassword:T,serverKey:A}),(0,i.makeUnexpectedErrorObject)(D.message,v);const O=await(0,c.confirmMasterPasswordChangeDone)(g,w,{});return(0,c.isApiError)(O)?((0,d.logChangeMasterPasswordError)(h,a.ChangeMasterPasswordError.ConfirmationError),(0,i.revertOnError)(e,y,{currentPassword:T,serverKey:A}),(0,i.makeUnexpectedErrorObject)(O.message,v)):(await e.applicationModulesAccess.createClients().session.commands.updateUserSessionKey({email:(0,n.userLoginSelector)(g.getState()),sessionKey:{type:"mp",masterPassword:f,secondaryKey:""}}),{success:!0,response:{reason:o.ChangeMasterPasswordCode.SUCCESS}})}},937515:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleMigrationMPtoSso=void 0;const a=r(700033),o=r(632626),n=r(751),s=r(416593),i=r(350059),c=r(433740),l=r(46298),d=r(761984);t.handleMigrationMPtoSso=async(e,t,r,u,p,S)=>{const{storeService:g,sessionService:m,remoteDataEncryptorService:y,eventLoggerService:h}=e,{newPassword:f,flow:v}=t,T=g.getState(),A=(0,s.userLoginSelector)(T);if(!A)return(0,d.logChangeMasterPasswordError)(h,a.ChangeMasterPasswordError.LoginError),(0,c.makeReturnErrorObject)(o.ChangeMasterPasswordCode.UNEXPECTED_STATE,v);const{remoteKey:P,serverKeyBase64:w}=await(0,n.prepareRemoteDataEncryptionServices)(e,f),b=[P],I={type:"sso",ssoServerKey:w},{authTicket:E}=(0,s.authTicketInfoSelector)(T),C=await(0,c.cipherTransactionWithNewMP)(g,m,y,r,v),_=await(0,c.cipherPrivateKey)(y,u),D={timestamp:S,transactions:(0,c.formatTransaction)(C),remoteKeys:b,updateVerification:I,sharingKeys:{publicKey:p,privateKey:_},authTicket:E};(0,i.emitChangeMasterPasswordStatus)({type:o.ChangeMasterPasswordStepNeeded.UPLOADING,value:95});const O=await(0,l.uploadDataForMasterPasswordChange)(g,A,D);if((0,l.isApiError)(O))return(0,d.logChangeMasterPasswordError)(h,a.ChangeMasterPasswordError.UploadError),(0,c.logoutUserOnError)(e),(0,c.makeUnexpectedErrorObject)(O.message,v);const M=await(0,l.confirmMasterPasswordChangeDone)(g,A,{});return(0,l.isApiError)(M)?((0,d.logChangeMasterPasswordError)(h,a.ChangeMasterPasswordError.ConfirmationError),(0,c.logoutUserOnError)(e),(0,c.makeUnexpectedErrorObject)(M.message,v)):(await e.applicationModulesAccess.createClients().session.commands.updateUserSessionKey({email:(0,s.userLoginSelector)(g.getState()),sessionKey:{type:"sso",ssoKey:""}}),{success:!0,response:{reason:o.ChangeMasterPasswordCode.SUCCESS}})}},522018:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleMigrationSSOtoMP=void 0;const a=r(700033),o=r(632626),n=r(416593),s=r(350059),i=r(433740),c=r(46298),l=r(816356),d=r(761984);t.handleMigrationSSOtoMP=async(e,t,r,u,p,S)=>{const{storeService:g,sessionService:m,masterPasswordEncryptorService:y,eventLoggerService:h}=e,{newPassword:f,flow:v}=t,T=g.getState(),A=(0,n.userLoginSelector)(T);if(!A)return(0,d.logChangeMasterPasswordError)(h,a.ChangeMasterPasswordError.LoginError),(0,i.makeReturnErrorObject)(o.ChangeMasterPasswordCode.UNEXPECTED_STATE,v);const P=(0,i.returnProperCryptoConfig)(g);y.setInstance({raw:f},"",P),g.dispatch((0,l.updateMasterPassword)(f)),g.dispatch((0,l.updateServerKey)("")),g.dispatch((0,l.updateRemoteKey)(null));const{authTicket:w}=(0,n.authTicketInfoSelector)(T),b=await(0,i.cipherTransactionWithNewMP)(g,m,y,r,v),I=await(0,i.cipherPrivateKey)(y,u),E={timestamp:S,transactions:(0,i.formatTransaction)(b),updateVerification:{type:"email_token"},sharingKeys:{publicKey:p,privateKey:I},authTicket:w};(0,s.emitChangeMasterPasswordStatus)({type:o.ChangeMasterPasswordStepNeeded.UPLOADING,value:95});const C=await(0,c.uploadDataForMasterPasswordChange)(g,A,E);if((0,c.isApiError)(C))return(0,d.logChangeMasterPasswordError)(h,a.ChangeMasterPasswordError.UploadError),(0,i.logoutUserOnError)(e),(0,i.makeUnexpectedErrorObject)(C.message,v);const _=await(0,c.confirmMasterPasswordChangeDone)(g,A,{});return(0,c.isApiError)(_)?((0,d.logChangeMasterPasswordError)(h,a.ChangeMasterPasswordError.ConfirmationError),(0,i.logoutUserOnError)(e),(0,i.makeUnexpectedErrorObject)(_.message,v)):(await e.applicationModulesAccess.createClients().session.commands.updateUserSessionKey({email:(0,n.userLoginSelector)(g.getState()),sessionKey:{type:"mp",masterPassword:f,secondaryKey:""}}),{success:!0,response:{reason:o.ChangeMasterPasswordCode.SUCCESS}})}},841383:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleUserChangingMP=void 0;const a=r(700033),o=r(632626),n=r(416593),s=r(350059),i=r(433740),c=r(46298),l=r(816356),d=r(761984);t.handleUserChangingMP=async(e,t,r,u,p,S)=>{const{storeService:g,sessionService:m,masterPasswordEncryptorService:y,eventLoggerService:h}=e,f=g.getState(),{newPassword:v,flow:T}=t,A=(0,i.extractCurrentPassword)(f,t),{serverKey:P}=g.getUserSession(),w=(0,n.userLoginSelector)(f);if(!w)return(0,d.logChangeMasterPasswordError)(h,a.ChangeMasterPasswordError.LoginError),(0,i.makeReturnErrorObject)(o.ChangeMasterPasswordCode.UNEXPECTED_STATE,T);y.setInstance({raw:v},P),g.dispatch((0,l.updateMasterPassword)(v));const b=await(0,i.cipherTransactionWithNewMP)(g,m,y,r),I=await(0,i.cipherPrivateKey)(y,u),E={timestamp:S,transactions:(0,i.formatTransaction)(b),sharingKeys:{publicKey:p,privateKey:I},uploadReason:T===o.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY?"complete_account_recovery":void 0};(0,s.emitChangeMasterPasswordStatus)({type:o.ChangeMasterPasswordStepNeeded.UPLOADING,value:95});const C=await(0,c.uploadDataForMasterPasswordChange)(g,w,E);if((0,c.isApiError)(C))return(0,d.logChangeMasterPasswordError)(h,a.ChangeMasterPasswordError.UploadError),(0,i.revertOnError)(e,y,{currentPassword:A,serverKey:P}),(0,i.makeUnexpectedErrorObject)(C.message,T);const _=await(0,c.confirmMasterPasswordChangeDone)(g,w,{});return(0,c.isApiError)(_)?((0,d.logChangeMasterPasswordError)(h,a.ChangeMasterPasswordError.ConfirmationError),(0,i.revertOnError)(e,y,{currentPassword:A,serverKey:P}),(0,i.makeUnexpectedErrorObject)(_.message,T)):(await e.applicationModulesAccess.createClients().session.commands.updateUserSessionKey({email:(0,n.userLoginSelector)(g.getState()),sessionKey:{type:"mp",masterPassword:v,secondaryKey:P}}),{success:!0,response:{reason:o.ChangeMasterPasswordCode.SUCCESS}})}},515209:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(735186);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},761984:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.logUserDeleteAccountRecoveryKey=t.logChangeMasterPasswordError=t.logChangeMasterPasswordComplete=t.logChangeMasterPasswordCancel=t.logChangeMasterPasswordStart=void 0;const a=r(700033),o=(e,t,r,o,n)=>{e.logEvent(new a.UserChangeMasterPasswordEvent({flowStep:t,errorName:r||void 0,isLeaked:o,isWeak:n}))};t.logChangeMasterPasswordStart=e=>o(e,a.FlowStep.Start),t.logChangeMasterPasswordCancel=e=>o(e,a.FlowStep.Cancel),t.logChangeMasterPasswordComplete=(e,t,r)=>o(e,a.FlowStep.Complete,void 0,t,r),t.logChangeMasterPasswordError=(e,t)=>o(e,a.FlowStep.Error,t),t.logUserDeleteAccountRecoveryKey=e=>{e.logEvent(new a.UserDeleteAccountRecoveryKeyEvent({deleteKeyReason:a.DeleteKeyReason.VaultKeyChanged}))}},862844:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.changeMPinProgressSelector=void 0,t.changeMPinProgressSelector=e=>e.userSession.changeMPData.changeMPinProgress},823486:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cipherPrivateKey=void 0;const a=r(956668);t.cipherPrivateKey=async(e,t)=>{const r=(0,a.utf16ToDeflatedUtf8)(t,{skipDeflate:!0});return await e.getInstance().encrypt(r)}},217696:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cipherTransactionWithNewMP=void 0;const a=r(632626),o=r(433740),n=r(127627),s=r(116859),i=r(875270),c=r(791301),l=r(655623),d=r(827517);t.cipherTransactionWithNewMP=async(e,t,r,u,p,S=!0)=>{const{announce:g}=t.getInstance().user.getSyncArgs(),m=await Promise.all(u.map((async t=>{if(p&&"SETTINGS"===t.type&&t.content){const r={...t,content:await(0,o.getBaseModelFromXml)(g,t.content)};switch(p){case a.ChangeMPFlowPath.MP_TO_SSO:const n={...r.content,CryptoUserPayload:c.CRYPTO_NODERIVATION_HMAC64};return{...r,content:(0,i.getTransactionXml)(n)};case a.ChangeMPFlowPath.SSO_TO_MP:const s={forceSalt:(0,l.getRandomValues)(16),cryptoConfig:(0,o.returnProperCryptoConfig)(e)},u=(0,o.returnProperSettingContent)(e,r,s);return e.dispatch((0,d.editPersonalSettings)(u)),{...t,content:(0,i.getTransactionXml)(u)};case a.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY:case a.ChangeMPFlowPath.ACCOUNT_RECOVERY_KEY:case a.ChangeMPFlowPath.USER_CHANGING_MP:case a.ChangeMPFlowPath.TO_EMAIL_TOKEN:}}return t}))),y=m.length,h=S?(0,o.initializeProgress)(a.ChangeMasterPasswordStepNeeded.ENCRYPTING,100,y):null,f=async(e,t)=>{h&&h(),t(await(0,s.encryptSingleTransaction)(r,e))};return await new Promise((e=>{(0,n.asyncMapLimit)(m,f,e,100)}))}},168328:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deCipherAllTransactions=void 0;const a=r(632626),o=r(883638),n=r(433740),s=r(127627),i=r(116859),c=r(582761),l=r(670252),d=r(392263);t.deCipherAllTransactions=async(e,t,r,u=!0)=>{const{announce:p}=e.getInstance().user.getSyncArgs(),S=t.getInstance(),g=r.length,m=u?(0,n.initializeProgress)(a.ChangeMasterPasswordStepNeeded.DECRYPTING,100,g):null,y=async(e,t)=>{if(m&&m(),e.content)try{const r=await(0,i.decryptTransactionContent)(S,p,e);t({...e,content:r})}catch(r){if(e.type===o.TransactionType.SETTINGS){const t=d.CarbonError.fromAnyError(r).addContextInfo("CHANGE_MP","decipherAllTransactions").addAdditionalInfo({comment:r.message??`Transaction of type ${e.type} couldn't be decrypted`});throw(0,l.sendExceptionLog)({error:t}),r}t(null)}else t(e)},h=await new Promise((e=>{(0,s.asyncMapLimit)(r,y,e,100)}));return(0,c.sanitizeTransactions)(h)}},874931:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decipherPrivateKey=void 0;const a=r(956668),o=r(816356);t.decipherPrivateKey=async(e,t,r)=>{const n=await t.getInstance().decrypt(r.privateKey),s=(0,a.deflatedUtf8ToUtf16)(n,{skipInflate:!0}),i={privateKey:s,publicKey:r.publicKey};return e.dispatch((0,o.updateKeyPair)(i)),s}},360950:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatTransaction=void 0,t.formatTransaction=e=>e.map((({action:e,content:t,identifier:r,time:a,type:o})=>({action:e,content:t,identifier:r,time:a,type:o})))},210078:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBaseModelFromXml=void 0;const a=r(80469),o=r(116859),n=r(351104);t.getBaseModelFromXml=async(e,t)=>{const r=await(0,o.parseTransactionContentXml)(e,t);return n.fixPersonalSettingTypes.fromTransaction((0,a.fixKwType)(r))}},433740:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(823486),t),o(r(217696),t),o(r(874931),t),o(r(168328),t),o(r(360950),t),o(r(210078),t),o(r(539463),t),o(r(590673),t),o(r(117433),t),o(r(899849),t),o(r(714224),t),o(r(761484),t),o(r(716494),t),o(r(255612),t),o(r(178028),t),o(r(655429),t)},539463:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initializeProgress=void 0;const a=r(632626),o=r(350059);t.initializeProgress=(e,t,r)=>{const n=e===a.ChangeMasterPasswordStepNeeded.DECRYPTING?10:50;let s=0;return()=>{s++,s%t!=0&&s!==r||(0,o.emitChangeMasterPasswordStatus)({type:e,value:n+Math.round(40*s/r)})}}},590673:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isOtpStatusValid=void 0,t.isOtpStatusValid=(e,t)=>{switch(e){case"login":return t&&t.length>0;case"disabled":case"newDevice":return!t||0===t.length;default:return!1}}},117433:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.logoutUserOnError=void 0;const a=r(216194),o=r(301965),n=r(416593);t.logoutUserOnError=async e=>{const{storeService:t,storageService:r,sessionService:s,applicationModulesAccess:i}=e,c=(0,n.userLoginSelector)(t.getState());t.dispatch((0,a.changeMPDone)()),c&&(0,o.wipeOutLocalAccounts)(r,i,[c]),s.close()}},899849:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeReturnErrorObject=void 0;const a=r(632626),o=r(350059),n=r(670252);t.makeReturnErrorObject=(e,t)=>{(0,o.emitChangeMasterPasswordStatus)({type:a.ChangeMasterPasswordStepNeeded.ERROR,value:100});const r=new Error(`[ChangeMP] ${t}: ${e}`);return(0,n.sendExceptionLog)({error:r}),{success:!1,error:{code:e}}}},714224:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeUnexpectedErrorObject=void 0;const a=r(632626),o=r(670252);t.makeUnexpectedErrorObject=(e,t)=>{const r=new Error(`[ChangeMP] - Unexpected - ${t}: ${e}`);return(0,o.sendExceptionLog)({error:r}),{success:!1,error:{code:a.ChangeMasterPasswordCode.UNKNOWN_ERROR,message:e}}}},761484:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.preValidationForChangeMP=t.extractCurrentPassword=void 0;const a=r(632626),o=r(361380),n=r(357903),s=r(664948),i=r(416593),c=r(429303),l=r(288205),d=r(433740),u=r(628287),p=r(771012);t.extractCurrentPassword=(e,t)=>t.flow===a.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY?(0,c.recoveryDataSelector)(e).currentPassword:t.currentPassword,t.preValidationForChangeMP=async(e,t)=>{const{applicationModulesAccess:r,masterPasswordEncryptorService:c,storeService:S}=e,{newPassword:g,flow:m}=t;if(!await(0,n.waitUntilSyncComplete)(S))return(0,d.makeReturnErrorObject)(a.ChangeMasterPasswordCode.SYNC_PROGRESS,m);const y=S.getState(),h=await(0,l.makeFeatureFlipsSelectors)(r).featureFlipsSelector();if(!S.getAccountInfo().isAuthenticated)return(0,d.makeReturnErrorObject)(a.ChangeMasterPasswordCode.INNACTIVE_SESSION,m);if(h[o.CHANGEMP_WEB_BLOCKED_FEATURE_FLIP])return(0,d.makeReturnErrorObject)(a.ChangeMasterPasswordCode.FEATURE_BLOCKED,m);const f=await(0,s.evaluatePasswordStrengthOutOfFive)(g);if(!g||!f||f<p.minAcceptablePasswordStrength)return(0,d.makeReturnErrorObject)(a.ChangeMasterPasswordCode.MP_STRENGTH_ERROR,m);const v=(0,i.isRemoteKeyActivatedSelector)(y),T=9e5,{authTicket:A,date:P}=(0,i.authTicketInfoSelector)(y);if(!(0,i.userLoginSelector)(y))return(0,d.makeReturnErrorObject)(a.ChangeMasterPasswordCode.UNEXPECTED_STATE,m);switch(t.flow){case a.ChangeMPFlowPath.MP_TO_SSO:if(!A||!P||Date.now()-P>T)return(0,d.makeReturnErrorObject)(a.ChangeMasterPasswordCode.INVALID_TOKEN,m);if(v)return(0,d.makeReturnErrorObject)(a.ChangeMasterPasswordCode.UNEXPECTED_STATE,m);break;case a.ChangeMPFlowPath.SSO_TO_MP:if(!A||!P||Date.now()-P>T)return(0,d.makeReturnErrorObject)(a.ChangeMasterPasswordCode.INVALID_TOKEN,m);if(!v)return(0,d.makeReturnErrorObject)(a.ChangeMasterPasswordCode.UNEXPECTED_STATE,m);break;case a.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY:break;case a.ChangeMPFlowPath.TO_EMAIL_TOKEN:case a.ChangeMPFlowPath.USER_CHANGING_MP:case a.ChangeMPFlowPath.ACCOUNT_RECOVERY_KEY:{const{currentPassword:e}=t;if(m!==a.ChangeMPFlowPath.ACCOUNT_RECOVERY_KEY&&e===g)return(0,d.makeReturnErrorObject)(a.ChangeMasterPasswordCode.MP_ERROR,m);if(!await(0,u.validateMasterPassword)(S,c,e))return(0,d.makeReturnErrorObject)(a.ChangeMasterPasswordCode.WRONG_PASSWORD,m)}break;default:return(0,d.makeReturnErrorObject)(a.ChangeMasterPasswordCode.UNEXPECTED_STATE,m)}return{success:!0}}},716494:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetMigrationState=void 0;const a=r(632626),o=r(195363),n=r(807624);t.resetMigrationState=async(e,t)=>{if(t===a.ChangeMPFlowPath.USER_CHANGING_MP||t===a.ChangeMPFlowPath.TO_EMAIL_TOKEN||t===a.ChangeMPFlowPath.ACCOUNT_RECOVERY_KEY)return;const{storeService:r}=e;r.dispatch((0,o.resetRecoverySessionData)()),r.dispatch((0,n.resetSSOSettings)()),t===a.ChangeMPFlowPath.MP_TO_SSO&&r.dispatch((0,n.storeSSOSettings)({ssoUser:!0}))}},255612:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.returnProperCryptoConfig=void 0;const a=r(956668),o=r(65675),n=r(692310);t.returnProperCryptoConfig=e=>{let t=a.ARGON2_DEFAULT_PAYLOAD;const r=(0,n.currentSpaceInfoSelector)(e.getState());r?.cryptoForcedPayload&&(t=r.cryptoForcedPayload);try{return(0,o.parsePayload)(t).cryptoConfig}catch(e){return(0,o.makeFlexibleMarkerCryptoConfig)("argon2d")}}},178028:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.returnProperSettingContent=void 0;const a=r(956668),o=r(316038),n=r(895648),s=r(692310);t.returnProperSettingContent=(e,t,r)=>{let i=a.ARGON2_DEFAULT_PAYLOAD;const c=(0,s.currentSpaceInfoSelector)(e.getState());return c?.cryptoForcedPayload&&(i=c.cryptoForcedPayload),{...(0,n.makeBasePersonalSettings)(),...t.content,CryptoUserPayload:i,CryptoFixedSalt:(0,o.bufferToBase64)(r.forceSalt)}}},655429:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.revertOnError=void 0;const a=r(216194),o=r(816356);t.revertOnError=async(e,t,r)=>{const{currentPassword:n,serverKey:s}=r,{storeService:i}=e;t.setInstance({raw:n},s),i.dispatch((0,o.updateMasterPassword)(n)),i.dispatch((0,o.updateServerKey)(s)),i.dispatch((0,a.changeMPDone)())}},361380:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CHANGEMP_WEB_BLOCKED_FEATURE_FLIP=void 0,t.CHANGEMP_WEB_BLOCKED_FEATURE_FLIP="disableChangeMpOnWeb"},620849:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToDebugEvents=void 0;const a=r(795623),o=e=>(t,r)=>{const{message:a,details:o={}}=r;t[e]({date:(new Date).toJSON(),message:a,optionalParams:Object.keys(o).reduce(((e,t)=>[...e,o[t]]),[])})};t.subscribeToDebugEvents=function(e){(0,a.redirectConsoleLogs)((t=>{const{level:r=a.LogLevel.Debug}=t;(e=>{switch(e){case a.LogLevel.Error:return o("error");case a.LogLevel.Warn:return o("warning");case a.LogLevel.Info:return o("info");case a.LogLevel.Debug:case a.LogLevel.Verbose:default:return o("log")}})(r)(e,t)}))}},644273:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToDiagnosticEvents=void 0;let r=null;t.subscribeToDiagnosticEvents=function(e){r=e,e.decipheringDiagnosticLogEvent.on((e=>e))},t.default=function(){return r}},339947:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.carbonE2EConnector=void 0;const a=r(330504);t.carbonE2EConnector={registerFreeTrial:(0,a.slot)(),getTeamTokens:(0,a.slot)(),confirmFreeTrial:(0,a.slot)(),getPremiumStatus:(0,a.slot)(),proposeMembers:(0,a.slot)(),acceptTeamInvite:(0,a.slot)(),getTokenForTestUser:(0,a.slot)(),getServiceProviderToken:(0,a.slot)(),createOrUpdateDarkWebBreach:(0,a.slot)(),addPrivateBreach:(0,a.slot)(),createPublicBreach:(0,a.slot)(),forceBreachRefresh:(0,a.slot)(),getUserCryptoPayload:(0,a.slot)()}},758427:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToE2EEvents=void 0;const a=r(803674),o=r(17338),n=r(937864),s=r(871602),i=r(732006),c=r(79734);t.subscribeToE2EEvents=function(e,t){const r=(0,o.getCoreServices)(t),l=(0,a.makeTeamAdminController)(r.storeService,r.wsService);e.registerFreeTrial.on(l.registerFreeTrial),e.getTeamTokens.on(l.getTeamTokens),e.confirmFreeTrial.on(l.confirmFreeTrial),e.getPremiumStatus.on(l.getPremiumStatus),e.proposeMembers.on(l.proposeMembers),e.acceptTeamInvite.on(l.acceptTeamInvite),e.getTokenForTestUser.on((e=>(0,n.getTokenForKwUser)(r,e))),e.getServiceProviderToken.on((e=>(0,s.getServiceProviderToken)(r,e))),e.createOrUpdateDarkWebBreach.on((e=>(0,c.createOrUpdateDarkWebBreachHelper)(r,e))),e.addPrivateBreach.on((e=>(0,c.addPrivateBreachHelper)(r,e))),e.createPublicBreach.on((e=>(0,c.createPublicBreachHelper)(r,e))),e.forceBreachRefresh.on((()=>{(0,i.forceBreachRefreshHandler)(r)})),e.getUserCryptoPayload.on((()=>r.storeService.getPersonalSettings().CryptoUserPayload))}},730855:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToE2EEvents=t.carbonE2EConnector=void 0;var a=r(339947);Object.defineProperty(t,"carbonE2EConnector",{enumerable:!0,get:function(){return a.carbonE2EConnector}});var o=r(758427);Object.defineProperty(t,"subscribeToE2EEvents",{enumerable:!0,get:function(){return o.subscribeToE2EEvents}})},319697:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setEventBus=void 0;let r=null;t.setEventBus=e=>{r=e},t.default=function(){return r}},339421:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setEventBus=void 0;let r=null;t.setEventBus=e=>{r=e},t.default=function(){return r}},444242:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToMaverickEvents=void 0;const a=r(319065),o=r(17338),n=r(538865),s=r(339421);t.subscribeToMaverickEvents=function(e,t){(0,s.setEventBus)(e);const r=(0,o.getCoreServices)(t),i=(0,a.makeDataManagementController)(r);e.savePersonalDataItem.on((e=>{i.savePersonalDataItem(e)})),e.filledDataItem.on((e=>i.updateMetadataItemFilledOnPage(e.id,e.url,e.dataType))),e.updateWebOnboardingMode.on((e=>(0,n.updateWebOnboardingMode)(r.storeService,r.sessionService,e)))}},721726:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setEventBus=void 0;let r=null;t.setEventBus=e=>{r=e},t.default=function(){return r}},804798:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToExtensionEvents=void 0;const a=r(802246),o=r(290622),n=r(670252),s=r(538865),i=r(25576),c=r(17338),l=r(405464),d=r(188610),u=r(721726);t.subscribeToExtensionEvents=function(e,t){(0,u.setEventBus)(e);const r=(0,c.getCoreServices)(t),{storeService:p,storageService:S}=r,g=(0,d.makeLoginController)(r),m=(0,l.makeSessionController)(r);e.getAccountInfo.on((()=>m.getAndTriggerRefreshAccountInfo())),e.getDevicesList.on((()=>m.getDevicesList().then((e=>({devicesList:e}))))),e.getLocalAccountsList.on((()=>(0,o.getLocalAccounts)(p,S).then((e=>({localAccounts:e}))))),e.getAnonymousLogsMetadata.on((()=>({anonymouscomputerid:(0,a.getCommonAppSetting)("anonymousComputerId")}))),e.askWebsiteInfo.on((({fullUrl:e})=>m.askWebsiteInfo(e))),e.deactivateDevice.on((e=>{m.deactivateDevice(e.deviceId)})),e.changeDeviceName.on((e=>{m.changeDeviceName(e.deviceId,e.updatedName)})),e.checkIfMasterPasswordIsValid.on((e=>m.validateMasterPassword(e.masterPassword).then((e=>({isMasterPasswordValid:e}))))),e.closeSession.on((()=>m.closeSession())),e.lockSession.on((()=>m.lockSession())),e.openSession.on((({login:e,password:t})=>g.openSession(e,{password:t}))),e.openSessionWithToken.on((({login:e,password:t,token:r,persistData:a,deviceName:o})=>{g.openSessionWithToken(e,t,r,a?i.PersistData.PERSIST_DATA_YES:i.PersistData.PERSIST_DATA_NO,o)})),e.openSessionWithDashlaneAuthenticator.on((({login:e,password:t,persistData:r,deviceName:a})=>{g.openSessionWithDashlaneAuthenticator(e,t,r?i.PersistData.PERSIST_DATA_YES:i.PersistData.PERSIST_DATA_NO,a)})),e.cancelDashlaneAuthenticatorRegistration.on((()=>{g.cancelDashlaneAuthenticatorRegistration()})),e.openSessionResendToken.on((e=>{g.openSessionResendToken(e.login)})),e.openSessionWithOTP.on((e=>{g.openSessionWithOTP(e.login,e.password,e.otp)})),e.openSessionWithOTPForNewDevice.on((({login:e,password:t,otp:r,persistData:a,deviceName:o})=>{g.openSessionWithOTPForNewDevice(e,t,r,a?i.PersistData.PERSIST_DATA_YES:i.PersistData.PERSIST_DATA_NO,o)})),e.openSessionWithMasterPassword.on((e=>{g.openSessionWithMasterPassword(e.login,e.password,{rememberMasterPassword:e.rememberPassword,serverKey:e.serverKey,loginType:e.loginType})})),e.openExtraDeviceSession.on((e=>{g.openExtraDeviceSession(e.login,{password:e.password,serverKey:e.serverKey})})),e.openSessionWithExtraDeviceToken.on((e=>g.openSessionWithExtraDeviceToken(e.login,e.extraDeviceToken,e.persistData?i.PersistData.PERSIST_DATA_YES:i.PersistData.PERSIST_DATA_NO,{password:e.password,deviceName:e.deviceName}))),e.sessionForceSync.on((e=>{m.sessionForceSync(e.trigger)})),e.updateWebOnboardingMode.on((e=>{s.updateWebOnboardingMode(r.storeService,r.sessionService,e)})),e.exceptionLog.on((e=>(0,n.sendTypedExceptionLog)("extensionException",e)))}},175391:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToLeelooEvents=void 0;const a=r(871703),o=r(670252),n=r(25576),s=r(290622),i=r(17338),c=r(405464),l=r(538865),d=r(188610),u=r(515444),p=r(803674),S=r(263623),g=r(358415),m=r(97124),y=r(633332),h=r(958639),f=r(589675),v=r(319065),T=r(319697);t.subscribeToLeelooEvents=function(e,t){(0,T.setEventBus)(e);const r=(0,i.getCoreServices)(t),{applicationModulesAccess:A,storeService:P,localStorageService:w,wsService:b,sessionService:I,storageService:E}=r,C=(0,a.makeAccountCreationController)(r),_=(0,c.makeSessionController)(r),D=(0,d.makeLoginController)(r),O=(0,v.makeDataManagementController)(r),M=(0,u.makeRecoveryController)(P,b),N=(0,f.makeSettingsController)(P,b),F=(0,p.makeTeamAdminController)(P,b),U=(0,m.makeSharingService)(P,b),L=(0,g.makeDirectorySyncController)({storeService:P,localStorageService:w,wsService:b,sessionService:I,sharingService:U}),k=(0,y.makeStaticDataController)();e.getUki.on((()=>_.getUki())),e.savePaymentCard.on((e=>{O.savePaymentCardFromClient(e)})),e.savePersonalDataItem.on((e=>O.savePersonalDataItem(e))),e.removePersonalDataItem.on((e=>O.removePersonalDataItem(e.id))),e.getAccountInfo.on((()=>_.getAndTriggerRefreshAccountInfo())),e.getDevicesList.on((()=>_.getDevicesList().then((e=>({devicesList:e}))))),e.getLocalAccountsList.on((()=>(0,s.getLocalAccounts)(P,E).then((e=>({localAccounts:e}))))),e.getTemporaryToken.on((()=>_.getTemporaryToken().then((e=>({temporaryToken:e}))))),e.deactivateDevice.on((e=>{_.deactivateDevice(e.deviceId)})),e.changeDeviceName.on((e=>{_.changeDeviceName(e.deviceId,e.updatedName)})),e.cancelPremiumSubscription.on((()=>_.cancelPremiumSubscription())),e.getInvoices.on((()=>_.getInvoices().then((e=>({invoices:e}))))),e.closeSession.on((()=>_.closeSession())),e.lockSession.on((()=>_.lockSession())),e.resumeSession.on((()=>_.resumeSession())),e.getPersonalSettings.on((()=>_.getPersonalSettings().then((e=>e)))),e.openSession.on((({login:e,password:t})=>D.openSession(e,{password:t}))),e.openSessionWithToken.on((({login:e,password:t,token:r,persistData:a,deviceName:o})=>{D.openSessionWithToken(e,t,r,a?n.PersistData.PERSIST_DATA_YES:n.PersistData.PERSIST_DATA_NO,o)})),e.openSessionWithDashlaneAuthenticator.on((({login:e,password:t,persistData:r,deviceName:a})=>{D.openSessionWithDashlaneAuthenticator(e,t,r?n.PersistData.PERSIST_DATA_YES:n.PersistData.PERSIST_DATA_NO,a)})),e.cancelDashlaneAuthenticatorRegistration.on((()=>{D.cancelDashlaneAuthenticatorRegistration()})),e.openSessionResendToken.on((e=>{D.openSessionResendToken(e.login)})),e.openSessionWithOTP.on((e=>{D.openSessionWithOTP(e.login,e.password,e.otp,void 0,e.withBackupCode)})),e.openSessionWithOTPForNewDevice.on((({login:e,password:t,otp:r,persistData:a,deviceName:o,withBackupCode:s})=>{D.openSessionWithOTPForNewDevice(e,t,r,a?n.PersistData.PERSIST_DATA_YES:n.PersistData.PERSIST_DATA_NO,o,s)})),e.openSessionWithMasterPassword.on((e=>D.openSessionWithMasterPassword(e.login,e.password,{rememberMasterPassword:e.rememberPassword,requiredPermissions:e.requiredPermissions,serverKey:e.serverKey,loginType:e.loginType}))),e.openExtraDeviceSession.on((e=>{D.openExtraDeviceSession(e.login,{password:e.password,serverKey:e.serverKey})})),e.openSessionWithExtraDeviceToken.on((e=>D.openSessionWithExtraDeviceToken(e.login,e.extraDeviceToken,e.persistData?n.PersistData.PERSIST_DATA_YES:n.PersistData.PERSIST_DATA_NO,{password:e.password,deviceName:e.deviceName}))),e.sessionForceSync.on((e=>_.sessionForceSync(e.trigger))),e.exceptionLog.on((e=>(0,o.sendTypedExceptionLog)("leelooException",e))),e.teamUpdated.on((e=>F.teamUpdateHandler(e).then((e=>({errors:e}))))),e.createUserGroup.on((e=>F.createUserGroupAction(I,e))),e.deleteUserGroup.on((e=>F.deleteUserGroupAction(e))),e.renameUserGroup.on((e=>F.renameUserGroupAction(e))),e.inviteUserGroupMembers.on((e=>F.inviteUserGroupMembersAction(e))),e.revokeUserGroupMembers.on((e=>F.revokeUserGroupMembersAction(e))),e.updateUserGroupMembers.on((e=>F.updateUserGroupMembersAction(e))),e.createAccountStep1.on((e=>C.createAccount(e))),e.createAccountStep2.on((e=>C.confirmAccountCreation(e))),e.checkLogin.on((e=>C.checkLogin(e))),e.getMasterPasswordResetDemandList.on((e=>M.getMasterPasswordResetDemandList(e))),e.acceptMasterPasswordResetDemand.on((e=>M.acceptMasterPasswordResetDemand(e))),e.checkIfMasterPasswordIsValid.on((e=>_.validateMasterPassword(e.masterPassword).then((e=>({isMasterPasswordValid:e}))))),e.declineMasterPasswordResetDemand.on((e=>M.declineMasterPasswordResetDemand(e))),e.getMembers.on((e=>F.getMembers(e))),e.addTeamAdmin.on((e=>F.addTeamAdmin(e))),e.removeTeamAdmin.on((e=>F.removeTeamAdmin(e))),e.setTeamSettings.on((e=>N.setTeamSettings(e))),e.updateWebOnboardingMode.on((e=>l.updateWebOnboardingMode(P,I,e))),e.checkDirectorySyncKeyResponse.on((e=>{const{teamId:t,publicKey:r,requestId:a,response:o}=e;"validated"===o?L.keyValidatedByTacAdmin(t,r):"rejected"===o&&L.keyRejectedByTacAdmin(t,a)})),e.queryStaticDataCollections.on((e=>k.query(e))),e.sendSharingResponse.on((e=>(0,S.handleSharingResponse)(A,P,I,e))),e.getDataModel.on((()=>(0,h.getDataUpdates)(P).obfuscatedPersonalDataToSend)),e.getSharingSync.on((()=>P.getState().userSession.sharingSync)),e.getSharingData.on((()=>P.getSharingData())),e.revokeSharing.on((({itemGroupId:e,recipient:t})=>(0,S.handleRevokeSharing)(A,P,I,b,e,t))),e.updateSharingPermission.on((({itemGroupId:e,recipient:t,permission:r})=>(0,S.handleUpdateSharingPermission)(P,I,b,e,t,r))),e.setPendingElementsAsSeen.on((e=>(0,S.setPendingElementsAsSeen)(P,w,e))),e.isUserLastAdminOnItem.on((e=>(0,S.isUserLastAdminOnItem)(P,e))),e.doesUserReceiveItemViaGroup.on((e=>(0,S.doesUserReceiveItemViaGroup)(P,e)))}},349267:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(475653),o=r(357193);t.config={commands:{changeUserCrypto:{handler:o.changeUserCrypto}},queries:{getCanUserChangeCrypto:{selector:a.canUserSelectCryptoSelector},getUserDerivationMethod:{selector:a.userDerivationMethodSelector}},liveQueries:{liveUserDerivationMethod:{operator:a.userDerivationMethodSelector$}}}},821344:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const a=r(349267);t.bootstrap=e=>{e.register(a.config)}},221583:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(821344);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},475653:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.userDerivationMethodSelector$=t.userDerivationMethodSelector=t.canUserSelectCryptoSelector=t.teamCryptoForcedPayloadSelector=t.hasCryptoMigrationPhase2EnabledSelector=t.hasCryptoMigrationPhase1EnabledSelector=void 0;const a=r(518948),o=r(903343),n=r(632626),s=r(807944),i=r(288205),c=r(65675),l=r(416593);t.hasCryptoMigrationPhase1EnabledSelector=async e=>(await(0,i.makeFeatureFlipsSelectors)(e.applicationModulesAccess).featureFlipsSelector()).itadmin_SAEX_CryptoMigration_Phase1,t.hasCryptoMigrationPhase2EnabledSelector=async e=>(await(0,i.makeFeatureFlipsSelectors)(e.applicationModulesAccess).featureFlipsSelector()).itadmin_SAEX_CryptoMigration_Phase2,t.teamCryptoForcedPayloadSelector=e=>{const t=(0,s.activeSpacesSelector)(e)[0];return t?.details.info.cryptoForcedPayload??""},t.canUserSelectCryptoSelector=e=>!(0,t.teamCryptoForcedPayloadSelector)(e),t.userDerivationMethodSelector=e=>{switch((0,l.userDefaultCryptoSelector)(e)){case c.ARGON2_DEFAULT_PAYLOAD:return n.SupportedDerivationMethods.ARGON2D;case c.PBKDF2_DEFAULT_PAYLOAD:return n.SupportedDerivationMethods.PBKDF2;case c.KWC3_DEFAULT_PAYLOAD:return n.SupportedDerivationMethods.KWC3;default:return null}},t.userDerivationMethodSelector$=()=>(0,a.pipe)((0,o.map)(t.userDerivationMethodSelector),(0,o.distinctUntilChanged)())},357193:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.changeUserCrypto=void 0;const a=r(700033),o=r(355696),n=r(748238);t.changeUserCrypto=async function(e,{newDerivationMethod:t}){const{storeService:r}=e,s=r.getPersonalSettings().CryptoUserPayload,i=(0,n.getNewCryptoPayload)(t);if(!i)throw new Error(`[changeUserCrypto] - client sent wrong derivation value (${t})`);return await(0,o.migrateUserCrypto)(e,s,i,a.CryptoMigrationType.SettingsChange)}},177965:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decryptAllTransactions=void 0;const a=r(116859),o=r(883638);t.decryptAllTransactions=async function(e,t,r){const{announce:n}=r.getInstance().user.getSyncArgs(),s=e.map((async e=>({...e,content:await(0,a.decryptTransactionContent)(t.getInstance(),n,e).catch((t=>{if(e.type!==o.TransactionType.SETTINGS)return"";throw t}))})));return(await Promise.all(s)).filter((e=>!!e.content))}},909027:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decryptAllUserData=void 0;const a=r(433740),o=r(177965);t.decryptAllUserData=async function(e,t,r,{transactions:n,sharingKeys:s}){try{return{clearTransactions:await(0,o.decryptAllTransactions)(n,r,e),clearPrivateKey:await(0,a.decipherPrivateKey)(t,r,s)}}catch(e){throw new Error(`decipherAllUserData failed with error: ${e}`)}}},373909:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDataToMigrate=void 0;const a=r(700033),o=r(46298),n=r(416593);t.getDataToMigrate=async function(e,t){try{const t=e.getState(),r=(0,n.userLoginSelector)(t),a=await(0,o.getDataForMasterPasswordChange)(e,r,{});if((0,o.isApiError)(a))throw new Error(`getDataDoMigrate failed with error: ${a}`);return{transactions:a.data.transactions,sharingKeys:a.data.sharingKeys,timestamp:a.timestamp}}catch(e){throw t(a.CryptoMigrationStatus.ErrorDownload),new Error(`getDataDoMigrate failed with error: ${e}`)}}},748238:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getNewCryptoPayload=void 0;const a=r(632626),o=r(65675);t.getNewCryptoPayload=function(e){switch(e){case a.SupportedDerivationMethods.ARGON2D:return o.ARGON2_DEFAULT_PAYLOAD;case a.SupportedDerivationMethods.PBKDF2:return o.PBKDF2_DEFAULT_PAYLOAD;case a.SupportedDerivationMethods.KWC3:return o.KWC3_DEFAULT_PAYLOAD;default:return}}},318767:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reEncryptAllUserData=void 0;const a=r(700033),o=r(433740),n=r(116859);t.reEncryptAllUserData=async function(e,{clearTransactions:t,clearPrivateKey:r},s){try{const a=t.map((t=>(0,n.encryptSingleTransaction)(e,t)));return{encryptedTransactions:await Promise.all(a),encryptedPrivateKey:await(0,o.cipherPrivateKey)(e,r)}}catch(e){throw s(a.CryptoMigrationStatus.ErrorReencryption),new Error(`reEncryptAllUserData failed with error: ${e}`)}}},246076:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetMasterPasswordEncryptorService=void 0;const a=r(65675),o=r(416593);t.resetMasterPasswordEncryptorService=function(e,t){const{storeService:r,masterPasswordEncryptorService:n}=e,s=r.getState(),i=(0,o.masterPasswordSelector)(s),c=(0,o.serverKeySelector)(s),l=t===a.KWC3_DEFAULT_PAYLOAD?(0,a.getLegacyCryptoConfig)(t):(0,a.parsePayload)(t).cryptoConfig;n.setInstance({raw:i},c,l)}},836116:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateAndPersistLocalData=void 0;const a=r(700033),o=r(316038),n=r(655623),s=r(827517);t.updateAndPersistLocalData=async function(e,t,r,i,c){try{e.dispatch((0,s.editPersonalSettings)({CryptoUserPayload:i,CryptoFixedSalt:(0,o.bufferToBase64)((0,n.getRandomValues)(16))})),await t.getInstance().user.persistPersonalSettings();const a=await r.getInstance().getLocalKey();await t.getInstance().user.persistLocalKey(a)}catch(e){throw c(a.CryptoMigrationStatus.ErrorUpdateLocalData),new Error(`updateAndPersistLocalData failed with error: ${e}`)}}},334726:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.uploadDataOnServer=void 0;const a=r(700033),o=r(433740),n=r(46298),s=r(469214),i=r(416593);t.uploadDataOnServer=async function(e,t,r){try{const r=e.getState(),a=(0,i.userLoginSelector)(r),c={...t,transactions:(0,o.formatTransaction)(t.transactions)},l=await(0,s.uploadDataForCryptoChange)(e,a,c);if((0,n.isApiError)(l))throw new Error(`uploadDataForCryptoChange failed with error: ${l}`)}catch(e){throw r(a.CryptoMigrationStatus.ErrorUpload),new Error(`uploadDataForCryptoChange failed with error: ${e}`)}}},355696:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.migrateUserCrypto=void 0;const a=r(700033),o=r(632626),n=r(65675),s=r(670252),i=r(357903),c=r(909027),l=r(373909),d=r(318767),u=r(246076),p=r(836116),S=r(334726),g={[n.KWC3_DEFAULT_PAYLOAD]:a.CryptoAlgorithm.Kwc3,[n.ARGON2_DEFAULT_PAYLOAD]:a.CryptoAlgorithm.Argon2d,[n.PBKDF2_DEFAULT_PAYLOAD]:a.CryptoAlgorithm.Pbkdf2};t.migrateUserCrypto=async function(e,t,r,n){try{const{sessionService:s,storeService:m,masterPasswordEncryptorService:y,localStorageService:h,eventLoggerService:f}=e;if(!await(0,i.waitUntilSyncComplete)(m))return{success:!1,error:{code:o.CryptoMigrationApiErrorType.ChangeUserCryptoFailed}};const v=e=>f.logEvent(new a.UserMigrateCryptoEvent({newCrypto:g[r],previousCrypto:g[t],type:n,status:e})),{transactions:T,sharingKeys:A,timestamp:P}=await(0,l.getDataToMigrate)(m,v),{clearTransactions:w,clearPrivateKey:b}=await(0,c.decryptAllUserData)(s,m,y,{transactions:T,sharingKeys:A});(0,u.resetMasterPasswordEncryptorService)(e,r);const{encryptedTransactions:I,encryptedPrivateKey:E}=await(0,d.reEncryptAllUserData)(y,{clearTransactions:w,clearPrivateKey:b},v);return await(0,S.uploadDataOnServer)(m,{timestamp:P,transactions:I,sharingKeys:{publicKey:A.publicKey,privateKey:E}},v),await(0,p.updateAndPersistLocalData)(m,s,h,r,v),await s.getInstance().user.attemptSync(a.Trigger.SettingsChange),v(a.CryptoMigrationStatus.Success),{success:!0}}catch(r){return(0,u.resetMasterPasswordEncryptorService)(e,t),(0,s.sendExceptionLog)({funcName:"migrateUserCrypto",fileName:"/carbon/src/CryptoMigration/services/migrate-user-crypto.ts",message:`Migration from KWC3 to Argon2 failed with error: ${r}`}),{success:!1,error:{code:o.CryptoMigrationApiErrorType.ChangeUserCryptoFailed,message:r.message}}}}},663549:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const a=r(355696),o=r(700033),n=r(475653),s=r(65675),i=r(416593);t.setupSubscriptions=function(e,t){e.sessionOpened.on((()=>{const{storeService:e}=t,r=e.getState(),c=(0,n.hasCryptoMigrationPhase1EnabledSelector)(t),l=(0,n.hasCryptoMigrationPhase2EnabledSelector)(t),d=(0,n.teamCryptoForcedPayloadSelector)(r),u=(0,i.userDefaultCryptoSelector)(r);!c||d||u!==s.KWC3_DEFAULT_PAYLOAD?l&&d&&d!==u&&(0,a.migrateUserCrypto)(t,u,d,o.CryptoMigrationType.TeamEnforced):(0,a.migrateUserCrypto)(t,s.KWC3_DEFAULT_PAYLOAD,s.ARGON2_DEFAULT_PAYLOAD,o.CryptoMigrationType.MigrateLegacy)}))}},844812:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(252921),o=r(331858);t.config={commands:{getDarkWebInsightsReportResults:{handler:a.getDarkWebInsightsReportResults},getDarkWebInsightsSummary:{handler:o.getDarkWebInsightsSummary}},queries:{},liveQueries:{}}},101945:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const a=r(844812);t.bootstrap=e=>{e.register(a.config)}},976592:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(101945);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},252921:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDarkWebInsightsReportResults=void 0;const a=r(632626),o=r(416593),n=r(46298),s=r(682512);t.getDarkWebInsightsReportResults=async function(e,t){const{storeService:r}=e,i=r.getState(),c=(0,o.userLoginSelector)(i),l=await(0,s.getDarkWebInsightReport)(r,c,t);return(0,n.isApiError)(l)?{success:!1,error:{code:a.DarkWebInsightsApiErrorType.GetDarkWebInsightsFailed,message:`get Dark Web Insights Report failed: ${l.message}`}}:{success:!0,data:l}}},331858:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDarkWebInsightsSummary=void 0;const a=r(632626),o=r(416593),n=r(46298),s=r(319667);t.getDarkWebInsightsSummary=async function(e){const{storeService:t}=e,r=t.getState(),i=(0,o.userLoginSelector)(r),c=await(0,s.getDarkWebInsightsSummaryRequest)(t,i);return(0,n.isApiError)(c)?{success:!1,error:{code:a.DarkWebInsightsApiErrorType.GetDarkWebInsightsSummaryFailed,message:`get Dark Web Insights Summary failed: ${c.message}`}}:{success:!0,data:c}}},252578:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isCredentialSmartCategorized=t.isSpaceQuarantined=void 0;const a=r(421178),o=r(106205);t.isSpaceQuarantined=function(e){return!!e&&!("accepted"===e.details.status.toLowerCase()||!e.details.info)&&Boolean(e.details.info.forcedDomainsEnabled)&&Boolean(e.details.info.removeForcedContentEnabled)},t.isCredentialSmartCategorized=function(e,t){if(!e)return!1;let r="";if(e.Url){const t=new a.ParsedURL(e.Url).getRootDomain();r=t?t.toLowerCase():""}const n=e.Email?e.Email.toLowerCase():"",s=e.Login?e.Login.toLowerCase():"",i=e.SecondaryLogin?e.SecondaryLogin.toLowerCase():"",c=(0,o.getUserAddedLinkedWebsiteDomains)(e).map((e=>e.toLowerCase()));return t.filter((e=>{const t=e.toLowerCase();return r.includes(t)||n.includes(t)||s.includes(t)||i.includes(t)||c.some((e=>e.includes(t)))})).length>0}},276235:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(404914),o=r(143837),n=r(502946),s=r(913648),i=r(215141),c=r(402282),l=r(481911),d=r(808453),u=r(868728),p=r(717025),S=r(857718),g=r(775912),m=r(880818),y=r(497321),h=r(280529),f=r(460309),v=r(345665),T=r(674172),A=r(302105),P=r(711230),w=r(616458);t.config={commands:{...w.vaultConfig.commands,...a.config.commands,...o.config.commands,...n.config.commands,...s.config.commands,...g.config.commands,...i.config.commands,...y.config.commands,...c.config.commands,...P.importApiConfig.commands,...m.config.commands,...l.config.commands,...d.config.commands,...u.config.commands,...p.config.commands,...A.config.commands,...h.config.commands,...T.config.commands,...f.config.commands,...S.config.commands},queries:{...w.vaultConfig.queries,...a.config.queries,...n.config.queries,...g.config.queries,...y.config.queries,...P.importApiConfig.queries,...m.config.queries,...l.config.queries,...u.config.queries,...p.config.queries,...A.config.queries,...h.config.queries,...f.config.queries,...v.config.queries},liveQueries:{...a.config.liveQueries,...n.config.liveQueries,...y.config.liveQueries,...P.importApiConfig.liveQueries,...m.config.liveQueries,...l.config.liveQueries,...u.config.liveQueries,...p.config.liveQueries,...A.config.liveQueries,...h.config.liveQueries,...f.config.liveQueries}}},314369:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getNewBankAccount=void 0;const a=r(292882),o=r(500053),n=r(278320);t.getNewBankAccount=e=>{const t=(0,o.getUnixTimestamp)();return{kwType:"KWBankStatement",Id:(0,n.generateItemUuid)(),LastBackupTime:0,LocaleFormat:(0,a.defaultToUS)(e.country),AnonId:(0,n.generateItemUuid)(),SpaceId:(0,a.defaultToEmptyString)(e.spaceId),CreationDatetime:t,UserModificationDatetime:t,BankAccountName:(0,a.defaultToEmptyString)(e.name),BankAccountOwner:(0,a.defaultToEmptyString)(e.owner),BankAccountIBAN:(0,a.defaultToEmptyString)(e.IBAN),BankAccountBIC:(0,a.defaultToEmptyString)(e.BIC),BankAccountBank:(0,a.defaultToEmptyString)(e.bank)}}},808639:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(314369),t)},292882:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBankInfoFromBankAccountData=t.defaultToUS=t.defaultToEmptyString=void 0;const a=r(401067),o=r(632626),n=r(985406);t.defaultToEmptyString=(0,a.defaultTo)(""),t.defaultToUS=(0,a.defaultTo)(o.Country.US),t.getBankInfoFromBankAccountData=e=>{const r=(0,t.defaultToUS)(e.LocaleFormat),{banks:a}=(0,n.getBanks)({country:r}),o=((e,r)=>{if(r){const[a,o]=(0,t.defaultToEmptyString)(e).split("-"),n=r.find((({code:e})=>[a,o].includes(e)))?.code;return n||"NO_TYPE"}return""})(e.BankAccountBank,a),s=o?.length>0?`${r}-${o}`:"",i=(0,t.defaultToEmptyString)(a?.find((({code:e})=>e===o))?.localizedString);return{country:r,bankCode:o,bankLocalizedName:i,bank:s}}},448931:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeBankAccountSpecificProps=t.makeNewBankAccount=t.makeUpdatedBankAccount=void 0;const a=r(401067),o=r(500053),n=r(178163);function s(e){const t=(0,a.defaultTo)("");return{BankAccountName:t(e.name),BankAccountOwner:t(e.owner),BankAccountIBAN:t(e.IBAN),BankAccountBIC:t(e.BIC),BankAccountBank:t(e.bank)}}t.makeUpdatedBankAccount=async function(e,t){const r=(0,n.makeUpdatedPersonalDataItemBase)({existingItem:t,updatedItem:e,itemUpdateDate:(0,o.getUnixTimestamp)()});return{...t,...r,...s(e.content)}},t.makeNewBankAccount=async function(e){return{...(0,n.makeNewPersonalDataItemBase)(e),...s(e.content)}},t.makeBankAccountSpecificProps=s},760931:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBankAccountMappers=void 0;const a=r(883539);t.getBankAccountMappers=()=>({spaceId:e=>e.SpaceId,accountName:e=>e.BankAccountName,bankName:e=>e.BankAccountBank,lastUse:a.lastUseMapper,id:e=>e.Id})},853704:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bankAccountMatch=t.searchGetters=void 0;const a=r(64455),o=r(382234);t.searchGetters=[(0,o.stringProp)("BankAccountName"),(0,o.stringProp)("BankAccountOwner"),(0,o.stringProp)("BankAccountBank")],t.bankAccountMatch=(0,a.match)(t.searchGetters)},516018:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryBankAccountsSelector=t.bankAccountSelector=t.bankAccountsSelector=void 0;const a=r(853704),o=r(324589),n=r(749551),s=r(432034),i=r(760931),c=r(657989),l=r(340602);t.bankAccountsSelector=(0,s.createSelector)((e=>e.userSession.personalData.bankAccounts),c.quarantinedSpacesSelector,l.filterOutQuarantinedItems),t.bankAccountSelector=(e,r)=>{const a=(0,t.bankAccountsSelector)(e);return(0,n.findDataModelObject)(r,a)},t.queryBankAccountsSelector=(0,o.getQuerySelector)(t.bankAccountsSelector,(()=>a.bankAccountMatch),(e=>(0,i.getBankAccountMappers)()))},404914:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(621342),o=r(52283),n=r(944444);t.config={commands:{updateBreachStatus:{handler:n.updateBreachStatusHandler}},queries:{getBreach:{selector:a.viewedBreachSelector},getBreaches:{selector:a.viewedQueriedBreachesSelector},getBreachesPage:{selector:a.breachesPageSelector},getBreachesPaginationToken:{selector:a.breachesPaginationTokenSelector},getBreachesUpdateStatus:{selector:a.breachesUpdaterStatusSelector}},liveQueries:{liveBreach:{operator:o.getBreach$},liveBreaches:{operator:o.breaches$},liveBreachesBatch:{operator:o.breachesBatch$},liveBreachesUpdaterStatus:{operator:o.breachesUpdaterStatus$}}}},495303:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearInstance=t.getInstance=void 0;const a=r(632626),o=r(670252),n=r(290622),s=r(416593),i=r(288205),c=r(936017),l=r(675130),d=r(544331),u=r(338785),p=r(645291);class S{constructor(e,t,r,a,o){this.storeService=e,this.applicationModulesAccess=t,this.credentialVault=r,this.breachVault=a,this.gateway=o,this.lastRefreshTimestamp=0,this.refreshInProgress=!1}async refresh(e){try{if(this.refreshInProgress)return{vaultSyncNeeded:!1};this.refreshInProgress=!0,this.storeService.dispatch((0,p.updateBreachesUpdaterStatus)(a.BreachesUpdaterStatus.SYNCING));const t=Boolean(e&&e.forceRefresh);if(!await this.isFeatureFlipped()||!this.isSessionOpened()||!this.isRefreshNeeded(t))return this.storeService.dispatch((0,p.updateBreachesUpdaterStatus)(a.BreachesUpdaterStatus.SKIPPED)),this.refreshInProgress=!1,{vaultSyncNeeded:!1};const{breachVault:r,credentialVault:o}=this,n=await this.fetchLatestPublicBreaches(),s=await this.fetchLatestPrivateBreaches();this.resetTimer();const i=o.getAllCredentials(),l=r.getAllBreaches(),d=[...n.breaches,...s.breaches],u=(0,c.getChangesFromIncomingBreaches)(i,l,d);await r.applyChangesFromSync(u,n.revision,s.refreshDate);const S=this.isVaultSyncNeeded(u);return this.storeService.dispatch((0,p.updateBreachesUpdaterStatus)(S?a.BreachesUpdaterStatus.UPDATED:a.BreachesUpdaterStatus.UNCHANGED)),{vaultSyncNeeded:S}}catch(e){this.storeService.dispatch((0,p.updateBreachesUpdaterStatus)(a.BreachesUpdaterStatus.ERROR));const t=new Error(`[Breaches] - refresh: ${e}`);return(0,o.sendExceptionLog)({error:t,code:a.ExceptionCriticality.WARNING}),{vaultSyncNeeded:!1}}finally{this.refreshInProgress=!1}}async isFeatureFlipped(){const{applicationModulesAccess:e}=this,t=await(0,i.makeFeatureFlipsSelectors)(e).featureFlipsSelector();return Boolean(t)&&t[S.BREACHES_REFRESH_FEATURE_FLIP]}isSessionOpened(){const{storeService:e}=this,t=e.getState(),r=(0,s.userLoginSelector)(t),a=(0,n.ukiSelector)(t);return Boolean(a&&r)}isRefreshNeeded(e){return e||Date.now()-this.lastRefreshTimestamp>=S.BREACHES_REFRESH_INTERVAL_MS}resetTimer(){this.lastRefreshTimestamp=Date.now()}isVaultSyncNeeded(e){return e.updates.length+e.deletions.length>0}async fetchLatestPublicBreaches(){const e=this.breachVault.getLatestPublicBreachesRevision();return this.gateway.getLatestPublicBreaches(e)}async fetchLatestPrivateBreaches(){const e=this.breachVault.getPrivateBreachesRefreshDate();let t,r=[];try{const a=await this.gateway.getLatestPrivateBreaches(e);a&&(r=a.breaches,t=a.refreshDate)}catch(e){const t=new Error(`[Breaches] - refresh: fetchPrivateBreaches error: ${e}`);(0,o.sendExceptionLog)({error:t,code:a.ExceptionCriticality.WARNING})}return{breaches:r,refreshDate:t}}}S.BREACHES_REFRESH_INTERVAL_MS=864e5,S.BREACHES_REFRESH_FEATURE_FLIP="breachesFetchWeb";let g=null;t.getInstance=(e,t,r)=>(null===g&&(g=new S(t,e,new d.CredentialVault(t),new l.BreachVault(t),new u.BreachesWS(r,t))),g),t.clearInstance=()=>{g=null}},936017:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getChangesFromIncomingBreaches=void 0;const a=r(632626),o=r(290073),n=r(567083),s=r(186715),i=r(125656),c=r(183480),l=e=>Boolean(e.Password),d=e=>Array.from(new Set(e)),u=(e,t)=>{const{content:r}=e,{leakedPasswords:o}=e;let n=o;if((0,c.hasBreachLeakedDataOfType)(r,a.BreachLeakedDataType.Password)){const{eventDate:e}=r,a=t.filter((e=>t=>1e3*(t.ModificationDatetime||t.CreationDatetime||0)<Date.parse(e))(e)).filter(l).map((e=>e.Password));n=[...o,...a]}return d(n||[])};t.getChangesFromIncomingBreaches=function(e,t,r){const a=new Map;return e.forEach((e=>{const t=(0,o.getDomainForCredential)(e)||"",r=a.get(t)??[];a.set(t,[...r,e])})),r.reduce(((e,r)=>((e,t)=>({updates:[...e.updates,...t.updates],deletions:[...e.deletions,...t.deletions]}))(e,function(e,t,r){const{content:a}=r,{id:o,lastModificationRevision:l}=a,p=(0,c.findByBreachId)(o,t);if(p){if(l<=p.ContentRevision)return{updates:[],deletions:[]};if((0,c.isBreachDeleted)(a))return{updates:[],deletions:[p.Id]}}const S=((e,t)=>(t.content.domains??[]).reduce(((t,r)=>[...t,...e.get(r)??[]]),[]))(e,r),g=u(r,S);return((e,t,r)=>{const a=!(0,s.isDataLeaksBreachContent)(e),o=r.length>0,n=(0,c.hasBreachLeakedPrivateInfo)(e),i=t.length>0;return a&&!o&&(!n||!i)})(a,S,g)?{updates:[],deletions:[]}:(e=>({updates:[e],deletions:[]}))(p?((e,t,r)=>{const a=d(e.LeakedPasswords||[]),o=d([...e.LeakedPasswords,...r]),s=a.length!==o.length?n.BreachStatus.PENDING:e.Status;return{...e,Content:t,ContentRevision:t.lastModificationRevision,LeakedPasswords:o,Status:s}})(p,a,g):(0,i.makeBreachFromContent)(a,g))}(a,t,r))),{updates:[],deletions:[]})}},125656:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeBreachFromContent=void 0;const a=r(632626),o=r(278320),n=r(567083);t.makeBreachFromContent=(e,t)=>({kwType:a.DataModelType.KWSecurityBreach,LastBackupTime:0,Id:(0,o.generateItemUuid)(),AnonId:(0,o.generateItemUuid)(),BreachId:e.id,Content:e,ContentRevision:e.lastModificationRevision,Status:n.BreachStatus.PENDING,LeakedPasswords:t})},944444:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateBreachStatus=t.updateBreachStatusHandler=void 0;const a=r(700033),o=r(448313),n=r(823136),s=r(670252),i=r(795623),c=r(621342);function l(e,t){if(!e.isAuthenticated())throw new Error("No session available to update Breach");const r=e.getState(),a=(0,c.breachSelector)(r,t.id);if(!a)throw new Error("Breach does not exist, cant update");const n={...a,Status:t.status};e.dispatch((0,o.savePersonalDataItem)(n,n.kwType))}t.updateBreachStatusHandler=async function(e,t){const{storeService:r,sessionService:o}=e;try{return l(r,t),(0,n.getDebounceSync)(r,o)({immediateCall:!0},a.Trigger.Save),{success:!0}}catch(e){return i.Debugger.error(e),(0,s.sendExceptionLog)({error:e}),{success:!1}}},t.updateBreachStatus=l},338785:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BreachesWS=void 0;const a=r(401067),o=r(314656),n=r(632626),s=r(335587),i=r(736513),c=r(656984),l=r(72365),d=r(316038),u=r(32607),p=r(670252),S=r(416593),g=r(290622),m=r(448162),y=r(186715),h=r(183480),f=r(448162),v=r(956668);t.BreachesWS=class{constructor(e,t){this.wsService=e,this.storeService=t}async getLatestPublicBreaches(e){const t=this.storeService.getState(),r=(0,S.userLoginSelector)(t),a=(0,g.ukiSelector)(t);if(null===r||null===a)throw new Error("[Breaches] - getLatestPublicBreaches: no current authenticated user");const o=await this.wsService.breaches.get({login:r,uki:a,revision:e});if(!(0,u.isWSResponseSuccess)(o)){const e=`[Breaches] getLatestPublicBreaches: ${o.message}(statusCode: ${o.code})`;throw new Error(e)}const{content:n}=o,{latest:s,filesToDownload:i,revision:c}=n,l=[...s,...await this.downloadFileBreaches(i)].filter(y.isSupportedBreachContent);return{revision:c,breaches:(0,h.deduplicateBreachContents)(l).map((e=>(0,f.makeIncomingBreach)(e,[])))}}async getLatestPrivateBreaches(e){const t=this.storeService.getState(),r=(0,S.premiumStatusSelector)(t);if(!(0,m.hasDarkWebMonitoringFeature)(r))return null;const a=(0,S.userLoginSelector)(t),o=(0,g.ukiSelector)(t);if(null===a||null===o)throw new Error("[Breaches] - getLatestPrivateBreaches: no current authenticated user");const n=await this.wsService.dataleaks.leaks({login:a,uki:o,wantsDetails:!0,includeDisabled:!1,lastUpdateDate:e});if(!(0,u.isWSResponseSuccess)(n)){if((0,f.isBreachesWSResponseNotModified)(n))return{breaches:[],refreshDate:e};const t=n.error&&n.error.code?`, code: ${n.error.code}`:"",r=`[Breaches] - getLatestPrivateBreaches: ${n.message} (statusCode: ${n.code}${t})`;throw new Error(r)}const{content:s}=n,{details:i,leaks:c,lastUpdateDate:l}=s,d=await this.extractLeakedPasswords(i),p=c.filter(y.isSupportedBreachContent);return{breaches:(0,h.deduplicateBreachContents)(p).map((e=>(0,f.makeIncomingBreach)(e,d[e.id]||[]))),refreshDate:l}}async downloadFileBreaches(e){return(0,a.flatten)(await(0,s.asyncMap)(e,this.downloadFileBreach))}async downloadFileBreach(e){try{const{data:t}=await(0,o.get)(e);return t.breaches}catch(e){const t=new Error(`[Breaches] - downloadFileBreach: ${e}`);return(0,p.sendExceptionLog)({error:t,code:n.ExceptionCriticality.ERROR}),[]}}async extractLeakedPasswords(e){try{if(!e||!e.cipheredKey||!e.cipheredInfo)return{};const t=this.storeService.getState(),r=(0,S.sharingKeysSelector)(t);if(!r||!r.publicKey||!r.privateKey)return{};const{privateKey:a}=r,o=(0,i.makeAsymmetricEncryption)({hashAlgorithm:c.HashAlgorithm.SHA_1}),n=await o.decrypt(a,e.cipheredKey),s=(0,l.makeDataEncryptorService)(this.storeService),u=(0,d.base64ToBuffer)(n),p=(0,d.arrayBufferToText)(u);s.setInstance({raw:p},"");const g=await s.getInstance().decrypt(e.cipheredInfo),m=(0,v.deflatedUtf8ToUtf16)(g,{skipInflate:!0}),y=JSON.parse(m);return(0,f.getLeakedPasswordFromIncomingDataLeakDetails)(y)}catch(e){const t=new Error(`[Breaches] - extractLeakedPasswords: ${e}`);return(0,p.sendExceptionLog)({error:t}),{}}}}},412756:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isIncomingDataLeakPasswordInfo=t.isIncomingDataLeakBreachDetails=void 0;const a=r(401067);t.isIncomingDataLeakBreachDetails=e=>(0,a.is)(Object,e)&&"string"==typeof e.breachId&&""!==e.breachId&&Array.isArray(e.data),t.isIncomingDataLeakPasswordInfo=e=>(0,a.is)(Object,e)&&"password"===e.type&&"plaintext"===e.hashMethod&&"string"==typeof e.value&&""!==e.value},448162:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hasDarkWebMonitoringFeature=t.isBreachesWSResponseNotModified=t.getLeakedPasswordFromIncomingDataLeakDetails=t.makeIncomingBreach=void 0;const a=r(412756);t.makeIncomingBreach=(e,t)=>({content:e,leakedPasswords:t}),t.getLeakedPasswordFromIncomingDataLeakDetails=e=>{if(!Array.isArray(e))return{};const t=e=>(0,a.isIncomingDataLeakPasswordInfo)(e)?e.value:null;return e.reduce(((e,r)=>{if(!(0,a.isIncomingDataLeakBreachDetails)(r))return e;const{breachId:o,data:n}=r,s=n.map(t).filter(Boolean);return s.length?{...e,[o]:s}:e}),{})},t.isBreachesWSResponseNotModified=e=>304===e.code,t.hasDarkWebMonitoringFeature=function(e){if(!e)return!1;const{capabilities:t}=e;return Boolean(t?.dataLeak?.enabled)}},675130:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BreachVault=void 0;const a=r(645291),o=r(412362),n=r(986691),s=r(621342);t.BreachVault=class{constructor(e){this.storeService=e}async applyChangesFromSync(e,t,r){const s=(0,a.breachesUpdated)(e,t,r);let i=null;const{updates:c,deletions:l}=e,d=c.length+l.length,u=(0,o.getInstance)(),p=(0,n.getInstance)();try{d&&(i=p.lockTopic("iconsUpdates"),await u.add("iconsUpdates",{type:"breachUpdates",breachesIds:c.map((e=>e.Id))})),this.storeService.dispatch(s),d&&p.releaseTopic("iconsUpdates",i)}catch(e){throw i&&p.releaseTopic("iconsUpdates",i),e}}getAllBreaches(){const e=this.storeService.getState();return(0,s.breachesSelector)(e)}getLatestPublicBreachesRevision(){const e=this.storeService.getState();return(0,s.publicBreachesRevisionSelector)(e)}getPrivateBreachesRefreshDate(){const e=this.storeService.getState();return(0,s.privateBreachesLastUpdateTimestamp)(e)}}},544331:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CredentialVault=void 0;const a=r(751319);t.CredentialVault=class{constructor(e){this.storeService=e}getAllCredentials(){const e=this.storeService.getState();return(0,a.credentialsSelector)(e)}}},209335:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.detailItemView=void 0;const a=r(401067),o=r(388749),n=r(186715),s=r(90451),i=(0,a.defaultTo)([]);function c({name:e,domains:t}){if(e)return e;if(t.length>0){const[e]=t;return e}return""}function l(e,t){if(t&&0!==t.length)return(0,s.getIcon)(e)(t[0])}function d(e,t){const r=t.Content,a=(0,n.isDataLeaksBreach)(t)?t.Content.impactedEmails:[];return{domains:i(r.domains),breachType:(0,o.breachTypeMapper)(t),domainIcon:l(e,t.Content.domains),eventDate:r.eventDate,id:t.Id,impactedEmails:a,name:c(r),status:t.Status}}t.detailItemView=function(e,t){const r=t.Content,a=(0,n.isDataLeaksBreach)(t)?t.Content.impactedEmails:[],s=new Set;return{anonId:t.AnonId,breachType:(0,o.breachTypeMapper)(t),domains:i(r.domains),domainIcon:l(e,t.Content.domains),eventDate:r.eventDate,id:t.Id,impactedEmails:a,kwType:t.kwType,leakedData:i(r.leakedData),leakedPasswords:i(t.LeakedPasswords),name:c(r),status:t.Status,compromisedCredentialIds:[...s]}},t.itemView=d,t.listView=function(e,t){return t.map((t=>d(e,t)))}},183480:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hasBreachLeakedPrivateInfo=t.hasBreachLeakedDataOfType=t.isBreachDeleted=t.findByBreachId=t.deduplicateBreachContents=void 0;const a=r(401067),o=r(632626),n=r(567083),s=r(186715),i=(0,a.takeLast)(1);t.deduplicateBreachContents=(0,a.pipe)((0,a.groupBy)((0,a.prop)("id")),(0,a.mapObjIndexed)((0,a.sortBy)((0,a.prop)("lastModificationRevision"))),(0,a.mapObjIndexed)((e=>i(e))),a.values,a.flatten),t.findByBreachId=(e,t)=>t.find((t=>t.BreachId===e)),t.isBreachDeleted=e=>e.status===n.BreachEnvStatus.Deleted,t.hasBreachLeakedDataOfType=(e,t)=>(e.leakedData||[]).findIndex((e=>t===e))>=0,t.hasBreachLeakedPrivateInfo=e=>(0,s.isDataLeaksBreachContent)(e)||((e,t)=>(e.leakedData||[]).findIndex((e=>t.some((t=>t===e))))>=0)(e,[o.BreachLeakedDataType.Email,o.BreachLeakedDataType.Username,o.BreachLeakedDataType.CreditCard,o.BreachLeakedDataType.Phone,o.BreachLeakedDataType.Address,o.BreachLeakedDataType.SSN,o.BreachLeakedDataType.IP,o.BreachLeakedDataType.Location,o.BreachLeakedDataType.PersonalInfo,o.BreachLeakedDataType.SocialNetwork])},186715:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isPublicBreach=t.isDataLeaksBreach=t.isDataLeaksBreachContent=t.isBreach=t.isSupportedBreach=t.isSupportedBreachContent=void 0;const a=r(401067),o=e=>(0,a.is)(Object,e);function n(e){return function(e){return o(e)&&"number"==typeof e.breachModelVersion}(e)&&1===e.breachModelVersion&&Array.isArray(e.domains)&&"string"==typeof e.eventDate&&"string"==typeof e.id}function s(e){return i(e)&&n(e.Content)}function i(e){return Boolean(e)&&"KWSecurityBreach"===e.kwType}function c(e){return function(e){return"impactedEmails"in e&&Array.isArray(e.impactedEmails)}(e)&&e.impactedEmails.length>0}t.isSupportedBreachContent=n,t.isSupportedBreach=s,t.isBreach=i,t.isDataLeaksBreachContent=c,t.isDataLeaksBreach=e=>s(e)&&c(e.Content),t.isPublicBreach=e=>s(e)&&!c(e.Content)},52283:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.breachesUpdaterStatus$=t.getBreach$=t.breaches$=t.breachesBatch$=void 0;const a=r(518948),o=r(903343),n=r(735893),s=r(433627),i=r(555220),c=r(621342);t.breachesBatch$=e=>{const t=(0,n.parseToken)(e),r=(0,c.getViewedBreachesBatchSelector)(t);return(0,a.pipe)((0,o.map)(r),(0,o.distinctUntilChanged)(s.sameBatch))},t.breaches$=(0,i.getLivePersonalInfo)(c.getLiveBreachesSelector),t.getBreach$=function(e){const t=(0,c.getViewedBreachSelector)(e);return(0,a.pipe)((0,o.map)(t),(0,o.distinctUntilChanged)())},t.breachesUpdaterStatus$=()=>(0,a.pipe)((0,o.map)(c.breachesUpdaterStatusSelector),(0,o.distinctUntilChanged)())},388749:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBreachMappers=t.breachTypeMapper=void 0;const a=r(186715);function o(e){return(0,a.isDataLeaksBreach)(e)?"private":"public"}t.breachTypeMapper=o,t.getBreachMappers=()=>({breachType:e=>o(e),eventDate:e=>function({eventDate:e}){return Date.parse(e)}(e.Content),id:e=>e.Id,status:e=>e.Status})},569623:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBreachesBatch=t.viewBreachesBatch=t.getBreachesFirstToken=t.getBreacheSortToken=t.getBreachesFilterToken=void 0;const a=r(401067),o=r(920553),n=r(209335);t.getBreachesFilterToken=({filterCriteria:e})=>({filterCriteria:e||[]}),t.getBreacheSortToken=({sortCriteria:e})=>({uniqField:"id",sortCriteria:e||[]}),t.getBreachesFirstToken=(e,t,r,a)=>(0,o.generateFirstToken)(e,t,r.initialBatchSize||30,a),t.viewBreachesBatch=(e,t)=>(0,n.listView)(e,t),t.getBreachesBatch=(0,a.curry)(((e,t,r)=>(0,o.getBatch)(r,e,t)))},537600:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.breachMatch=t.searchGetters=void 0;const a=r(64455);t.searchGetters=[],t.breachMatch=(0,a.match)(t.searchGetters)},621342:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.breachesUpdaterStatusSelector=t.getViewedBreachSelector=t.getViewedBreachesBatchSelector=t.getLiveBreachesSelector=t.fieldMappersSelector=t.breachesQuerySelector=t.breachesPaginationTokenSelector=t.breachesPageSelector=t.viewedQueriedBreachesSelector=t.breachMappersSelector=t.viewedBreachSelector=t.breachSelector=t.privateBreachesLastUpdateTimestamp=t.publicBreachesRevisionSelector=t.publicBreachesSelector=t.privateBreachesSelector=t.breachesSelector=void 0;const a=r(518948),o=r(432034),n=r(186715),s=r(749551),i=r(563566),c=r(324589),l=r(735893),d=r(920553),u=r(497006),p=r(209335),S=r(388749),g=r(537600),m=r(569623),y=r(791892),h=e=>e.userSession.personalData.securityBreaches,f=(0,o.createSelector)(h,(e=>e.filter(n.isSupportedBreach)));function v(e,r){const a=(0,t.breachesSelector)(e);return(0,s.findDataModelObject)(r,a)}t.breachesSelector=(0,o.createSelector)(f,(e=>[...e.reduce(((e,t)=>{const r=e.get(t.BreachId);return(!r||r.LastBackupTime<t.LastBackupTime)&&e.set(t.BreachId,t),e}),new Map).values()])),t.privateBreachesSelector=(0,o.createSelector)(h,(e=>[...new Set(e.filter(n.isDataLeaksBreach))])),t.publicBreachesSelector=(0,o.createSelector)(h,(e=>[...new Set(e.filter(n.isPublicBreach))])),t.publicBreachesRevisionSelector=e=>e.userSession.personalData.securityBreachesMetadata.latestPublicBreachesRevision,t.privateBreachesLastUpdateTimestamp=e=>e.userSession.personalData.securityBreachesMetadata.latestDataLeaksBreachesUpdate,t.breachSelector=v,t.viewedBreachSelector=function(e,t){const r=(0,y.iconsSelector)(e),a=v(e,t);return(0,p.detailItemView)(r,a)},t.breachMappersSelector=e=>(0,S.getBreachMappers)();const T=()=>g.breachMatch,A=(0,c.getQuerySelector)(t.breachesSelector,T,t.breachMappersSelector),P=(0,o.createSelector)(y.iconsSelector,(e=>t=>(0,m.viewBreachesBatch)(e,t)));t.viewedQueriedBreachesSelector=(e,t)=>{const r=A(e,t),a=P(e);return(0,i.viewListResults)(a)(r)},t.breachesPageSelector=function(e,r){const a=(0,l.parseToken)(r),{sortToken:o,filterToken:n}=a,s={sortToken:o,filterToken:n},i=(0,S.getBreachMappers)(),c=(0,t.breachesQuerySelector)(e,s),u=P(e),p=(0,d.generateNextToken)(i,a,c),g=(0,d.generatePrevToken)(i,a,c),m=(0,d.getBatch)(i,a,c),y=(0,l.stringifyToken)(p),h=(0,l.stringifyToken)(g);return{batch:u(m),nextToken:y,prevToken:h}},t.breachesPaginationTokenSelector=(e,r)=>{const a=(0,m.getBreacheSortToken)(r),o=(0,m.getBreachesFilterToken)(r),n=(0,S.getBreachMappers)(),s={sortToken:a,filterToken:o},i=(0,t.breachesQuerySelector)(e,s),c=(0,m.getBreachesFirstToken)(n,s,r,i);return(0,l.stringifyToken)(c)};const w=(0,l.createOptimizedSortTokenSelector)(((e,{sortToken:t})=>t),a.identity),b=(0,l.createOptimizedFilterTokenSelector)(((e,{filterToken:t})=>t),a.identity);t.breachesQuerySelector=(0,o.createSelector)(S.getBreachMappers,T,w,b,t.breachesSelector,l.queryData),t.fieldMappersSelector=(0,o.createSelector)(t.breachesSelector,S.getBreachMappers),t.getLiveBreachesSelector=(0,u.makeLiveSelectorGetter)(t.breachesSelector,P,T,t.breachMappersSelector),t.getViewedBreachesBatchSelector=e=>{const{sortToken:r,filterToken:a}=e,n={sortToken:r,filterToken:a},s=(0,m.getBreachesBatch)(e),i=(0,o.createSelector)((e=>(0,t.breachesQuerySelector)(e,n)),t.fieldMappersSelector,s),c=(0,l.optimizeBatchSelector)(i);return(0,o.createSelector)(y.iconsSelector,c,m.viewBreachesBatch)},t.getViewedBreachSelector=function(e){const r=(0,o.createSelector)(t.breachesSelector,(t=>(0,s.findDataModelObject)(e,t)));return(0,o.createSelector)(y.iconsSelector,r,p.detailItemView)},t.breachesUpdaterStatusSelector=e=>e.userSession.personalData.breachesUpdaterStatus},279405:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const a=r(495303);t.setupSubscriptions=async function(e,t){const{applicationModulesAccess:r,storeService:o,wsService:n}=t;e.syncSuccess.on((()=>{(0,a.getInstance)(r,o,n).refresh({forceRefresh:!1})}))}},567083:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BreachCriticality=t.BreachEnvStatus=t.BreachStatus=void 0,function(e){e.PENDING="PENDING",e.VIEWED="VIEWED",e.ACKNOWLEDGED="ACKNOWLEDGED"}(t.BreachStatus||(t.BreachStatus={})),function(e){e.Legacy="legacy",e.Live="live",e.Staging="staging",e.Deleted="deleted"}(t.BreachEnvStatus||(t.BreachEnvStatus={})),function(e){e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"}(t.BreachCriticality||(t.BreachCriticality={}))},540220:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrentData=t.getChangeSet=t.getChangedProperties=t.getChangedPropertiesForRemoval=void 0;const a=r(401067),o=r(278320),n=r(500053),s={KWAuthentifiant:{Email:"",Login:"",Note:"",Password:"",SecondaryLogin:"",Title:"",Url:"",UserSelectedUrl:"",LinkedServices:{associated_domains:[]}},KWSecureNote:{Content:"",Title:""},KWSecret:{Content:"",Title:""}};function i(e){const t=s[e.kwType];return Object.keys(t).filter((r=>"LinkedServices"===r?e[r]?.associated_domains&&e[r].associated_domains.length>0:e[r]&&e[r]!==t[r]))}t.getChangedPropertiesForRemoval=i;const c=(e,t)=>e.length===t.length&&e.sort().join("")===t.sort().join("");function l(e,t){const r=s[e.kwType];return Object.keys(r).filter((r=>{if("LinkedServices"===r){const a=(e[r]?.associated_domains??[]).map((e=>e.domain)),o=(t[r]?.associated_domains??[]).map((e=>e.domain));return!c(a,o)}return e[r]&&""!==e[r]&&e[r]!==t[r]}))}function d(e){return Object.keys(s[e.kwType]).reduce(((t,r)=>(t[r]="LinkedServices"===r?e[r]?.associated_domains?e[r]:{associated_domains:[]}:e[r]||"",t)),{})}t.getChangedProperties=l,t.getChangeSet=function(e){const{change:t,deviceName:r,oldItem:s,userLogin:c,platformInfo:u}=e;if((0,a.isNil)(s))return null;const p="removal"===t.type?i(s):l(s,t.updatedItem);return 0===p.length?null:{kwType:"KWChangeSet",ChangedProperties:p,CurrentData:d(s),Id:(0,o.generateItemUuid)(),Platform:u.platformName,DeviceName:r||"",ModificationDate:(0,n.getUnixTimestamp)(),Removed:(0,a.defaultTo)(!1,"removal"===t.type),User:c}},t.getCurrentData=d},885225:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeRemovalChange=t.makeUpdateChange=void 0,t.makeUpdateChange=e=>({type:"update",updatedItem:e}),t.makeRemovalChange=e=>({type:"removal",itemId:e.Id,itemKwType:e.kwType})},673566:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUpdatedItemChangeHistory=t.isChangeHistoryCandidate=t.getEmptyChangeHistory=void 0;const a=r(401067),o=r(632626),n=r(278320),s=r(540220),i=r(584977),c=r(883638),l=r(749551);function d(e){const[t,r,a]="removal"===e.type?[e.itemId,e.itemKwType,""]:[e.updatedItem.Id,e.updatedItem.kwType,e.updatedItem.Title||""];return{kwType:"KWDataChangeHistory",ChangeSets:[],Id:(0,n.generateItemUuid)(),ObjectId:t,ObjectTitle:a,ObjectType:(0,c.getTransactionTypeFromDataModelType)(r),LastBackupTime:0}}t.getEmptyChangeHistory=d;t.isChangeHistoryCandidate=function(e){return(0,o.isCredential)(e)||(0,o.isNote)(e)||(0,o.isSecret)(e)},t.getUpdatedItemChangeHistory=function(e){const{deviceName:t,personalData:r,change:o,userLogin:n,platformInfo:c}=e,[u,p,S]="removal"===o.type?[o.itemId,o.itemKwType,""]:[o.updatedItem.Id,o.updatedItem.kwType,o.updatedItem.Title],g=i.default[p],m=(0,l.findDataModelObject)(u,r[g]),y=(0,s.getChangeSet)({deviceName:t,change:o,oldItem:m,userLogin:n,platformInfo:c});if(!y)return null;const h=r.changeHistories.find((e=>e?.ObjectId?.toUpperCase()===(u||"").toUpperCase())),f=h||d(o),v=(0,a.last)(f.ChangeSets);return v&&((e,t)=>(0,a.equals)(t.CurrentData,e.CurrentData))(v,y)?null:{...f,ObjectTitle:S,ChangeSets:f.ChangeSets.concat(y)}}},435385:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsHistoriesSelector=void 0;const a=r(432034),o=r(340602),n=r(83659),s=r(657989),i=r(883638),c=e=>e.ObjectType===i.TransactionType.AUTHENTIFIANT,l=(0,a.createSelector)((e=>e.userSession.personalData.changeHistories),(e=>e.filter(c)));t.credentialsHistoriesSelector=(0,a.createSelector)(l,s.quarantinedSpacesSelector,n.unsafeAllCredentialsSelector,o.filterOutQuarantinedItems)},143837:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(142682);t.config={commands:{addCollection:{handler:a.addCollectionHandler},deleteCollection:{handler:a.deleteCollectionHandler},removeItemsFromCollections:{handler:a.removeItemsFromCollectionsHandler},updateCollection:{handler:a.updateCollectionHandler}},queries:{},liveQueries:{}}},55740:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addCollectionHandler=t.getNewCollection=void 0;const a=r(632626),o=r(700033),n=r(823136),s=r(448313),i=r(500053),c=r(278320),l=r(670252),d=r(298416);function u(e){const t=(0,i.getUnixTimestamp)();return{kwType:"KWCollection",Id:(0,c.generateItemUuid)(),LastBackupTime:0,LastUse:t,LocaleFormat:a.Country.UNIVERSAL,AnonId:(0,c.generateItemUuid)(),SpaceId:e.spaceId,CreationDatetime:t,UserModificationDatetime:t,Name:e.name,VaultItems:e.vaultItems.map((e=>({Id:e.id,Type:e.type})))}}t.getNewCollection=u,t.addCollectionHandler=async function(e,t){try{const r=await async function({storeService:e,sessionService:t},r){if(!e.isAuthenticated())throw new Error("No session available to addCollection");const a=u((0,d.sanitizeInputPersonalData)(r));if(!a.SpaceId){const t=await(0,n.getDefaultSpaceId)(e);a.SpaceId=t}return e.dispatch((0,s.savePersonalDataItem)(a,a.kwType)),t.getInstance().user.persistPersonalData(),a.Id}(e,t);return(0,n.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save),{success:!0,id:r}}catch(e){return(0,l.sendExceptionLog)({error:e}),{success:!1}}}},309833:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteCollectionHandler=void 0;const a=r(632626),o=r(700033),n=r(823136),s=r(670252),i=r(645291);t.deleteCollectionHandler=async function(e,t){try{return await async function({storeService:e,sessionService:t},r){if(!e.isAuthenticated())throw new Error("No session available to deleteCollection");const o=(0,i.removePersonalItem)(a.DataModelType.KWCollection,r,null);e.dispatch(o),t.getInstance().user.persistPersonalData()}(e,t.id),(0,n.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save),{success:!0}}catch(e){return(0,s.sendExceptionLog)({error:e}),{success:!1}}}},142682:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(55740),t),o(r(309833),t),o(r(73240),t),o(r(506366),t)},73240:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeItemsFromCollectionsHandler=void 0;const a=r(153626),o=r(506366);t.removeItemsFromCollectionsHandler=async function(e,t){const r=e.storeService.getState(),n=(0,a.collectionsSelector)(r),s=[];let i,c;if(n.forEach((e=>{i=e.VaultItems.length,e.VaultItems=e.VaultItems.filter((e=>!t.ids.includes(e.Id))),c=e.VaultItems.length,i!==c&&s.push(e)})),!s.length)return;const l=s.map((t=>(0,o.updateCollectionHandler)(e,{id:t.Id,name:t.Name,spaceId:t.SpaceId,vaultItems:t.VaultItems.map((e=>({id:e.Id,type:e.Type})))})));return{success:!(await Promise.all(l)).some((e=>!e.success))}}},506366:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateCollectionHandler=void 0;const a=r(700033),o=r(823136),n=r(448313),s=r(500053),i=r(670252),c=r(298416),l=r(153626),d=e=>({LastUse:(0,s.getUnixTimestamp)(),Name:e.name,SpaceId:e.spaceId,VaultItems:e.vaultItems.map((e=>({Id:e.id,Type:e.type})))});t.updateCollectionHandler=async function(e,t){try{return await async function(e,t,r){if(!e.isAuthenticated())throw new Error("No session available to updateCollection");const a=function(e,t){const r=(0,l.collectionSelector)(e,t.id);if(!r)throw new Error("[updateCollection]: unable to find collection to update.");return{...r,...d(t)}}(e.getState(),(0,c.sanitizeInputPersonalData)(r));return e.dispatch((0,n.savePersonalDataItem)(a,a.kwType)),t.getInstance().user.persistPersonalData()}(e.storeService,e.sessionService,t),(0,o.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},a.Trigger.Save),{success:!0}}catch(e){return(0,i.sendExceptionLog)({error:e}),{success:!1}}}},310770:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(142682),t),o(r(153626),t),o(r(200182),t)},153626:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.collectionSelector=t.collectionsSelector=void 0;const a=r(749551);t.collectionsSelector=e=>e.userSession.personalData.collections,t.collectionSelector=(e,r)=>{const o=(0,t.collectionsSelector)(e);return(0,a.findDataModelObject)(r,o)}},200182:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCollectionNamesContainingVaultItemId=void 0,t.getCollectionNamesContainingVaultItemId=(e,t,r=[])=>t.flatMap((t=>t.VaultItems.some((t=>t.Id===e))?t.Name:[])).concat(r.flatMap((t=>t.vaultItems.some((t=>t.id===e))?t.name:[])))},502946:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(808777),o=r(371806),n=r(807657),s=r(410043),i=r(335410),c=r(780920),l=r(779895),d=r(460581),u=r(866663),p=r(628831),S=r(673567),g=r(709763),m=r(552109),y=r(870853);t.config={commands:{addCredential:{handler:g.createCredential},deleteCredential:{handler:m.deleteCredentialHandler},updateCredential:{handler:y.updateCredentialHandler}},queries:{canUserAddNewCredential:{selector:a.canUserAddNewCredentialSelector},getCredential:{selector:d.viewedCredentialSelector},getCredentialCategories:{selector:l.viewedCredentialCategoriesSelector},getCredentials:{selector:u.viewedQueriedCredentialsSelector},getCredentialsByDomain:{selector:p.viewedQueriedCredentialsByDomainSelector},getCredentialsCount:{selector:o.credentialsCountSelector},getCredentialLimitStatus:{selector:n.credentialLimitStatusSelector},getCredentialsPage:{selector:s.credentialsPageSelector},getCredentialsPaginationToken:{selector:i.credentialsPaginationTokenSelector},getShouldShowRequireMasterPassword:{selector:c.shouldShowRequireMasterPasswordSelector}},liveQueries:{liveCanUserAddNewCredential:{operator:S.canUserAddNewCredential$},liveCredentialLimitStatus:{operator:S.credentialLimitStatus$},liveCredential:{operator:S.getCredential$},liveCredentials:{operator:S.credentials$},liveCredentialsByDomain:{operator:S.credentialsByDomain$},liveCredentialsBatch:{operator:S.credentialsBatch$},liveCredentialsCount:{operator:S.credentialsCount$}}}},239373:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleLimitedSharedCredentialsPassword=t.removeCredentialsWithQuarantinedSpaces=t.fixCredentialsWithMissingTitles=t.fixCredentialWithMissingTitle=void 0;const a=r(252578),o=r(589489),n=r(290073),s=r(937275);function i(e){return e.Title?e:Object.assign({},e,{Title:(0,n.getDomainForCredential)(e)})}t.fixCredentialWithMissingTitle=i,t.fixCredentialsWithMissingTitles=function(e){return e.map(i)},t.removeCredentialsWithQuarantinedSpaces=function(e,t){if(!e.spaces||0===e.spaces.length)return t;const r=[];return e.spaces.filter(a.isSpaceQuarantined).forEach((e=>{const o=e.details.info&&e.details.info.teamDomains?e.details.info.teamDomains:[];t.filter((e=>(0,a.isCredentialSmartCategorized)(e,o))).forEach((t=>{""!==t.SpaceId&&t.SpaceId===e.details.teamId&&r.push(t)}))})),t.filter((e=>!r.includes(e)))},t.handleLimitedSharedCredentialsPassword=function(e,t,r){const a=(0,s.getSharingDataWithCollections)(t),n=(0,o.getLimitedSharedItemIds)(t,a.collections,a.itemGroups,r);return e.map((e=>n[e.Id]?Object.assign({},e,{Password:"************",limitedPermissions:!0}):e))}},336439:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.countCredentials=void 0;const a=r(735893);t.countCredentials=(e,t,r,o)=>(0,a.filterData)(e,t,r,o).length},290073:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDomainForCredential=void 0;const a=r(421178);t.getDomainForCredential=e=>new a.ParsedURL(e.Url).getRootDomain()},552109:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteCredentialHandler=void 0;const a=r(700033),o=r(176496),n=r(823136),s=r(795623),i=r(670252);t.deleteCredentialHandler=async({sessionService:e,storeService:t,wsService:r,eventLoggerService:c},{credentialId:l})=>{try{return(await(0,o.deletePersonalDataItem)({storeService:t,wsService:r,eventLoggerService:c},l)).success?((0,n.getDebounceSync)(t,e)({immediateCall:!0},a.Trigger.Save),Promise.resolve({success:!0})):Promise.resolve({success:!1})}catch(e){const t=new Error(`[Credentials] - deleteCredentialHandler: ${e}`);return(0,i.sendExceptionLog)({error:t}),(0,s.logError)(t),Promise.resolve({success:!1})}}},870853:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateCredentialHandler=void 0;const a=r(795623),o=r(670252),n=r(688779);t.updateCredentialHandler=async function(e,t){const{storeService:r,sessionService:s,eventLoggerService:i,applicationModulesAccess:c}=e;try{return await(0,n.updateCredential)({storeService:r,sessionService:s,eventLoggerService:i,applicationModulesAccess:c},t),{success:!0}}catch(e){return(0,a.logError)(e),(0,o.sendExceptionLog)({error:e}),{success:!1}}}},423529:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCredentialsDisplayTitles=void 0;const a=r(290073);t.getCredentialsDisplayTitles=function(e){const t=e.reduce(((e,t)=>{const{Id:r,Title:o}=t,n=o||(0,a.getDomainForCredential)(t);return e.concat([[r,n]])}),[]);return new Map(t)}},488542:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewCredential=t.afterCredentialSaved=t.notifySharersCredentialUpdated=t.makeCredentialSpecificProps=t.makeNewCredential=t.makeUpdatedCredential=t.beforeCredentialChange=t.sharedFields=t.SaveFrom=void 0;const a=r(401067),o=r(50415),n=r(632626),s=r(421178),i=r(947975),c=r(587496),l=r(261923),d=r(448313),u=r(500053);t.SaveFrom=(0,o.Enum)("MANUAL","SAVE_PASSWORD","DATACAPTURE","IMPORT");const p=r(670252),S=r(178163),g=r(443145),m=r(165968),y=r(183687),h=r(292307),f=r(90451),v=r(632626);t.sharedFields=["Email","Login","Note","OtpSecret","OtpUrl","Password","SecondaryLogin","Title","Url","UseFixedUrl","UserSelectedUrl","LinkedServices"];const T=(0,a.defaultTo)("");function A(e,t){const{url:r}=e.content,a=void 0===r,o=t?.UserSelectedUrl??"",s=t?.UseFixedUrl??!1,i=t?.TrustedUrlGroup??[],l=e.origin===n.SaveOrigin.MANUAL,d=!a&&t?.Url!==r,u=(0,c.cleanUrlForPersonalData)(a?t?.Url:r,{keepQueryString:l}),p=l&&d?{UserSelectedUrl:u,UseFixedUrl:!0}:{UserSelectedUrl:o,UseFixedUrl:s};return{Url:u,TrustedUrlGroup:(0,c.getUpdatedTrustedUrlList)(i,u),...p}}async function P(e,t,r=(0,u.getUnixTimestamp)()){const{content:o}=e,n={associated_domains:o.linkedWebsites?.addedByUser?.map((e=>({source:v.LinkedWebsiteSource.Manual,domain:e})))??t?.LinkedServices?.associated_domains??[]},s=function(e,t){return({itemField:r,existingItemField:o,defaultValue:n})=>(0,a.isNil)(e[r])?t&&!(0,a.isNil)(t[o])?t[o]:n:e[r]}(o,t),{email:c,login:d,secondaryLogin:p}=(0,l.normalizeUsernames)(s({itemField:"email",existingItemField:"Email",defaultValue:""}),s({itemField:"login",existingItemField:"Login",defaultValue:""}),s({itemField:"secondaryLogin",existingItemField:"SecondaryLogin",defaultValue:""})),S=s({itemField:"password",existingItemField:"Password",defaultValue:""}),g=t&&t.Password===S?{}:{ModificationDatetime:r};return{AutoLogin:s({itemField:"autoLogin",existingItemField:"AutoLogin",defaultValue:!0}),AutoProtected:s({itemField:"protectWithMasterPassword",existingItemField:"AutoProtected",defaultValue:!1}),Category:s({itemField:"category",existingItemField:"Category",defaultValue:""}),Checked:s({itemField:"checked",existingItemField:"Checked",defaultValue:!1}),Email:c,Login:d,Note:s({itemField:"note",existingItemField:"Note",defaultValue:""}),Password:S,SecondaryLogin:p,Status:"ACCOUNT_NOT_VERIFIED",Strength:S?await(0,i.evaluatePasswordStrength)(S):0,SubdomainOnly:Boolean(o.onlyForThisSubdomain),Title:s({itemField:"title",existingItemField:"Title",defaultValue:""}),...A(e,t),OtpSecret:s({itemField:"otpSecret",existingItemField:"OtpSecret",defaultValue:void 0}),OtpUrl:s({itemField:"otpUrl",existingItemField:"OtpUrl",defaultValue:void 0}),LinkedServices:n,...g}}t.beforeCredentialChange=function(e,t){const r=t.credentialCategories,a=e.content.category;if(!a)return e;if(r.find((e=>e.Id===a)))return e;const o=r.find((e=>e.CategoryName===a));return((e,t)=>({...e,content:{...e.content,category:t}}))(e,o?o.Id:"")},t.makeUpdatedCredential=async function(e,t){const r=(0,u.getUnixTimestamp)(),a=await P(e,t,r);return{...t,...(0,S.makeUpdatedPersonalDataItemBase)({existingItem:t,updatedItem:e,itemUpdateDate:r}),...a}},t.makeNewCredential=async function(e){const t=(0,u.getUnixTimestamp)(),r=await P(e,null,t);return function(e){const{Title:t,Url:r}=e;return{...e,Title:t||T(new s.ParsedURL(r).getRootDomain())}}({...(0,S.makeNewPersonalDataItemBase)(e,t),...r})},t.makeCredentialSpecificProps=P,t.notifySharersCredentialUpdated=async function(e,r,o,n){if((0,a.equals)((0,a.pick)(t.sharedFields,r),(0,a.pick)(t.sharedFields,o)))return!0;try{return await(0,S.notifySharersOnUpdate)(e,o,n),!0}catch(e){const t=new Error(`[Sharing] - Failed to update shared item: ${e}`);return(0,p.sendExceptionLog)({error:t}),!1}},t.afterCredentialSaved=function(e,t){(0,g.associateGeneratedPasswordsToCredential)(e.getPersonalData().generatedPasswords,t).forEach((t=>{e.dispatch((0,d.saveGeneratedPassword)(t))}))},t.viewCredential=function(e,t,r,a,o,n,s){if(!e)return;const i=(0,y.getSharingStatusDetail)(a,t,r),c=(0,f.getIcon)(n),l=(0,h.getCategory)(o),d=(0,h.getSmartCategorizedSpace)(s);return(0,m.detailView)(i,l,c,d,e)}},673567:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialLimitStatus$=t.canUserAddNewCredential$=t.credentialsByDomain$=t.credentials$=t.credentialsCount$=t.getCredential$=t.credentialsBatch$=void 0;const a=r(518948),o=r(903343),n=r(808777),s=r(807657),i=r(371806),c=r(761645),l=r(886685),d=r(678767),u=r(865950),p=r(735893),S=r(433627),g=r(555220);t.credentialsBatch$=e=>{const t=(0,p.parseToken)(e),r=(0,d.getViewedCredentialsBatchSelector)(t);return(0,a.pipe)((0,o.map)(r),(0,o.distinctUntilChanged)(S.sameBatch))},t.getCredential$=e=>{const t=(0,l.getViewedCredentialSelector)(e);return(0,a.pipe)((0,o.map)(t),(0,o.distinctUntilChanged)())},t.credentialsCount$=e=>{const t=(0,p.parseToken)(e);return(0,a.pipe)((0,o.map)((e=>(0,i.credentialsCountSelector)(e,t))),(0,o.distinctUntilChanged)())},t.credentials$=(0,g.getLivePersonalInfo)(c.getLiveCredentialsSelector),t.credentialsByDomain$=e=>{const{domain:t,...r}=(0,p.parseToken)(e),n=(0,u.getLiveCredentialsByDomainSelector)(t)(r);return(0,a.pipe)((0,o.map)(n),(0,o.distinctUntilChanged)(((e,t)=>e.matchingCount===t.matchingCount&&(0,S.sameBatch)(e.items,t.items))))},t.canUserAddNewCredential$=()=>(0,a.pipe)((0,o.map)(n.canUserAddNewCredentialSelector),(0,o.distinctUntilChanged)()),t.credentialLimitStatus$=()=>(0,a.pipe)((0,o.map)(s.credentialLimitStatusSelector),(0,o.distinctUntilChanged)())},994687:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCredentialMappers=void 0;const a=r(401067),o=r(883539),n=r(471646),s=(0,a.curry)(((e,t)=>e.get(t.Id)||"")),i=e=>!!e.Attachments&&e.Attachments.length>0,c=(0,a.curry)(((e,t)=>!!e[t.Id])),l=(0,a.curry)(((e,t)=>{const r=t.Category,a=(e||[]).find((e=>e.Id===r));return a&&a.CategoryName?a.CategoryName:"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz"}));t.getCredentialMappers=(e,t,r,a,d,u)=>({category:l(e),groupIds:e=>(0,n.getItemUserGroupIds)(a,e.Id),sharingUserIds:e=>(0,n.getItemUserIds)(a,e.Id),hasAttachments:i,id:e=>e.Id,isLimited:c(t),lastUse:o.lastUseMapper,login:e=>e.Login,numberUse:e=>e.NumberUse,spaceId:e=>e.SpaceId,title:s(r),email:e=>e.Email,collectionIds:e=>((e,t,r)=>t.flatMap((t=>t.VaultItems.some((t=>t.Id===e))?t.Id:[])).concat(r.flatMap((t=>t.vaultItems.some((t=>t.id===e))?t.id:[]))))(e.Id,d,u)})},825501:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCredentialsBatch=t.viewCredentialsBatch=t.getCredentialsFirstToken=t.getCredentialsSortToken=t.getCredentialsFilterToken=void 0;const a=r(401067),o=r(920553),n=r(529179),s=r(183687),i=r(292307),c=r(90451);t.getCredentialsFilterToken=({filterCriteria:e})=>({filterCriteria:e||[]}),t.getCredentialsSortToken=({sortCriteria:e})=>({uniqField:"id",sortCriteria:e||[]}),t.getCredentialsFirstToken=(e,t,r,a)=>(0,o.generateFirstToken)(e,t,r.initialBatchSize||30,a),t.viewCredentialsBatch=(e,t,r,a,o)=>{const l=(0,s.getSharingStatusItem)(t,r),d=(0,c.getIcon)(o),u=(0,i.getCategory)(a);return(0,n.listView)(l,u,d,e)},t.getCredentialsBatch=(0,a.curry)(((e,t,r)=>(0,o.getBatch)(r,e,t)))},331400:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCredentialMatch=void 0;const a=r(64455),o=r(382234),n=r(106205),s=r(310770);t.getCredentialMatch=(e,t)=>(0,a.match)(((e,t)=>[(0,o.stringProp)("Email"),(0,o.stringProp)("Login"),(0,o.stringProp)("Title"),(0,o.stringProp)("Note"),(0,o.stringProp)("SecondaryLogin"),null===e&&null===t?(0,o.stringProp)("CategoryName"):r=>(0,s.getCollectionNamesContainingVaultItemId)(r.Id,e,t).join(" "),e=>(0,n.getDashlaneDefinedLinkedWebsites)(e.Url).join(" "),e=>(0,n.getUserAddedLinkedWebsitesRootDomains)(e).join(" ")])(e,t))},808777:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.canUserAddNewCredentialSelector=void 0;const a=r(432034),o=r(632626),n=r(807657);t.canUserAddNewCredentialSelector=(0,a.createSelector)(n.credentialLimitStatusSelector,(e=>e!==o.CredentialLimitStatus.AtOrAboveLimit))},774380:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.countAllCredentialsSelector=void 0,t.countAllCredentialsSelector=e=>e.userSession.personalData.credentials.length},779895:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewedCredentialCategoriesSelector=t.credentialCategoryNamesMapSelector=t.credentialCategoriesSelector=void 0;const a=r(432034),o=r(371120);t.credentialCategoriesSelector=e=>e.userSession.personalData.credentialCategories,t.credentialCategoryNamesMapSelector=(0,a.createSelector)([t.credentialCategoriesSelector],(e=>e.reduce(((e,t)=>(e[t.Id]=t.CategoryName,e)),{}))),t.viewedCredentialCategoriesSelector=(0,a.createSelector)(t.credentialCategoriesSelector,(e=>({items:(0,o.listView)(e),matchingCount:e.length})))},885505:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialMatchSelector=void 0;const a=r(153626),o=r(331400),n=r(31607);t.credentialMatchSelector=e=>{const t=(0,n.sharedCollectionsWithItemsSelector)(e),r=(0,a.collectionsSelector)(e);return(0,o.getCredentialMatch)(r,t)}},719736:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialSelector=void 0;const a=r(751319),o=r(749551);t.credentialSelector=(e,t)=>{const r=(0,a.credentialsSelector)(e);return(0,o.findDataModelObject)(t,r)}},488083:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCredentialsByDomainSelector=t.getCredentialByDomainMatchType=t.DomainMatchType=void 0;const a=r(432034),o=r(421178),n=r(751319),s=r(106205);var i;!function(e){e.MainWebsite="MainWebsite",e.DashlaneDefinedLinkedWebsite="DashlaneDefinedLinkedWebsite",e.UserDefinedLinkedWebsite="UserDefinedLinkedWebsite",e.None="None"}(i=t.DomainMatchType||(t.DomainMatchType={})),t.getCredentialByDomainMatchType=(e,t)=>e?e===new o.ParsedURL(t.Url).getRootDomain()?i.MainWebsite:(0,s.getDashlaneDefinedLinkedWebsites)(t.Url).includes(e)?i.DashlaneDefinedLinkedWebsite:(0,s.getUserAddedLinkedWebsitesRootDomains)(t).includes(e)?i.UserDefinedLinkedWebsite:i.None:i.None,t.getCredentialsByDomainSelector=e=>(0,a.createSelector)(n.credentialsSelector,(r=>((e,r)=>e.filter((e=>{const a=(0,t.getCredentialByDomainMatchType)(r,e);return[i.MainWebsite,i.DashlaneDefinedLinkedWebsite,i.UserDefinedLinkedWebsite].includes(a)})))(r,e)))},371806:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsCountSelector=void 0;const a=r(432034),o=r(949960),n=r(751319),s=r(885505),i=r(336439),c=r(707439);t.credentialsCountSelector=(0,a.createSelector)(o.fieldMappersSelector,s.credentialMatchSelector,c.filterTokenSelector,n.credentialsSelector,i.countCredentials)},660463:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialDisplayTitlesSelector=void 0;const a=r(432034),o=r(751319),n=r(423529);t.credentialDisplayTitlesSelector=(0,a.createSelector)(o.credentialsSelector,n.getCredentialsDisplayTitles)},807657:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialLimitStatusSelector=void 0;const a=r(432034),o=r(632626),n=r(751319),s=r(416593);t.credentialLimitStatusSelector=(0,a.createSelector)(s.nodePremiumStatusSelector,n.credentialsSelector,((e,t)=>{if(!e||!e.capabilities)return o.CredentialLimitStatus.AtOrAboveLimit;if(!e.capabilities?.passwordsLimit?.enabled)return o.CredentialLimitStatus.Unlimited;const r=t.length,a=e.capabilities?.passwordsLimit?.info?.limit;return r>=a?o.CredentialLimitStatus.AtOrAboveLimit:r>=a-5?o.CredentialLimitStatus.NearLimit:o.CredentialLimitStatus.UnderLimit}))},410043:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsPageSelector=void 0;const a=r(920553),o=r(735893),n=r(949960),s=r(209365),i=r(351443);t.credentialsPageSelector=(e,t)=>{const r=(0,o.parseToken)(t),{sortToken:c,filterToken:l}=r,d={sortToken:c,filterToken:l},u=(0,n.fieldMappersSelector)(e),p=(0,s.credentialsQuerySelector)(e,d),S=(0,i.listViewSelector)(e),g=(0,a.generateNextToken)(u,r,p),m=(0,a.generatePrevToken)(u,r,p),y=(0,a.getBatch)(u,r,p),h=(0,o.stringifyToken)(g),f=(0,o.stringifyToken)(m);return{batch:S(y),nextToken:h,prevToken:f}}},335410:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsPaginationTokenSelector=void 0;const a=r(825501),o=r(949960),n=r(209365),s=r(735893);t.credentialsPaginationTokenSelector=(e,t)=>{const r=(0,a.getCredentialsSortToken)(t),i=(0,a.getCredentialsFilterToken)(t),c=(0,o.fieldMappersSelector)(e),l={sortToken:r,filterToken:i},d=(0,n.credentialsQuerySelector)(e,l),u=(0,a.getCredentialsFirstToken)(c,l,t,d);return(0,s.stringifyToken)(u)}},209365:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsQuerySelector=void 0;const a=r(432034),o=r(949960),n=r(707439),s=r(292897),i=r(751319),c=r(885505),l=r(735893);t.credentialsQuerySelector=(0,a.createSelector)(o.fieldMappersSelector,c.credentialMatchSelector,s.sortTokenSelector,n.filterTokenSelector,i.credentialsSelector,l.queryData)},751319:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsSelector=void 0;const a=r(432034),o=r(83659),n=r(92888),s=r(657989),i=r(340602),c=r(779895),l=(0,a.createSelector)([e=>(0,n.hasCredentialsDedupViewSelector)(e)?(0,n.dedupedCredentialsSelector)(e):(0,o.unsafeAllCredentialsSelector)(e),c.credentialCategoryNamesMapSelector],((e,t)=>e.map((e=>({...e,CategoryName:t[e.Category]})))));t.credentialsSelector=(0,a.createSelector)(l,s.quarantinedSpacesSelector,i.filterOutQuarantinedItems)},92888:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hasCredentialsDedupViewSelector=t.dedupedCredentialsSelector=void 0;const a=r(432034),o=r(453682),n=r(366982),s=r(83659),i={Alias:n.genericMerge,Attachments:n.concatMerge,AutoLogin:n.strictEqual,AutoProtected:n.boolEqual,Category:n.genericMerge,Checked:n.strictEqual,ConnectionOptions:n.genericMerge,CreationDatetime:n.minMerge,Email:n.strictEqual,LastUse:n.maxMerge,LinkedServices:n.strictEqual,Login:n.strictEqual,ModificationDatetime:n.maxMerge,Note:n.genericMerge,NumberUse:n.sumMerge,OtpSecret:n.strictEqual,OtpUrl:n.strictEqual,Password:n.strictEqual,Port:n.genericMerge,SID:n.genericMerge,SecondaryLogin:n.strictEqual,Server:n.genericMerge,SharedObject:n.strictEqual,SpaceId:n.strictEqual,Status:n.strictEqual,Strength:n.strictEqual,SubdomainOnly:n.boolEqual,Title:n.strictEqual,TrustedUrlGroup:n.concatMerge,Url:n.strictEqual,UseFixedUrl:n.strictEqual,UserModificationDatetime:n.maxMerge,UserSelectedUrl:n.strictEqual,kwType:n.strictEqual,limitedPermissions:n.strictEqual};t.dedupedCredentialsSelector=(0,a.createSelector)(s.unsafeAllCredentialsSelector,(0,o.dedupItems)(["Password","Title","Url"],i)),t.hasCredentialsDedupViewSelector=e=>e.userSession.credentialsDedupViewState.credentialsDedupView},949960:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fieldMappersSelector=void 0;const a=r(432034),o=r(994687),n=r(779895),s=r(660463),i=r(691210),c=r(589698),l=r(310770),d=r(31607);t.fieldMappersSelector=(0,a.createSelector)(n.credentialCategoriesSelector,i.limitedSharingItemsSelector,s.credentialDisplayTitlesSelector,c.acceptedItemGroupsSelector,l.collectionsSelector,d.sharedCollectionsWithItemsSelector,o.getCredentialMappers)},707439:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.filterTokenSelector=void 0;const a=r(401067),o=r(735893);t.filterTokenSelector=(0,o.createOptimizedFilterTokenSelector)(((e,{filterToken:t})=>t),a.identity)},865950:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLiveCredentialsByDomainSelector=void 0;const a=r(497006),o=r(351443),n=r(949960),s=r(885505),i=r(488083);t.getLiveCredentialsByDomainSelector=e=>(0,a.makeLiveSelectorGetter)((0,i.getCredentialsByDomainSelector)(e),o.listViewSelector,s.credentialMatchSelector,n.fieldMappersSelector)},761645:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLiveCredentialsSelector=void 0;const a=r(497006),o=r(751319),n=r(351443),s=r(949960),i=r(885505);t.getLiveCredentialsSelector=(0,a.makeLiveSelectorGetter)(o.credentialsSelector,n.listViewSelector,i.credentialMatchSelector,s.fieldMappersSelector)},780920:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.shouldShowRequireMasterPasswordSelector=void 0;const a=r(538981);t.shouldShowRequireMasterPasswordSelector=e=>!(0,a.isSSOUserSelector)(e)},886685:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedCredentialSelector=void 0;const a=r(432034),o=r(352102),n=r(691210),s=r(751319),i=r(779895),c=r(791892),l=r(416593),d=r(749551),u=r(807944),p=r(488542);t.getViewedCredentialSelector=e=>{const t=(0,a.createSelector)(s.credentialsSelector,(t=>(0,d.findDataModelObject)(e,t)));return(0,a.createSelector)(t,o.sharingDataSelector,l.userIdSelector,n.limitedSharingItemsSelector,i.credentialCategoriesSelector,c.iconsSelector,u.spacesSelector,p.viewCredential)}},678767:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedCredentialsBatchSelector=void 0;const a=r(432034),o=r(691210),n=r(980993),s=r(779895),i=r(209365),c=r(949960),l=r(791892),d=r(825501),u=r(735893);t.getViewedCredentialsBatchSelector=e=>{const{sortToken:t,filterToken:r}=e,p={sortToken:t,filterToken:r},S=(0,d.getCredentialsBatch)(e),g=(0,a.createSelector)((e=>(0,i.credentialsQuerySelector)(e,p)),c.fieldMappersSelector,S),m=(0,u.optimizeBatchSelector)(g);return(0,a.createSelector)(m,n.sortedSharedItemIdsSelector,o.limitedSharingItemsSelector,s.credentialCategoriesSelector,l.iconsSelector,d.viewCredentialsBatch)}},351443:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listViewSelector=void 0;const a=r(432034),o=r(825501),n=r(980993),s=r(691210),i=r(779895),c=r(791892);t.listViewSelector=(0,a.createSelector)(n.sortedSharedItemIdsSelector,s.limitedSharingItemsSelector,i.credentialCategoriesSelector,c.iconsSelector,((e,t,r,a)=>n=>(0,o.viewCredentialsBatch)(n,e,t,r,a)))},919325:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getQueryByDomainSelector=void 0;const a=r(324589),o=r(949960),n=r(885505),s=r(488083);t.getQueryByDomainSelector=e=>(0,a.getQuerySelector)((0,s.getCredentialsByDomainSelector)(e),n.credentialMatchSelector,o.fieldMappersSelector)},841841:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.querySelector=void 0;const a=r(324589),o=r(751319),n=r(949960),s=r(885505);t.querySelector=(0,a.getQuerySelector)(o.credentialsSelector,s.credentialMatchSelector,n.fieldMappersSelector)},292897:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sortTokenSelector=void 0;const a=r(401067),o=r(735893);t.sortTokenSelector=(0,o.createOptimizedSortTokenSelector)(((e,{sortToken:t})=>t),a.identity)},83659:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unsafeAllCredentialsSelector=void 0,t.unsafeAllCredentialsSelector=e=>e.userSession.personalData.credentials},460581:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewedCredentialSelector=void 0;const a=r(488542),o=r(691210),n=r(352102),s=r(719736),i=r(779895),c=r(416593),l=r(791892),d=r(807944);t.viewedCredentialSelector=(e,t)=>{const r=(0,s.credentialSelector)(e,t);if(!r)return;const u=(0,i.credentialCategoriesSelector)(e),p=(0,n.sharingDataSelector)(e),S=(0,c.userIdSelector)(e),g=(0,o.limitedSharingItemsSelector)(e),m=(0,l.iconsSelector)(e),y=(0,d.spacesSelector)(e);return(0,a.viewCredential)(r,p,S,g,u,m,y)}},628831:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewedQueriedCredentialsByDomainSelector=void 0;const a=r(919325),o=r(351443),n=r(563566);t.viewedQueriedCredentialsByDomainSelector=(e,t)=>{const{domain:r,...s}=t,i=(0,a.getQueryByDomainSelector)(r)(e,s),c=(0,o.listViewSelector)(e);return(0,n.viewListResults)(c)(i)}},866663:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewedQueriedCredentialsSelector=void 0;const a=r(563566),o=r(841841),n=r(351443);t.viewedQueriedCredentialsSelector=(e,t)=>{const r=(0,o.querySelector)(e,t),s=(0,n.listViewSelector)(e);return(0,a.viewListResults)(s)(r)}},709763:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createCredential=t.createBaseCredentialModel=void 0;const a=r(401067),o=r(421178),n=r(632626),s=r(261923),i=r(298416),c=r(947975),l=r(278320),d=r(500053),u=r(390771),p=r(123439),S=r(178163),g=r(823136);t.createBaseCredentialModel=(e=n.Country.NO_TYPE)=>{const t=(0,d.getUnixTimestamp)();return{kwType:"KWAuthentifiant",Id:(0,l.generateItemUuid)(),AnonId:(0,l.generateItemUuid)(),CreationDatetime:t,LastBackupTime:0,LastUse:t,LocaleFormat:e}},t.createCredential=async function({storeService:e,sessionService:r,eventLoggerService:l,applicationModulesAccess:d},m,y){if(!e.isAuthenticated())throw new Error("No session available to updateCredential");const h=await(0,g.getDefaultSpaceId)(e),f=(0,p.getUrlFields)(m.url,!0),{email:v,login:T,secondaryLogin:A}=(0,s.normalizeUsernames)(m.email,m.login,m.secondaryLogin),P=e.getPersonalData(),w=e.getPlatformInfo(),b=(0,p.getCategoryIdByName)(P,m.category),I=(0,a.defaultTo)("",m.password),E=(0,a.defaultTo)(h,m.spaceId),C=I?await(0,c.evaluatePasswordStrength)(I):0,_=y||(()=>({})),D=new o.ParsedURL(m.url).getRootDomain(),O=(0,i.sanitizeInputPersonalData)({...(0,t.createBaseCredentialModel)(n.Country[w.country]),AutoProtected:m.protectWithMasterPassword,Title:D,Email:v,Login:T,SubdomainOnly:m.onlyForThisSubdomain,SecondaryLogin:A,Password:I,Strength:C,Status:"ACCOUNT_NOT_VERIFIED",Category:b,SpaceId:E,AutoLogin:m.autoLogin??!0,...f,..._(m)});return(0,u.saveCredentialAsPersonalDataItem)({storeService:e,sessionService:r,eventLoggerService:l,applicationModulesAccess:d},O),d&&(0,S.shouldSendCreateOrModifiedCredentialActivityLog)(e,d,O)&&await(0,S.computeAndSendCreatedCredentialActivityLog)(d,{domainUrl:O.Url}),{credentialId:O.Id}}},123439:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUrlFields=t.getCategoryIdByName=void 0;const a=r(587496);t.getCategoryIdByName=(e,t)=>{const r=e.credentialCategories;if(!t)return"";if(r.find((e=>e.Id===t)))return t;const a=r.find((e=>e.CategoryName===t));return a?.Id},t.getUrlFields=(e,t,r)=>{const o=r?.Url!==e,n=(0,a.cleanUrlForPersonalData)(e,{keepQueryString:t}),s=t&&o?{UserSelectedUrl:n,UseFixedUrl:!0}:{UserSelectedUrl:r?.UserSelectedUrl??"",UseFixedUrl:r?.UseFixedUrl??!1};return{Url:n,TrustedUrlGroup:(0,a.getUpdatedTrustedUrlList)(r?.TrustedUrlGroup??[],n),...s}}},390771:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveCredentialAsPersonalDataItem=void 0;const a=r(700033),o=r(532965),n=r(448313),s=r(412362),i=r(986691),c=r(656915),l=r(673566),d=r(885225),u=r(823136),p=r(488542),S=r(579980);t.saveCredentialAsPersonalDataItem=async function({storeService:e,sessionService:t,eventLoggerService:r,applicationModulesAccess:g},m,y){y&&(0,p.notifySharersCredentialUpdated)(e,y,m,g);const h=e.getPersonalData(),f=(0,l.getUpdatedItemChangeHistory)({deviceName:e.getLocalSettings().deviceName,personalData:h,change:(0,d.makeUpdateChange)(m),userLogin:e.getUserLogin(),platformInfo:(0,c.platformInfoSelector)(e.getState())});let v=null;const T=(0,s.getInstance)(),A=(0,i.getInstance)();try{v=A.lockTopic("iconsUpdates"),e.dispatch((0,n.savePersonalDataItem)(m,m.kwType,f)),await t.getInstance().user.persistPersonalData(),(0,p.afterCredentialSaved)(e,m);const s={type:"credentialUpdates",credentialIds:[m.Id]};await T.add("iconsUpdates",s),y?(0,S.logEditVaultItem)(e,r,m,y):(0,S.logAddVaultItem)(e,r,m);const{commands:i}=g.createClients().vaultItemsCrud;await i.emitTemporaryVaultItemEvent({ids:[m.Id],eventType:y?o.EventType.Updated:o.EventType.Created}),(0,u.getDebounceSync)(e,t)({immediateCall:!0},a.Trigger.Save)}finally{v&&A.releaseTopic("iconsUpdates",v)}}},688779:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateCredential=void 0;const a=r(719736),o=r(500053),n=r(390771),s=r(123439),i=r(178163);t.updateCredential=async function({storeService:e,sessionService:t,eventLoggerService:r,applicationModulesAccess:c},l,d){if(!e.isAuthenticated())throw new Error("No session available to updateCredential");const u=e.getState(),p=(0,a.credentialSelector)(u,l.id);if(!p)throw new Error("Credential does not exist, cant update");const S=l.update.url?(0,s.getUrlFields)(l.update.url,l.update.isUrlSelectedByUser,p):{},g=d||(()=>({})),m={...p,...S,Password:void 0!==l.update.password?l.update.password:p.Password,Email:l.update.email??p.Email,Login:l.update.login??p.Login,Checked:void 0!==l.update.isExcludedFromHealth?l.update.isExcludedFromHealth:p.Checked,LinkedServices:l.update.linkedServices??p.LinkedServices,ModificationDatetime:(0,o.getUnixTimestamp)(),...g(l)};(0,n.saveCredentialAsPersonalDataItem)({storeService:e,sessionService:t,eventLoggerService:r,applicationModulesAccess:c},m,p),c&&(0,i.shouldSendCreateOrModifiedCredentialActivityLog)(e,c,m)&&await(0,i.computeAndSendModifiedCredentialActivityLog)(c,{domainUrl:m.Url})}},238786:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isAmazonWebsite=void 0;const a=r(421178);t.isAmazonWebsite=e=>"amazon"===new a.ParsedURL(e).getRootDomainName()},587496:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUpdatedTrustedUrlList=t.cleanUrlForPersonalData=t.getBestUrl=t.getFirstTrustedUrl=t.getBaseTrustedUrls=void 0;const a=r(51121),o=r(401067),n=r(421178),s=r(238786),i=r(500053),c=e=>new n.ParsedURL(e).getUrlWithFallbackHttpsProtocol(),l=(0,o.compose)((e=>{const{protocol:t,hostname:r,port:o}=(0,a.parse)(e);return t&&/^https?:/.test(t)?(0,a.format)({protocol:t,hostname:r,port:o}):null}),c,o.trim),d=e=>!(0,o.isNil)(e);function u(e,t){if(!e)return"";if((0,s.isAmazonWebsite)(e))return e;let r=e;return{keepQueryString:!1,...t}.keepQueryString||(r=function(e){const t=e.indexOf("?");return t>-1?e.slice(0,t):e}(r)),c(r)}t.getBaseTrustedUrls=(0,o.compose)((e=>e.filter(d)),(0,o.map)(l),(0,o.map)((0,o.defaultTo)("")),(0,o.map)((0,o.prop)("TrustedUrl")),(0,o.defaultTo)([])),t.getFirstTrustedUrl=e=>(0,o.defaultTo)("")((0,o.head)((0,t.getBaseTrustedUrls)(e.TrustedUrlGroup))),t.getBestUrl=e=>{const r=(a=e).UseFixedUrl&&a.UserSelectedUrl?a.UserSelectedUrl:null;var a;return r&&r.length?r:e.Url&&e.Url.length?e.Url:(0,t.getFirstTrustedUrl)(e)},t.cleanUrlForPersonalData=u,t.getUpdatedTrustedUrlList=function(e,t){const r=u(t),a=new n.ParsedURL(r).getRootDomain(),o=(e||[]).filter((e=>new n.ParsedURL(e.TrustedUrl).getRootDomain()===a));if(o.some((e=>e.TrustedUrl===r)))return o;const s=o.length>=20?o.length-20+1:0;return o.slice(s).concat({TrustedUrl:r,TrustedUrlExpire:(0,i.getUnixTimestamp)().toString()})}},261923:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeUsernames=void 0;const a=r(401067),o=r(428445);t.normalizeUsernames=function(e,t,r){const n=(0,a.defaultTo)("");let s=e,i=t;return(0,o.looksLikeEmail)(t)?(s=t,(0,o.looksLikeEmail)(e)?(s=e,i=""):i=e):(0,o.looksLikeEmail)(e)||((0,a.isEmpty)(e)||(i=e),(0,o.looksLikeEmail)(t)?s=t:((0,a.isEmpty)(t)||(i=t),s="")),{email:n(s),login:n(i),secondaryLogin:n(r)}}},371120:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.detailView=void 0;const a=(0,r(401067).defaultTo)("");t.detailView=e=>{if(e)return{id:e.Id,categoryName:a(e.CategoryName)}},t.listView=e=>e.map(t.detailView)},165968:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.detailView=void 0;const a=r(401067),o=r(782043),n=r(371120),s=r(290073),i=r(106205),c=(0,a.defaultTo)(""),l=(0,a.defaultTo)(!1);t.detailView=(0,a.curry)(((e,t,r,a,d)=>{const u=t(d.Category),p=e(d.Id),S=r(d.Url),g=c(d.Password),m=a(d),y={addedByDashlane:(0,i.getDashlaneDefinedLinkedWebsites)(d.Url),addedByUser:(0,i.getUserAddedLinkedWebsiteDomains)(d)};return{...(0,o.dataModelDetailView)(d),autoLogin:d.AutoLogin||!1,autoProtected:l(d.AutoProtected),category:(0,n.detailView)(u),domainIcon:S,email:c(d.Email),forceCategorizedSpace:m,linkedWebsites:y,login:c(d.Login),note:c(d.Note),hasOtp:Boolean(d.OtpSecret)||Boolean(d.OtpUrl),otpSecret:c(d.OtpSecret),otpUrl:c(d.OtpUrl),password:g,secondaryLogin:d.SecondaryLogin,sharingStatus:p,strength:d.Strength||0,subdomainOnly:d.SubdomainOnly||!1,title:c(d.Title||(0,s.getDomainForCredential)(d)),url:c(d.Url||d.UserSelectedUrl)}}))},529179:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=void 0;const a=r(401067),o=r(782043),n=r(371120),s=r(290073),i=(0,a.defaultTo)("");t.itemView=(0,a.curry)(((e,t,r,c)=>{const l=t(c.Category);return{...(0,o.dataModelItemView)(c),autoProtected:(0,a.defaultTo)(!1,c.AutoProtected),category:(0,n.detailView)(l),domainIcon:r(c.Url),email:i(c.Email),login:i(c.Login),password:i(c.Password),sharingSatus:e(c.Id),title:i(c.Title||(0,s.getDomainForCredential)(c)),url:i(c.Url||c.UserSelectedUrl)}})),t.listView=(e,r,a,o)=>{const n=(0,t.itemView)(e,r,a);return o.map(n)}},319065:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeDataManagementController=void 0;const a=r(700033),o=r(535834),n=r(650886),s=r(176496),i=r(823136),c=r(684511),l={immediateCall:!0};t.makeDataManagementController=e=>{const t=(0,i.getDebounceSync)(e.storeService,e.sessionService);return{savePaymentCardFromClient:r=>function(e,t,r){(0,o.savePaymentCard)(e,r),t(l,a.Trigger.Save)}({storeService:e.storeService,sessionService:e.sessionService,eventLoggerService:e.eventLoggerService},t,r),savePersonalDataItem:r=>async function(e,t,r){const{storeService:s,sessionService:i,eventLoggerService:d,applicationModulesAccess:u}=e;if("KWPaymentMean_creditCard"===r.kwType)return(0,o.savePaymentCard)({storeService:s,sessionService:i,eventLoggerService:d},r.content),t(l,a.Trigger.Save),Promise.resolve({success:!0,itemId:""});{const o=await(0,n.addPersonalDataItem)({storeService:s,sessionService:i,eventLoggerService:d,applicationModulesAccess:u},r),p=s.getState(),S=(0,c.isSharedSelector)(p,r.content.id);return"KWAuthentifiant"===r.kwType&&r.shouldSkipSync||(S?await e.sessionService.getInstance().user.attemptSync(a.Trigger.SettingsChange):t(l,a.Trigger.Save)),o}}({storeService:e.storeService,sessionService:e.sessionService,eventLoggerService:e.eventLoggerService,applicationModulesAccess:e.applicationModulesAccess},t,r),removePersonalDataItem:t=>function(e,t){return(0,s.deletePersonalDataItem)(e,t)}({storeService:e.storeService,wsService:e.wsService,eventLoggerService:e.eventLoggerService,applicationModulesAccess:e.applicationModulesAccess},t),updateMetadataItemFilledOnPage:(r,o,s)=>function(e,t,r,o,s){(0,n.updatePersonalDataUsageMetadata)(e,r,o,s),t({},a.Trigger.SaveMeta)}(e.storeService,t,r,o,s)}}},453682:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.dedupItems=t.merge=void 0,t.merge=(e,t,r)=>{const a={};return Object.keys(r).every((o=>{const n=r[o](e[o],t[o]);return n.success&&(a[o]=n.result),n.success}))?{success:!0,result:{...e,...t,...a}}:{success:!1}},t.dedupItems=(e,r)=>a=>{const o=[],n={};for(const s of a){const a=e.reduce(((e,t)=>`${e}${s[t]}`),"");if(a in n){const e=n[a];let i=!1;for(const a of e){const e=o[a],n=(0,t.merge)(s,e,r);if(n.success){o[a]=n.result,i=!0;break}}i||(o.push(s),e.push(o.length-1))}else o.push(s),n[a]=[o.length-1]}return o}},366982:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.concatMerge=t.minMerge=t.maxMerge=t.sumMerge=t.genericMerge=t.boolEqual=t.strictEqual=void 0,t.strictEqual=(e,t)=>e===t?{success:!0,result:e}:{success:!1},t.boolEqual=(e,t)=>Boolean(e)===Boolean(t)?{success:!0,result:e}:{success:!1},t.genericMerge=(e,t)=>e===t?{success:!0,result:e}:e&&t?{success:!1}:{success:!0,result:e||t};const r=e=>(t,r)=>({success:!0,result:void 0===t&&void 0===r?void 0:e(t??0,r??0)});t.sumMerge=r(((e,t)=>e+t)),t.maxMerge=r(Math.max),t.minMerge=r(Math.min),t.concatMerge=(e,t)=>({success:!0,result:void 0===e&&void 0===t?void 0:[...e??[],...t??[]]})},645157:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRemoveChangeHistory=void 0;const a=r(673566),o=r(656915),n=r(416593),s=r(576330),i=r(885225);t.getRemoveChangeHistory=function(e,t){const r=e.getState(),c=(0,s.personalDataSelector)(r),l=(0,o.platformInfoSelector)(r),d=(0,n.userLoginSelector)(r),{localSettings:u}=e.getState().userSession,p=u.deviceName,S=(0,i.makeRemovalChange)(t);return(0,a.getUpdatedItemChangeHistory)({change:S,deviceName:p,personalData:c,userLogin:d,platformInfo:l})}},176496:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deletePersonalDataItem=t.findPersonalDataItemToDelete=void 0;const a=r(401067),o=r(632626),n=r(658107),s=r(471646),i=r(795623),c=r(645291),l=r(645157),d=r(749551),u=r(670252),p=r(736884),S=r(736513),g=r(663698),m=r(290622),y=r(416593),h=r(976089),f=r(579980),v=r(700033),T=r(692310),A=r(178163),P=["addresses","bankAccounts","companies","credentialCategories","credentials","driverLicenses","emails","fiscalIds","idCards","identities","noteCategories","notes","passkeys","passports","paymentCards","paypalAccounts","personalWebsites","phones","secrets","secureFileInfo","socialSecurityIds"];function w(e,t){let r,o=0;const n=e.getPersonalData(),s=(0,a.pick)(P,n);for(const e of Object.keys(s))if(r=(0,d.findDataModelObject)(t,s[e]),r){o=s[e].length;break}return{itemToDelete:r,currentItemsCountForDataType:o}}t.findPersonalDataItemToDelete=w,t.deletePersonalDataItem=async function({storeService:e,wsService:t,eventLoggerService:r,applicationModulesAccess:a},d,P){const{FORBIDDEN_GROUP_ITEM:b,FORBIDDEN_LAST_ADMIN:I,INTERNAL_ERROR:E,LEAVE_SHARING_FAILED:C,NOT_AUTHORIZED:_,NOT_FOUND:D}=o.RemovePersonalDataItemFailureReason;let O=null;try{if(!e.isAuthenticated()){const e="No session available to delete personal item";return i.Debugger.log(e),{success:!1,reason:_,message:e}}const{itemToDelete:u}=w(e,d);if(!u){const e=`Unable to find personal item to delete: ${d}`;return i.Debugger.error(e),{success:!1,reason:D,message:e}}const E=(0,o.isCredential)(u);if(E||(0,o.isNote)(u)||(0,o.isSecret)(u)){const r=await(0,S.makeCryptoService)(),a=e.getUserLogin(),o=(0,m.ukiSelector)(e.getState()),{makeRefuseItemGroupEvent:i}=(0,p.makeItemGroupService)(t,r),{Id:c}=u,{userGroups:d,itemGroups:y}=e.getSharingData(),h=(0,s.findItemItemGroup)(c,y),f=P&&P.ignoreSharing;if(h&&!f){const t=(0,n.isUserLastAdmin)(h,a),r=(0,n.doesUserReceiveItemGroupViaGroup)(h,d,a);if(t||r)return{success:!1,reason:t?I:b,message:"Unshare the item before deleting it"};try{const{groupId:e,revision:t}=h,{refuseItemGroup:r}=(0,g.makeItemGroupWS)(),n=i(e,t,null);await r(a,o,n)}catch(e){return{success:!1,reason:C,message:`${e}`}}}O=(0,l.getRemoveChangeHistory)(e,u)}(0,f.logDeleteVaultItem)(e,r,u,v.UpdateCredentialOrigin.Manual,P?.multiSelectId||null);const M=(0,c.removePersonalItem)(u.kwType,u.Id,O);if(e.dispatch(M),E){const t=e.getState();if((0,y.isOnboardingNotificationShowingSelector)(t)){const t=(0,h.webOnboardingModeReset)();e.dispatch(t)}}if(a&&E&&(0,A.hasVaultAuditLogsFFActivated)(a)){const t=(0,T.currentTeamIdSelector)(e.getState());u.SpaceId===t&&await(0,A.computeAndSendDeletedCredentialActivityLog)(a,{domainUrl:u.Url})}return{success:!0}}catch(e){const t=`[DataManagement] - deletePersonalDataItem: ${e}`,r=new Error(t);return(0,u.sendExceptionLog)({error:r}),{success:!1,reason:E,message:t}}}},57779:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.duplicateSharedElements=void 0;const a=r(632626),o=r(448313),n=r(278320),s=r(749551),i=r(412362),c=r(986691);t.duplicateSharedElements=async function(e,t){let r=null;const l=(0,i.getInstance)(),d=(0,c.getInstance)(),{notes:u,credentials:p,changeHistories:S,secrets:g}=e.getPersonalData(),m=[...u,...p,...g],y=(0,s.findDataModelObject)(t,m);if(!y)return null;const h=(0,n.generateItemUuid)(),f={...y,Id:h},v=S.find((e=>e.ObjectId.toUpperCase()===t.toUpperCase()));if((0,a.isCredential)(y)){r=d.lockTopic("iconsUpdates");const e={credentialIds:[h],type:"credentialUpdates"};await l.add("iconsUpdates",e)}const T=(0,o.savePersonalDataItem)(f,f.kwType,v);return e.dispatch(T),r&&d.releaseTopic("iconsUpdates",r),h}},775912:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(257012),o=r(940086);t.config={commands:{getPersonalDataExport:{handler:a.getPersonalDataExport}},queries:{getIsForcedDomainsEnabled:{selector:o.isForcedDomainsEnabledSelector}},liveQueries:{}}},940086:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isForcedDomainsEnabledSelector=void 0;const a=r(416593);t.isForcedDomainsEnabledSelector=e=>{const t=(0,a.activeSpacesSelector)(e)[0];return t?.info?.forcedDomainsEnabled??!1}},24108:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCredentialsExport=void 0;const a=r(632626),o=r(533553),n=r(428780),s=e=>e.reduce(((e,t)=>(t.VaultItems.filter((e=>e.Type===a.DataModelType.KWAuthentifiant)).map((e=>e.Id)).forEach((r=>{e[r]?e[r].push(t.Name):e[r]=[t.Name]})),e)),{});t.getCredentialsExport=function(e){const t=e.credentials,r=e.collections,a=s(r),i=[{headerKey:"username",dataKey:"Email"},{headerKey:"username2",dataKey:"Login"},{headerKey:"username3",dataKey:"SecondaryLogin"},{headerKey:"title",dataKey:"Title"},{headerKey:"password",dataKey:"Password"},{headerKey:"note",dataKey:"Note"},{headerKey:"url",dataKey:"Url"},{headerKey:"category",dataKey:"Category"},{headerKey:"otpSecret",dataKey:"OtpSecret"}];return(0,n.formatDataToCSV)([(0,n.formatHeader)(i),(c=t,c.map((e=>{const t=[e.Email,e.Login,e.SecondaryLogin].filter((e=>void 0!==e&&""!==e)),[r="",n="",s=""]=t;return i.map((t=>{const i=e[t.dataKey]??"";if("Category"===t.dataKey)return(0,o.handleSpecialCharacter)(((e,t)=>{const r=e[t];return r?r.join(", "):""})(a,e.Id));if("Email"===t.dataKey)return(0,o.handleSpecialCharacter)(r);if("Login"===t.dataKey)return(0,o.handleSpecialCharacter)(n);if("SecondaryLogin"===t.dataKey)return(0,o.handleSpecialCharacter)(s);if("Note"===t.dataKey&&""!==i)return(0,o.handleSpecialCharacter)(i);if("Password"===t.dataKey){const e=`${i}`;return(0,o.handleSpecialCharacter)(e)}{const e=`${i}`;return(0,o.handleSpecialCharacter)(e)}})).join(",")}))).join("\r\n")]);var c}},888096:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCSVExport=void 0;const a=r(249267);a.configure({useWebWorkers:!1});const o=r(24108),n=r(831107),s=r(40549),i=r(108177),c=r(829375),l=[{filename:"credentials",generator:o.getCredentialsExport},{filename:"personalInfo",generator:c.getPersonalInfoExport},{filename:"securenotes",generator:n.getSecureNotesExport},{filename:"payments",generator:s.getPaymentsExport},{filename:"ids",generator:i.getIdsExport}];t.getCSVExport=async function(e){const t=new a.ZipWriter(new a.BlobWriter("application/zip")),r=[];for(const{filename:o,generator:n}of l){const s=n(e);r.push(t.add(`${o}.csv`,new a.BlobReader(new Blob([s],{type:"text/csv"}))))}await Promise.all(r);const o=await t.close();return await(e=>new Promise(((t,r)=>{const a=new FileReader;a.readAsDataURL(e),a.onloadend=()=>{const e=a.result;e?t(e.toString()):r(new Error("Error creating CSV export."))}})))(o)}},854130:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDashlaneSecureExport=void 0;const a=r(401067),o=r(956668),n=r(761797);t.getDashlaneSecureExport=async function(e,t){const r=(0,a.join)(";",(0,a.pluck)("Id",t));t.forEach((e=>{delete e.Attachments}));const s=(0,n.getDashlaneXml)(t),i=(0,o.utf16ToDeflatedUtf8)(s),c=await e.encrypt(i);return(0,a.join)("\n",["-------------------- Dashlane Secured Export ----------------------","--------------------        Id BEGIN         ----------------------",r,"--------------------         Id END          ----------------------","--------------------       Data BEGIN        ----------------------",c,"--------------------        Data END         ----------------------","--------------------       Files BEGIN       ----------------------","--------------------        Files END        ----------------------\n"])}},108177:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getIdsExport=void 0;const a=r(672099),o=r(533553),n=r(428780);t.getIdsExport=function(e){const t=new Map;e.identities.forEach((e=>{t.set(e.Id,e)}));const r=e.idCards,s=e.passports,i=e.driverLicenses,c=e.socialSecurityIds,l=e.fiscalIds,d=[{headerKey:"type",dataKey:"type"},{headerKey:"number",dataKey:"Number"},{headerKey:"name",dataKey:"Fullname"},{headerKey:"issue_date",dataKey:"DeliveryDate"},{headerKey:"expiration_date",dataKey:"ExpireDate"},{headerKey:"place_of_issue",dataKey:"DeliveryPlace"},{headerKey:"state",dataKey:"State"}];return(0,n.formatDataToCSV)([(0,n.formatHeader)(d),(e=>(e=>e.map((e=>{const r=t.get(e.LinkedIdentity);return d.map((t=>{const n=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return"card";if("Fullname"===t.dataKey&&r){const e=(0,a.identityToName)(r)??n;return(0,o.handleSpecialCharacter)(e)}return(0,o.handleSpecialCharacter)(n)})).join(",")})))(e).join("\r\n"))(r),(e=>(e=>e.map((e=>{const r=t.get(e.LinkedIdentity);return d.map((t=>{const n=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return"passport";if("Fullname"===t.dataKey&&r){const e=(0,a.identityToName)(r)??n;return(0,o.handleSpecialCharacter)(e)}return(0,o.handleSpecialCharacter)(n)})).join(",")})))(e).join("\r\n"))(s),(e=>(e=>e.map((e=>{const r=t.get(e.LinkedIdentity);return d.map((t=>{const n=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return"license";if("Fullname"===t.dataKey&&r){const e=(0,a.identityToName)(r)??n;return(0,o.handleSpecialCharacter)(e)}return(0,o.handleSpecialCharacter)(n)})).join(",")})))(e).join("\r\n"))(i),(e=>(e=>e.map((e=>{const r=t.get(e.Id);return d.map((t=>{const n=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return"social_security";if("Number"===t.dataKey){const t=e.SocialSecurityNumber;return(0,o.handleSpecialCharacter)(t)}if("Fullname"===t.dataKey){const t=r?(0,a.identityToName)(r):e.SocialSecurityFullname;return(0,o.handleSpecialCharacter)(t)}return(0,o.handleSpecialCharacter)(n)})).join(",")})))(e).join("\r\n"))(c),(e=>(e=>e.map((e=>d.map((t=>{const r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,o.handleSpecialCharacter)("tax_number");if("Number"===t.dataKey){const t=e.FiscalNumber;return(0,o.handleSpecialCharacter)(t)}{const e=`${r}`;return(0,o.handleSpecialCharacter)(e)}})).join(","))))(e).join("\r\n"))(l)])}},40549:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPaymentsExport=void 0;const a=r(533553),o=r(428780);t.getPaymentsExport=function(e){const t=e.bankAccounts,r=e.paymentCards,n=[{headerKey:"type",dataKey:"Type"},{headerKey:"account_name",dataKey:"BankAccountName"},{headerKey:"account_holder",dataKey:"BankAccountOwner"},{headerKey:"cc_number",dataKey:"CardNumber"},{headerKey:"code",dataKey:"SecurityCode"},{headerKey:"expiration_month",dataKey:"ExpireMonth"},{headerKey:"expiration_year",dataKey:"ExpireYear"},{headerKey:"routing_number",dataKey:"BankAccountBIC"},{headerKey:"account_number",dataKey:"BankAccountIBAN"},{headerKey:"country",dataKey:"LocaleFormat"},{headerKey:"issuing_bank",dataKey:"BankAccountBank"},{headerKey:"note",dataKey:"CCNote"},{headerKey:"name",dataKey:"Name"}];return(0,o.formatDataToCSV)([(0,o.formatHeader)(n),(i=t,(e=>e.map((e=>n.map((t=>{const r=`${e[t.dataKey]??""}`;if("Type"===t.dataKey)return(0,a.handleSpecialCharacter)("bank");{const e=`${r}`;return(0,a.handleSpecialCharacter)(e)}})).join(","))))(i).join("\r\n")),(s=r,(e=>e.map((e=>n.map((t=>{const r=`${e[t.dataKey]??""}`;if("Type"===t.dataKey)return(0,a.handleSpecialCharacter)("payment_card");if("BankAccountName"===t.dataKey){const t=e.OwnerName;return(0,a.handleSpecialCharacter)(t)}return(0,a.handleSpecialCharacter)(r)})).join(","))))(s).join("\r\n"))]);var s,i}},257012:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPersonalDataExport=t.getFilteredPersonalData=t.filterNonExportableData=void 0;const a=r(632626),o=r(854130),n=r(72365),s=r(65675),i=r(249901),c=r(691210),l=r(657989),d=r(340602),u=r(99281),p=r(516018),S=r(310770),g=r(180624),m=r(751319),y=r(723437),h=r(509774),f=r(326147),v=r(141092),T=r(628074),A=r(181904),P=r(675705),w=r(518665),b=r(865401),I=r(358235),E=r(381473),C=r(82439),_=r(727147),D=r(940086),O=r(888096);t.filterNonExportableData=(e,t)=>{const r=(0,D.isForcedDomainsEnabledSelector)(e),o=(0,c.limitedSharingItemsSelector)(e);return t.filter((e=>{let t=!1;const n=!!o[e.Id]||!!e.limitedPermissions;return r&&(0,a.isDataModelObject)(e)&&(t=e.SpaceId!==i.PERSONAL_SPACE_ID),!t&&!n}))};const M=(e,r)=>{const a=(0,l.quarantinedSpacesSelector)(e);return(0,t.filterNonExportableData)(e,(0,d.filterOutQuarantinedItems)(r(e),a))};t.getFilteredPersonalData=e=>({addresses:M(e,u.addressesSelector),bankAccounts:M(e,p.bankAccountsSelector),collections:M(e,S.collectionsSelector),companies:M(e,g.companiesSelector),credentials:M(e,m.credentialsSelector),driverLicenses:M(e,h.driverLicensesSelector),emails:M(e,f.emailsSelector),fiscalIds:M(e,v.fiscalIdsSelector),idCards:M(e,y.idCardsSelector),identities:M(e,T.identitiesSelector),notes:M(e,P.notesSelector),passkeys:M(e,w.passkeysSelector),passports:M(e,b.passportsSelector),paymentCards:M(e,I.paymentCardsSelector),personalWebsites:M(e,E.personalWebsitesSelector),phones:M(e,C.phonesSelector),secrets:M(e,A.secretsSelector),socialSecurityIds:M(e,_.socialSecurityIdsSelector)}),t.getPersonalDataExport=async function(e,r){const{storeService:i}=e,c=i.getState(),{exportType:l,password:d}=r,u=(0,t.getFilteredPersonalData)(c);switch(l){case"csv":return{success:!0,response:{filename:"dashlane-credential-export.zip",content:await(0,O.getCSVExport)(u)}};case"secure-dashlane":{if(!d)return{success:!1,error:{code:a.GetPersonalDataExportErrorMessage.UNDEFINED_PASSWORD_ERROR}};const e=(0,n.makeDataEncryptorService)(i),t=(0,s.makeFlexibleMarkerCryptoConfig)("argon2d");e.setInstance({raw:d},"",t);const r=Object.values(u).flat().map((e=>({...e})));return{success:!0,response:{filename:"Dashlane Export.dash",content:await(0,o.getDashlaneSecureExport)(e.getInstance(),r)}}}default:return{success:!1,error:{code:a.GetPersonalDataExportErrorMessage.UNSUPPORTED_DATATYPE_ERROR}}}}},829375:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPersonalInfoExport=void 0;const a=r(322630),o=r(632626),n=r(533553),s=r(428780),i=e=>{const{LocaleFormat:t,Number:r}=e;if(t&&t!==o.Country.UNIVERSAL&&t!==o.Country.NO_TYPE&&(0,a.isSupportedCountry)(t)){const t=o.Country[e.LocaleFormat];return`+${(0,a.getCountryCallingCode)(t)}${r}`}return r};t.getPersonalInfoExport=function(e){const t=e.identities,r=e.emails,a=e.phones,o=e.addresses,c=e.companies,l=e.personalWebsites,d=[{headerKey:"type",dataKey:"type"},{headerKey:"title",dataKey:"Title"},{headerKey:"first_name",dataKey:"FirstName"},{headerKey:"middle_name",dataKey:"MiddleName"},{headerKey:"last_name",dataKey:"LastName"},{headerKey:"login",dataKey:"Pseudo"},{headerKey:"date_of_birth",dataKey:"BirthDate"},{headerKey:"place_of_birth",dataKey:"BirthPlace"},{headerKey:"email",dataKey:"Email"},{headerKey:"email_type",dataKey:"Type"},{headerKey:"item_name",dataKey:"Name"},{headerKey:"phone_number",dataKey:"Number"},{headerKey:"address",dataKey:"AddressFull"},{headerKey:"country",dataKey:"Country"},{headerKey:"state",dataKey:"State"},{headerKey:"city",dataKey:"City"},{headerKey:"zip",dataKey:"ZipCode"},{headerKey:"address_recipient",dataKey:"Receiver"},{headerKey:"address_building",dataKey:"Building"},{headerKey:"address_apartment",dataKey:"Door"},{headerKey:"address_floor",dataKey:"Floor"},{headerKey:"address_door_code",dataKey:"DigitCode"},{headerKey:"job_title",dataKey:"JobTitle"},{headerKey:"url",dataKey:"Website"}];return(0,s.formatDataToCSV)([(0,s.formatHeader)(d),(y=t,(e=>e.map((e=>d.map((t=>{const r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,n.handleSpecialCharacter)("name");{const e=`${r}`;return(0,n.handleSpecialCharacter)(e)}})).join(","))))(y).join("\r\n")),(m=r,(e=>e.map((e=>d.map((t=>{const r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,n.handleSpecialCharacter)("email");if("Type"===t.dataKey)return"PERSO"===r?(0,n.handleSpecialCharacter)("personal"):(0,n.handleSpecialCharacter)("business");if("Name"===t.dataKey){const t=e.EmailName??"";return(0,n.handleSpecialCharacter)(t)}{const e=`${r}`;return(0,n.handleSpecialCharacter)(e)}})).join(","))))(m).join("\r\n")),(g=a,(e=>e.map((e=>d.map((t=>{const r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,n.handleSpecialCharacter)("number");if("Type"===t.dataKey)return(0,n.handleSpecialCharacter)("");if("Name"===t.dataKey){const t=e.PhoneName??"";return(0,n.handleSpecialCharacter)(t)}if("Number"===t.dataKey){const t=i(e);return(0,n.handleSpecialCharacter)(t)}{const e=`${r}`;return(0,n.handleSpecialCharacter)(e)}})).join(","))))(g).join("\r\n")),(S=o,(e=>e.map((e=>d.map((t=>{const r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,n.handleSpecialCharacter)("address");if("Name"===t.dataKey){const t=e.AddressName??"";return(0,n.handleSpecialCharacter)(t)}{const e=`${r}`;return(0,n.handleSpecialCharacter)(e)}})).join(","))))(S).join("\r\n")),(p=c,(e=>e.map((e=>d.map((t=>{const r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,n.handleSpecialCharacter)("company");{const e=`${r}`;return(0,n.handleSpecialCharacter)(e)}})).join(","))))(p).join("\r\n")),(u=l,(e=>e.map((e=>d.map((t=>{const r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,n.handleSpecialCharacter)("website");{const e=`${r}`;return(0,n.handleSpecialCharacter)(e)}})).join(","))))(u).join("\r\n"))]);var u,p,S,g,m,y}},831107:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSecureNotesExport=void 0;const a=r(533553),o=r(428780);t.getSecureNotesExport=function(e){const t=e.notes,r=[{headerKey:"title",dataKey:"Title"},{headerKey:"note",dataKey:"Content"}];return(0,o.formatDataToCSV)([(0,o.formatHeader)(r),(e=>e.map((e=>r.map((t=>{const r=e[t.dataKey]??"";if("Content"===t.dataKey&&""!==r)return(0,a.handleSpecialCharacter)(r);{const e=`${r}`;return(0,a.handleSpecialCharacter)(e)}})).join(","))).join("\r\n"))(t)])}},533553:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleSpecialCharacter=void 0,t.handleSpecialCharacter=function(e){return void 0===e?"":e.match(/[,"\n\r]/g)?['"',...e.split("").map((e=>'"'===e?'""':e)),'"'].join(""):e}},428780:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatDataToCSV=t.formatHeader=void 0,t.formatHeader=e=>e.map((e=>e.headerKey)).join(","),t.formatDataToCSV=function(e){return e.filter((e=>e.length>0)).join("\r\n")}},497321:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(992598),o=r(847205),n=r(11507);t.config={commands:{saveGeneratedPassword:{handler:o.saveGeneratedPasswordHandler}},queries:{getGeneratedPassword:{selector:a.viewedGeneratedPasswordSelector},getGeneratedPasswordsCount:{selector:a.countAllGeneratedPasswordsSelector},getGeneratedPasswords:{selector:a.viewedQueriedGeneratedPasswordsSelector},getGeneratedPasswordsPage:{selector:a.generatedPasswordsPageSelector},getGeneratedPasswordsPaginationToken:{selector:a.generatedPasswordsPaginationTokenSelector}},liveQueries:{liveGeneratedPasswordsCount:{operator:n.generatedPasswordCount$},liveGeneratedPasswords:{operator:n.generatedPasswords$}}}},443145:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.findAssociatedCredential=t.associateGeneratedPasswordsToCredential=void 0;const a=r(290073);t.associateGeneratedPasswordsToCredential=function(e,t){return e.filter((e=>!e.AuthId&&e.Domain===(0,a.getDomainForCredential)(t)&&e.Password===t.Password)).map((e=>({...e,AuthId:t.Id})))},t.findAssociatedCredential=function(e,t){if(e?.AuthId)return(t||[]).find((t=>t.Id===e.AuthId))}},94170:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createGeneratedPassword=void 0;const a=r(632626),o=r(278320),n=r(500053);t.createGeneratedPassword=({Id:e=(0,o.generateItemUuid)(),LastBackupTime:t=0,AuthId:r,Domain:s,GeneratedDate:i=(0,n.getUnixTimestamp)(),Password:c,SpaceId:l,Platform:d})=>({kwType:a.DataModelType.KWGeneratedPassword,AuthId:r,Domain:s,GeneratedDate:i,Id:e,SpaceId:l,Password:c,LastBackupTime:t,Platform:d})},847205:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveGeneratedPasswordHandler=void 0;const a=r(344908);t.saveGeneratedPasswordHandler=async function(e,t){const{storeService:r,sessionService:o}=e;return(0,a.saveGeneratedPassword)(r,o,t.password,t.url)}},344908:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateAndSavePassword=t.saveGeneratedPassword=t.generatePassword=t.fixIncoherentSettings=t.getDefaultPasswordGenerationSettings=t.passwordGeneratorDefaultSettings=t.associateGeneratedPasswordsToCredential=void 0;const a=r(928255),o=r(401067),n=r(285465),s=r(632626),i=r(795623),c=r(278320),l=r(500053),d=r(448313),u=r(670252),p=r(94170),S=r(656915);var g=r(443145);function m(e){const r=(0,o.reject)((e=>(0,o.isNil)(e)||(0,o.isEmpty)(e)))({length:e.GeneratorDefaultSize,digits:e.GeneratorDefaultDigits,letters:e.GeneratorDefaultLetters,symbols:e.GeneratorDefaultSymbols,avoidAmbiguous:e.GeneratorDefaultAvoidAmbiguousChars});return y((0,o.merge)(t.passwordGeneratorDefaultSettings,r))}function y(e){return e.digits||e.letters||e.symbols||(e.digits=!0,e.letters=!0,e.symbols=!0),(void 0===e.length||e.length<1)&&(e.length=t.passwordGeneratorDefaultSettings.length),e}function h(e,t){const r=(0,o.isNil)(t)?m(e):y(t);if(!r.digits&&!r.letters&&r.symbols){const a=new Error("Should not generate password from symbols only"),o={length:e.GeneratorDefaultSize,digits:e.GeneratorDefaultDigits,letters:e.GeneratorDefaultLetters,symbols:e.GeneratorDefaultSymbols,avoidAmbiguous:e.GeneratorDefaultAvoidAmbiguousChars},n=`customSettings = ${JSON.stringify(t)}\npersonalSettingsGeneratorDefaults = ${JSON.stringify(o)}`;i.default.error(a),(0,u.sendExceptionLog)({error:a,code:s.ExceptionCriticality.WARNING,precisions:n}),r.digits=!0,r.letters=!0,r.symbols=!0}return(0,n.generate)(r)}function f(e,t,r,a){const o=(0,p.createGeneratedPassword)({Domain:a??"",GeneratedDate:(0,l.getUnixTimestamp)(),Id:(0,c.generateItemUuid)(),Password:r,LastBackupTime:0,Platform:(0,S.platformInfoSelector)(e.getState()).platformName});e.dispatch(d.saveGeneratedPassword(o)),t.getInstance().user.persistPersonalData()}Object.defineProperty(t,"associateGeneratedPasswordsToCredential",{enumerable:!0,get:function(){return g.associateGeneratedPasswordsToCredential}}),t.passwordGeneratorDefaultSettings={length:16,digits:!0,letters:!0,symbols:!0,avoidAmbiguous:!0},t.getDefaultPasswordGenerationSettings=m,t.fixIncoherentSettings=y,t.generatePassword=h,t.saveGeneratedPassword=f,t.generateAndSavePassword=function(e,t,r){if(!e.isAuthenticated())return i.default.log("No session available to generateAndSavePassword"),null;const o=h(e.getPersonalSettings());return a((()=>{f(e,t,o,r)})),o}},11507:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generatedPasswords$=t.generatedPasswordCount$=void 0;const a=r(992598),o=r(555220),n=r(518948),s=r(903343);t.generatedPasswordCount$=()=>(0,n.pipe)((0,s.map)(a.countAllGeneratedPasswordsSelector),(0,s.distinctUntilChanged)()),t.generatedPasswords$=(0,o.getLivePersonalInfo)(a.getLiveGeneratedPasswordsSelector)},691329:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getGeneratedPasswordMappers=void 0,t.getGeneratedPasswordMappers=()=>({id:e=>e.Id,domain:e=>e.Domain,generatedDate:e=>e.GeneratedDate})},545853:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewGeneratedPasswordsBatch=t.getGeneratedPasswordsFirstToken=t.getGeneratedPasswordsSortToken=t.getGeneratedPasswordsFilterToken=void 0;const a=r(920553),o=r(336407);t.getGeneratedPasswordsFilterToken=({filterCriteria:e})=>({filterCriteria:e||[]}),t.getGeneratedPasswordsSortToken=({sortCriteria:e})=>({uniqField:"id",sortCriteria:e||[]}),t.getGeneratedPasswordsFirstToken=(e,t,r,o)=>(0,a.generateFirstToken)(e,t,r.initialBatchSize||30,o),t.viewGeneratedPasswordsBatch=e=>(0,o.listView)(e)},809546:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generatedPasswordMatch=t.searchGetters=void 0;const a=r(382234),o=r(64455);t.searchGetters=[(0,a.stringProp)("Domain")],t.generatedPasswordMatch=(0,o.match)(t.searchGetters)},992598:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generatedPasswordsQuerySelector=t.generatedPasswordsPaginationTokenSelector=t.generatedPasswordsPageSelector=t.getLiveGeneratedPasswordsSelector=t.viewedQueriedGeneratedPasswordsSelector=t.queryGeneratedPasswordsSelector=t.getGeneratedPasswordMappersSelector=t.generatedPasswordMappersSelector=t.viewedGeneratedPasswordSelector=t.generatedPasswordSelector=t.generatedPasswordsSelector=t.countAllGeneratedPasswordsSelector=void 0;const a=r(401067),o=r(563566),n=r(336407),s=r(324589),i=r(809546),c=r(691329),l=r(545853),d=r(432034),u=r(735893),p=r(518948),S=r(920553),g=r(657989),m=r(497006),y=r(340602),h=r(83659),f=r(749551);t.countAllGeneratedPasswordsSelector=e=>e.userSession.personalData.generatedPasswords.length,t.generatedPasswordsSelector=(0,d.createSelector)((e=>e.userSession.personalData.generatedPasswords),g.quarantinedSpacesSelector,h.unsafeAllCredentialsSelector,y.filterOutQuarantinedItems),t.generatedPasswordSelector=(e,r)=>{const a=(0,t.generatedPasswordsSelector)(e);return(0,f.findDataModelObject)(r,a)},t.viewedGeneratedPasswordSelector=(e,r)=>{const a=(0,t.generatedPasswordSelector)(e,r);return(0,n.itemView)(a)},t.generatedPasswordMappersSelector=e=>(0,c.getGeneratedPasswordMappers)();const v=()=>i.generatedPasswordMatch,T=(0,c.getGeneratedPasswordMappers)();t.getGeneratedPasswordMappersSelector=()=>T,t.queryGeneratedPasswordsSelector=(0,s.getQuerySelector)(t.generatedPasswordsSelector,v,t.generatedPasswordMappersSelector),t.viewedQueriedGeneratedPasswordsSelector=(0,a.compose)((0,o.viewListResults)(n.listView),t.queryGeneratedPasswordsSelector),t.getLiveGeneratedPasswordsSelector=(0,m.makeLiveSelectorGetter)(t.generatedPasswordsSelector,(()=>n.listView),v,t.getGeneratedPasswordMappersSelector),t.generatedPasswordsPageSelector=(e,r)=>{const a=(0,u.parseToken)(r),{sortToken:o,filterToken:n}=a,s={sortToken:o,filterToken:n},i=(0,c.getGeneratedPasswordMappers)(),d=(0,t.generatedPasswordsQuerySelector)(e,s),p=(0,S.generateNextToken)(i,a,d),g=(0,S.generatePrevToken)(i,a,d),m=(0,S.getBatch)(i,a,d),y=(0,u.stringifyToken)(p),h=(0,u.stringifyToken)(g);return{batch:(0,l.viewGeneratedPasswordsBatch)(m),nextToken:y,prevToken:h}},t.generatedPasswordsPaginationTokenSelector=(e,r)=>{const a=(0,l.getGeneratedPasswordsSortToken)(r),o=(0,l.getGeneratedPasswordsFilterToken)(r),n=(0,c.getGeneratedPasswordMappers)(),s={sortToken:a,filterToken:o},i=(0,t.generatedPasswordsQuerySelector)(e,s),d=(0,l.getGeneratedPasswordsFirstToken)(n,s,r,i);return(0,u.stringifyToken)(d)};const A=(0,u.createOptimizedSortTokenSelector)(((e,{sortToken:t})=>t),p.identity),P=(0,u.createOptimizedFilterTokenSelector)(((e,{filterToken:t})=>t),p.identity);t.generatedPasswordsQuerySelector=(0,d.createSelector)(c.getGeneratedPasswordMappers,v,A,P,t.generatedPasswordsSelector,u.queryData)},336407:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=void 0;const a=(0,r(401067).defaultTo)("");t.itemView=e=>({domain:a(e.Domain),generatedDate:e.GeneratedDate,password:e.Password,id:e.Id,platform:e.Platform}),t.listView=e=>e.map(t.itemView)},164185:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeEmptyIconUrls=t.computeIconUrls=void 0,t.computeIconUrls=(e,t)=>t.reduce(((t,r)=>{const a=e.find((e=>e&&e.type===r));return t[r]=a?a.url:null,t}),{}),t.makeEmptyIconUrls=e=>(0,t.computeIconUrls)([],e)},256814:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFormattedDomainsFromUrls=t.decryptIconsDomains=void 0;const a=r(401067),o=r(421178),n=r(246445);t.decryptIconsDomains=(e,t)=>{const r=Array.from(e.keys()),a=new Map,o=t.reduce(((e,t)=>(e[(0,n.computeHashMD5)(t)]=t,e)),{});return r.forEach((t=>{const r=o[t];a.set(r,e.get(t))})),a},t.getFormattedDomainsFromUrls=e=>(0,a.uniq)(e.map((e=>new o.ParsedURL(e).getRootDomain()))).filter((e=>"string"==typeof e&&e.length))},436081:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearInstance=t.getInstance=t.setInstance=void 0;const a=r(35949),o=r(123381);let n=null;t.setInstance=(e,t,r)=>(n=n||new a.IconsUpdater(t,e,new o.IconsWS(r)),n),t.getInstance=()=>n,t.clearInstance=()=>{n&&n.teardown(),n=null}},35949:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IconsUpdater=void 0;const a=r(518948),o=r(903343),n=r(735088),s=r(621342),i=r(719736),c=r(751319),l=r(795623),d=r(791892),u=r(216661),p=r(17825),S=r(819979),g=r(670252),m=r(600541),y=r(958639),h=r(721726),f=r(841717);var v;!function(e){e.BreachesOperation="breachesOperation",e.CredentialsOperation="credentialsOperation",e.RefreshOperation="refreshOperation"}(v||(v={})),t.IconsUpdater=class{constructor(e,t,r){this.localStorageService=e,this.storeService=t,this.gateway=r,this._operation$=new a.Subject,this.subs=new Set,this.handleRefreshIcons=async()=>{const e=(0,n.v4)(),t=new Promise((t=>{const r=this._operationResults$.subscribe((a=>{a.id===e&&(t(a.success),r.unsubscribe(),this.subs.delete(r))}));this.subs.add(r)}));return this.triggerRefreshOperation(e),await t},this.handleCredentialUpdates=async e=>{const t=(0,n.v4)(),r=new Promise((e=>{const r=this._operationResults$.subscribe((a=>{a.id===t&&(e(a.success),r.unsubscribe(),this.subs.delete(r))}));this.subs.add(r)}));return this.triggerCredentialsOperation(t,e),await r},this.handleBreachesUpdates=async e=>{const t=(0,n.v4)(),r=new Promise((e=>{const r=this._operationResults$.subscribe((a=>{a.id===t&&(e(a.success),r.unsubscribe(),this.subs.delete(r))}));this.subs.add(r)}));return this.triggerBreachesOperation(t,e),await r},this.triggerCredentialsOperation=(e,t,r=f.defaultIconTypes)=>{this._operation$.next({credentialIds:t,id:e,type:v.CredentialsOperation,iconTypes:r})},this.triggerBreachesOperation=(e,t,r=f.defaultIconTypes)=>{this._operation$.next({breachesIds:t,id:e,type:v.BreachesOperation,iconTypes:r})},this.triggerRefreshOperation=(e,t=f.defaultIconTypes)=>{this._operation$.next({id:e,type:v.RefreshOperation,iconTypes:t})},this.handleOperation=async(e,t)=>{const{type:r,id:a}=t,o={id:a,type:r},n=this.localStorageService.getInstance(),s=this.storeService.getState();try{return await e(t),await n.storeIcons((0,d.iconsCacheSelector)(s)),{...o,success:!0}}catch(e){const r=`[Icons Updater] - handle operation: operation ${t.type} failed with ${e}`;l.default.error(r);const a=new Error(r);return(0,g.sendExceptionLog)({error:a}),console.error(a),{...o,success:!1}}},this.onOperation=async e=>{switch(e.type){case v.CredentialsOperation:return this.handleOperation(((e,t)=>async({credentialIds:r,iconTypes:a})=>{const o=e.getState(),n=r.map((e=>(0,i.credentialSelector)(o,e))).filter((e=>!!e)),s=await(0,S.fetchIconsForCredentials)(o,t,n,a);e.dispatch((0,u.iconsUpdated)(s)),(0,h.default)()&&s.length>0&&(0,y.reportDataUpdate)(e)})(this.storeService,this.gateway),e);case v.BreachesOperation:return this.handleOperation(((e,t)=>async({breachesIds:r,iconTypes:a})=>{const o=e.getState(),n=r.map((e=>(0,s.breachSelector)(o,e))).filter((e=>!!e)),i=await(0,S.fetchIconsForBreaches)(o,t,n,a);e.dispatch((0,u.iconsUpdated)(i))})(this.storeService,this.gateway),e);case v.RefreshOperation:return this.handleOperation(((e,t)=>async({iconTypes:r})=>{const a=e.getState(),o=(0,d.iconsCacheSelector)(a);if((0,m.isIconsCacheValid)(o))return;const n=(0,c.credentialsSelector)(a),i=(0,s.breachesSelector)(a),l=await(0,S.fetchIconsForAllItems)(t,n,i,r);e.dispatch((0,u.iconsRefreshed)(l)),(0,h.default)()&&(0,y.reportDataUpdate)(e)})(this.storeService,this.gateway),e);default:return(0,p.assertUnreachable)(e)}},this.setupOperationsHandling=()=>{const e=this._operation$.pipe((0,o.concatMap)(this.onOperation),(0,o.share)()),t=e.subscribe();this.subs.add(t),this._operationResults$=e},this.setupOperationsHandling()}teardown(){this.subs.forEach((e=>e.unsubscribe()))}}},600541:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isIconsCacheValid=void 0;const a=r(500053),o=86400*(7+Math.random());t.isIconsCacheValid=e=>!(!e||!e.lastUpdateTimeSeconds)&&(0,a.getUnixTimestamp)()-e.lastUpdateTimeSeconds<o},841717:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultIconTypes=void 0,t.defaultIconTypes=["46x30@2x","160x106@2x","118x98@2x"]},819979:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fetchIconsForAllItems=t.fetchIconsForCredentials=t.getCredentialsWithWebsiteIcon=t.fetchIconsForBreaches=t.getIconsUrlsForBreaches=t.getIconsUrlsForCredentials=void 0;const a=r(401067),o=r(421178),n=r(256814),s=r(791892),i=r(164185);t.getIconsUrlsForCredentials=e=>e.map((e=>e.Url)),t.getIconsUrlsForBreaches=e=>e.reduce(((e,t)=>{const r=t.Content.domains;return r&&0!==r.length?[...e,r[0]]:e}),[]),t.fetchIconsForBreaches=async(e,r,o,i)=>{const c=(0,t.getIconsUrlsForBreaches)(o),l=(0,n.getFormattedDomainsFromUrls)(c),d=(0,n.decryptIconsDomains)((0,s.iconsSelector)(e),l),u=Array.from(d.keys()),p=(0,a.difference)(l,u);return r.getIcons(p,i)},t.getCredentialsWithWebsiteIcon=(e,t,r)=>{const n={backgroundColor:null,mainColor:null,urls:(0,i.makeEmptyIconUrls)(r)};return e.map((e=>{const r=t.get(new o.ParsedURL(e.Url).getRootDomain()),s=(0,a.defaultTo)(n,r);return{...e,domainIcon:s}}))},t.fetchIconsForCredentials=async(e,r,o,i)=>{const c=(0,t.getIconsUrlsForCredentials)(o),l=(0,n.getFormattedDomainsFromUrls)(c),d=(0,n.decryptIconsDomains)((0,s.iconsSelector)(e),l),u=Array.from(d.keys()),p=(0,a.difference)(l,u);return r.getIcons(p,i)},t.fetchIconsForAllItems=async(e,r,a,o)=>{const s=[...(0,t.getIconsUrlsForBreaches)(a),...(0,t.getIconsUrlsForCredentials)(r)],i=(0,n.getFormattedDomainsFromUrls)(s);return e.getIcons(i,o)}},250415:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.iconsUpdatesHook=void 0;const a=r(17825),o=r(436081);t.iconsUpdatesHook=async e=>{const t=(0,o.getInstance)();if(!t)return!1;switch(e.type){case"breachUpdates":return t.handleBreachesUpdates(e.breachesIds);case"credentialUpdates":return t.handleCredentialUpdates(e.credentialIds);case"refresh":return t.handleRefreshIcons();default:return(0,a.assertUnreachable)(e)}}},544816:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatFetchedIcons=t.makeIconDataWithDomain=t.getDomainsIconsToBeFetched=t.getDomainIconsToBeFetched=void 0;const a=r(401067),o=r(164185),n=(0,a.defaultTo)(null);t.getDomainIconsToBeFetched=(e,t)=>t.reduce(((t,r)=>[...t,{domain:e,type:r}]),[]),t.getDomainsIconsToBeFetched=(e,r)=>e.reduce(((e,a)=>[...e,...(0,t.getDomainIconsToBeFetched)(a,r)]),[]),t.makeIconDataWithDomain=(e,t)=>{const r=(0,a.head)(e)||{};return{urls:(0,o.computeIconUrls)(e,t),backgroundColor:n(r.backgroundColor),mainColor:n(r.mainColor),domain:n(r.domain)}},t.formatFetchedIcons=(e,r,a)=>{const o=r.length;return[...Array(a)].reduce(((a,n,s)=>{const i=s*o,c=i+o,l=e.slice(i,c);return[...a,(0,t.makeIconDataWithDomain)(l,r)]}),[])}},123381:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IconsWS=void 0;const a=r(544816),o=r(32607);t.IconsWS=class{constructor(e){this.wsService=e}async getIcons(e,t){if(!e||!e.length)return[];const r=(0,a.getDomainsIconsToBeFetched)(e,t),n=await this.wsService.iconCrawler.getIcons(r);if(!(0,o.isWSResponseSuccess)(n)){const e=`[Icons] getIcons: ${n.message}(statusCode: ${n.code})`;throw new Error(e)}const{content:s}=n;return(0,a.formatFetchedIcons)(s,t,e.length)}}},90451:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getIcon=void 0;const a=r(421178),o=r(246445);t.getIcon=e=>t=>{const r=new a.ParsedURL(t).getRootDomain();if(!r)return;const n=(0,o.computeHashMD5)(r);return e.get(n)}},791892:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.iconsSelector=t.iconsCacheSelector=void 0,t.iconsCacheSelector=e=>e.userSession.iconsCache,t.iconsSelector=e=>(0,t.iconsCacheSelector)(e).domains},108566:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const a=r(412362),o=r(986691),n=async()=>{const e=(0,a.getInstance)(),t=(0,o.getInstance)(),r=t.lockTopic("iconsUpdates");await e.add("iconsUpdates",{type:"refresh"}),t.releaseTopic("iconsUpdates",r)};t.setupSubscriptions=async function(e,t){e.syncSuccess.on((async()=>{await n()})),e.syncFailure.on((async()=>{await n()}))}},913648:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(308302);t.config={commands:{addDriverLicense:{handler:a.addDriverLicenseHandler},editDriverLicense:{handler:a.editDriverLicenseHandler}},queries:void 0,liveQueries:void 0}},60445:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDriverLicenseHandler=void 0;const a=r(632626),o=r(672099),n=r(758452),s=({expirationDate:e,idNumber:t,issueDate:r,name:n,state:s})=>({DateOfBirth:"",DeliveryDate:(0,o.viewDateToVaultDate)(r),ExpireDate:(0,o.viewDateToVaultDate)(e),Fullname:n??"",LinkedIdentity:"",Number:t??"",kwType:a.DataModelType.KWDriverLicence,State:s??"",Sex:""});t.addDriverLicenseHandler=(e,t)=>(0,n.addIdHandler)(e,t,s)},363589:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.editDriverLicenseHandler=t.handleDriverLicenseFields=void 0;const a=r(509774),o=r(672099),n=r(822388);t.handleDriverLicenseFields=(e,t)=>({DeliveryDate:void 0===e.issueDate?t.DeliveryDate:(0,o.viewDateToVaultDate)(e.issueDate),ExpireDate:void 0===e.expirationDate?t.ExpireDate:(0,o.viewDateToVaultDate)(e.expirationDate),Fullname:e.name??t.Fullname,Number:e.idNumber??t.Number,State:e.state??t.State,LinkedIdentity:void 0===e.name?t.LinkedIdentity:"",Attachments:void 0===e.attachments?t.Attachments:e.attachments}),t.editDriverLicenseHandler=(e,r)=>(0,n.updateIdHandler)(e,r,t.handleDriverLicenseFields,a.driverLicenseSelector)},308302:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(60445),t),o(r(363589),t)},591019:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDriverLicenseMappers=void 0;const a=r(883539),o=r(672099);t.getDriverLicenseMappers=()=>({spaceId:e=>e.SpaceId,name:e=>(0,o.identityToName)(e.identity)||e.Fullname,idNumber:e=>e.Number,lastUse:a.lastUseMapper,id:e=>e.Id,creationDate:e=>e.CreationDatetime})},550317:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.driverLicenseMatch=t.searchGetters=void 0;const a=r(64455),o=r(382234),n=r(672099);t.searchGetters=[(0,o.stringProp)("Number"),e=>(0,n.identityToName)(e.identity)||e.Fullname],t.driverLicenseMatch=(0,a.match)(t.searchGetters)},509774:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryDriverLicensesSelector=t.driverLicenseWithIdentitySelector=t.driverLicenseSelector=t.driverLicensesSelector=void 0;const a=r(432034),o=r(550317),n=r(324589),s=r(749551),i=r(591019),c=r(628074),l=r(340602),d=r(657989);t.driverLicensesSelector=(0,a.createSelector)((e=>e.userSession.personalData.driverLicenses),d.quarantinedSpacesSelector,l.filterOutQuarantinedItems),t.driverLicenseSelector=(e,r)=>{const a=(0,t.driverLicensesSelector)(e);return(0,s.findDataModelObject)(r,a)};const u=(0,a.createSelector)([t.driverLicensesSelector,c.identitiesByIdSelector],((e,t)=>e.map((e=>({...e,identity:t[e.LinkedIdentity]})))));t.driverLicenseWithIdentitySelector=(0,a.createSelector)([t.driverLicenseSelector,e=>(0,c.identitiesByIdSelector)(e)],((e,t)=>({...e,identity:t[e.LinkedIdentity]}))),t.queryDriverLicensesSelector=(0,n.getQuerySelector)(u,(()=>o.driverLicenseMatch),(e=>(0,i.getDriverLicenseMappers)()))},215141:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(632813);t.config={commands:{addFiscalId:{handler:a.addFiscalIdHandler},editFiscalId:{handler:a.editFiscalIdHandler}},queries:void 0,liveQueries:void 0}},246033:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addFiscalIdHandler=void 0;const a=r(632626),o=r(758452),n=({idNumber:e,teledeclarantNumber:t})=>({FiscalNumber:e??"",kwType:a.DataModelType.KWFiscalStatement,TeledeclarantNumber:t??""});t.addFiscalIdHandler=(e,t)=>(0,o.addIdHandler)(e,t,n)},809175:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.editFiscalIdHandler=t.handleFiscalIdFields=void 0;const a=r(141092),o=r(822388);t.handleFiscalIdFields=(e,t)=>({FiscalNumber:e.idNumber??t.FiscalNumber,TeledeclarantNumber:e.teledeclarantNumber??t.TeledeclarantNumber,Attachments:void 0===e.attachments?t.Attachments:e.attachments}),t.editFiscalIdHandler=(e,r)=>(0,o.updateIdHandler)(e,r,t.handleFiscalIdFields,a.fiscalIdSelector)},632813:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(246033),t),o(r(809175),t)},142143:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFiscalIdMappers=void 0;const a=r(883539);t.getFiscalIdMappers=()=>({spaceId:e=>e.SpaceId,idNumber:e=>e.FiscalNumber,teledeclarantNumber:e=>e.TeledeclarantNumber,lastUse:a.lastUseMapper,id:e=>e.Id,creationDate:e=>e.CreationDatetime})},791341:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fiscalIdMatch=t.searchGetters=void 0;const a=r(64455),o=r(382234);t.searchGetters=[(0,o.stringProp)("FiscalNumber"),(0,o.stringProp)("TeledeclarantNumber")],t.fiscalIdMatch=(0,a.match)(t.searchGetters)},141092:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryFiscalIdsSelector=t.fiscalIdSelector=t.fiscalIdsSelector=void 0;const a=r(432034),o=r(791341),n=r(324589),s=r(749551),i=r(142143),c=r(340602),l=r(657989);t.fiscalIdsSelector=(0,a.createSelector)((e=>e.userSession.personalData.fiscalIds),l.quarantinedSpacesSelector,c.filterOutQuarantinedItems),t.fiscalIdSelector=(e,r)=>{const a=(0,t.fiscalIdsSelector)(e);return(0,s.findDataModelObject)(r,a)},t.queryFiscalIdsSelector=(0,n.getQuerySelector)(t.fiscalIdsSelector,(()=>o.fiscalIdMatch),(e=>(0,i.getFiscalIdMappers)()))},402282:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(417607);t.config={commands:{addIdCard:{handler:a.addIdCardHandler},editIdCard:{handler:a.editIdCardHandler}},queries:void 0,liveQueries:void 0}},538052:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addIdCardHandler=void 0;const a=r(632626),o=r(672099),n=r(758452),s=({expirationDate:e,idNumber:t,issueDate:r,name:n})=>({DateOfBirth:"",DeliveryDate:(0,o.viewDateToVaultDate)(r),ExpireDate:(0,o.viewDateToVaultDate)(e),Fullname:n??"",LinkedIdentity:"",Number:t??"",kwType:a.DataModelType.KWIDCard,Sex:""});t.addIdCardHandler=(e,t)=>(0,n.addIdHandler)(e,t,s)},284260:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.editIdCardHandler=t.handleIdCardFields=void 0;const a=r(723437),o=r(672099),n=r(822388);t.handleIdCardFields=(e,t)=>({DeliveryDate:void 0===e.issueDate?t.DeliveryDate:(0,o.viewDateToVaultDate)(e.issueDate),ExpireDate:void 0===e.expirationDate?t.ExpireDate:(0,o.viewDateToVaultDate)(e.expirationDate),Fullname:e.name??t.Fullname,Number:e.idNumber??t.Number,LinkedIdentity:void 0===e.name?t.LinkedIdentity:"",Attachments:void 0===e.attachments?t.Attachments:e.attachments}),t.editIdCardHandler=(e,r)=>(0,n.updateIdHandler)(e,r,t.handleIdCardFields,a.idCardSelector)},417607:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(538052),t),o(r(284260),t)},275455:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getIdCardMappers=void 0;const a=r(883539),o=r(672099);t.getIdCardMappers=()=>({spaceId:e=>e.SpaceId,name:e=>(0,o.identityToName)(e.identity)||e.Fullname,idNumber:e=>e.Number,lastUse:a.lastUseMapper,id:e=>e.Id,creationDate:e=>e.CreationDatetime})},527062:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.idCardMatch=t.searchGetters=void 0;const a=r(64455),o=r(382234),n=r(672099);t.searchGetters=[(0,o.stringProp)("Number"),e=>(0,n.identityToName)(e.identity)||e.Fullname],t.idCardMatch=(0,a.match)(t.searchGetters)},723437:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryIdCardsSelector=t.idCardWithIdentitySelector=t.idCardSelector=t.idCardsSelector=void 0;const a=r(432034),o=r(527062),n=r(324589),s=r(749551),i=r(275455),c=r(628074),l=r(340602),d=r(657989);t.idCardsSelector=(0,a.createSelector)((e=>e.userSession.personalData.idCards),d.quarantinedSpacesSelector,l.filterOutQuarantinedItems),t.idCardSelector=(e,r)=>{const a=(0,t.idCardsSelector)(e);return(0,s.findDataModelObject)(r,a)};const u=(0,a.createSelector)([t.idCardsSelector,c.identitiesByIdSelector],((e,t)=>e.map((e=>({...e,identity:t[e.LinkedIdentity]})))));t.idCardWithIdentitySelector=(0,a.createSelector)([t.idCardSelector,e=>(0,c.identitiesByIdSelector)(e)],((e,t)=>({...e,identity:t[e.LinkedIdentity]}))),t.queryIdCardsSelector=(0,n.getQuerySelector)(u,(()=>o.idCardMatch),(e=>(0,i.getIdCardMappers)()))},808453:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(362535);t.config={commands:{addPassport:{handler:a.addPassportHandler},editPassport:{handler:a.editPassportHandler}},queries:void 0,liveQueries:void 0}},57237:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addPassportHandler=void 0;const a=r(632626),o=r(672099),n=r(758452),s=({expirationDate:e,idNumber:t,issueDate:r,name:n,deliveryPlace:s})=>({DateOfBirth:"",DeliveryDate:(0,o.viewDateToVaultDate)(r),ExpireDate:(0,o.viewDateToVaultDate)(e),Fullname:n??"",LinkedIdentity:"",Number:t??"",kwType:a.DataModelType.KWPassport,DeliveryPlace:s??"",Sex:""});t.addPassportHandler=(e,t)=>(0,n.addIdHandler)(e,t,s)},629461:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.editPassportHandler=t.handlePassportFields=void 0;const a=r(865401),o=r(672099),n=r(822388);t.handlePassportFields=(e,t)=>({DeliveryDate:void 0===e.issueDate?t.DeliveryDate:(0,o.viewDateToVaultDate)(e.issueDate),ExpireDate:void 0===e.expirationDate?t.ExpireDate:(0,o.viewDateToVaultDate)(e.expirationDate),Fullname:e.name??t.Fullname,Number:e.idNumber??t.Number,DeliveryPlace:e.deliveryPlace??t.DeliveryPlace,LinkedIdentity:void 0===e.name?t.LinkedIdentity:"",Attachments:void 0===e.attachments?t.Attachments:e.attachments}),t.editPassportHandler=(e,r)=>(0,n.updateIdHandler)(e,r,t.handlePassportFields,a.passportSelector)},362535:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(57237),t),o(r(629461),t)},294023:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPassportMappers=void 0;const a=r(883539),o=r(672099);t.getPassportMappers=()=>({spaceId:e=>e.SpaceId,name:e=>(0,o.identityToName)(e.identity)||e.Fullname,idNumber:e=>e.Number,lastUse:a.lastUseMapper,id:e=>e.Id,creationDate:e=>e.CreationDatetime})},39515:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.passportMatch=t.searchGetters=void 0;const a=r(64455),o=r(382234),n=r(672099);t.searchGetters=[(0,o.stringProp)("Number"),e=>(0,n.identityToName)(e.identity)||e.Fullname],t.passportMatch=(0,a.match)(t.searchGetters)},865401:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryPassportsWithIdentitySelector=t.passportMappersSelector=t.passportWithIdentitySelector=t.passportSelector=t.passportsSelector=void 0;const a=r(432034),o=r(39515),n=r(324589),s=r(749551),i=r(294023),c=r(628074),l=r(340602),d=r(657989);t.passportsSelector=(0,a.createSelector)((e=>e.userSession.personalData.passports),d.quarantinedSpacesSelector,l.filterOutQuarantinedItems),t.passportSelector=(e,r)=>{const a=(0,t.passportsSelector)(e);return(0,s.findDataModelObject)(r,a)};const u=(0,a.createSelector)([t.passportsSelector,c.identitiesByIdSelector],((e,t)=>e.map((e=>({...e,identity:t[e.LinkedIdentity]})))));t.passportWithIdentitySelector=(0,a.createSelector)([t.passportSelector,e=>(0,c.identitiesByIdSelector)(e)],((e,t)=>({...e,identity:t[e.LinkedIdentity]}))),t.passportMappersSelector=e=>(0,i.getPassportMappers)(),t.queryPassportsWithIdentitySelector=(0,n.getQuerySelector)(u,(()=>o.passportMatch),t.passportMappersSelector)},857718:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(827753);t.config={commands:{addSocialSecurityId:{handler:a.addSocialSecurityIdHandler},editSocialSecurityId:{handler:a.editSocialSecurityIdHandler}},queries:void 0,liveQueries:void 0}},706702:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addSocialSecurityIdHandler=void 0;const a=r(632626),o=r(758452),n=e=>({DateOfBirth:"",LinkedIdentity:"",SocialSecurityFullname:e.name??"",SocialSecurityNumber:e.idNumber??"",kwType:a.DataModelType.KWSocialSecurityStatement,Sex:""});t.addSocialSecurityIdHandler=(e,t)=>(0,o.addIdHandler)(e,t,n)},696163:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.editSocialSecurityIdHandler=t.handleSocialSecurityIdFields=void 0;const a=r(727147),o=r(822388);t.handleSocialSecurityIdFields=(e,t)=>({SocialSecurityFullname:e.name??t.SocialSecurityFullname,SocialSecurityNumber:e.idNumber??t.SocialSecurityNumber,LinkedIdentity:void 0===e.name?t.LinkedIdentity:"",Attachments:void 0===e.attachments?t.Attachments:e.attachments}),t.editSocialSecurityIdHandler=(e,r)=>(0,o.updateIdHandler)(e,r,t.handleSocialSecurityIdFields,a.socialSecurityIdSelector)},827753:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(706702),t),o(r(696163),t)},150147:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSocialSecurityIdMappers=void 0;const a=r(883539),o=r(672099);t.getSocialSecurityIdMappers=()=>({spaceId:e=>e.SpaceId,name:e=>(0,o.identityToName)(e.identity)||e.SocialSecurityFullname,idNumber:e=>e.SocialSecurityNumber,lastUse:a.lastUseMapper,id:e=>e.Id,creationDate:e=>e.CreationDatetime})},929989:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.socialSecurityIdMatch=t.searchGetters=void 0;const a=r(64455),o=r(382234),n=r(672099);t.searchGetters=[(0,o.stringProp)("SocialSecurityNumber"),e=>(0,n.identityToName)(e.identity)||e.SocialSecurityFullname],t.socialSecurityIdMatch=(0,a.match)(t.searchGetters)},727147:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.querySocialSecurityIdsSelector=t.socialSecurityIdWithIdentitySelector=t.socialSecurityIdSelector=t.socialSecurityIdsSelector=void 0;const a=r(432034),o=r(929989),n=r(324589),s=r(749551),i=r(150147),c=r(628074),l=r(657989),d=r(340602);t.socialSecurityIdsSelector=(0,a.createSelector)((e=>e.userSession.personalData.socialSecurityIds),l.quarantinedSpacesSelector,d.filterOutQuarantinedItems),t.socialSecurityIdSelector=(e,r)=>{const a=(0,t.socialSecurityIdsSelector)(e);return(0,s.findDataModelObject)(r,a)};const u=(0,a.createSelector)([t.socialSecurityIdsSelector,c.identitiesByIdSelector],((e,t)=>e.map((e=>({...e,identity:t[e.LinkedIdentity]})))));t.socialSecurityIdWithIdentitySelector=(0,a.createSelector)([t.socialSecurityIdSelector,e=>(0,c.identitiesByIdSelector)(e)],((e,t)=>({...e,identity:t[e.LinkedIdentity]}))),t.querySocialSecurityIdsSelector=(0,n.getQuerySelector)(u,(()=>o.socialSecurityIdMatch),(e=>(0,i.getSocialSecurityIdMappers)()))},758452:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addIdHandler=void 0;const a=r(700033),o=r(632626),n=r(823136),s=r(448313),i=r(500053),c=r(278320),l=r(795623),d=r(670252),u=r(298416),p=r(672099),S=r(579980);t.addIdHandler=async({sessionService:e,storeService:t,eventLoggerService:r},g,m)=>{if(""===g.idNumber)return Promise.resolve({success:!1,error:{code:o.AddIdResultErrorCode.MISSING_ID_NUMBER}});const y=({country:e,spaceId:t})=>{const r=(0,i.getUnixTimestamp)();return{AnonId:(0,c.generateItemUuid)(),CreationDatetime:r,Id:(0,c.generateItemUuid)(),LastBackupTime:0,LocaleFormat:(0,p.viewCountryToVaultCountry)(e),SpaceId:t,UserModificationDatetime:r}};try{if(!t.isAuthenticated())return Promise.resolve({success:!1,error:{code:o.IdErrorCode.NOT_AUTHENTICATED}});const i={...y(h=(0,u.sanitizeInputPersonalData)(g)),...m(h)};if(!i.SpaceId){const e=await(0,n.getDefaultSpaceId)(t);i.SpaceId=e}return t.dispatch((0,s.savePersonalDataItem)(i,i.kwType)),e.getInstance().user.persistPersonalData(),(0,n.getDebounceSync)(t,e)({immediateCall:!0},a.Trigger.Save),(0,S.logAddVaultItem)(t,r,i),Promise.resolve({success:!0,id:i.Id})}catch(e){const t=new Error(`[IDs] - addIdHandler: ${e}`);return(0,d.sendExceptionLog)({error:t}),(0,l.logError)(t),Promise.resolve({success:!1,error:{code:o.IdErrorCode.INTERNAL_ERROR}})}var h}},822388:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateIdHandler=void 0;const a=r(700033),o=r(632626),n=r(823136),s=r(448313),i=r(500053),c=r(795623),l=r(670252),d=r(298416),u=r(672099),p=r(579980);t.updateIdHandler=({sessionService:e,storeService:t,eventLoggerService:r},S,g,m)=>{if(""===S.idNumber)return Promise.resolve({success:!1,error:{code:o.UpdateIdResultErrorCode.MISSING_ID_NUMBER}});const y=({country:e,spaceId:t},r)=>({SpaceId:t??r.SpaceId,LocaleFormat:void 0===e?r.LocaleFormat:(0,u.viewCountryToVaultCountry)(e)}),h=(e,t)=>({...y(e,t),...g(e,t)});try{if(!t.isAuthenticated())return Promise.resolve({success:!1,error:{code:o.IdErrorCode.NOT_AUTHENTICATED}});const c=t.getState(),l=(0,d.sanitizeInputPersonalData)(S),u=m(c,S.id);if(!u)return Promise.resolve({success:!1,error:{code:o.IdErrorCode.NOT_FOUND}});const g={...u,...h(l,u),UserModificationDatetime:(0,i.getUnixTimestamp)()},y=g.kwType;t.dispatch((0,s.savePersonalDataItem)(g,y)),e.getInstance().user.persistPersonalData(),(0,n.getDebounceSync)(t,e)({immediateCall:!0},a.Trigger.Save);const f=m(c,S.id);return(0,p.logEditVaultItem)(t,r,g,f),Promise.resolve({success:!0})}catch(e){const t=new Error(`[IDs] - updateIdHandler: ${e}`);return(0,l.sendExceptionLog)({error:t}),(0,c.logError)(t),Promise.resolve({success:!1,error:{code:o.IdErrorCode.INTERNAL_ERROR}})}}},672099:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.identityToName=t.viewCountryToVaultCountry=t.vaultCountryToViewCountry=t.vaultDateToViewDate=t.viewDateToVaultDate=t.epochToDate=t.ZERO_INDEX_BASED_MONTH_OFFSET=void 0;const a=r(632626);t.ZERO_INDEX_BASED_MONTH_OFFSET=1,t.epochToDate=e=>new Date(1e3*e),t.viewDateToVaultDate=e=>null===e?"":(e=>{const r=(0,t.epochToDate)(e);return`${r.getUTCFullYear()}-${r.getUTCMonth()+1}-${r.getUTCDate()}`})(e),t.vaultDateToViewDate=e=>{if(!e)return null;const t=(e=>{if(!e)return 0;const[t,r,a]=e.split(/[-/]/).map((e=>Number.parseInt(e,10))),o=new Date;o.setUTCHours(0,0,0,0);const n=o.setUTCFullYear(t,r-1,a);return Math.floor(n/1e3)})(e);return Number.isNaN(t)?null:t},t.vaultCountryToViewCountry=e=>{const t=a.Country[e];return void 0===t||t===a.Country.NO_TYPE?a.Country.UNIVERSAL:t},t.viewCountryToVaultCountry=t.vaultCountryToViewCountry,t.identityToName=e=>e?[e.FirstName,e.MiddleName,e.LastName,e.LastName2].filter(Boolean).join(" "):""},711230:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.importApiConfig=void 0;const a=r(656242),o=r(29613),n=r(428927),s=r(176295),i=r(894746);t.importApiConfig={commands:{importPersonalData:{handler:n.importPersonalDataHandler},previewPersonalData:{handler:s.previewPersonalDataHandler},dismissPersonalDataImportNotifications:{handler:i.dismissDataImportHandler}},queries:{getImportPersonalDataStatus:{selector:o.importPersonalDataStateSelector}},liveQueries:{liveImportPersonalDataStatus:{operator:a.importPersonalDataState$}}}},894746:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.dismissDataImportHandler=t.dismissDataImport=void 0;const a=r(632626),o=r(743691);t.dismissDataImport=async e=>{await e.waitReady(),e.onNewState({status:a.ImportPersonalDataStateType.Idle})},t.dismissDataImportHandler=e=>(0,t.dismissDataImport)((0,o.makeImportService)(e))},428927:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.importPersonalDataHandler=t.importPersonalData=void 0;const a=r(632626),o=r(795623),n=r(670252),s=r(743691);t.importPersonalData=async(e,t)=>{try{e.onNewState({status:a.ImportPersonalDataStateType.Processing,name:t.name});const r=t.content;return(async()=>{try{const o=await e.importPersonalDataItems(r);e.onNewState({status:a.ImportPersonalDataStateType.Success,name:t.name,totalCount:o.totalCount,successCount:o.successCount,duplicateCount:o.duplicateCount})}catch(r){const s=new Error(`[import] - importError: ${r}`);(0,n.sendExceptionLog)({error:s}),(0,o.logError)(s),e.onNewState({status:a.ImportPersonalDataStateType.Error,name:t.name})}})(),{success:!0}}catch(r){const s=new Error(`[import] - formatError: ${r}`);return(0,n.sendExceptionLog)({error:s}),(0,o.logError)(s),e.onNewState({status:a.ImportPersonalDataStateType.Error,name:t.name}),{success:!1,error:a.ImportPersonalDataErrorType.Unknown}}},t.importPersonalDataHandler=(e,r)=>(0,t.importPersonalData)((0,s.makeImportService)(e),r)},176295:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.previewPersonalDataHandler=t.previewPersonalData=void 0;const a=r(632626),o=r(743691);t.previewPersonalData=async(e,t)=>{if(!e.canDoImport())return{success:!1,error:a.PreviewPersonalDataErrorType.Unavailable};try{return await e.previewPersonalDataArchive(t)}catch(e){return{success:!1,error:a.PreviewPersonalDataErrorType.InvalidFormat}}},t.previewPersonalDataHandler=(e,r)=>{const a=(0,o.makeImportService)(e);return(0,t.previewPersonalData)(a,r)}},656242:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.importPersonalDataState$=void 0;const a=r(518948),o=r(903343),n=r(29613);t.importPersonalDataState$=()=>(0,a.pipe)((0,o.map)(n.importPersonalDataStateSelector,(0,o.distinctUntilChanged)()))},29613:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isImportPersonalDataAvailableSelector=t.importPersonalDataStateSelector=void 0;const a=r(632626),o=r(862844);t.importPersonalDataStateSelector=e=>e.userSession.importPersonalData.state??{status:a.ImportPersonalDataStateType.Idle},t.isImportPersonalDataAvailableSelector=e=>!(0,o.changeMPinProgressSelector)(e)&&(0,t.importPersonalDataStateSelector)(e).status!==a.ImportPersonalDataStateType.Processing},490537:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUniqueVaultItemIdentifier=void 0;const a=r(401067),o={Attachments:!1},n={...o,Title:!0,Email:!0,Login:!0,SecondaryLogin:!0,Password:!0,Strength:!1,Note:!0,Checked:!1,Status:!1,SharedObject:!1,ModificationDatetime:!1,Category:!1,Url:!0,UserSelectedUrl:!1,UseFixedUrl:!1,TrustedUrlGroup:!1,NumberUse:!1,AutoLogin:!1,AutoProtected:!1,SubdomainOnly:!1,Type:!1,Server:!1,Port:!1,Alias:!1,SID:!1,ConnectionOptions:!1,domainIcon:!1,limitedPermissions:!1,OtpSecret:!0,OtpUrl:!0,LinkedServices:!1},s={...o,Title:!0,Content:!0,Secured:!1},i={...o,Title:!0,Category:!1,Type:!1,limitedPermissions:!1,Content:!0,Secured:!1,CreationDate:!1,UpdateDate:!1},c={...o,LinkedIdentity:!1,Fullname:!0,Sex:!0,DateOfBirth:!0,Number:!0,ExpireDate:!0,DeliveryDate:!0},l={...o,Email:!0,Type:!1,EmailName:!0},d={...o,Type:!1,Number:!0,NumberNational:!0,NumberInternational:!0,PhoneName:!0,PersonalNote:!0},u={...o,Title:!0,FirstName:!0,MiddleName:!0,LastName:!0,LastName2:!0,Pseudo:!1,BirthDate:!0,BirthPlace:!0},p={...o,Counter:!1,CredentialId:!0,ItemName:!0,KeyAlgorithm:!0,Note:!0,PrivateKey:!0,RpId:!0,RpName:!0,UserDisplayName:!0,UserHandle:!0},S={...o,LinkedIdentity:!1,Fullname:!0,Sex:!0,DateOfBirth:!0,Number:!0,ExpireDate:!0,DeliveryDate:!0,DeliveryPlace:!0},g={...o,PersonalNote:!0,Name:!0,Website:!0},m={...o,Number:!0,LinkedIdentity:!1,Fullname:!0,Sex:!0,DateOfBirth:!0,DeliveryDate:!0,ExpireDate:!0,State:!0},y={...o,PersonalNote:!0,Name:!0,JobTitle:!0},h={...o,PersonalNote:!0,State:!0,AddressName:!0,Receiver:!0,AddressFull:!0,City:!0,ZipCode:!0,Country:!0,StreetNumber:!0,StreetTitle:!0,StreetName:!0,StateNumber:!0,StateLevel2:!0,Building:!0,Stairs:!0,Floor:!0,Door:!0,DigitCode:!0,LinkedPhone:!1},f={...o,Name:!0,CardNumber:!0,CardNumberLastDigits:!0,OwnerName:!0,SecurityCode:!0,ExpireMonth:!0,ExpireYear:!0,StartMonth:!0,StartYear:!0,IssueNumber:!0,Color:!1,Bank:!0,CCNote:!0,Type:!1},v={...o,BankAccountName:!0,BankAccountOwner:!0,BankAccountIBAN:!0,BankAccountBIC:!0,BankAccountBank:!0},T=e=>Object.keys(e).filter((t=>!!e[t])),A={KWAddress:T(h),KWAuthCategory:T({Attachments:!1,CategoryName:!0}),KWAuthentifiant:T(n),KWBankStatement:T(v),KWCollection:T({Attachments:!1,Name:!0,VaultItems:!0}),KWCompany:T(y),KWDataChangeHistory:[],KWDriverLicence:T(m),KWEmail:T(l),KWFiscalStatement:[],KWGeneratedPassword:[],KWIDCard:T(c),KWIdentity:T(u),KWMerchand:[],KWMiscData:[],KWPasskey:T(p),KWPassport:T(S),KWPaymentMean_creditCard:T(f),KWPaymentMean_paypal:[],KWPersonalWebsite:T(g),KWPhone:T(d),KWPurchaseAccount:[],KWPurchaseCategory:[],KWPurchasePaidBasket:[],KWPurchaseTrueArticle:[],KWSecureFileInfo:[],KWSecret:T(s),KWSecureNote:T(i),KWSecureNoteCategory:T({Attachments:!1,CategoryName:!0}),KWSecurityBreach:[],KWSettingsManagerApp:[],KWSocialSecurityStatement:[],KWWebSite:[]};t.getUniqueVaultItemIdentifier=e=>((e,t)=>{const r={};return e.forEach((e=>{r[e]=t[e]??""})),(0,a.isEmpty)(r)?"":JSON.stringify(r)})(A[e.kwType],e)},247437:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getImportableItemsFromUserFile=t.getExistingVaultItemUniqueIdentifiers=t.getAllExistingCollections=void 0;const a=r(632626),o=r(926634),n=r(298416),s=r(249901),i=r(72883),c=r(490537),l=r(688655),d=[a.DataModelType.KWAddress,a.DataModelType.KWAuthentifiant,a.DataModelType.KWCompany,a.DataModelType.KWDriverLicence,a.DataModelType.KWEmail,a.DataModelType.KWIDCard,a.DataModelType.KWIdentity,a.DataModelType.KWPassport,a.DataModelType.KWPaymentMean_creditCard,a.DataModelType.KWPersonalWebsite,a.DataModelType.KWPhone,a.DataModelType.KWSecureNote,a.DataModelType.KWSocialSecurityStatement,a.DataModelType.KWWebSite],u=(e,t)=>e+"_"+t,p=(e,t)=>{for(let r=1;;r++){const a=e+" - "+r;let o=!1;if(t.forEach((e=>{e.isShared||e.item?.Name!==a||(o=!0)})),!o)return a}},S="shared";t.getAllExistingCollections=(e,t)=>{const r=new Map;return e.forEach((e=>{r.set(u(e.name,S),{item:null,isShared:!0})})),t.forEach((e=>{r.set(u(e.Name,e.SpaceId),{item:e,isShared:!1})})),r},t.getExistingVaultItemUniqueIdentifiers=e=>{const t=new Set,r=Object.entries(e).filter((([e])=>(0,i.isDataKeyVaultItem)(e))).reduce(((e,[t,r])=>({...e,[t]:r})),{});for(const e of Object.values(r))e.forEach((e=>{if((0,a.isDataModelObject)(e)){const r=(0,c.getUniqueVaultItemIdentifier)(e);r&&t.add(r)}}));return t};const g=(e,t,r)=>{r.length&&t?e.SpaceId=r[0].teamId:e.SpaceId&&(e.SpaceId=r[0]?.teamId??s.PERSONAL_SPACE_ID)},m=async e=>((0,a.isCredential)(e)?e=await(0,l.prepareCredentialForImport)(e):(0,a.isNote)(e)&&(e=(0,l.prepareSecureNoteForImport)(e)),e);t.getImportableItemsFromUserFile=async(e,t,r,s)=>{const{storeService:i}=e,{spaces:y}=i.getSpaceData(),h=i.getState(),f=!(0,o.isPersonalSpaceEnabledSelector)(h),v=[];let T=0,A=0;for(const e of t){d.includes(e.kwType)&&T++;const t=await m((0,n.sanitizeInputPersonalData)((0,l.convertImportable)(e)));if(g(t,f,y),(0,a.isCollection)(t)){const e=v.find((e=>(0,a.isCollection)(e)&&e.SpaceId===t.SpaceId&&e.Name===t.Name));if(e){e.VaultItems=[...e.VaultItems,...t.VaultItems];continue}const r=s.get(u(t.Name,t.SpaceId))||s.get(u(t.Name,S));if(r&&!r.isShared){const e={...t,Id:r.item.Id,VaultItems:[...t.VaultItems,...r.item.VaultItems]};v.push(e);continue}if(r?.isShared){t.Name=p(t.Name,s),v.push(t);continue}}(0,a.isCollection)(t)||!r.has((0,c.getUniqueVaultItemIdentifier)(t))?v.push(t):A++}return{itemsToImport:v,importableItemCount:T,duplicateItemCount:A}}},320485:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.importPersonalDataItems=void 0;const a=r(632626),o=r(700033),n=r(692310),s=r(178163),i=r(823136),c=r(688655),l=r(247437);t.importPersonalDataItems=async(e,t)=>{const{storeService:r,sessionService:d,localStorageService:u,applicationModulesAccess:p}=e,S=r.getState(),g=(0,i.getDebounceSync)(r,d);let m=0,y=0;const h=(0,l.getExistingVaultItemUniqueIdentifiers)(S.userSession.personalData),{itemsToImport:f,importableItemCount:v,duplicateItemCount:T}=await(0,l.getImportableItemsFromUserFile)(e,t,h,(0,l.getAllExistingCollections)(S.userSession.sharingData.collections??[],S.userSession.personalData.collections)),A=(0,c.groupByType)(f);for(const[e,t]of A.entries()){if((0,c.savePersonalDataItemsForImport)({storeService:r,sessionService:d,localStorageService:u,applicationModulesAccess:p},e,t),e!==a.DataModelType.KWCollection&&e!==a.DataModelType.KWSecureNoteCategory&&e!==a.DataModelType.KWAuthCategory&&(m+=t.length),e===a.DataModelType.KWAuthentifiant&&(0,s.hasVaultAuditLogsFFActivated)(p)){const e=(0,n.currentTeamIdSelector)(S);y=t.filter((t=>t.SpaceId===e)).length,y>=1&&await(0,s.computeAndSendCSVImportActivityLog)(p,{domainUrl:null,importCount:y})}e===a.DataModelType.KWCollection&&(0,s.hasVaultAuditLogsFFActivated)(p)&&t.forEach((e=>{const t=e;t?.SpaceId&&(0,s.computeAndSendCollectionImportActivityLog)(p,{collectionName:t?.Name,itemCount:t?.VaultItems.length}).catch((()=>{}))}))}return g({immediateCall:!0},o.Trigger.Save),{successCount:m,totalCount:v,duplicateCount:T}}},688655:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.savePersonalDataItemsForImport=t.groupByType=t.prepareSecureNoteForImport=t.prepareCredentialForImport=t.convertImportable=void 0;const a=r(632626),o=r(532965),n=r(448313),s=r(656915),i=r(673566),c=r(885225),l=r(500053),d=r(947975),u=r(278320),p=r(128207),S=r(670252);t.convertImportable=e=>({...e,Id:e.Id?e.Id:(0,u.generateItemUuid)(),AnonId:(0,u.generateItemUuid)(),SpaceId:e.SpaceId??"",LocaleFormat:e.LocaleFormat??a.Country.UNIVERSAL}),t.prepareCredentialForImport=async e=>({...e,Category:"",Strength:e.Password?await(0,d.evaluatePasswordStrength)(e.Password):0}),t.prepareSecureNoteForImport=e=>{const t=(0,l.getUnixTimestamp)();return{...e,CreationDatetime:t,LocaleFormat:a.Country.US,UserModificationDatetime:t,LastBackupTime:0,Title:e.Title??`Untitled - ${t.toLocaleString()}`,Content:e.Content??"",Category:e.Category??"noCategory",Secured:e.Secured??!1,Type:a.NoteTypes.includes(e.Type)?e.Type:"GRAY",Attachments:e.Attachments??[]}},t.groupByType=e=>{const t=new Map;for(const r of e){const e=t.get(r.kwType);e?e.push(r):t.set(r.kwType,[r])}return t},t.savePersonalDataItemsForImport=({storeService:e,sessionService:t,applicationModulesAccess:r},l,d)=>{if(!d.length)return;const u=e.getPersonalData(),g=d.reduce(((t,r)=>{let o=null;return(0,i.isChangeHistoryCandidate)(r)&&(o=(0,i.getUpdatedItemChangeHistory)({deviceName:e.getLocalSettings().deviceName??"",personalData:u,change:(0,c.makeUpdateChange)(r),userLogin:e.getUserLogin(),platformInfo:(0,s.platformInfoSelector)(e.getState())})),{changeHistories:[...t.changeHistories,...o?[o]:[]],credentialIds:[...t.credentialIds,...(0,a.isCredential)(r)?[r.Id]:[]]}}),{changeHistories:[],credentialIds:[]});e.dispatch((0,n.savePersonalDataItems)(d,l,g.changeHistories)),t.getInstance().user.persistPersonalData(),(async(e,t)=>{if(t.length)try{const{commands:r}=e.createClients().vaultItemsCrud;await r.emitTemporaryVaultItemEvent({ids:[...t],eventType:o.EventType.Created}),p.carbonEventHooks.iconsUpdates({type:"credentialUpdates",credentialIds:t})}catch(e){const t=new Error(`Failed to handle health & credential health updates with ${e}`);return void(0,S.sendExceptionLog)({error:t})}})(r,g.credentialIds)}},743691:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeImportService=void 0;const a=r(632626),o=r(656915),n=r(17825),s=r(903343),i=r(656242),c=r(29613),l=r(161655),d=r(320485),u=r(299474),p=r(332814);t.makeImportService=e=>{const{storeService:t}=e;return{previewPersonalDataArchive:e=>(async(e,t)=>{const r=(0,o.platformInfoSelector)(e.getState());switch(t.format){case a.ImportFormats.Csv:{const e=(0,u.getImportablePersonalData)(t.content,a.Country[r.country]);return 0===e.items.length?{success:!1,error:a.PreviewPersonalDataErrorType.InvalidFormat}:{success:!0,data:{items:e.items,headers:e.headers}}}case a.ImportFormats.Dash:{const r=(0,p.parseDashData)(t.content.data);return await(0,p.checkPassword)(e,r,t.password)?{success:!0,data:{items:(await(0,p.getSaveEventsFromDash)(e,r,t.password)).map((e=>({baseDataModel:e,rawData:{}}))),headers:[]}}:{success:!1,error:a.PreviewPersonalDataErrorType.BadPassword}}}(0,n.assertUnreachable)(t)})(t,e),canDoImport:()=>(0,c.isImportPersonalDataAvailableSelector)(t.getState()),importPersonalDataItems:t=>(0,d.importPersonalDataItems)(e,t),onNewState:e=>t.dispatch((0,l.notifyNewImportPersonalDataStateAction)(e)),waitReady:async()=>{await(0,i.importPersonalDataState$)()(t.getState$()).pipe((0,s.first)((e=>e.status!==a.ImportPersonalDataStateType.Processing))).toPromise()}}}},789586:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFieldLevelProcessor=void 0;const a=r(632626),o=r(985803),n=(e,t)=>"title"===e?null:t,s=(e,t)=>{switch(e){case"reprompt":if("0"===t)return null;break;case"name":if("--"===t)return null;break;case"type":return null}return t};t.getFieldLevelProcessor=e=>{switch(e){case a.ImportSource.Safari:return n;case a.ImportSource.Bitwarden:return s;case a.ImportSource.Lastpass:return o.fieldProcessorForLastPass;default:return null}}},762754:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getItemTypeProcessor=void 0;const a=r(632626),o=r(985803);t.getItemTypeProcessor=e=>e===a.ImportSource.Lastpass?o.itemTypeProcessorForLastPass:null},192522:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseCustomKeeperCredentialData=t.getKeeperImportHeaders=void 0,t.getKeeperImportHeaders=e=>{const t=["Folder","Title","Login","Password","Website Address","Notes","Shared Folder"],r=Math.max(0,e-t.length);return r&&t.push(...[...Array(r).keys()].map(((e,t)=>`Custom ${t+1}`))),t},t.parseCustomKeeperCredentialData=(e,t)=>{Object.keys(e).forEach((r=>{const a=e[r];"TFC:Keeper"===a?delete e[r]:"string"==typeof a&&a.startsWith("otpauth://")&&(t.OtpUrl=a,delete e[r])}))}},985803:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fieldProcessorForLastPass=t.itemTypeProcessorForLastPass=t.processAndPushLastPassNote=t.parseLastPassSecureNote=t.LPNoteTypeField=t.LastPassNoteType=t.LAST_PASS_SECURE_NOTE_URL=void 0;const a=r(400251),o=r(632626),n=r(297437),s=r(338959);var i,c;t.LAST_PASS_SECURE_NOTE_URL="http://sn",function(e){e.BankAccountType="Bank Account",e.PaymentCardType="Credit Card"}(t.LastPassNoteType||(t.LastPassNoteType={})),t.LPNoteTypeField={NoteType:"NoteType"},function(e){e.BankName="Bank Name",e.AccountType="Account Type",e.RoutingNumber="Routing Number",e.AccountNumber="Account Number",e.SWIFTCode="SWIFT Code",e.IBANNumber="IBAN Number",e.Pin="Pin",e.BranchAddress="Branch Address",e.BranchPhone="BranchPhone",e.Notes="Notes"}(i||(i={})),function(e){e.NameOnCard="Name on Card",e.Type="Type",e.Number="Number",e.SecurityCode="Security Code",e.StartDate="Start Date",e.ExpirationDate="Expiration Date",e.Notes="Notes",e.Language="Language"}(c||(c={})),t.parseLastPassSecureNote=e=>{const r={};try{switch(e.split("\n").forEach((e=>{const[t,a]=e.split(":");r[t]=a})),r.NoteType){case"Bank Account":return{type:"Bank Account",data:{BankAccountName:r["Bank Name"],BankAccountOwner:"",BankAccountIBAN:r["IBAN Number"]?r["IBAN Number"]:r["Account Number"],BankAccountBIC:r["SWIFT Code"]?r["SWIFT Code"]:r["Routing Number"],BankAccountBank:"",kwType:o.DataModelType.KWBankStatement}};case"Credit Card":{const e=r["Expiration Date"];let n,s;if(e){const[t,r]=e.split(",");n=`${(0,a.getMonth)(new Date(`${t} 1`))+1}`,n=n.length<=2?n:"",s=4!==r.length||isNaN(r)?"":r}const i={CardNumber:r.Number,OwnerName:r["Name on Card"],SecurityCode:r["Security Code"],ExpireMonth:n,ExpireYear:s,CCNote:r.Notes,kwType:o.DataModelType.KWPaymentMean_creditCard};delete r[t.LPNoteTypeField.NoteType],delete r["Expiration Date"],delete r.Language,r["Payment Type"]=r.Type,delete r[t.LPNoteTypeField.NoteType];const c=Object.keys(i),l=Object.values(i);return Object.keys(r).forEach((e=>{(c.includes(e)||l.includes(r[e]))&&delete r[e]})),{type:"Credit Card",data:{...r,...i}}}default:return null}}catch{return null}},t.processAndPushLastPassNote=(e,r,a,o,i)=>{if(e.url?.includes(t.LAST_PASS_SECURE_NOTE_URL)){delete e.url;const c=(0,t.parseLastPassSecureNote)(e.extra),l="Bank Account"===c?.type?n.BANK_ACCOUNT_HEADERS:"Credit Card"===c?.type?n.PAYMENT_CARD_HEADERS:n.SECURE_NOTES_HEADERS;switch(Object.keys(c?.data??{}).forEach((e=>{const t=Object.keys(l).find((t=>l[t].has(e.toLocaleLowerCase())));!i.has(e)&&e&&i.set(e,{original:e,matched:t??""})})),c?.type){case"Bank Account":{const t={baseDataModel:(0,s.buildBankAccountObj)(c.data,r,i),rawData:e};return void o.bankAccounts.push(t)}case"Credit Card":{const t={baseDataModel:(0,s.buildPaymentCardObj)(c.data,r,i,a),rawData:e};return void o.paymentCards.push(t)}default:{const t={baseDataModel:(0,s.buildNoteObj)(e,r,i),rawData:e};return void o.notes.push(t)}}}},t.itemTypeProcessorForLastPass=e=>{if(e.url?.includes(t.LAST_PASS_SECURE_NOTE_URL)){const r=e.extra.split("\n");let a="";for(let e=0;e<r.length;e++){const[o,n]=r[e]?r[e].split(":"):[];o===t.LPNoteTypeField.NoteType&&(a=n)}switch(a){case"Bank Account":return o.SupportedVaultTypes.BANK_ACCOUNT;case"Credit Card":return o.SupportedVaultTypes.PAYMENT_CARD;default:return o.SupportedVaultTypes.NOTE}}return null},t.fieldProcessorForLastPass=(e,t)=>{switch(e){case"fav":if(!t||t.includes("0"))return null;break;case"grouping":if(!t||t.includes("(none)"))return null}return t}},299474:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getImportablePersonalData=t.parseCSV=void 0;const a=r(632626),o=r(421178),n=r(192522),s=r(985803),i=r(338959),c=r(310770);function l(e,t,r,a){const o={baseDataModel:(0,i.buildNoteObj)(e,t,r),rawData:e};a.notes.push(o)}function d(e,t,r,a){const o={baseDataModel:(0,i.buildBankAccountObj)(t,e,a),rawData:t};r.bankAccounts.push(o)}function u(e,t,r,a,o){const n={baseDataModel:(0,i.buildPaymentCardObj)(t,e,o,r),rawData:t};a.paymentCards.push(n)}const p="otpauth://totp/?secret=",S=/^otpauth:\/\/.*/;function g(e,t,r,n,s){const l={baseDataModel:(0,i.buildCredentialObj)(e,t,r,n),rawData:e};l.baseDataModel.Category&&(t===a.ImportSource["1Password"]&&(l.baseDataModel.Category=l.baseDataModel.Category.replaceAll(";",",")),l.baseDataModel.Category.split(",").forEach((t=>{const r=s.collections.find((e=>e.baseDataModel.Name===t));if(r)r.baseDataModel.VaultItems.push({Id:l.baseDataModel.Id,Type:l.baseDataModel.kwType});else{const r={Name:t,baseDataModel:(0,c.getNewCollection)({name:t,vaultItems:[],spaceId:""}),rawData:e};s.collections.push(r),r.baseDataModel.VaultItems=[...r.baseDataModel.VaultItems,{Id:l.baseDataModel.Id,Type:l.baseDataModel.kwType}]}}))),l.baseDataModel.OtpUrl&&!S.test(l.baseDataModel.OtpUrl)&&(l.baseDataModel.OtpUrl=p+l.baseDataModel.OtpUrl);const d=new o.ParsedURL(l.baseDataModel.Url);l.baseDataModel.Url&&d.isUrlValid()&&(l.baseDataModel.Url=d.getPIIStrippedURL()),s.credentials.push(l)}const m=(e,t,r,o)=>{const n={credentials:[],notes:[],bankAccounts:[],paymentCards:[],collections:[]},c=new Map;for(let p=0;p<e.length;p++){const S=e[p].reduce(((e,r,a)=>(e[t[a]]=r,e)),{}),m=(0,i.determineBestItemType)(S,r),y=(0,i.getHeadersAndIndexMap)(t,m),h=new Map;if(y.forEach((e=>{(!c.has(e.original)||!c.get(e.original)?.matched&&e.matched)&&c.set(e.original,e),e.matched&&h.set(e.original,e)})),[a.SupportedVaultTypes.BANK_ACCOUNT,a.SupportedVaultTypes.NOTE,a.SupportedVaultTypes.PAYMENT_CARD].includes(m)&&r===a.ImportSource.Lastpass)(0,s.processAndPushLastPassNote)(S,r,o,n,h);else switch(m){case a.SupportedVaultTypes.CREDENTIAL:g(S,r,h,o,n);break;case a.SupportedVaultTypes.PAYMENT_CARD:u(r,S,o,n,h);break;case a.SupportedVaultTypes.BANK_ACCOUNT:d(r,S,n,h);break;case a.SupportedVaultTypes.NOTE:default:l(S,r,h,n)}}return{...n,headers:[...c.values()]}},y=(e,t)=>{const r=/(?=["'])(?:"[^"\\]*(?:\\[\s\S][^"\\]*)*"|'[^'\\]*(?:\\[\s\S][^'\\]*)*')|,,|,\n/gi;let a;for(;a=r.exec(e.trim());){const e=",,"===a[0]?a.index:a.index-1;a.input[e]&&","!==a.input[e]&&t.push([]),",\n"!==a[0]&&t[t.length-1].push(a[0].replace(new RegExp(/","/gi),",").replace(new RegExp(/^"|"$/gi),"").replace(new RegExp(/^,,$/gi),""))}},h=(e,t)=>{const r=/(,|\r?\n|\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^,\r\n]*))/gi;let a;for(;a=r.exec(e.trim());)a[1].length&&","!==a[1]&&t.push([]),t[t.length-1].push(void 0!==a[2]?a[2].replace(new RegExp('^"|"$|"(?=,")|(?<=",)"|""',"gi"),'"'):a[3])};function f(e,t,r){const o={credentials:[],notes:[],paymentCards:[],bankAccounts:[],headers:[],collections:[]};if(!e)return o;const{csvHead:s,csvRows:c}=function(e,t){const r=[[]];if(e.startsWith('"')?y(e,r):h(e,r),t===a.ImportSource.Keeper){const e=r.reduce(((e,t)=>Math.max(e,t.length)),0);r.unshift((0,n.getKeeperImportHeaders)(e))}const[o,...s]=r;return{csvHead:o,csvRows:s}}(e,t),l=s.map((e=>e.toLowerCase()));return c.length&&(0,i.areHeadersValid)(l)?m(c,l,t,r):o}t.parseCSV=f,t.getImportablePersonalData=(e,t)=>{const r=f(e.data,e.importSource,t),{headers:a,...o}=r;return{headers:a,items:Object.values(o).flat()}}},332814:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSaveEventsFromDash=t.getXmlData=t.checkPassword=t.parseDashData=void 0;const a=r(632626),o=r(80469),n=r(653628),s=r(956668),i=r(72365),c=r(761797),l=r(795623),d=r(670252),u=r(278320),p=e=>new RegExp(`-+\\s+${e} BEGIN\\s+-+\n(.+)\n-+\\s+${e} END`);t.parseDashData=e=>{const[t,r]=["Id","Data"].map(p).map((t=>t.exec(e))).map((e=>e?.[1]));return{ids:t?.split(";")??[],encryptedData:r??""}},t.checkPassword=async(e,t,r)=>{const a=(0,i.makeDataEncryptorService)(e);a.setInstance({raw:r},"");try{return(0,s.deflatedUtf8ToUtf16)(await a.getInstance().decrypt(t.encryptedData)),!0}catch(e){const r=`[import] - checkPassword: ${e}, ${t.encryptedData}`,a=new Error(r);(0,d.sendExceptionLog)({error:a}),(0,l.logError)(a)}return!1},t.getXmlData=async(e,t,r)=>{const a=(0,i.makeDataEncryptorService)(e);a.setInstance({raw:r},"");const o=await a.getInstance().decrypt(t.encryptedData),n=(0,s.deflatedUtf8ToUtf16)(o),l=await(0,c.parseDashlaneXml)(n);return Array.isArray(l)?l:[l]},t.getSaveEventsFromDash=async(e,r,s)=>{const i={},c=(await(0,t.getXmlData)(e,r,s)).map((e=>(0,n.fixPersonalDataItemFromExternalSource)((0,o.fixKwType)(e)))).map((e=>{const t=(0,u.generateItemUuid)();return i[e.Id]=t,{...e,Id:t}}));return c.forEach((e=>{(0,a.isCollection)(e)&&e.VaultItems.forEach((e=>{e.Id=i[e.Id]??e.Id}))})),c}},297437:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TYPE_MAPPINGS=t.TYPE_HEADERS=t.HEADER_MAPPINGS=t.BANK_ACCOUNT_HEADERS=t.PAYMENT_CARD_HEADERS=t.CREDENTIAL_HEADERS=t.SECURE_NOTES_HEADERS=void 0;const a=r(632626);t.SECURE_NOTES_HEADERS={Title:new Set(["title","name"]),Content:new Set(["note","notes","comments","extra","content"])},t.CREDENTIAL_HEADERS={Title:new Set(["title","name","account","site name"]),Login:new Set(["username","login","login_username","login name","user name"]),Url:new Set(["url","website","domain","login_url","login url","login_uri","web site","website address"]),Email:new Set(["email"]),Password:new Set(["password","login_password"]),OtpUrl:new Set(["first one-time password","login_otp","login_totp","otp","otpauth","otpurl","otpsecret","totp"]),Note:new Set(["note","notes","comments","extra"]),Category:new Set(["category","grouping","tags","folders","folder","tag","collection","collections"])},t.PAYMENT_CARD_HEADERS={CardNumber:new Set(["number","cardnumber","cc_number"]),CCNote:new Set(["notes","ccnote","note"]),OwnerName:new Set(["name on card","ownername","account_name"]),SecurityCode:new Set(["security code","securitycode","code"]),ExpireMonth:new Set(["exp_month","expiremonth","expiration_month"]),ExpireYear:new Set(["exp_year","expireyear","expiration_year"]),Name:new Set(["name"])},t.BANK_ACCOUNT_HEADERS={BankAccountName:new Set(["bank name","bankaccountname","account_name"]),BankAccountIBAN:new Set(["iban number","account number","account_number","bankaccountiban"]),BankAccountBIC:new Set(["swift code","routing number","routing_number","bankaccountbic"]),BankAccountOwner:new Set(["account_holder"]),BankAccountBank:new Set(["issuing_bank"]),LocaleFormat:new Set(["country"])},t.HEADER_MAPPINGS={[a.SupportedVaultTypes.CREDENTIAL]:t.CREDENTIAL_HEADERS,[a.SupportedVaultTypes.NOTE]:t.SECURE_NOTES_HEADERS,[a.SupportedVaultTypes.PAYMENT_CARD]:t.PAYMENT_CARD_HEADERS,[a.SupportedVaultTypes.BANK_ACCOUNT]:t.BANK_ACCOUNT_HEADERS,[a.SupportedVaultTypes.COLLECTION]:{}},t.TYPE_HEADERS=new Set(["type","item type"]),t.TYPE_MAPPINGS={[a.SupportedVaultTypes.NOTE]:["securenote","note","secure note"],[a.SupportedVaultTypes.CREDENTIAL]:["password","login","credential"],[a.SupportedVaultTypes.BANK_ACCOUNT]:["bankaccount","bank"],[a.SupportedVaultTypes.PAYMENT_CARD]:["paymentcard","payment_card","creditcard","debitcard"],[a.SupportedVaultTypes.COLLECTION]:[]}},338959:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.areHeadersValid=t.determineBestItemType=t.getHeadersAndIndexMap=t.buildCredentialObj=t.buildBankAccountObj=t.buildPaymentCardObj=t.buildNoteObj=t.reduceVaultObj=t.constructBankAccount=t.constructPaymentCard=t.constructSecureNote=t.constructCredentialContent=t.formatCredentialData=t.buildNoteContent=void 0;const a=r(632626),o=r(421178),n=r(709763),s=r(123439),i=r(535834),c=r(549293),l=r(808639),d=r(297437),u=r(762754),p=r(789586),S=r(192522),g=(e,t)=>{for(const r in e)t.includes(r)||delete e[r]};t.buildNoteContent=(e,t,r,o,n)=>{let s="";if((0,a.isCredential)(e))s=e.Note??"";else if((0,a.isNote)(e))e.Note&&(e.Content=e.Note,delete e.Note),s=e.Content;else{if(!(0,a.isPaymentCard)(e))return;s=e.CCNote}const i=!!s;let c=!1;const l={...e,...r};for(const e in l)o.includes(e)||t.get(e)?.matched||!l[e]||(n?n(e.toLocaleLowerCase(),l[e]):l[e])&&(s+=`${i&&!c?"\n\n\n":"\n"}${e}: ${l[e]}`,c=!0);s=s.trim(),(0,a.isCredential)(e)?e.Note=s:(0,a.isNote)(e)?e.Content=s:(0,a.isPaymentCard)(e)&&(e.CCNote=s)},t.formatCredentialData=e=>{let t=e.Url?.trim()??"";const r=e.Url?.split(",")??[""];if(r.length>1&&new o.ParsedURL(r[0]).isUrlValid()&&r.slice(1).some((e=>new o.ParsedURL(e).isUrlValid()))){const[r,...n]=e.Url?.split(",")??[];t=r.trim(),e.LinkedServices={associated_domains:[]},n.forEach((t=>{const r=new o.ParsedURL(t.trim());r.isUrlValid()&&e.LinkedServices?.associated_domains.push({domain:r.getPIIStrippedURL(),source:a.LinkedWebsiteSource.Manual})}))}const n=new o.ParsedURL(t);e.Url=n.isUrlValid()?t:"";const s=new o.ParsedURL(e.Title?.trim());e.Title&&!s.isUrlValid()||(e.Title=n.getRootDomain()??"")},t.constructCredentialContent=(e,t,r)=>({Title:"",Email:"",Login:"",Password:"",Note:"",...e,...(0,n.createBaseCredentialModel)(t),...(0,s.getUrlFields)(e.Url??"",!0),SpaceId:r??"",SubdomainOnly:!1,SecondaryLogin:"",Category:"",AutoLogin:!0,AutoProtected:!1,Strength:0}),t.constructSecureNote=(e,t)=>(0,c.noteFormatter)({content:e.Content||"",title:e.Title||"",category:"",secured:!1,type:a.NoteTypes[0],spaceId:t||""}),t.constructPaymentCard=(e,t)=>(0,i.getNewPaymentCard)({ownerName:e.OwnerName??"",cardName:e.Name??"",cardNumber:e.CardNumber??"",securityCode:e.SecurityCode??"",expireMonth:e.ExpireMonth??"",expireYear:e.ExpireYear??"",...e,spaceId:t}),t.constructBankAccount=(e,t,r)=>(0,l.getNewBankAccount)({name:e.BankAccountName??"",owner:e.BankAccountOwner??"",IBAN:e.BankAccountIBAN??"",BIC:e.BankAccountBIC??"",bank:e.BankAccountBank??"",country:t,...e,spaceId:r??""}),t.reduceVaultObj=(e,t,r,a,o)=>Object.entries(e).reduce(((e,[t,o])=>{const n=a.get(t)?.matched;return a.has(t)&&n&&(e[n]=r?r(t,"string"==typeof o?o:""):o),e}),t({},o)),t.buildNoteObj=(e,r,a)=>{const o=Object.keys({Title:"",Content:"",Category:"",Secured:"",Type:"",LocaleFormat:"",AnonId:"",SpaceId:"",kwType:"",Id:"",LastBackupTime:"",CreationDate:"",UpdateDate:"",limitedPermissions:"",CreationDatetime:"",UserModificationDatetime:"",LastUse:"",Attachments:""}),n=(0,p.getFieldLevelProcessor)(r),s=(0,t.reduceVaultObj)(e,t.constructSecureNote,n,a);return(0,t.buildNoteContent)(s,a,e,o,n),g(s,o),s},t.buildPaymentCardObj=(e,r,a,o)=>{const n=Object.keys({Name:"",CardNumber:"",CardNumberLastDigits:"",OwnerName:"",SecurityCode:"",ExpireMonth:"",ExpireYear:"",StartMonth:"",StartYear:"",IssueNumber:"",Color:"",Bank:"",CCNote:"",Type:"",LocaleFormat:"",AnonId:"",SpaceId:"",kwType:"",Id:"",LastBackupTime:"",CreationDatetime:"",UserModificationDatetime:"",LastUse:"",Attachments:""}),s=(0,p.getFieldLevelProcessor)(r),i=(0,t.reduceVaultObj)(e,t.constructPaymentCard,s,a,o);return(0,t.buildNoteContent)(i,a,e,n,s),g(i,n),i},t.buildBankAccountObj=(e,r,a)=>{const o=Object.keys({BankAccountName:"",BankAccountOwner:"",BankAccountIBAN:"",BankAccountBIC:"",BankAccountBank:"",LocaleFormat:"",AnonId:"",SpaceId:"",kwType:"",Id:"",LastBackupTime:"",CreationDatetime:"",UserModificationDatetime:"",LastUse:"",Attachments:""}),n=(0,p.getFieldLevelProcessor)(r),s=(0,t.reduceVaultObj)(e,t.constructBankAccount,n,a);return g(s,o),s},t.buildCredentialObj=(e,r,o,n)=>{const s=Object.keys({Title:"",Email:"",Login:"",SecondaryLogin:"",Password:"",Strength:"",Category:"",Url:"",UseFixedUrl:"",TrustedUrlGroup:"",LocaleFormat:"",AnonId:"",SpaceId:"",kwType:"",Id:"",LastBackupTime:"",CreationDatetime:"",LastUse:"",Note:"",SubdomainOnly:"",AutoLogin:"",AutoProtected:"",OtpSecret:"",UserSelectedUrl:"",Checked:"",Status:"",SharedObject:"",ModificationDatetime:"",NumberUse:"",Type:"",Server:"",Port:"",Alias:"",SID:"",ConnectionOptions:"",domainIcon:"",limitedPermissions:"",LinkedServices:"",UserModificationDatetime:"",Attachments:"",OtpUrl:""}),i=(0,p.getFieldLevelProcessor)(r),c=(0,t.reduceVaultObj)(e,t.constructCredentialContent,i,o,n);return r===a.ImportSource.Keeper&&(0,S.parseCustomKeeperCredentialData)(e,c),(0,t.buildNoteContent)(c,o,e,s,i),g(c,s),(0,t.formatCredentialData)(c),c},t.getHeadersAndIndexMap=(e,t)=>{const r=((e,t)=>{const r=Object.keys(t),a={};return e.forEach(((e,o)=>{const n=r.find((r=>t[r].has(e)));a[n??e]={supported:!!n,index:o}})),a})(e,d.HEADER_MAPPINGS[t]),a=Object.entries(r).reduce(((e,[t,r])=>({...e,[r.index]:r.supported?t:""})),{});return e.map(((e,t)=>({original:e,matched:a[t]??""})))},t.determineBestItemType=(e,t)=>{let r=null;const o=(0,u.getItemTypeProcessor)(t);if(o&&(r=o(e)),!r){for(const t in e)if(d.TYPE_HEADERS.has(t)&&(r=Object.keys(d.TYPE_MAPPINGS).find((r=>d.TYPE_MAPPINGS[r]?.includes(e[t].toLocaleLowerCase()))),r))break;if(!r){const t=Object.keys(e).map((e=>e.toLocaleLowerCase())),a={};Object.entries(d.HEADER_MAPPINGS).forEach((([r,o])=>{Object.values(o).forEach((o=>{a[r]=(a[r]||0)+[...o].filter((r=>t.includes(r)&&e[r])).length}))})),r=Object.keys(a).reduce(((e,t)=>a[e]>a[t]?e:t))}}return r||a.SupportedVaultTypes.NOTE},t.areHeadersValid=e=>{if(!e.length)return!1;const t=Object.values(d.HEADER_MAPPINGS);return Object.values(t).reduce(((e,t)=>[...e,...Object.values(t).map((e=>Array.from(e)))]),[]).flat().some((t=>e.includes(t)))}},161655:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notifyNewImportPersonalDataStateAction=t.NOTIFY_NEW_PERSONAL_DATA_STATE=void 0,t.NOTIFY_NEW_PERSONAL_DATA_STATE="NOTIFY_NEW_PERSONAL_DATA_STATE",t.notifyNewImportPersonalDataStateAction=e=>({type:t.NOTIFY_NEW_PERSONAL_DATA_STATE,newState:e})},236784:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImportDataStateReducer=void 0;const a=r(632626),o=r(161655);t.ImportDataStateReducer=(e,t)=>t.type===o.NOTIFY_NEW_PERSONAL_DATA_STATE?{state:t.newState}:e??{state:{status:a.ImportPersonalDataStateType.Idle}}},106205:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUserAddedLinkedWebsitesRootDomains=t.getUserAddedLinkedWebsiteDomains=t.getDashlaneDefinedLinkedWebsites=t.populateDashlaneDefinedLinkedWebsitesIndex=t.reduceLinkedDomainsLists=t.fromObjectToArray=void 0;const a=r(693843),o=r(148501),n=r(621543),s=r(421178);function i(e){const t=[];return Object.keys(e).forEach((r=>{t.push([r].concat(e[r]))})),t}t.fromObjectToArray=i;const c=(e,t)=>{const r=[],a=[];e.forEach((e=>{return o=t,e.some((e=>o.includes(e)))?r.push(e):a.push(e);var o}));const o=r.concat([t]).flat();return a.concat([o])};function l(e){const t={};return e.forEach((e=>{e.forEach((r=>{t[r]=e}))})),t}t.reduceLinkedDomainsLists=(e,t,r)=>e.concat(t,r).reduce(c,[]),t.populateDashlaneDefinedLinkedWebsitesIndex=l;const d=l((0,t.reduceLinkedDomainsLists)(a,i(n),i(o)).map((e=>[...new Set(e)])));t.getDashlaneDefinedLinkedWebsites=function(e){const t=new s.ParsedURL(e).getRootDomain();return t?d[t]||[t]:[]},t.getUserAddedLinkedWebsiteDomains=e=>(e.LinkedServices?.associated_domains??[]).map((e=>e.domain)).filter(Boolean)??[],t.getUserAddedLinkedWebsitesRootDomains=e=>(0,t.getUserAddedLinkedWebsiteDomains)(e).map((e=>new s.ParsedURL(e).getRootDomain()))},481911:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(518665),o=r(885569),n=r(937215);t.config={commands:{addPasskey:{handler:n.addPasskeyHandler},updatePasskey:{handler:n.updatePasskeyHandler},deletePasskey:{handler:n.deletePasskeyHandler}},queries:{getPasskey:{selector:a.viewedPasskeySelector},getPasskeys:{selector:a.viewedQueriedPasskeysSelector},getPasskeysForDomain:{selector:a.viewedQueriedPasskeysForDomainSelector}},liveQueries:{livePasskey:{operator:o.getPasskey$},livePasskeys:{operator:o.passkeys$}}}},270863:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addPasskeyHandler=t.getNewPasskey=void 0;const a=r(700033),o=r(632626),n=r(823136),s=r(448313),i=r(500053),c=r(278320),l=r(670252),d=r(298416);function u(e){const t=(0,i.getUnixTimestamp)();return{kwType:"KWPasskey",Id:(0,c.generateItemUuid)(),LastBackupTime:0,LastUse:t,LocaleFormat:o.Country.UNIVERSAL,AnonId:(0,c.generateItemUuid)(),SpaceId:e.spaceId,CreationDatetime:t,UserModificationDatetime:t,Counter:0,CredentialId:e.credentialId,ItemName:e.itemName,KeyAlgorithm:e.keyAlgorithm,Note:e.note,PrivateKey:e.privateKey,RpId:e.rpId,RpName:e.rpName,UserDisplayName:e.userDisplayName,UserHandle:e.userHandle}}t.getNewPasskey=u,t.addPasskeyHandler=async function(e,t){try{const r=await async function({storeService:e,sessionService:t},r){if(!e.isAuthenticated())throw new Error("No session available to savePasskey");const a=u((0,d.sanitizeInputPersonalData)(r));if(!a.SpaceId){const t=await(0,n.getDefaultSpaceId)(e);a.SpaceId=t}return e.dispatch((0,s.savePersonalDataItem)(a,a.kwType)),t.getInstance().user.persistPersonalData(),a.Id}(e,t);return(0,n.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},a.Trigger.Save),{success:!0,id:r}}catch(e){return(0,l.sendExceptionLog)({error:e}),{success:!1}}}},220308:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deletePasskeyHandler=void 0;const a=r(700033),o=r(632626),n=r(518665),s=r(823136),i=r(645291),c=r(670252);t.deletePasskeyHandler=function(e,{id:t}){const r=(({storeService:e},t)=>{const r=e.getState();try{if(!e.isAuthenticated())return{success:!1,error:{code:o.DeletePasskeyErrorCode.NOT_AUTHORIZED}};const a=(0,n.passkeySelector)(r,t);if(!a)return{success:!1,error:{code:o.DeletePasskeyErrorCode.NOT_FOUND}};const s=(0,i.removePersonalItem)(a.kwType,a.Id,null);return e.dispatch(s),{success:!0}}catch(e){const t=new Error(`[Passkeys] - deletePasskey: ${e}`);return(0,c.sendExceptionLog)({error:t}),{success:!1,error:{code:o.DeletePasskeyErrorCode.INTERNAL_ERROR}}}})(e,t);return r.success&&(0,s.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},a.Trigger.Save),Promise.resolve(r)}},937215:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(270863),t),o(r(789979),t),o(r(220308),t)},789979:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updatePasskeyHandler=t.getUpdatedPasskey=t.getPasskeyModifiedProperties=void 0;const a=r(700033),o=r(518665),n=r(823136),s=r(448313),i=r(500053),c=r(670252),l=r(298416);function d(e,r){const a=(0,o.passkeySelector)(e,r.id);if(!a)throw new Error("[updatePasskey]: unable to find passkey to update.");return{...a,...(0,t.getPasskeyModifiedProperties)(r,a)}}t.getPasskeyModifiedProperties=(e,t)=>{const r=(0,i.getUnixTimestamp)();return{Counter:e.counter??t.Counter,Note:e.note??t.Note,SpaceId:e.spaceId??t.SpaceId,ItemName:e.itemName??t.ItemName,LastUse:r}},t.getUpdatedPasskey=d,t.updatePasskeyHandler=function(e,t){try{const r=function({storeService:e,sessionService:t},r){if(!e.isAuthenticated())throw new Error("No session available to updatePasskey");const a=d(e.getState(),(0,l.sanitizeInputPersonalData)(r));return e.dispatch((0,s.savePersonalDataItem)(a,a.kwType)),t.getInstance().user.persistPersonalData(),{success:!0}}(e,t);return r.success?((0,n.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},a.Trigger.Save),Promise.resolve({success:!0})):Promise.resolve(r)}catch(e){return(0,c.sendExceptionLog)({error:e}),Promise.resolve({success:!1})}}},885569:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPasskey$=t.passkeys$=void 0;const a=r(518948),o=r(903343),n=r(555220),s=r(518665);t.passkeys$=(0,n.getLivePersonalInfo)(s.getLivePasskeysSelector),t.getPasskey$=e=>{const t=(0,s.getViewedPasskeySelector)(e);return(0,a.pipe)((0,o.map)(t),(0,o.distinctUntilChanged)())}},962900:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPasskeyMappers=void 0;const a=r(883539);t.getPasskeyMappers=()=>({id:e=>e.Id,itemName:e=>e.ItemName,lastUse:a.lastUseMapper,rpId:e=>e.RpId,spaceId:e=>e.SpaceId,userDisplayName:e=>e.UserDisplayName})},396664:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.passkeyMatch=t.searchGetters=void 0;const a=r(64455),o=r(382234);t.searchGetters=[(0,o.stringProp)("RpId"),(0,o.stringProp)("RpName"),(0,o.stringProp)("CredentialId")],t.passkeyMatch=(0,a.match)(t.searchGetters)},518665:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewedQueriedPasskeysForDomainSelector=t.queryPasskeysByDomainSelector=t.getPasskeysByFullDomainSelector=t.getViewedPasskeySelector=t.viewedPasskeySelector=t.getLivePasskeysSelector=t.viewedQueriedPasskeysSelector=t.queryPasskeysSelector=t.passkeyMappersSelector=t.passkeySelector=t.passkeysSelector=void 0;const a=r(401067),o=r(421178),n=r(396664),s=r(540200),i=r(324589),c=r(563566),l=r(497006),d=r(749551),u=r(432034),p=r(962900),S=e=>e.userSession.personalData.passkeys;t.passkeysSelector=S,t.passkeySelector=(e,t)=>{const r=S(e);return(0,d.findDataModelObject)(t,r)},t.passkeyMappersSelector=e=>(0,p.getPasskeyMappers)();const g=()=>n.passkeyMatch;t.queryPasskeysSelector=(0,i.getQuerySelector)(t.passkeysSelector,g,t.passkeyMappersSelector),t.viewedQueriedPasskeysSelector=(0,a.compose)((0,c.viewListResults)(s.listView),t.queryPasskeysSelector),t.getLivePasskeysSelector=(0,l.makeLiveSelectorGetter)(t.passkeysSelector,(()=>s.listView),g,t.passkeyMappersSelector),t.viewedPasskeySelector=(e,r)=>{const a=(0,t.passkeySelector)(e,r);return(0,s.detailView)(a)},t.getViewedPasskeySelector=e=>{const r=(0,u.createSelector)(t.passkeysSelector,(t=>(0,d.findDataModelObject)(e,t)));return(0,u.createSelector)(r,s.detailView)},t.getPasskeysByFullDomainSelector=e=>(0,u.createSelector)(t.passkeysSelector,(t=>((e,t)=>e.filter((e=>{const r=new o.ParsedURL(e.RpId).getHostname(),a=new o.ParsedURL(t).getHostname();return a===r||a.endsWith(`.${r}`)})))(t,e))),t.queryPasskeysByDomainSelector=e=>(0,i.getQuerySelector)((0,t.getPasskeysByFullDomainSelector)(e),g,t.passkeyMappersSelector),t.viewedQueriedPasskeysForDomainSelector=(e,r)=>{const a=(0,t.queryPasskeysByDomainSelector)(r.domain)(e,r);return(0,c.viewListResults)(s.listView)(a)}},540200:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.detailView=void 0;const a=r(782043),o=e=>({credentialId:e.CredentialId,counter:e.Counter,itemName:e.ItemName,keyAlgorithm:e.KeyAlgorithm,note:e.Note,privateKey:e.PrivateKey,rpId:e.RpId,rpName:e.RpName,userDisplayName:e.UserDisplayName,userHandle:e.UserHandle});t.detailView=e=>({...(0,a.dataModelDetailView)(e),...o(e)}),t.itemView=e=>({...(0,a.dataModelItemView)(e),...o(e)}),t.listView=e=>e.map(t.itemView)},868728:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(883449),o=r(847205),n=r(158695);t.config={commands:{saveGeneratedPassword:{handler:o.saveGeneratedPasswordHandler}},queries:{getPasswordHistory:{selector:a.viewedQueriedPasswordHistorySelector},getPasswordHistoryPage:{selector:a.passwordHistoryPageSelector},getPasswordHistoryPaginationToken:{selector:a.passwordHistoryPaginationTokenSelector},getHasPasswordHistory:{selector:a.hasPasswordHistorySelector}},liveQueries:{livePasswordHistory:{operator:n.passwordHistory$},livePasswordHistoryBatch:{operator:n.passwordHistoryBatch$}}}},158695:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.passwordHistoryBatch$=t.passwordHistory$=void 0;const a=r(518948),o=r(903343),n=r(883449),s=r(555220),i=r(735893),c=r(433627);t.passwordHistory$=(0,s.getLivePersonalInfo)(n.getLivePasswordHistorySelector),t.passwordHistoryBatch$=e=>{const t=(0,i.parseToken)(e),r=(0,n.getViewedPasswordHistoryBatchSelector)(t);return(0,a.pipe)((0,o.map)(r),(0,o.distinctUntilChanged)(c.sameBatch))}},387644:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPasswordHistoryMappers=void 0,t.getPasswordHistoryMappers=()=>({primaryInfo:e=>e.primaryInfo,timestamp:e=>e.timestamp,type:e=>e.type,id:e=>e.id,credentialId:e=>"credentialId"in e&&e.credentialId||""})},825294:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPasswordHistoryBatch=t.viewPasswordHistoryBatch=t.getPasswordHistoryFirstToken=t.getPasswordHistorySortToken=t.getPasswordHistoryFilterToken=void 0;const a=r(920553),o=r(402104),n=r(401067),s=r(183687),i=r(90451);t.getPasswordHistoryFilterToken=({filterCriteria:e})=>({filterCriteria:e||[]}),t.getPasswordHistorySortToken=({sortCriteria:e})=>({uniqField:"id",sortCriteria:e||[]}),t.getPasswordHistoryFirstToken=(e,t,r,o)=>(0,a.generateFirstToken)(e,t,r.initialBatchSize||30,o),t.viewPasswordHistoryBatch=(e,t,r,a)=>{const n=(0,s.getSharingStatusItem)(t,r),c=(0,i.getIcon)(a);return(0,o.listView)(n,c,e)},t.getPasswordHistoryBatch=(0,n.curry)(((e,t,r)=>(0,a.getBatch)(r,e,t)))},736859:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.passwordHistoryItemMatch=t.searchGettersForGeneratedPassword=t.searchGettersForCredential=void 0;const a=r(632626),o=r(382234),n=r(64455),s=r(106205);t.searchGettersForCredential=[(0,o.stringProp)("primaryInfo"),(0,o.stringProp)("domain"),(0,o.stringProp)("email"),(0,o.stringProp)("login"),(0,o.stringProp)("secondaryLogin"),e=>(0,s.getDashlaneDefinedLinkedWebsites)(e.domain).join(" ")],t.searchGettersForGeneratedPassword=[(0,o.stringProp)("primaryInfo")],t.passwordHistoryItemMatch=(e,r)=>r.type===a.PasswordHistoryItemType.Credential?(0,n.match)(t.searchGettersForCredential)(e,r):(0,n.match)(t.searchGettersForGeneratedPassword)(e,r)},883449:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedPasswordHistoryBatchSelector=t.passwordHistoryQuerySelector=t.passwordHistoryPaginationTokenSelector=t.passwordHistoryPageSelector=t.getLivePasswordHistorySelector=t.viewedQueriedPasswordHistorySelector=t.passwordHistoryListViewSelector=t.getPasswordHistoryMappersSelector=t.passwordHistoryMappersSelector=t.hasPasswordHistorySelector=t.passwordHistorySelector=void 0;const a=r(632626),o=r(421178),n=r(432034),s=r(518948),i=r(324589),c=r(992598),l=r(435385),d=r(751319),u=r(736859),p=r(563566),S=r(825294),g=r(387644),m=r(497006),y=r(735893),h=r(920553),f=r(980993),v=r(691210),T=r(791892),A=e=>"ChangedProperties"in e&&e.ChangedProperties.some((e=>"password"===e.toLowerCase())),P=(0,n.createSelector)(d.credentialsSelector,(e=>e.reduce(((e,t)=>e.set(t.Id,t)),new Map)));t.passwordHistorySelector=(0,n.createSelector)(c.generatedPasswordsSelector,l.credentialsHistoriesSelector,P,v.limitedSharingItemsSelector,((e,t,r,n)=>{const s=e.filter((e=>!e.AuthId)).map((e=>({type:a.PasswordHistoryItemType.Generated,primaryInfo:e.Domain??"",secondaryInfo:"",domain:e.Domain,password:e.Password,timestamp:e.GeneratedDate,id:e.Id,isProtected:!1}))),i=t.reduce(((e,t)=>{if(n[t.ObjectId]||!t.hasOwnProperty("ChangeSets"))return e;const s=r.get(t.ObjectId);if(!s)return e;const i=s?.Title,c=s?.Url,l=s?.Email,d=s?.Login,u=s?.AutoProtected||!1,p=t.ChangeSets.reduce(((e,t)=>{if(!A(t)||!(r=t.CurrentData)||void 0===r.Email&&void 0===r.Login||void 0===r.Url||void 0===r.Password)return e;var r;const n=new o.ParsedURL(c).getRootDomain(),p={type:a.PasswordHistoryItemType.Credential,primaryInfo:(i||n)??"",secondaryInfo:(l||d)??"",domain:c||t.CurrentData.Url,password:t.CurrentData.Password,timestamp:t.ModificationDate,id:t.Id,credentialId:s?.Id,isProtected:u,spaceId:s.SpaceId,email:s?.Email??"",login:s?.Login??"",secondaryLogin:s?.SecondaryLogin??""};return e.concat(p)}),[]);return e.concat(p)}),[]);return s.concat(i)})),t.hasPasswordHistorySelector=(e,t)=>{const r=(0,v.limitedSharingItemsSelector)(e);return(0,l.credentialsHistoriesSelector)(e).some((e=>{return e.ObjectId===t&&!((a=e.ObjectId)in r&&r[a])&&e.ChangeSets.filter(A).length>0;var a}))},t.passwordHistoryMappersSelector=e=>(0,g.getPasswordHistoryMappers)();const w=(0,g.getPasswordHistoryMappers)();t.getPasswordHistoryMappersSelector=()=>w;const b=()=>u.passwordHistoryItemMatch,I=(0,i.getQuerySelector)(t.passwordHistorySelector,b,t.passwordHistoryMappersSelector);t.passwordHistoryListViewSelector=(0,n.createSelector)(f.sortedSharedItemIdsSelector,v.limitedSharingItemsSelector,T.iconsSelector,t.passwordHistorySelector,((e,t,r)=>a=>(0,S.viewPasswordHistoryBatch)(a,e,t,r))),t.viewedQueriedPasswordHistorySelector=(e,r)=>{const a=I(e,r),o=(0,t.passwordHistoryListViewSelector)(e);return(0,p.viewListResults)(o)(a)},t.getLivePasswordHistorySelector=(0,m.makeLiveSelectorGetter)(t.passwordHistorySelector,t.passwordHistoryListViewSelector,b,t.getPasswordHistoryMappersSelector),t.passwordHistoryPageSelector=(e,r)=>{const a=(0,y.parseToken)(r),{sortToken:o,filterToken:n}=a,s=(0,g.getPasswordHistoryMappers)(),i=(0,t.passwordHistoryQuerySelector)(e,{sortToken:o,filterToken:n}),c=(0,t.passwordHistoryListViewSelector)(e),l=(0,h.generateNextToken)(s,a,i),d=(0,h.generatePrevToken)(s,a,i),u=(0,h.getBatch)(s,a,i),p=(0,y.stringifyToken)(l),S=(0,y.stringifyToken)(d);return{batch:c(u),nextToken:p,prevToken:S}},t.passwordHistoryPaginationTokenSelector=(e,r)=>{const a=(0,S.getPasswordHistorySortToken)(r),o=(0,S.getPasswordHistoryFilterToken)(r),n=(0,g.getPasswordHistoryMappers)(),s={sortToken:a,filterToken:o},i=(0,t.passwordHistoryQuerySelector)(e,s),c=(0,S.getPasswordHistoryFirstToken)(n,s,r,i);return(0,y.stringifyToken)(c)};const E=(0,n.createSelector)(t.passwordHistorySelector,g.getPasswordHistoryMappers),C=(0,y.createOptimizedSortTokenSelector)(((e,{sortToken:t})=>t),s.identity),_=(0,y.createOptimizedFilterTokenSelector)(((e,{filterToken:t})=>t),s.identity);t.passwordHistoryQuerySelector=(0,n.createSelector)(g.getPasswordHistoryMappers,b,C,_,t.passwordHistorySelector,y.queryData),t.getViewedPasswordHistoryBatchSelector=e=>{const{sortToken:r,filterToken:a}=e,o=(0,S.getPasswordHistoryBatch)(e),s=(0,n.createSelector)((e=>(0,t.passwordHistoryQuerySelector)(e,{filterToken:a,sortToken:r})),E,o),i=(0,y.optimizeBatchSelector)(s);return(0,n.createSelector)(i,f.sortedSharedItemIdsSelector,v.limitedSharingItemsSelector,T.iconsSelector,S.viewPasswordHistoryBatch)}},402104:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=void 0;const a=r(632626);t.listView=(e,t,r)=>r.map((r=>r.type===a.PasswordHistoryItemType.Credential?{type:a.PasswordHistoryItemType.Credential,id:r.id,primaryInfo:r.primaryInfo,secondaryInfo:r.secondaryInfo,password:r.password,timestamp:r.timestamp,credentialId:r.credentialId,icons:t(r.domain),sharingStatus:e(r.credentialId),isProtected:r.isProtected,spaceId:r.spaceId,domain:r.domain}:{type:a.PasswordHistoryItemType.Generated,id:r.id,primaryInfo:r.primaryInfo,password:r.password,timestamp:r.timestamp}))},717025:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(358235),o=r(7408),n=r(748121);t.config={commands:{addPaymentCard:{handler:n.addPaymentCardHandler},deletePaymentCard:{handler:n.deletePaymentCardHandler},updatePaymentCard:{handler:n.updatePaymentCardHandler}},queries:{getPaymentCard:{selector:a.viewedPaymentCardSelector},getPaymentCards:{selector:a.viewedQueriedPaymentCardsSelector}},liveQueries:{livePaymentCard:{operator:o.getPaymentCard$},livePaymentCards:{operator:o.paymentCards$}}}},519738:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addPaymentCardHandler=t.getNewPaymentCard=void 0;const a=r(700033),o=r(632626),n=r(823136),s=r(442316),i=r(448313),c=r(500053),l=r(278320),d=r(670252),u=r(298416),p=r(579980);function S(e){e=(0,u.sanitizeInputPersonalData)(e);const t=(0,c.getUnixTimestamp)(),r=(0,s.defaultToEmptyString)(e.cardNumber).replace(/ /g,"");if(!r&&!e.securityCode)throw new s.RequestError("[addPaymentCard]: refusing to add a payment card without card number or security code.",o.PaymentCardSaveResultErrorCode.EMPTY_CARD_NUMBER_AND_SECURITY_CODE);return{kwType:"KWPaymentMean_creditCard",AnonId:(0,l.generateItemUuid)(),Bank:"US-NO_TYPE",CardNumber:r,CardNumberLastDigits:(0,s.getLastDigitsFromCardNumber)(r),CreationDatetime:t,Color:(0,s.defaultToFallbackColor)(e.color),ExpireMonth:(0,s.defaultToEmptyString)(e.expireMonth),ExpireYear:(0,s.defaultToEmptyString)(e.expireYear),Id:(0,l.generateItemUuid)(),IssueNumber:"",Name:(0,s.defaultToEmptyString)(e.name),OwnerName:(0,s.defaultToEmptyString)(e.ownerName),CCNote:(0,s.defaultToEmptyString)(e.personalNote),LocaleFormat:o.Country.US,SecurityCode:(0,s.defaultToEmptyString)(e.securityCode),SpaceId:(0,s.defaultToEmptyString)(e.spaceId),StartYear:"",StartMonth:"",Type:(0,s.getPaymentTypeFromCardNumber)(r),UserModificationDatetime:t,LastBackupTime:0}}t.getNewPaymentCard=S,t.addPaymentCardHandler=async(e,t)=>{try{return await(async({storeService:e,sessionService:t,eventLoggerService:r},a)=>{if(!e.isAuthenticated())throw new Error("No session available to addPaymentCard");const o=S(a);if(!o.SpaceId){const t=await(0,n.getDefaultSpaceId)(e);o.SpaceId=t}(0,p.logAddVaultItem)(e,r,o),e.dispatch((0,i.savePersonalDataItem)(o,o.kwType)),t.getInstance().user.persistPersonalData()})(e,t),(0,n.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},a.Trigger.Save),Promise.resolve({success:!0})}catch(e){return(0,d.sendExceptionLog)({error:e}),e instanceof s.RequestError&&void 0!==e.code?Promise.resolve({success:!1,error:{code:e.code}}):Promise.resolve({success:!1})}}},537028:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deletePaymentCardHandler=void 0;const a=r(700033),o=r(632626),n=r(823136),s=r(358235),i=r(670252),c=r(645291),l=r(579980);t.deletePaymentCardHandler=function(e,{id:t}){const r=(({storeService:e,eventLoggerService:t},r)=>{const a=e.getState();try{if(!e.isAuthenticated())return{success:!1,error:{code:o.DeletePaymentCardErrorCode.NOT_AUTHORIZED}};const n=(0,s.paymentCardSelector)(a,r);if(!n)return{success:!1,error:{code:o.DeletePaymentCardErrorCode.NOT_FOUND}};const i=(0,c.removePersonalItem)(n.kwType,n.Id,null);return e.dispatch(i),(0,l.logDeleteVaultItem)(e,t,n),{success:!0}}catch(e){const t=new Error(`[PaymentCards] - deletePaymentCard: ${e}`);return(0,i.sendExceptionLog)({error:t}),{success:!1,error:{code:o.DeletePaymentCardErrorCode.INTERNAL_ERROR}}}})(e,t);return r.success&&(0,n.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},a.Trigger.Save),Promise.resolve(r)}},748121:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(519738),t),o(r(537028),t),o(r(665468),t)},665468:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updatePaymentCardHandler=t.getUpdatedPaymentCard=void 0;const a=r(700033),o=r(632626),n=r(358235),s=r(823136),i=r(442316),c=r(448313),l=r(500053),d=r(670252),u=r(298416),p=r(579980);function S(e,t){if(!e)throw new i.RequestError("[updatePaymentCard]: unable to find payment card to update.",o.PaymentCardSaveResultErrorCode.NOT_FOUND);t=(0,u.sanitizeInputPersonalData)(t);const r=(0,i.defaultToEmptyString)(t.cardNumber??e.CardNumber).replace(/ /g,""),a=(0,l.getUnixTimestamp)(),n={CardNumber:r,CardNumberLastDigits:(0,i.getLastDigitsFromCardNumber)(r),Color:t.color??e.Color,ExpireMonth:t.expireMonth??e.ExpireMonth,ExpireYear:t.expireYear??e.ExpireYear,Name:t.name??e.Name,OwnerName:t.ownerName??e.OwnerName,SecurityCode:t.securityCode??e.SecurityCode,SpaceId:t.spaceId??e.SpaceId,Type:(0,i.getPaymentTypeFromCardNumber)(r),UserModificationDatetime:a,CCNote:t.personalNote??e.CCNote},s={...e,...n};if(!r&&!s.SecurityCode)throw new i.RequestError("[updatePaymentCard]: refusing to add a payment card without card number or security code.",o.PaymentCardSaveResultErrorCode.EMPTY_CARD_NUMBER_AND_SECURITY_CODE);return s}t.getUpdatedPaymentCard=S,t.updatePaymentCardHandler=function(e,t){try{return function({storeService:e,sessionService:t,eventLoggerService:r},a){if(!e.isAuthenticated())throw new Error("No session available to updatePaymentCard");const o=(0,n.paymentCardSelector)(e.getState(),a.id),s=S(o,a);(0,p.logEditVaultItem)(e,r,s,o),e.dispatch((0,c.savePersonalDataItem)(s,s.kwType)),t.getInstance().user.persistPersonalData()}(e,t),(0,s.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},a.Trigger.Save),Promise.resolve({success:!0})}catch(e){return(0,d.sendExceptionLog)({error:e}),e instanceof i.RequestError&&void 0!==e.code?Promise.resolve({success:!1,error:{code:e.code}}):Promise.resolve({success:!1})}}},442316:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RequestError=t.getPaymentTypeFromCardNumber=t.getLastDigitsFromCardNumber=t.defaultColor=t.defaultToFallbackColor=t.defaultToEmptyString=void 0;const a=r(401067),o=r(632626);t.defaultToEmptyString=(0,a.defaultTo)(""),t.defaultToFallbackColor=(0,a.defaultTo)(o.PaymentCardColor.BLUE_1),t.defaultColor="BLUE_1",t.getLastDigitsFromCardNumber=function(e){const r=(0,t.defaultToEmptyString)(e).trim();return r.length>=4?r.slice(-4):""},t.getPaymentTypeFromCardNumber=function(e){if(!e)return o.PaymentCardType.PAYMENT_TYPE_VISA;const t=(e,t)=>t.some((t=>e.startsWith(t)));return e.startsWith("4")?o.PaymentCardType.PAYMENT_TYPE_VISA:t(e,["34","37"])?o.PaymentCardType.PAYMENT_TYPE_AMEX:t(e,["50","51","52","53","54","55"])?o.PaymentCardType.PAYMENT_TYPE_MASTERCARD:t(e,["6011","65"])?o.PaymentCardType.PAYMENT_TYPE_DISCOVER:t(e,["300","301","302","303","304","305","36","38"])?o.PaymentCardType.PAYMENT_TYPE_DINERSCLUB:t(e,["2123","2131","1800","3"])?o.PaymentCardType.PAYMENT_TYPE_JCB:o.PaymentCardType.PAYMENT_TYPE_MASTERCARD};class n extends Error{constructor(e,t){super(e),Object.setPrototypeOf(this,new.target.prototype),this.name="RequestError",this.code=t}}t.RequestError=n},535834:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUpdatedPaymentCard=t.getNewPaymentCard=t.savePaymentCard=void 0;const a=r(401067),o=r(632626),n=r(795623),s=r(645291),i=r(278320),c=r(500053),l=r(749551),d=r(442316),u=r(579980);function p(e){n.default.log("[Data] Creating new Payment Card");const t=(0,c.getUnixTimestamp)(),r=(0,d.defaultToEmptyString)(e.cardNumber).replace(/ /g,"");return{kwType:"KWPaymentMean_creditCard",AnonId:(0,i.generateItemUuid)(),Bank:"US-NO_TYPE",CardNumber:r,CardNumberLastDigits:(0,d.getLastDigitsFromCardNumber)(r),CreationDatetime:t,Color:(0,a.defaultTo)(o.PaymentCardColor.BLUE_1,e.color),ExpireMonth:(0,d.defaultToEmptyString)(e.expireMonth),ExpireYear:(0,d.defaultToEmptyString)(e.expireYear),Id:(0,i.generateItemUuid)(),IssueNumber:"",Name:(0,a.defaultTo)("Card",e.cardName),OwnerName:(0,d.defaultToEmptyString)(e.ownerName),CCNote:(0,d.defaultToEmptyString)(e.personalNote),LocaleFormat:o.Country.US,SecurityCode:(0,d.defaultToEmptyString)(e.securityCode),SpaceId:e.spaceId||"",StartYear:"",StartMonth:"",Type:(0,d.getPaymentTypeFromCardNumber)(r),UserModificationDatetime:t,LastBackupTime:0}}function S(e,t){const r=(0,l.findDataModelObject)(t.id,e);if(!r)return void n.default.log("Client asks to update an unknown Payment Card");n.default.log(`[Data] Updating existing Payment Card ${t.id}`);const o=(0,c.getUnixTimestamp)(),s=(0,d.defaultToEmptyString)(t.cardNumber).replace(/ /g,""),i={CardNumber:s,CardNumberLastDigits:(0,d.getLastDigitsFromCardNumber)(s),Color:t.color?t.color:r.Color,ExpireMonth:(0,d.defaultToEmptyString)(t.expireMonth),ExpireYear:(0,d.defaultToEmptyString)(t.expireYear),Name:(0,a.defaultTo)("Card",t.cardName),OwnerName:(0,d.defaultToEmptyString)(t.ownerName),SecurityCode:(0,d.defaultToEmptyString)(t.securityCode),SpaceId:(0,d.defaultToEmptyString)(t.spaceId),Type:(0,d.getPaymentTypeFromCardNumber)(t.cardNumber),UserModificationDatetime:o,CCNote:(0,d.defaultToEmptyString)(t.personalNote)};return{...r,...i}}t.savePaymentCard=function({storeService:e,sessionService:t,eventLoggerService:r},a){if(!e.isAuthenticated())return void n.default.log("No session available to savePaymentCard");const o=e.getPersonalData(),i=a.id?S(o.paymentCards,a):p(a);if(a.id){const t=(0,l.findDataModelObject)(i.Id,o.paymentCards);(0,u.logEditVaultItem)(e,r,i,t)}else(0,u.logAddVaultItem)(e,r,i);e.dispatch((0,s.savePaymentCard)(i)),t.getInstance().user.persistPersonalData()},t.getNewPaymentCard=p,t.getUpdatedPaymentCard=S},7408:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPaymentCard$=t.paymentCards$=void 0;const a=r(518948),o=r(903343),n=r(555220),s=r(358235);t.paymentCards$=(0,n.getLivePersonalInfo)(s.getLivePaymentCardsSelector),t.getPaymentCard$=e=>{const t=(0,s.getViewedPaymentCardSelector)(e);return(0,a.pipe)((0,o.map)(t),(0,o.distinctUntilChanged)())}},791663:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPaymentCardMappers=void 0;const a=r(883539);t.getPaymentCardMappers=()=>({spaceId:e=>e.SpaceId,name:e=>e.Name,lastUse:a.lastUseMapper,id:e=>e.Id})},538701:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.paymentCardMatch=t.searchGetters=void 0;const a=r(382234),o=r(64455);t.searchGetters=[(0,a.stringProp)("Name"),(0,a.stringProp)("OwnerName")],t.paymentCardMatch=(0,o.match)(t.searchGetters)},358235:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedPaymentCardSelector=t.viewedPaymentCardSelector=t.getLivePaymentCardsSelector=t.viewedQueriedPaymentCardsSelector=t.queryPaymentCardsSelector=t.paymentCardMappersSelector=t.paymentCardSelector=t.paymentCardsSelector=void 0;const a=r(401067),o=r(538701),n=r(8818),s=r(324589),i=r(563566),c=r(497006),l=r(749551),d=r(432034),u=r(791663),p=r(340602),S=r(657989);t.paymentCardsSelector=(0,d.createSelector)((e=>e.userSession.personalData.paymentCards),S.quarantinedSpacesSelector,p.filterOutQuarantinedItems),t.paymentCardSelector=(e,r)=>{const a=(0,t.paymentCardsSelector)(e);return(0,l.findDataModelObject)(r,a)},t.paymentCardMappersSelector=e=>(0,u.getPaymentCardMappers)();const g=()=>o.paymentCardMatch;t.queryPaymentCardsSelector=(0,s.getQuerySelector)(t.paymentCardsSelector,g,t.paymentCardMappersSelector),t.viewedQueriedPaymentCardsSelector=(0,a.compose)((0,i.viewListResults)(n.listView),t.queryPaymentCardsSelector),t.getLivePaymentCardsSelector=(0,c.makeLiveSelectorGetter)(t.paymentCardsSelector,(()=>n.listView),g,t.paymentCardMappersSelector),t.viewedPaymentCardSelector=(e,r)=>{const a=(0,t.paymentCardSelector)(e,r);return(0,n.maybeDetailView)(a)},t.getViewedPaymentCardSelector=e=>{const r=(0,d.createSelector)(t.paymentCardsSelector,(t=>(0,l.findDataModelObject)(e,t)));return(0,d.createSelector)(r,n.maybeDetailView)}},8818:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.maybeDetailView=t.detailView=void 0;const a=r(401067),o=r(782043),n=r(442316),s=(0,a.defaultTo)("");t.detailView=e=>({...(0,o.dataModelDetailView)(e),bank:s(e.Bank),cardNumber:s(e.CardNumber),cardNumberLastDigits:(0,n.getLastDigitsFromCardNumber)(e.CardNumber),color:e.Color||n.defaultColor,expireMonth:s(e.ExpireMonth),expireYear:s(e.ExpireYear),issueNumber:s(e.IssueNumber),name:s(e.Name),ownerName:s(e.OwnerName),personalNote:s(e.CCNote),securityCode:s(e.SecurityCode),startMonth:s(e.StartMonth),startYear:s(e.StartYear),type:e.Type}),t.maybeDetailView=(0,o.maybeDataModelDetailView)(t.detailView),t.itemView=e=>({...(0,o.dataModelItemView)(e),cardNumber:s(e.CardNumber),cardNumberLastDigits:(0,n.getLastDigitsFromCardNumber)(e.CardNumber),color:e.Color||n.defaultColor,expireMonth:s(e.ExpireMonth),expireYear:s(e.ExpireYear),name:s(e.Name),ownerName:s(e.OwnerName),personalNote:s(e.CCNote),type:e.Type}),t.listView=e=>e.map(t.itemView)},579980:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.logDeleteVaultItem=t.logAddVaultItem=t.logEditVaultItem=void 0;const a=r(700033),o=r(632626),n=r(421178),s=r(249901),i=r(553966),c=r(310770),l=r(153626),d=(e,t,r,d,u,p,S)=>{const g=e.getState(),m=(0,l.collectionsSelector)(g),y=d.SpaceId===s.PERSONAL_SPACE_ID?a.Space.Personal:a.Space.Professional,h=void 0!==p?p.map((e=>(0,i.getHermesFieldFromProperty)(d,e))).filter((e=>e)):void 0,f=i.dataModelTypeToItemType[d.kwType],v=(0,c.getCollectionNamesContainingVaultItemId)(d.Id,m).length;if(t.logEvent(new a.UserUpdateVaultItemEvent({action:r,itemId:d.Id,itemType:f,fieldsEdited:h,space:y,collectionCount:v,multiSelectId:S??void 0,updateCredentialOrigin:u})),d.kwType===o.DataModelType.KWAuthentifiant){const e=d,o=new n.ParsedURL(e.Url).getRootDomain(),s="string"==typeof o?o:"";(0,a.hashDomain)(s).then((e=>{t.logEvent(new a.AnonymousUpdateCredentialEvent({action:r,domain:{id:e,type:a.DomainType.Web},fieldList:h,space:y}))}))}};t.logEditVaultItem=(e,t,r,o,n)=>{const s=(0,i.getUpdatedProperties)(r,o);d(e,t,a.Action.Edit,r,n,s)},t.logAddVaultItem=(e,t,r,o)=>d(e,t,a.Action.Add,r,o),t.logDeleteVaultItem=(e,t,r,o,n)=>d(e,t,a.Action.Delete,r,o,void 0,n)},553966:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUpdatedProperties=t.getHermesFieldFromProperty=t.dataModelTypeToItemType=void 0;const a=r(700033),o=r(632626);t.dataModelTypeToItemType={[o.DataModelType.KWAuthentifiant]:a.ItemType.Credential,[o.DataModelType.KWSecureNote]:a.ItemType.SecureNote,[o.DataModelType.KWIdentity]:a.ItemType.Identity,[o.DataModelType.KWEmail]:a.ItemType.Email,[o.DataModelType.KWPhone]:a.ItemType.Phone,[o.DataModelType.KWAddress]:a.ItemType.Address,[o.DataModelType.KWCompany]:a.ItemType.Company,[o.DataModelType.KWPersonalWebsite]:a.ItemType.Website,[o.DataModelType.KWPaymentMean_creditCard]:a.ItemType.CreditCard,[o.DataModelType.KWBankStatement]:a.ItemType.BankStatement,[o.DataModelType.KWIDCard]:a.ItemType.IdCard,[o.DataModelType.KWSocialSecurityStatement]:a.ItemType.SocialSecurity,[o.DataModelType.KWDriverLicence]:a.ItemType.DriverLicence,[o.DataModelType.KWPassport]:a.ItemType.Passport,[o.DataModelType.KWFiscalStatement]:a.ItemType.FiscalStatement,[o.DataModelType.KWSecret]:a.ItemType.Secret};const n={Title:a.Field.Title,FirstName:a.Field.FirstName,MiddleName:a.Field.MiddleName,LastName:a.Field.LastName,BirthDate:a.Field.BirthDate,BirthPlace:a.Field.BirthPlace,Pseudo:a.Field.Pseudo,SpaceId:a.Field.Space},s={Email:a.Field.Email,Type:a.Field.Type,EmailName:a.Field.EmailName,SpaceId:a.Field.Space},i={Number:a.Field.Number,PhoneName:a.Field.PhoneName,Type:a.Field.Type,SpaceId:a.Field.Space},c={StreetNumber:a.Field.StreetNumber,StreetName:a.Field.StreetName,StreetTitle:a.Field.StreetTitle,City:a.Field.City,State:a.Field.State,StateLevel2:a.Field.StateLevel2,StateNumber:a.Field.StateNumber,ZipCode:a.Field.ZipCode,Country:a.Field.Country,AddressName:a.Field.AddressName,Receiver:a.Field.Receiver,Building:a.Field.Building,Floor:a.Field.Floor,Door:a.Field.Door,LinkedPhone:a.Field.LinkedPhone,PersonalNote:a.Field.Note,SpaceId:a.Field.Space},l={Name:a.Field.Name,JobTitle:a.Field.JobTitle,SpaceId:a.Field.Space},d={Website:a.Field.Website,Name:a.Field.Name,SpaceId:a.Field.Space},u={Name:a.Field.Name,OwnerName:a.Field.OwnerName,CardNumber:a.Field.CardNumber,SecurityCode:a.Field.SecurityCode,ExpireMonth:a.Field.ExpireDate,ExpireYear:a.Field.ExpireDate,Color:a.Field.Color,SpaceId:a.Field.Space},p={BankAccountName:a.Field.Name,BankAccountOwner:a.Field.Owner,BankAccountBIC:a.Field.Bic,BankAccountIBAN:a.Field.Iban,BankAccountBank:a.Field.Bank,SpaceId:a.Field.Space},S={Fullname:a.Field.Fullname,Number:a.Field.Number,DeliveryDate:a.Field.DeliveryDate,ExpireDate:a.Field.ExpireDate,LinkedIdentity:a.Field.LinkedIdentity,Sex:a.Field.Sex,DateOfBirth:a.Field.DateOfBirth,SpaceId:a.Field.Space},g={SocialSecurityFullname:a.Field.SocialSecurityFullname,SocialSecurityNumber:a.Field.SocialSecurityNumber,LinkedIdentity:a.Field.LinkedIdentity,Sex:a.Field.Sex,DateOfBirth:a.Field.DateOfBirth,SpaceId:a.Field.Space},m={Fullname:a.Field.Fullname,Number:a.Field.Number,DeliveryDate:a.Field.DeliveryDate,ExpireDate:a.Field.ExpireDate,State:a.Field.State,LinkedIdentity:a.Field.LinkedIdentity,Sex:a.Field.Sex,DateOfBirth:a.Field.DateOfBirth,SpaceId:a.Field.Space},y={Fullname:a.Field.Fullname,Number:a.Field.Number,DeliveryDate:a.Field.DeliveryDate,DeliveryPlace:a.Field.DeliveryPlace,ExpireDate:a.Field.ExpireDate,LinkedIdentity:a.Field.LinkedIdentity,Sex:a.Field.Sex,DateOfBirth:a.Field.DateOfBirth,SpaceId:a.Field.Space},h={FiscalNumber:a.Field.FiscalNumber,TeledeclarantNumber:a.Field.TeledeclarantNumber,SpaceId:a.Field.Space};t.getHermesFieldFromProperty=(e,t)=>{switch(e.kwType){case o.DataModelType.KWAuthentifiant:return((e,t)=>{switch(t){case"Email":return a.Field.Email;case"Login":return a.Field.Login;case"SecondaryLogin":return a.Field.SecondaryLogin;case"Password":return a.Field.Password;case"AutoLogin":return e.AutoLogin?a.Field.AutoLoginOn:a.Field.AutoLoginOff;case"AutoProtected":return e.AutoProtected?a.Field.MpProtectedOn:a.Field.MpProtectedOff;case"Url":return a.Field.Website;case"Category":return a.Field.Category;case"Note":return a.Field.Note;case"SubdomainOnly":return e.SubdomainOnly?a.Field.SubdomainOnlyOn:a.Field.SubdomainOnlyOff;case"Title":return a.Field.Title;case"SpaceId":return a.Field.Space}})(e,t);case o.DataModelType.KWSecureNote:return((e,t)=>{switch(t){case"Title":return a.Field.Title;case"Content":return a.Field.Content;case"Category":return a.Field.Category;case"SpaceId":return a.Field.Space;case"Secured":return e.Secured?a.Field.MpProtectedOn:a.Field.MpProtectedOff}})(e,t);case o.DataModelType.KWIdentity:return n[t];case o.DataModelType.KWEmail:return s[t];case o.DataModelType.KWPhone:return i[t];case o.DataModelType.KWAddress:return c[t];case o.DataModelType.KWCompany:return l[t];case o.DataModelType.KWPersonalWebsite:return d[t];case o.DataModelType.KWPaymentMean_creditCard:return u[t];case o.DataModelType.KWBankStatement:return p[t];case o.DataModelType.KWIDCard:return S[t];case o.DataModelType.KWSocialSecurityStatement:return g[t];case o.DataModelType.KWDriverLicence:return m[t];case o.DataModelType.KWPassport:return y[t];case o.DataModelType.KWFiscalStatement:return h[t]}},t.getUpdatedProperties=(e,t)=>Object.getOwnPropertyNames(e).filter((r=>{const a=void 0!==e[r],o=e[r]!==t[r];return a&&o}))},883539:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.lastUseMapper=void 0,t.lastUseMapper=e=>e.LastUse||-1},650886:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updatePersonalDataUsageMetadata=t.addPersonalDataItem=t.makePersonalDataItem=void 0;const a=r(632626),o=r(584977),n=r(587496),s=r(673566),i=r(885225),c=r(823136),l=r(670252),d=r(500053),u=r(795623),p=r(448313),S=r(209951),g=r(749766),m=r(529565),y=r(691494),h=r(39732),f=r(149723),v=r(772079),T=r(488542),A=r(448931),P=r(412362),w=r(986691),b=r(298416),I=r(656915),E=r(579980),C=r(749551),_=r(178163),D=r(796850),O={[a.DataModelType.KWAddress]:{create:f.makeNewAddress,update:f.makeUpdatedAddress},[a.DataModelType.KWAuthentifiant]:{beforeChange:T.beforeCredentialChange,create:T.makeNewCredential,update:T.makeUpdatedCredential,notifySharersOnUpdate:T.notifySharersCredentialUpdated,afterSave:T.afterCredentialSaved},[a.DataModelType.KWBankStatement]:{create:A.makeNewBankAccount,update:A.makeUpdatedBankAccount},[a.DataModelType.KWCompany]:{create:S.makeNewCompany,update:S.makeUpdatedCompany},[a.DataModelType.KWEmail]:{create:g.makeNewEmail,update:g.makeUpdatedEmail},[a.DataModelType.KWIdentity]:{create:y.makeNewIdentity,update:y.makeUpdatedIdentity},[a.DataModelType.KWPersonalWebsite]:{create:m.makeNewPersonalWebsite,update:m.makeUpdatedPersonalWebsite},[a.DataModelType.KWPhone]:{create:h.makeNewPhone,update:h.makeUpdatedPhone},[a.DataModelType.KWSecureNote]:{create:v.makeNewNote,update:v.makeUpdatedNote,notifySharersOnUpdate:v.notifySharersNoteUpdated},[a.DataModelType.KWSecret]:{create:D.makeNewSecret,update:D.makeUpdatedSecret,notifySharersOnUpdate:D.notifySharersSecretUpdated}};async function M(e,t,r){t.content||(u.default.error(`[Data] PersonalInfoItem: ${t.kwType}, has no content`),l.sendExceptionLog({message:`[makePersonalDataItem] No content found for PersonalDataItem of kwType: ${t.kwType}`,code:a.ExceptionCriticality.WARNING}),t={...t,content:{}});let o=null;if(t.content.id){const e=(0,c.getCurrentItems)(t.kwType,r);o=(0,C.findDataModelObject)(t.content.id,e)}const n=O[t.kwType];if(!n)return u.default.error(`[Data] Could not make PersonalDataItem of kwType: ${t.kwType}`),null;let s;if(t=function(e){return{...e,content:(0,b.sanitizeInputPersonalData)(e.content)}}(t),n.beforeChange&&(t=n.beforeChange(t,r)),o){if(s=await n.update(t,o),n.notifySharersOnUpdate&&!await n.notifySharersOnUpdate(e,o,s))return null}else s=await n.create(t);return s}t.makePersonalDataItem=M,t.addPersonalDataItem=async function({storeService:e,sessionService:t,eventLoggerService:r,applicationModulesAccess:n},l){if(!e.isAuthenticated())return u.default.log("No session available to addPersonalDataItem"),{success:!1,itemId:""};const d=e.getPersonalData(),S=await M(e,l,d);if(!S)return{success:!1,itemId:""};if(!S.SpaceId){const t=await(0,c.getDefaultSpaceId)(e);S.SpaceId=t}const g=Boolean(l?.content.id);let m=null;const y=(0,P.getInstance)(),h=(0,w.getInstance)();if(g){const t=o.default[S.kwType],a=(0,C.findDataModelObject)(S.Id,d[t]);(0,E.logEditVaultItem)(e,r,S,a)}else(0,E.logAddVaultItem)(e,r,S);const f=(0,I.platformInfoSelector)(e.getState()),v=(0,s.isChangeHistoryCandidate)(S)&&g?(0,s.getUpdatedItemChangeHistory)({deviceName:e.getLocalSettings().deviceName,personalData:d,change:(0,i.makeUpdateChange)(S),userLogin:e.getUserLogin(),platformInfo:f}):null;if(e.dispatch((0,p.savePersonalDataItem)(S,S.kwType,v)),(0,a.isCredential)(S)){m=h.lockTopic("iconsUpdates");const t={credentialIds:[S.Id],type:"credentialUpdates"};await y.add("iconsUpdates",t),"************"===S?.Password&&(0,u.logWarn)({message:"Saving credentials using a placeholder",tag:"Credentials"}),(0,_.shouldSendCreateOrModifiedCredentialActivityLog)(e,n,S,l.origin)&&(l.content.id?.length?await(0,_.computeAndSendModifiedCredentialActivityLog)(n,{domainUrl:l.content.url}):await(0,_.computeAndSendCreatedCredentialActivityLog)(n,{domainUrl:l.content.url}))}return O[l.kwType]?.afterSave&&O[l.kwType].afterSave(e,S),m&&h.releaseTopic("iconsUpdates",m),t.getInstance().user.persistPersonalData(),{success:!0,itemId:S.Id}},t.updatePersonalDataUsageMetadata=function(e,t,r,s){const i=o.default[s],c=(0,n.cleanUrlForPersonalData)(r),S=e.getPersonalData()[i],g=Array.isArray(S)?(0,C.findDataModelObject)(t,S):null;if(!g)return void l.sendExceptionLog({message:`[PersonalData] - updatePersonalDataUsageMetadata: No ${i} found for provided ID to update usage metadata`,code:a.ExceptionCriticality.WARNING});u.default.log(`[Data] Updating ${i} ${t} usage metadata`);const m={...g,LastUse:(0,d.getUnixTimestamp)()};if((0,a.isCredential)(m)){const{NumberUse:e,TrustedUrlGroup:t}=m;m.NumberUse=("number"==typeof e?e:0)+1,m.TrustedUrlGroup=(0,n.getUpdatedTrustedUrlList)(t,c)}e.dispatch((0,p.savePersonalDataItem)(m,s))}},298416:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sanitizeInputPersonalData=void 0;const a=r(401067),o=e=>"string"==typeof e?e.replace(new RegExp("([^\t\n\r -퟿-�𐀀-􏿿])","gu"),""):e;t.sanitizeInputPersonalData=e=>(0,a.mapObjIndexed)(o,e)},576330:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.personalDataSelector=t.personalDataItemsOfTypeSelector=void 0;const a=r(584977);t.personalDataItemsOfTypeSelector=(e,t)=>e.userSession&&e.userSession.personalData&&t.reduce(((t,r)=>t.concat(e.userSession.personalData[a.default[r]])),[]),t.personalDataSelector=e=>e.userSession&&e.userSession.personalData},749551:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.filterDataModelObjects=t.findDataModelObject=void 0;const a=r(401067),o=r(584977);t.findDataModelObject=(e,t)=>{const r=(e||"").toUpperCase();return(t||[]).find((e=>!!e?.Id&&r===e.Id?.toUpperCase()))},t.filterDataModelObjects=(e,t,r)=>{const n=(0,a.unnest)((0,a.values)((0,a.omit)(r,(0,a.pick)(o.PERSONAL_DATA_COLLECTIONS_KEYS,e)))),s=(0,a.map)(a.toUpper,t),i=(0,a.propSatisfies)((e=>(0,a.contains)((e||"").toUpperCase(),s)),"Id");return(0,a.filter)(i,n)}},149723:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeAddressSpecificProps=t.makeNewAddress=t.makeUpdatedAddress=void 0;const a=r(401067),o=r(632626),n=r(178163),s=r(310360),i=r(500053),c=r(795623);function l(e,t){const r=(0,a.defaultTo)(""),n=t.content,i=(0,s.getLocaleFormat)(e,t);return{AddressFull:r(n.addressFull),AddressName:n.addressName||r(n.addressFull),Building:r(n.building),City:r(n.city),Country:o.Country[i].toLocaleLowerCase(),DigitCode:r(n.digitCode),Door:r(n.door),Floor:r(n.floor),LinkedPhone:r(n.linkedPhone),PersonalNote:r(n.personalNote),Receiver:r(n.receiver),Stairs:r(n.stairs),State:(0,s.getValidState)(i,n.state),StateLevel2:r(n.stateLevel2),StateNumber:r(n.stateNumber),StreetName:r(n.streetName),StreetNumber:r(n.streetNumber),StreetTitle:r(n.streetTitle),ZipCode:r(n.zipCode)}}t.makeUpdatedAddress=async function(e,t){return c.default.log(`[Data] Updating existing Address with id: ${t.Id}`),{...t,...(0,n.makeUpdatedPersonalDataItemBase)({existingItem:t,updatedItem:e,itemUpdateDate:(0,i.getUnixTimestamp)()}),...l(t,e)}},t.makeNewAddress=async function(e){return c.default.log("[Data] Adding new Address"),{...(0,n.makeNewPersonalDataItemBase)(e),...l(null,e)}},t.makeAddressSpecificProps=l},783295:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAddressMappers=void 0;const a=r(883539);t.getAddressMappers=()=>({spaceId:e=>e.SpaceId,lastUse:a.lastUseMapper,id:e=>e.Id})},303179:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addressMatch=t.searchGetters=void 0;const a=r(382234),o=r(64455);t.searchGetters=[(0,a.stringProp)("AddressFull"),(0,a.stringProp)("AddressName"),(0,a.stringProp)("City"),(0,a.stringProp)("Receiver"),(0,a.stringProp)("StreetNumber"),(0,a.stringProp)("ZipCode")],t.addressMatch=(0,o.match)(t.searchGetters)},99281:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryAddressesSelector=t.addressSelector=t.addressesSelector=void 0;const a=r(303179),o=r(783295),n=r(324589),s=r(749551),i=r(432034),c=r(340602),l=r(657989);t.addressesSelector=(0,i.createSelector)((e=>e.userSession.personalData.addresses),l.quarantinedSpacesSelector,c.filterOutQuarantinedItems),t.addressSelector=(e,r)=>{const a=(0,t.addressesSelector)(e);return(0,s.findDataModelObject)(r,a)},t.queryAddressesSelector=(0,n.getQuerySelector)(t.addressesSelector,(()=>a.addressMatch),(e=>(0,o.getAddressMappers)()))},209951:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeCompanySpecificProps=t.makeNewCompany=t.makeUpdatedCompany=void 0;const a=r(401067),o=r(178163),n=r(500053),s=r(795623);function i(e){const t=(0,a.defaultTo)("");return{JobTitle:t(e.content.jobTitle),Name:t(e.content.name),PersonalNote:t(e.content.personalNote)}}t.makeUpdatedCompany=async function(e,t){return s.default.log(`[Data] Updating existing Company with id: ${t.Id}`),{...t,...(0,o.makeUpdatedPersonalDataItemBase)({existingItem:t,updatedItem:e,itemUpdateDate:(0,n.getUnixTimestamp)()}),...i(e)}},t.makeNewCompany=async function(e){return{...(0,o.makeNewPersonalDataItemBase)(e),...i(e)}},t.makeCompanySpecificProps=i},906628:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCompanyMappers=void 0;const a=r(883539);t.getCompanyMappers=()=>({spaceId:e=>e.SpaceId,lastUse:a.lastUseMapper,id:e=>e.Id})},576475:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.companyMatch=t.searchGetters=void 0;const a=r(64455),o=r(382234);t.searchGetters=[(0,o.stringProp)("JobTitle"),(0,o.stringProp)("Name")],t.companyMatch=(0,a.match)(t.searchGetters)},180624:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryCompaniesSelector=t.companySelector=t.companiesSelector=void 0;const a=r(576475),o=r(906628),n=r(324589),s=r(749551),i=r(432034),c=r(340602),l=r(657989);t.companiesSelector=(0,i.createSelector)((e=>e.userSession.personalData.companies),l.quarantinedSpacesSelector,c.filterOutQuarantinedItems),t.companySelector=(e,r)=>{const a=(0,t.companiesSelector)(e);return(0,s.findDataModelObject)(r,a)},t.queryCompaniesSelector=(0,n.getQuerySelector)(t.companiesSelector,(()=>a.companyMatch),(e=>(0,o.getCompanyMappers)()))},749766:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeEmailSpecificProps=t.makeNewEmail=t.makeUpdatedEmail=void 0;const a=r(401067),o=r(178163),n=r(500053),s=r(795623);function i(e){const t=(0,a.defaultTo)("");return{Email:t(e.content.email),EmailName:t(e.content.emailName),Type:e.content.type||"PERSO"}}t.makeUpdatedEmail=async function(e,t){return s.default.log(`[Data] Updating existing Email with id: ${t.Id}`),{...t,...(0,o.makeUpdatedPersonalDataItemBase)({existingItem:t,updatedItem:e,itemUpdateDate:(0,n.getUnixTimestamp)()}),...i(e)}},t.makeNewEmail=async function(e){return s.default.log("[Data] Adding new Email"),{...(0,o.makeNewPersonalDataItemBase)(e),...i(e)}},t.makeEmailSpecificProps=i},516384:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmailMappers=void 0;const a=r(883539);t.getEmailMappers=()=>({spaceId:e=>e.SpaceId,lastUse:a.lastUseMapper,id:e=>e.Id})},761808:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.emailMatch=t.searchGetters=void 0;const a=r(64455),o=r(382234);t.searchGetters=[(0,o.stringProp)("Email"),(0,o.stringProp)("EmailName")],t.emailMatch=(0,a.match)(t.searchGetters)},326147:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryEmailsSelector=t.emailSelector=t.emailsSelector=t.countAllEmailsSelector=void 0;const a=r(761808),o=r(516384),n=r(324589),s=r(749551),i=r(432034),c=r(657989),l=r(340602);t.countAllEmailsSelector=e=>e.userSession.personalData.emails.length,t.emailsSelector=(0,i.createSelector)((e=>e.userSession.personalData.emails),c.quarantinedSpacesSelector,l.filterOutQuarantinedItems),t.emailSelector=(e,r)=>{const a=(0,t.emailsSelector)(e);return(0,s.findDataModelObject)(r,a)},t.queryEmailsSelector=(0,n.getQuerySelector)(t.emailsSelector,(()=>a.emailMatch),(e=>(0,o.getEmailMappers)()))},691494:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeIdentitySpecificProps=t.makeNewIdentity=t.makeUpdatedIdentity=void 0;const a=r(401067),o=r(178163),n=r(795623),s=r(500053);function i(e){const t=(0,a.defaultTo)("");return{FirstName:t(e.content.firstName),MiddleName:t(e.content.middleName),LastName:t(e.content.lastName),LastName2:t(e.content.lastName2),Pseudo:t(e.content.pseudo),BirthDate:t(e.content.birthDate),BirthPlace:t(e.content.birthPlace),Title:t(e.content.title)}}t.makeUpdatedIdentity=async function(e,t){return n.Debugger.log(`[Data] Updating existing Identity with id: ${t.Id}`),{...t,...(0,o.makeUpdatedPersonalDataItemBase)({existingItem:t,updatedItem:e,itemUpdateDate:(0,s.getUnixTimestamp)()}),...i(e)}},t.makeNewIdentity=async function(e){return n.Debugger.log("[Data] Adding new Identity"),{...(0,o.makeNewPersonalDataItemBase)(e),...i(e)}},t.makeIdentitySpecificProps=i},15044:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getIdentityMappers=void 0;const a=r(883539);t.getIdentityMappers=()=>({spaceId:e=>e.SpaceId,lastUse:a.lastUseMapper,id:e=>e.Id})},886052:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.identityMatch=t.searchGetters=void 0;const a=r(64455),o=r(382234);t.searchGetters=[(0,o.stringProp)("BirthDate"),(0,o.stringProp)("BirthPlace"),(0,o.stringProp)("FirstName"),(0,o.stringProp)("LastName"),(0,o.stringProp)("LastName2"),(0,o.stringProp)("MiddleName"),(0,o.stringProp)("Pseudo")],t.identityMatch=(0,a.match)(t.searchGetters)},628074:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryIdentitiesSelector=t.identityMappersSelector=t.identitySelector=t.identitiesByIdSelector=t.identitiesSelector=void 0;const a=r(886052),o=r(324589),n=r(749551),s=r(432034),i=r(15044),c=r(340602),l=r(657989);t.identitiesSelector=(0,s.createSelector)((e=>e.userSession.personalData.identities),l.quarantinedSpacesSelector,c.filterOutQuarantinedItems),t.identitiesByIdSelector=(0,s.createSelector)(t.identitiesSelector,(e=>e.reduce(((e,t)=>(e[t.Id]=t,e)),{}))),t.identitySelector=(e,r)=>{const a=(0,t.identitiesSelector)(e);return(0,n.findDataModelObject)(r,a)},t.identityMappersSelector=e=>(0,i.getIdentityMappers)(),t.queryIdentitiesSelector=(0,o.getQuerySelector)(t.identitiesSelector,(()=>a.identityMatch),t.identityMappersSelector)},529565:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makePersonalWebsiteSpecificProps=t.makeNewPersonalWebsite=t.makeUpdatedPersonalWebsite=void 0;const a=r(401067),o=r(178163),n=r(500053),s=r(795623);function i(e){const t=(0,a.defaultTo)("");return{Website:t(e.content.website),Name:t(e.content.name)}}t.makeUpdatedPersonalWebsite=async function(e,t){return s.default.log(`[Data] Updating existing PersonalWebsite with id: ${t.Id}`),{...t,...(0,o.makeUpdatedPersonalDataItemBase)({existingItem:t,updatedItem:e,itemUpdateDate:(0,n.getUnixTimestamp)()}),...i(e)}},t.makeNewPersonalWebsite=async function(e){return s.default.log("[Data] Adding new PersonalWebsite"),{...(0,o.makeNewPersonalDataItemBase)(e),...i(e)}},t.makePersonalWebsiteSpecificProps=i},393315:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPersonalWebsiteMappers=void 0;const a=r(883539);t.getPersonalWebsiteMappers=()=>({spaceId:e=>e.SpaceId,lastUse:a.lastUseMapper,id:e=>e.Id})},986963:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.personalWebsiteMatch=t.searchGetters=void 0;const a=r(64455),o=r(382234);t.searchGetters=[(0,o.stringProp)("Name"),(0,o.stringProp)("Website")],t.personalWebsiteMatch=(0,a.match)(t.searchGetters)},381473:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryPersonalWebsitesSelector=t.personalWebsiteMappersSelector=t.personalWebsiteSelector=t.personalWebsitesSelector=void 0;const a=r(432034),o=r(986963),n=r(324589),s=r(749551),i=r(393315),c=r(340602),l=r(657989);t.personalWebsitesSelector=(0,a.createSelector)((e=>e.userSession.personalData.personalWebsites),l.quarantinedSpacesSelector,c.filterOutQuarantinedItems),t.personalWebsiteSelector=(e,r)=>{const a=(0,t.personalWebsitesSelector)(e);return(0,s.findDataModelObject)(r,a)},t.personalWebsiteMappersSelector=e=>(0,i.getPersonalWebsiteMappers)(),t.queryPersonalWebsitesSelector=(0,n.getQuerySelector)(t.personalWebsitesSelector,(()=>o.personalWebsiteMatch),t.personalWebsiteMappersSelector)},39732:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parsePhoneNumbers=t.makePhoneSpecificProps=t.makeNewPhone=t.makeUpdatedPhone=void 0;const a=r(401067),o=r(322630),n=r(632626),s=r(178163),i=r(786056),c=r(310360),l=r(500053),d=r(428445),u=r(795623);function p(e){const t=(0,a.defaultTo)(""),{Number:r,NumberInternational:o,NumberNational:s}=S(e);return{Number:r,NumberInternational:o,NumberNational:s,PersonalNote:t(e.content.personalNote),PhoneName:e.content.phoneName||s,Type:n.PhoneType[e.content.type]||n.PhoneType.PHONE_TYPE_ANY}}function S(e){const{localeFormat:t,number:r}=e.content;if(!r)return{Number:"",NumberInternational:"",NumberNational:""};const a=(0,c.isProposedLocaleLocalized)(t)&&n.Country[t]||n.Country[(0,i.getPlatformInfo)().country]||n.Country.US;if(!(a?(0,o.isValidNumber)(r,a):(0,o.isValidNumber)(r)))return{Number:(0,d.removeNonDigitCharacters)(r),NumberInternational:r,NumberNational:r};const s=(0,o.parsePhoneNumber)(r,a),l=s.formatNational(),u=s.formatInternational();return{Number:(0,d.removeNonDigitCharacters)(r),NumberInternational:u,NumberNational:l}}t.makeUpdatedPhone=async function(e,t){return u.default.log(`[Data] Updating existing Phone with id: ${t.Id}`),{...t,...(0,s.makeUpdatedPersonalDataItemBase)({existingItem:t,updatedItem:e,itemUpdateDate:(0,l.getUnixTimestamp)()}),...p(e)}},t.makeNewPhone=async function(e){return u.default.log("[Data] Adding new Phone"),{...(0,s.makeNewPersonalDataItemBase)(e),...p(e)}},t.makePhoneSpecificProps=p,t.parsePhoneNumbers=S},990076:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPhoneMappers=void 0;const a=r(883539);t.getPhoneMappers=()=>({spaceId:e=>e.SpaceId,lastUse:a.lastUseMapper,id:e=>e.Id})},341648:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.phoneMatch=t.searchGetters=void 0;const a=r(64455),o=r(382234);t.searchGetters=[(0,o.stringProp)("Number"),(0,o.stringProp)("PhoneName")],t.phoneMatch=(0,a.match)(t.searchGetters)},82439:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryPhonesSelector=t.phoneSelector=t.phonesSelector=void 0;const a=r(341648),o=r(990076),n=r(324589),s=r(749551),i=r(432034),c=r(340602),l=r(657989);t.phonesSelector=(0,i.createSelector)((e=>e.userSession.personalData.phones),l.quarantinedSpacesSelector,c.filterOutQuarantinedItems),t.phoneSelector=(e,r)=>{const a=(0,t.phonesSelector)(e);return(0,s.findDataModelObject)(r,a)},t.queryPhonesSelector=(0,n.getQuerySelector)(t.phonesSelector,(()=>a.phoneMatch),(e=>(0,o.getPhoneMappers)()))},555220:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLivePersonalInfo=void 0;const a=r(518948),o=r(903343),n=r(735893),s=r(433627);t.getLivePersonalInfo=e=>t=>{const r=(0,n.parseToken)(t),i=e(r);return(0,a.pipe)((0,o.map)(i),(0,o.distinctUntilChanged)(((e,t)=>(0,s.sameBatch)(e.items,t.items)&&e.matchingCount===t.matchingCount)))}},64455:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.match=void 0;const a=r(597601);t.match=e=>(t,r)=>"string"==typeof t&&0!==t.length&&e.some((e=>{const o=e(r)||"";return(0,a.normalizeString)(o).includes(t)}))},382234:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.stringProp=void 0;const a=r(401067);t.stringProp=e=>(0,a.prop)(e)},563566:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewListResults=void 0,t.viewListResults=e=>({items:t,matchingCount:r})=>({items:e(t),matchingCount:r})},302105:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(164202),o=r(861426),n=r(272918);t.config={commands:{addSecret:{handler:o.addSecretHandler},updateSecret:{handler:o.updateSecretHandler},deleteSecret:{handler:o.deleteSecretHandler}},queries:{getSecret:{selector:a.viewedSecretSelector},getSecrets:{selector:a.viewedQueriedSecretsSelector},getSecretsCount:{selector:a.secretsCountSelector},getSecretsPage:{selector:a.secretsPageSelector},getSecretsPaginationToken:{selector:a.secretsPaginationTokenSelector}},liveQueries:{liveSecret:{operator:n.getSecret$},liveSecrets:{operator:n.secrets$},liveSecretsBatch:{operator:n.secretsBatch$},liveSecretsCount:{operator:n.secretsCount$}}}},271498:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleLimitedSharedSecrets=void 0;const a=r(589489),o=r(937275);t.handleLimitedSharedSecrets=function(e,t,r){const n=(0,o.getSharingDataWithCollections)(t),s=(0,a.getLimitedSharedItemIds)(t,n.collections,n.itemGroups,r);return e.map((e=>({...e,...s[e.Id]?{limitedPermissions:!0}:{}})))}},896391:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addSecretHandler=t.secretFormatter=void 0;const a=r(700033),o=r(632626),n=r(823136),s=r(298900),i=r(448313),c=r(500053),l=r(278320),d=r(670252),u=r(298416),p=r(579980),S=r(673566),g=r(885225),m=r(656915);t.secretFormatter=e=>{const t=(0,u.sanitizeInputPersonalData)(e),r=(0,c.getUnixTimestamp)();return{kwType:"KWSecret",AnonId:(0,l.generateItemUuid)(),CreationDatetime:r,Id:(0,l.generateItemUuid)(),LocaleFormat:o.Country.US,SpaceId:t.spaceId||"",UserModificationDatetime:r,LastBackupTime:0,Title:t.title||"Untitled secret",Content:t.content||"",Secured:t.secured||!1}},t.addSecretHandler=async(e,r)=>{try{return(({storeService:e,sessionService:r,eventLoggerService:a},o)=>{const s=e.getPersonalData(),c=(0,t.secretFormatter)(o);if(!c.SpaceId){const t=(0,n.getDefaultSpaceId)(e);c.SpaceId=t}(0,p.logAddVaultItem)(e,a,c);const l=(0,S.getUpdatedItemChangeHistory)({deviceName:e.getLocalSettings().deviceName,personalData:s,change:(0,g.makeUpdateChange)(c),userLogin:e.getUserLogin(),platformInfo:(0,m.platformInfoSelector)(e.getState())});e.dispatch((0,i.savePersonalDataItem)(c,c.kwType,l)),r.getInstance().user.persistPersonalData()})(e,r),(0,n.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},a.Trigger.Save),Promise.resolve({success:!0})}catch(e){return(0,d.sendExceptionLog)({error:e}),e instanceof s.RequestError&&void 0!==e.code?Promise.resolve({success:!1,error:{code:e.code}}):Promise.resolve({success:!1})}}},56823:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSecretHandler=void 0;const a=r(700033),o=r(823136),n=r(164202),s=r(670252),i=r(645291),c=r(579980),l=r(736513),d=r(290622),u=r(736884),p=r(658107),S=r(471646),g=r(663698),m=r(645157),y=r(416593),h=r(352102),f=r(632626);t.deleteSecretHandler=async function(e,{id:t}){const r=await(async({storeService:e,eventLoggerService:t,wsService:r},a)=>{const o=e.getState();try{let s=null;const v=(0,n.secretSelector)(o,a);if(!v)return{success:!1,error:{code:f.DeleteSecretErrorCode.NOT_FOUND}};const T=(0,l.makeCryptoService)(),A=(0,y.userLoginSelector)(o),P=(0,d.ukiSelector)(e.getState()),{makeRefuseItemGroupEvent:w}=(0,u.makeItemGroupService)(r,T),{Id:b}=v,{userGroups:I,itemGroups:E}=(0,h.sharingDataSelector)(o),C=(0,S.findItemItemGroup)(b,E);if(C){const t=(0,p.isUserLastAdmin)(C,A),r=(0,p.doesUserReceiveItemGroupViaGroup)(C,I,A);if(t||r)return{success:!1,error:{code:t?f.DeleteSecretErrorCode.LEAVE_SHARING_FORBIDDEN_LAST_ADMIN:f.DeleteSecretErrorCode.LEAVE_SHARING_FORBIDDEN_GROUP_ITEM}};try{const{groupId:e,revision:t}=C,{refuseItemGroup:r}=(0,g.makeItemGroupWS)(),a=await w(e,t,null);await r(A,P,a)}catch(e){return{success:!1,error:{code:f.DeleteSecretErrorCode.LEAVE_SHARING_FAILED}}}}s=(0,m.getRemoveChangeHistory)(e,v);const _=(0,i.removePersonalItem)(v.kwType,v.Id,s);return e.dispatch(_),(0,c.logDeleteVaultItem)(e,t,v),{success:!0}}catch(e){const t=new Error(`[Secrets] - deleteSecret: ${e}`);return(0,s.sendExceptionLog)({error:t}),{success:!1,error:{code:f.DeleteSecretErrorCode.INTERNAL_ERROR}}}})(e,t);return r.success&&(0,o.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},a.Trigger.Save),Promise.resolve(r)}},861426:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(896391),t),o(r(994915),t),o(r(56823),t)},994915:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateSecretHandler=t.getUpdatedSecret=void 0;const a=r(632626),o=r(700033),n=r(164202),s=r(823136),i=r(298900),c=r(448313),l=r(500053),d=r(670252),u=r(298416),p=r(579980),S=r(796850),g=r(673566),m=r(885225),y=r(656915),h=r(684511);function f(e,t){if(!e)throw new i.RequestError("[updateSecret]: unable to find secret to update.",a.SecretSaveResultErrorCode.NOT_FOUND);const r=(0,u.sanitizeInputPersonalData)(t),o=(0,l.getUnixTimestamp)(),n={Title:r.title??e.Title,Content:r.content??e.Content,SpaceId:r.spaceId??e.SpaceId,UserModificationDatetime:o};return{...e,...n}}t.getUpdatedSecret=f,t.updateSecretHandler=async function(e,t){try{!function({storeService:e,sessionService:t,eventLoggerService:r},a){if(!e.isAuthenticated())throw new Error("No session available to updateSecret");const o=e.getPersonalData(),s=(0,n.secretSelector)(e.getState(),a.id),i=f(s,a);(0,S.notifySharersSecretUpdated)(e,s,i),(0,p.logEditVaultItem)(e,r,i,s);const l=(0,g.getUpdatedItemChangeHistory)({deviceName:e.getLocalSettings().deviceName,personalData:o,change:(0,m.makeUpdateChange)(i),userLogin:e.getUserLogin(),platformInfo:(0,y.platformInfoSelector)(e.getState())});e.dispatch((0,c.savePersonalDataItem)(i,i.kwType,l)),t.getInstance().user.persistPersonalData()}(e,t);const r=e.storeService.getState();return(0,h.isSharedSelector)(r,t.id)?await e.sessionService.getInstance().user.attemptSync(o.Trigger.SettingsChange):(0,s.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save),Promise.resolve({success:!0})}catch(e){return(0,d.sendExceptionLog)({error:e}),e instanceof i.RequestError&&void 0!==e.code?Promise.resolve({success:!1,error:{code:e.code}}):Promise.resolve({success:!1})}}},298900:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updatedAt=t.createdAt=t.RequestError=void 0;const a=r(401067);class o extends Error{constructor(e,t){super(e),Object.setPrototypeOf(this,new.target.prototype),this.name="RequestError",this.code=t}}t.RequestError=o,t.createdAt=e=>(0,a.isNil)(e.CreationDatetime)?0:e.CreationDatetime,t.updatedAt=e=>(0,a.isNil)(e.UserModificationDatetime)?0:e.UserModificationDatetime},796850:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notifySharersSecretUpdated=t.makeSecretSpecificProps=t.makeNewSecret=t.makeUpdatedSecret=t.sharedFields=void 0;const a=r(401067),o=r(500053),n=r(670252),s=r(178163);function i(e){return{Title:e.title||"Untitled secret",Content:e.content||"",Secured:e.secured||!1}}t.sharedFields=["Title","Content"],t.makeUpdatedSecret=async function(e,t){return{...t,...(0,s.makeUpdatedPersonalDataItemBase)({existingItem:t,updatedItem:e,itemUpdateDate:(0,o.getUnixTimestamp)()}),...i(e.content)}},t.makeNewSecret=async function(e){return{...(0,s.makeNewPersonalDataItemBase)(e),...i(e.content)}},t.makeSecretSpecificProps=i,t.notifySharersSecretUpdated=async function(e,r,o){if((0,a.equals)((0,a.pick)(t.sharedFields,r),(0,a.pick)(t.sharedFields,o)))return!0;try{return await(0,s.notifySharersOnUpdate)(e,o),!0}catch(e){const t=new Error(`[Sharing] - notifySharersSecretUpdated: ${e}`);(0,n.sendExceptionLog)({error:t})}return!1}},272918:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.secrets$=t.secretsCount$=t.getSecret$=t.secretsBatch$=void 0;const a=r(518948),o=r(903343),n=r(164202),s=r(735893),i=r(555220),c=r(433627);t.secretsBatch$=e=>{const t=(0,s.parseToken)(e),r=(0,n.getViewedSecretsBatchSelector)(t);return(0,a.pipe)((0,o.map)(r),(0,o.distinctUntilChanged)(c.sameBatch))},t.getSecret$=e=>{const t=(0,n.getViewedSecretSelector)(e);return(0,a.pipe)((0,o.map)(t),(0,o.distinctUntilChanged)())},t.secretsCount$=e=>{const t=(0,s.parseToken)(e);return(0,a.pipe)((0,o.map)((e=>(0,n.secretsCountSelector)(e,t))),(0,o.distinctUntilChanged)())},t.secrets$=(0,i.getLivePersonalInfo)(n.getLiveSecretsSelector)},154860:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSecretMappers=void 0;const a=r(298900),o=r(883539),n=r(471646);t.getSecretMappers=e=>({groupIds:t=>(0,n.getItemUserGroupIds)(e,t.Id),sharingUserIds:t=>(0,n.getItemUserIds)(e,t.Id),createdAt:a.createdAt,id:e=>e.Id,lastUse:o.lastUseMapper,spaceId:e=>e.SpaceId,title:e=>e.Title,updatedAt:a.updatedAt})},793823:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSecretsBatch=t.viewSecretsBatch=t.getSecretsFirstToken=t.getSecretsSortToken=t.getSecretsFilterToken=void 0;const a=r(401067),o=r(920553),n=r(919238),s=r(183687);t.getSecretsFilterToken=({filterCriteria:e})=>({filterCriteria:e||[]}),t.getSecretsSortToken=({sortCriteria:e})=>({uniqField:"id",sortCriteria:e||[]}),t.getSecretsFirstToken=(e,t,r,a)=>(0,o.generateFirstToken)(e,t,r.initialBatchSize||30,a),t.viewSecretsBatch=(e,t,r)=>{const a=(0,s.getSharingStatusItem)(t,r);return(0,n.listView)(a,e)},t.getSecretsBatch=(0,a.curry)(((e,t,r)=>(0,o.getBatch)(r,e,t)))},457141:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.secretMatch=t.searchGetters=t.limitedSearchGetters=void 0;const a=r(64455),o=r(382234);t.limitedSearchGetters=[(0,o.stringProp)("Title")],t.searchGetters=[...t.limitedSearchGetters,(0,o.stringProp)("Content")],t.secretMatch=(e,r)=>(0,a.match)(t.searchGetters)(e,r)},164202:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.secretsCountSelector=t.viewedQueriedSecretsSelector=t.querySecretsSelector=t.getViewedSecretSelector=t.getLiveSecretsSelector=t.getViewedSecretsBatchSelector=t.secretsQuerySelector=t.fieldMappersSelector=t.secretsPaginationTokenSelector=t.secretsPageSelector=t.viewedSecretSelector=t.secretSelector=void 0;const a=r(401067),o=r(432034),n=r(793823),s=r(154860),i=r(165021),c=r(920553),l=r(735893),d=r(691210),u=r(980993),p=r(749551),S=r(457141),g=r(324589),m=r(563566),y=r(352102),h=r(416593),f=r(497006),v=r(589698),T=r(181904);t.secretSelector=(e,t)=>{const r=(0,T.secretsSelector)(e);return(0,p.findDataModelObject)(t,r)},t.viewedSecretSelector=(e,r)=>{const a=(0,t.secretSelector)(e,r);if(!a)return;const o=(0,y.sharingDataSelector)(e),n=(0,h.userIdSelector)(e),s=(0,d.limitedSharingItemsSelector)(e);return(0,i.viewSecret)(a,o,n,s)},t.secretsPageSelector=(e,r)=>{const a=(0,l.parseToken)(r),{sortToken:o,filterToken:n}=a,s={sortToken:o,filterToken:n},i=(0,t.fieldMappersSelector)(e),d=(0,t.secretsQuerySelector)(e,s),u=b(e),p=(0,c.generateNextToken)(i,a,d),S=(0,c.generatePrevToken)(i,a,d),g=(0,c.getBatch)(i,a,d),m=(0,l.stringifyToken)(p),y=(0,l.stringifyToken)(S);return{batch:u(g),nextToken:m,prevToken:y}},t.secretsPaginationTokenSelector=(e,r)=>{const a=(0,n.getSecretsSortToken)(r),o=(0,n.getSecretsFilterToken)(r),s=(0,t.fieldMappersSelector)(e),i={sortToken:a,filterToken:o},c=(0,t.secretsQuerySelector)(e,i),d=(0,n.getSecretsFirstToken)(s,i,r,c);return(0,l.stringifyToken)(d)},t.fieldMappersSelector=(0,o.createSelector)(v.acceptedItemGroupsSelector,s.getSecretMappers);const A=(0,l.createOptimizedSortTokenSelector)(((e,{sortToken:t})=>t),a.identity),P=(0,l.createOptimizedFilterTokenSelector)(((e,{filterToken:t})=>t),a.identity),w=()=>S.secretMatch;t.secretsQuerySelector=(0,o.createSelector)(t.fieldMappersSelector,w,A,P,T.secretsSelector,l.queryData),t.getViewedSecretsBatchSelector=e=>{const{sortToken:r,filterToken:a}=e,s={sortToken:r,filterToken:a},i=(0,n.getSecretsBatch)(e),c=(0,o.createSelector)((e=>(0,t.secretsQuerySelector)(e,s)),t.fieldMappersSelector,i),p=(0,l.optimizeBatchSelector)(c);return(0,o.createSelector)(p,u.sortedSharedItemIdsSelector,d.limitedSharingItemsSelector,n.viewSecretsBatch)};const b=e=>{const t=(0,u.sortedSharedItemIdsSelector)(e),r=(0,d.limitedSharingItemsSelector)(e);return e=>(0,n.viewSecretsBatch)(e,t,r)};t.getLiveSecretsSelector=(0,f.makeLiveSelectorGetter)(T.secretsSelector,b,w,t.fieldMappersSelector),t.getViewedSecretSelector=e=>{const t=(0,o.createSelector)(T.secretsSelector,(t=>(0,p.findDataModelObject)(e,t)));return(0,o.createSelector)(t,y.sharingDataSelector,h.userIdSelector,d.limitedSharingItemsSelector,i.viewSecret)},t.querySecretsSelector=(0,g.getQuerySelector)(T.secretsSelector,w,t.fieldMappersSelector),t.viewedQueriedSecretsSelector=(e,r)=>{const a=(0,t.querySecretsSelector)(e,r),o=b(e);return(0,m.viewListResults)(o)(a)},t.secretsCountSelector=(0,o.createSelector)(t.fieldMappersSelector,w,P,T.secretsSelector,((e,t,r,a)=>(0,l.filterData)(e,t,r,a).length))},181904:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.secretsSelector=void 0;const a=r(432034),o=r(340602),n=r(657989);t.secretsSelector=(0,a.createSelector)((e=>e.userSession.personalData.secrets),n.quarantinedSpacesSelector,o.filterOutQuarantinedItems)},165021:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewSecret=void 0;const a=r(183687),o=r(645589);t.viewSecret=function(e,t,r,n){if(!e)return;const s=(0,a.getSharingStatusDetail)(n,t,r);return(0,o.detailView)(s,e)}},645589:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.detailView=void 0;const a=r(401067),o=r(782043),n=r(298900),s=(0,a.defaultTo)("");t.detailView=(0,a.curry)(((e,t)=>({...(0,o.dataModelDetailView)(t),content:s(t.Content),createdAt:(0,n.createdAt)(t),sharingStatus:e(t.Id),title:s(t.Title),updatedAt:(0,n.updatedAt)(t)})))},919238:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=void 0;const a=r(401067),o=r(782043),n=r(298900),s=(0,a.defaultTo)("");t.itemView=(0,a.curry)(((e,t)=>{const r=(e=>e.length>30?e.slice(0,27)+"…":e)(s(t.Content));return{...(0,o.dataModelItemView)(t),abbrContent:r,createdAt:(0,n.createdAt)(t),sharingStatus:e(t.Id),title:s(t.Title),updatedAt:(0,n.updatedAt)(t)}})),t.listView=(e,r)=>{const a=(0,t.itemView)(e);return r.map(a)}},280529:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(24465),o=r(389642),n=r(237403),s=r(989805),i=r(781043),c=r(282677),l=r(127416),d=r(132818),u=r(409124),p=r(940409);t.config={commands:{downloadSecureFile:{handler:s.downloadSecureFileHandler},deleteSecureFile:{handler:c.deleteSecureFileHandler},addSecureFile:{handler:a.addSecureFileHandler},validateSecureFile:{handler:d.validateSecureFileHandler},commitSecureFile:{handler:i.commitSecureFileHandler},initSecureFilesStorageInfo:{handler:n.initSecureFilesStorageInfoHandler},chunkTransferDone:{handler:u.chunkTransferDoneHandler},clearSecureFileState:{handler:p.clearSecureFileStateHandler}},queries:{getSecureFilesInfoList:{selector:o.secureFileInfoSelector},getSecureFilesQuota:{selector:o.secureFilesQuotaSelector},getFileDownloadProgress:{selector:o.secureFileDownloadSelector},getFileUploadProgress:{selector:o.secureFileUploadSelector}},liveQueries:{liveFileDownloadProgress:{operator:l.getFileDownloadProgress$},liveFileUploadProgress:{operator:l.getFileUploadProgress$},liveSecureFilesQuota:{operator:l.secureFilesQuota$}}}},24465:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addSecureFileHandler=t.createSecureFile=void 0;const a=r(632626),o=r(735088),n=r(290622),s=r(416593),i=r(869530),c=r(246445),l=r(65675),d=r(316038),u=r(655623),p=r(827993),S=r(920810),g=r(389642),m=r(199994),y={success:!1,error:{code:a.SecureFileResultErrorCode.SERVER_ERROR}},h=Math.pow(1024,2)/2,f=e=>{switch(e){case a.SecureFileResultErrorCode.MAX_CONTENT_LENGTH_EXCEEDED:return a.SecureFileResultErrorCode.MAX_CONTENT_LENGTH_EXCEEDED;case a.SecureFileResultErrorCode.QUOTA_EXCEEDED:return a.SecureFileResultErrorCode.QUOTA_EXCEEDED;default:return a.SecureFileResultErrorCode.SERVER_ERROR}},v=(e,t,r,a,n,s)=>{const i=`{${(0,o.v4)()}}`,c=Math.floor(Date.now()/1e3);return{kwType:"KWSecureFileInfo",Id:i,LastBackupTime:0,CryptoKey:(0,d.bufferToBase64)(t),DownloadKey:"",Filename:a,LocalSize:e.byteLength,RemoteSize:r.byteLength,Type:n,CreationDatetime:c,UserModificationDatetime:c,Owner:s}};async function T(e,t,r,a){try{const{cryptoConfig:o}=(0,l.parsePayload)("$1$noderivation$aes256$cbchmac$16$"),n=(0,u.getRandomValues)(32),s=await(0,c.hashAndSplitKey)(n),S=(0,p.generateIV)(),g=await(0,i.encryptAES256)({key:s.aes,iv:S,clearData:e}),m={salt:null,iv:S,hash:await(0,i.signHashHmacSHA256)({key:s.hmac,data:(0,d.concatBuffers)(S,g)}),cipheredContent:g,cryptoConfig:o},y=(0,l.convertDashlaneSecureDataFlexibleToTransportableData)(m);return{success:!0,secureFileDataBuffer:y,secureFileInfo:v(e,n,y,t,r,a)}}catch(e){return{success:!1}}}t.createSecureFile=T,t.addSecureFileHandler=async function({wsService:e,storeService:t},r){const o=(0,s.userIdSelector)(t.getState());if(!(0,m.validateSecureFile)(r.fileName,r.fileType))return{success:!1,error:{code:a.SecureFileResultErrorCode.INVALID_FILE_TYPE}};let i;t.dispatch((0,S.secureFileStartUploadAction)(r.serializedContent.length)),t.dispatch((0,S.secureFileStartCipheringAction)());try{const e=JSON.parse(r.serializedContent);i=new Uint8Array(e).buffer}catch(e){return{success:!1,error:{code:a.SecureFileResultErrorCode.INTERNAL_ERROR}}}const{secureFileDataBuffer:c,secureFileInfo:l}=await T(i,r.fileName,r.fileType,o);if((0,g.secureFilesQuotaSelector)(t.getState()).remaining<c.byteLength)return{success:!1,error:{code:a.SecureFileResultErrorCode.QUOTA_EXCEEDED}};const d=setInterval((()=>{t.dispatch((0,S.secureFileUploadChunkAction)(h))}),1e3);let u=null;try{u=await e.secureFile.getUploadLink({contentLength:l.RemoteSize,secureFileInfoId:l.Id,login:o,uki:(0,n.ukiSelector)(t.getState())})}catch(e){return clearInterval(d),t.dispatch((0,S.secureFileUploadErrorAction)()),(e=>"getAdditionalInfo"in e?{success:!1,error:{code:f(e.getAdditionalInfo().webServiceSubMessage)}}:y)(e)}return 200===u.code?(l.DownloadKey=u.content.key,await async function(e,t){try{const r=t.content.url,a=new FormData;for(const e of Object.keys(t.content.fields))a.append(e,t.content.fields[e]);return a.append("key",`${t.content.key}`),a.append("acl",`${t.content.acl}`),a.append("file",new Blob([e])),204===(await fetch(r,{method:"POST",body:a})).status}catch(e){return!1}}(c,u)?(t.dispatch((0,S.secureFileSetStorageInfoAction)(u.content.quota)),clearInterval(d),t.dispatch((0,S.secureFileUploadDoneAction)()),t.dispatch((0,S.secureFileUploadClearAction)()),{success:!0,secureFileInfo:l}):(clearInterval(d),y)):(clearInterval(d),t.dispatch((0,S.secureFileUploadErrorAction)()),y)}},409124:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.chunkTransferDoneHandler=void 0;const a=r(920810);t.chunkTransferDoneHandler=async function({storeService:e},t){return e.dispatch((0,a.secureFileChunkReadyAction)(t)),Promise.resolve()}},940409:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearSecureFileStateHandler=void 0;const a=r(920810);t.clearSecureFileStateHandler=async function({storeService:e},t){return e.dispatch((0,a.secureFileClearAction)(t)),Promise.resolve()}},781043:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.commitSecureFileHandler=void 0;const a=r(290622),o=r(416593),n=r(448313);t.commitSecureFileHandler=async function({wsService:e,sessionService:t,storeService:r},{secureFileInfo:s}){if(200!==(await e.secureFile.commit({key:s.DownloadKey,secureFileInfoId:s.Id,login:(0,o.userIdSelector)(r.getState()),uki:(0,a.ukiSelector)(r.getState())})).code)return{success:!1};try{return r.dispatch((0,n.savePersonalDataItem)(s,s.kwType)),t.getInstance().user.persistPersonalData(),{success:!0}}catch(e){return{success:!1}}}},282677:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSecureFileHandler=void 0;const a=r(632626),o=r(290622),n=r(176496),s=r(416593),i=r(920810);t.deleteSecureFileHandler=async(e,t)=>{const{storeService:r,wsService:c,eventLoggerService:l}=e,d=r.getState(),u=(0,s.userIdSelector)(d),p=(0,o.ukiSelector)(d),S=await(0,n.deletePersonalDataItem)({storeService:r,wsService:c,eventLoggerService:l},t.id);if(!S.success&&S.reason!==a.RemovePersonalDataItemFailureReason.NOT_FOUND)return{success:!1,error:{code:a.SecureFileResultErrorCode.INTERNAL_ERROR}};let g=null;try{g=await c.secureFile.delete({login:u,uki:p,secureFileInfoId:t.id})}catch(e){return{success:!1,error:{code:a.SecureFileResultErrorCode.SERVER_ERROR}}}return S.reason===a.RemovePersonalDataItemFailureReason.NOT_FOUND?{success:!1,error:{code:a.SecureFileResultErrorCode.FILE_NOT_FOUND}}:200!==g.code?{success:!1,error:{code:a.SecureFileResultErrorCode.SERVER_ERROR}}:(r.dispatch((0,i.secureFileSetStorageInfoAction)(g.content.quota)),{success:!0})}},989805:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.downloadSecureFileHandler=void 0;const a=r(632626),o=r(401067),n=r(920810),s=r(422349),i=r(37104),c=r(871422),l={success:!1,error:{code:a.SecureFileResultErrorCode.INTERNAL_ERROR}},d=15*Math.pow(1024,2);t.downloadSecureFileHandler=async(e,t)=>{const r=await(0,c.getDownloadLink)(e,t);if(!r)return l;const a=await(0,i.downloadFileFromStorage)(e,r,t);if(!a.success)return e.storeService.dispatch((0,n.secureFileDownloadErrorAction)(t.downloadKey)),l;e.storeService.dispatch((0,n.secureFileStartDecipheringAction)(t.downloadKey));const u=await(0,s.decipherSecureFileContent)(a.chunks,t.cryptoKey);if(null===u)return e.storeService.dispatch((0,n.secureFileDownloadErrorAction)(t.downloadKey)),l;const p=new Uint8Array(u),S=JSON.stringify(Array.from(p)),g=S.length>d?(0,o.splitEvery)(d,S):[S];return e.storeService.dispatch((0,n.secureFileChunkReadyAction)(t.downloadKey,g)),{success:!0}}},237403:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initSecureFilesStorageInfoHandler=void 0;const a=r(735088),o=r(632626),n=r(290622),s=r(416593),i=r(920810);t.initSecureFilesStorageInfoHandler=async function({wsService:e,storeService:t}){const r=(0,s.userIdSelector)(t.getState());let c=null;try{c=await e.secureFile.getUploadLink({contentLength:0,secureFileInfoId:(0,a.v4)(),login:r,uki:(0,n.ukiSelector)(t.getState())})}catch(e){return{success:!1,error:{code:o.SecureFileResultErrorCode.SERVER_ERROR}}}return 200===c.code?(t.dispatch((0,i.secureFileSetStorageInfoAction)(c.content.quota)),{success:!0}):(t.dispatch((0,i.secureFileSetStorageInfoAction)(null)),{success:!1})}},132818:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.validateSecureFileHandler=void 0;const a=r(632626),o=r(199994);t.validateSecureFileHandler=async function(e,t){return(0,o.validateSecureFile)(t.fileName,t.fileType)?{success:!0}:{success:!1,error:{code:a.SecureFileResultErrorCode.INVALID_FILE_TYPE}}}},127416:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.secureFilesQuota$=t.getFileUploadProgress$=t.getFileDownloadProgress$=void 0;const a=r(518948),o=r(903343),n=r(389642);t.getFileDownloadProgress$=e=>{const t=(0,n.getSecureFileDownloadSelector)(e);return(0,a.pipe)((0,o.map)(t),(0,o.distinctUntilChanged)())},t.getFileUploadProgress$=()=>(0,a.pipe)((0,o.map)(n.secureFileUploadSelector),(0,o.distinctUntilChanged)()),t.secureFilesQuota$=()=>(0,a.pipe)((0,o.map)(n.secureFilesQuotaSelector),(0,o.distinctUntilChanged)())},389642:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.secureFilesQuotaSelector=t.getSecureFileDownloadSelector=t.secureFileUploadSelector=t.secureFileDownloadSelector=t.secureFileInfoSelector=void 0;const a=r(632626),o=r(401067);t.secureFileInfoSelector=e=>e.userSession.personalData.secureFileInfo,t.secureFileDownloadSelector=(e,t)=>{const r=e.userSession.secureFileStorageState.downloads[t];if(!r)return null;const n=r?.status===a.FileDownloadStatus.ChunkReady?{chunk:r.chunks[r.currentChunkIndex]}:{};return{...(0,o.omit)(["chunks","currentChunkIndex"],r),...n}},t.secureFileUploadSelector=e=>e.userSession.secureFileStorageState.upload,t.getSecureFileDownloadSelector=e=>r=>(0,t.secureFileDownloadSelector)(r,e),t.secureFilesQuotaSelector=e=>e.userSession.secureFileStorageState.quota},422349:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decipherSecureFileContent=void 0;const a=r(316038),o=r(246445),n=r(869530),s=r(65675);t.decipherSecureFileContent=async(e,t)=>{const r=(0,s.parseCipheredData)(e),i=r.cryptoConfig;if(!(0,s.isDashlaneSecureDataFlexible)(r)||!(0,s.isNoDerivation)(i.derivation))return null;const c=await(0,o.hashAndSplitKey)((0,a.base64ToBuffer)(t)),l=await(0,n.signHashHmacSHA256)({key:c.hmac,data:(0,a.concatBuffers)(r.iv,r.cipheredContent)});return(0,a.bufferToBase64)(l)!==(0,a.bufferToBase64)(r.hash)?null:await(0,n.decryptAES256)({key:c.aes,iv:r.iv,encryptedData:r.cipheredContent})}},37104:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.downloadFileFromStorage=void 0;const a=r(920810);t.downloadFileFromStorage=async(e,t,r)=>{try{const o=await fetch(t);if(!o.ok)return{success:!1};const n=o.body.getReader(),s=[],i=o.headers.get("Content-Length");e.storeService.dispatch((0,a.secureFileStartDownloadAction)(r.downloadKey,Number.parseInt(i,10)));let c=0,l=!0,d=0;for(;l;){const{done:t,value:o}=await n.read();l=!t,l&&(s.push(new Uint8Array(o)),c+=o.length,d+=o.length,d>1e5&&(e.storeService.dispatch((0,a.secureFileDownloadChunkAction)(r.downloadKey,d)),d=0))}let u=0;const p=new Uint8Array(c);return s.forEach((e=>{p.set(e,u),u+=e.length})),{success:!0,chunks:p}}catch(e){return{success:!1}}}},871422:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDownloadLink=void 0;const a=r(290622),o=r(795623),n=r(416593),s=r(920810);t.getDownloadLink=async(e,t)=>{const{storeService:r,wsService:i}=e,c=r.getState(),l=(0,n.userIdSelector)(c),d=(0,a.ukiSelector)(c);let u=null;try{u=await i.secureFile.getDownloadLink({login:l,uki:d,key:t.downloadKey})}catch(r){return(0,o.logDebug)({tag:["SecureFile"],message:"Error while getting S3 download link",details:{error:r}}),e.storeService.dispatch((0,s.secureFileDownloadErrorAction)(t.downloadKey)),null}return 200!==u.code?(e.storeService.dispatch((0,s.secureFileDownloadErrorAction)(t.downloadKey)),null):u.content.url}},199994:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.validateSecureFile=void 0;const a=r(498337);t.validateSecureFile=(e,t)=>{const r=e.split(".").pop().toLowerCase();return((e,t)=>"rar"===e&&!t)(r,t)||(e=>(0,a.getSecureDocumentsAllowedMimeTypes)().includes(e))(t)&&(e=>(0,a.getSecureDocumentsAllowedExtensions)().includes(`.${e}`))(r)}},674172:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(594187);t.config={commands:{setupDefaultNoteCategories:{handler:a.setupDefaultNoteCategoriesHandler}},queries:{},liveQueries:{}}},594187:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupDefaultNoteCategoriesHandler=void 0;const a=r(700033),o=r(954565),n=r(823136);t.setupDefaultNoteCategoriesHandler=async function(e,t){try{const{storeService:r,sessionService:s}=e;if(!r.isAuthenticated())return{success:!1};const i=r.getPersonalData().noteCategories;return i&&0!==i.length||(t.categories.forEach((e=>{(0,o.saveNoteCategory)(r,{name:e})})),s.getInstance().user.persistPersonalData(),(0,n.getDebounceSync)(r,s)({immediateCall:!0},a.Trigger.Save)),{success:!0}}catch(e){return{success:!1}}}},954565:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveNoteCategory=t.getUpdatedNoteCategory=t.getNewNoteCategory=void 0;const a=r(645291),o=r(795623),n=r(278320),s=r(749551);function i(e){return{kwType:"KWSecureNoteCategory",Id:(0,n.generateItemUuid)(),CategoryName:e.trim(),LastBackupTime:0}}function c(e,t){const r=(0,s.findDataModelObject)(t.id,e);if(!r)throw new Error("UI asks to update an unknown Note Category");return{...r,CategoryName:t.name.trim()}}t.getNewNoteCategory=i,t.getUpdatedNoteCategory=c,t.saveNoteCategory=function(e,t){if(!e.isAuthenticated())return void(0,o.logError)({message:"No session available to save note category"});const r=e.getPersonalData().noteCategories;if(!function(e,t){return"string"==typeof t&&""!==t.trim()&&!e.some((e=>e.CategoryName===t))}(r,t.name))return void(0,o.logError)({message:"Category name is invalid"});const n=t.id?c(r,t):i(t.name);return e.dispatch((0,a.saveNoteCategory)(n)),n}},880818:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(381438),o=r(549293),n=r(777749);t.config={commands:{addSecureNote:{handler:o.addSecureNoteHandler},updateSecureNote:{handler:o.updateSecureNoteHandler},deleteSecureNote:{handler:o.deleteSecureNoteHandler}},queries:{getNote:{selector:a.viewedNoteSelector},getNoteCategories:{selector:a.viewedNoteCategoriesSelector},getNotes:{selector:a.viewedQueriedNotesSelector},getNotesCount:{selector:a.notesCountSelector},getNotesPage:{selector:a.notesPageSelector},getNotesPaginationToken:{selector:a.notesPaginationTokenSelector}},liveQueries:{liveNote:{operator:n.getNote$},liveNotes:{operator:n.notes$},liveNotesBatch:{operator:n.notesBatch$},liveNotesCount:{operator:n.notesCount$}}}},46083:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleLimitedSharedNotes=void 0;const a=r(589489),o=r(937275);t.handleLimitedSharedNotes=function(e,t,r){const n=(0,o.getSharingDataWithCollections)(t),s=(0,a.getLimitedSharedItemIds)(t,n.collections,n.itemGroups,r);return e.map((e=>({...e,...s[e.Id]?{limitedPermissions:!0}:{}})))}},167859:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addSecureNoteHandler=t.noteFormatter=void 0;const a=r(700033),o=r(632626),n=r(823136),s=r(271141),i=r(448313),c=r(500053),l=r(278320),d=r(670252),u=r(298416),p=r(579980),S=r(673566),g=r(885225),m=r(656915);t.noteFormatter=e=>{const t=(0,u.sanitizeInputPersonalData)(e),r=(0,c.getUnixTimestamp)();return{kwType:"KWSecureNote",AnonId:(0,l.generateItemUuid)(),CreationDatetime:r,Id:(0,l.generateItemUuid)(),LocaleFormat:o.Country.US,SpaceId:t.spaceId||"",UserModificationDatetime:r,LastBackupTime:0,Title:t.title||"Untitled note",Content:t.content||"",Category:t.category||"noCategory",Secured:t.secured||!1,Type:t.type||"GRAY",Attachments:t.attachments||[]}},t.addSecureNoteHandler=async(e,r)=>{try{return await(async({storeService:e,sessionService:r,eventLoggerService:a},o)=>{const s=e.getPersonalData(),c=(0,t.noteFormatter)(o);if(!c.SpaceId){const t=await(0,n.getDefaultSpaceId)(e);c.SpaceId=t}(0,p.logAddVaultItem)(e,a,c);const l=(0,S.getUpdatedItemChangeHistory)({deviceName:e.getLocalSettings().deviceName,personalData:s,change:(0,g.makeUpdateChange)(c),userLogin:e.getUserLogin(),platformInfo:(0,m.platformInfoSelector)(e.getState())});e.dispatch((0,i.savePersonalDataItem)(c,c.kwType,l)),r.getInstance().user.persistPersonalData()})(e,r),(0,n.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},a.Trigger.Save),Promise.resolve({success:!0})}catch(e){return(0,d.sendExceptionLog)({error:e}),e instanceof s.RequestError&&void 0!==e.code?Promise.resolve({success:!1,error:{code:e.code}}):Promise.resolve({success:!1})}}},105948:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSecureNoteHandler=void 0;const a=r(700033),o=r(632626),n=r(823136),s=r(381438),i=r(670252),c=r(645291),l=r(579980),d=r(736513),u=r(290622),p=r(736884),S=r(658107),g=r(471646),m=r(663698),y=r(645157),h=r(416593),f=r(352102);t.deleteSecureNoteHandler=async function(e,{id:t}){const r=await(async({storeService:e,eventLoggerService:t,wsService:r},a)=>{const n=e.getState();try{let i=null;const v=(0,s.noteSelector)(n,a);if(!v)return{success:!1,error:{code:o.DeleteSecureNoteErrorCode.NOT_FOUND}};const T=await(0,d.makeCryptoService)(),A=(0,h.userLoginSelector)(n),P=(0,u.ukiSelector)(e.getState()),{makeRefuseItemGroupEvent:w}=(0,p.makeItemGroupService)(r,T),{Id:b}=v,{userGroups:I,itemGroups:E}=(0,f.sharingDataSelector)(n),C=(0,g.findItemItemGroup)(b,E);if(C){const t=(0,S.isUserLastAdmin)(C,A),r=(0,S.doesUserReceiveItemGroupViaGroup)(C,I,A);if(t||r)return{success:!1,error:{code:t?o.DeleteSecureNoteErrorCode.LEAVE_SHARING_FORBIDDEN_LAST_ADMIN:o.DeleteSecureNoteErrorCode.LEAVE_SHARING_FORBIDDEN_GROUP_ITEM}};try{const{groupId:e,revision:t}=C,{refuseItemGroup:r}=(0,m.makeItemGroupWS)(),a=await w(e,t,null);await r(A,P,a)}catch(e){return{success:!1,error:{code:o.DeleteSecureNoteErrorCode.LEAVE_SHARING_FAILED}}}}i=(0,y.getRemoveChangeHistory)(e,v);const _=(0,c.removePersonalItem)(v.kwType,v.Id,i);return e.dispatch(_),(0,l.logDeleteVaultItem)(e,t,v),{success:!0}}catch(e){const t=new Error(`[SecureNotes] - deleteSecureNote: ${e}`);return(0,i.sendExceptionLog)({error:t}),{success:!1,error:{code:o.DeleteSecureNoteErrorCode.INTERNAL_ERROR}}}})(e,t);return r.success&&(0,n.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},a.Trigger.Save),Promise.resolve(r)}},549293:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(167859),t),o(r(971407),t),o(r(105948),t)},971407:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateSecureNoteHandler=t.getUpdatedSecureNote=void 0;const a=r(700033),o=r(632626),n=r(381438),s=r(823136),i=r(271141),c=r(448313),l=r(500053),d=r(670252),u=r(298416),p=r(579980),S=r(772079),g=r(673566),m=r(885225),y=r(656915),h=r(684511);function f(e,t){if(!e)throw new i.RequestError("[updateSecureNote]: unable to find secure note to update.",o.SecureNoteSaveResultErrorCode.NOT_FOUND);const r=(0,u.sanitizeInputPersonalData)(t),a=(0,l.getUnixTimestamp)(),n={Title:r.title??e.Title,Content:r.content??e.Content,Category:r.category??e.Category,Secured:r.secured??e.Secured,Type:r.type??e.Type,SpaceId:r.spaceId??e.SpaceId,UserModificationDatetime:a,Attachments:r.attachments??e.Attachments};return{...e,...n}}t.getUpdatedSecureNote=f,t.updateSecureNoteHandler=async function(e,t){try{!function({storeService:e,sessionService:t,eventLoggerService:r},a){if(!e.isAuthenticated())throw new Error("No session available to updateSecureNote");const o=e.getPersonalData(),s=(0,n.noteSelector)(e.getState(),a.id),i=f(s,a);(0,S.notifySharersNoteUpdated)(e,s,i),(0,p.logEditVaultItem)(e,r,i,s);const l=(0,g.getUpdatedItemChangeHistory)({deviceName:e.getLocalSettings().deviceName,personalData:o,change:(0,m.makeUpdateChange)(i),userLogin:e.getUserLogin(),platformInfo:(0,y.platformInfoSelector)(e.getState())});e.dispatch((0,c.savePersonalDataItem)(i,i.kwType,l)),t.getInstance().user.persistPersonalData()}(e,t);const r=e.storeService.getState();return(0,h.isSharedSelector)(r,t.id)?await e.sessionService.getInstance().user.attemptSync(a.Trigger.SettingsChange):(0,s.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},a.Trigger.Save),Promise.resolve({success:!0})}catch(e){return(0,d.sendExceptionLog)({error:e}),e instanceof i.RequestError&&void 0!==e.code?Promise.resolve({success:!1,error:{code:e.code}}):Promise.resolve({success:!1})}}},271141:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updatedAt=t.createdAt=t.getCategory=t.RequestError=void 0;const a=r(401067);class o extends Error{constructor(e,t){super(e),Object.setPrototypeOf(this,new.target.prototype),this.name="RequestError",this.code=t}}t.RequestError=o,t.getCategory=(0,a.curry)(((e,t)=>e.find((e=>e.Id===t)))),t.createdAt=e=>(0,a.isNil)(e.CreationDatetime)?(0,a.isNil)(e.CreationDate)?0:e.CreationDate:e.CreationDatetime,t.updatedAt=e=>(0,a.isNil)(e.UserModificationDatetime)?(0,a.isNil)(e.UpdateDate)?0:e.UpdateDate:e.UserModificationDatetime},772079:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notifySharersNoteUpdated=t.makeNoteSpecificProps=t.makeNewNote=t.makeUpdatedNote=t.sharedFields=void 0;const a=r(401067),o=r(500053),n=r(670252),s=r(178163);function i(e,t){const r=t?t.CreationDate:(0,o.getUnixTimestamp)(),a=t?e.content!==t.Content?(0,o.getUnixTimestamp)():t.UpdateDate:r;return{Title:e.title||"Untitled note",Content:e.content||"",Category:e.category||"noCategory",Secured:e.secured||!1,Type:e.type||"GRAY",CreationDate:r,UpdateDate:a}}t.sharedFields=["Title","Content"],t.makeUpdatedNote=async function(e,t){return{...t,...(0,s.makeUpdatedPersonalDataItemBase)({existingItem:t,updatedItem:e,itemUpdateDate:(0,o.getUnixTimestamp)()}),...i(e.content,t)}},t.makeNewNote=async function(e){return{...(0,s.makeNewPersonalDataItemBase)(e),...i(e.content)}},t.makeNoteSpecificProps=i,t.notifySharersNoteUpdated=async function(e,r,o){if((0,a.equals)((0,a.pick)(t.sharedFields,r),(0,a.pick)(t.sharedFields,o)))return!0;try{return await(0,s.notifySharersOnUpdate)(e,o),!0}catch(e){const t=new Error(`[Sharing] - notifySharersNoteUpdated: ${e}`);return(0,n.sendExceptionLog)({error:t}),!1}}},777749:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notes$=t.notesCount$=t.getNote$=t.notesBatch$=void 0;const a=r(518948),o=r(903343),n=r(381438),s=r(735893),i=r(555220),c=r(433627);t.notesBatch$=e=>{const t=(0,s.parseToken)(e),r=(0,n.getViewedNotesBatchSelector)(t);return(0,a.pipe)((0,o.map)(r),(0,o.distinctUntilChanged)(c.sameBatch))},t.getNote$=e=>{const t=(0,n.getViewedNoteSelector)(e);return(0,a.pipe)((0,o.map)(t),(0,o.distinctUntilChanged)())},t.notesCount$=e=>{const t=(0,s.parseToken)(e);return(0,a.pipe)((0,o.map)((e=>(0,n.notesCountSelector)(e,t))),(0,o.distinctUntilChanged)())},t.notes$=(0,i.getLivePersonalInfo)(n.getLiveNotesSelector)},403113:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getNoteMappers=void 0;const a=r(401067),o=r(271141),n=r(883539),s=r(471646),i=(0,a.curry)(((e,t)=>{const r=t.Category,a=(e||[]).find((e=>e.Id===r));return a&&a.CategoryName?a.CategoryName:"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz"})),c=e=>!!e.Attachments&&e.Attachments.length>0,l=(0,a.curry)(((e,t)=>!!e[t.Id]));t.getNoteMappers=(e,t,r)=>({category:i(e),groupIds:e=>(0,s.getItemUserGroupIds)(r,e.Id),sharingUserIds:e=>(0,s.getItemUserIds)(r,e.Id),createdAt:o.createdAt,hasAttachments:c,id:e=>e.Id,isLimited:l(t),lastUse:n.lastUseMapper,spaceId:e=>e.SpaceId,title:e=>e.Title,updatedAt:o.updatedAt})},993534:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getNotesBatch=t.viewNotesBatch=t.getNotesFirstToken=t.getNotesSortToken=t.getNotesFilterToken=void 0;const a=r(401067),o=r(920553),n=r(80010),s=r(183687),i=r(271141);t.getNotesFilterToken=({filterCriteria:e})=>({filterCriteria:e||[]}),t.getNotesSortToken=({sortCriteria:e})=>({uniqField:"id",sortCriteria:e||[]}),t.getNotesFirstToken=(e,t,r,a)=>(0,o.generateFirstToken)(e,t,r.initialBatchSize||30,a),t.viewNotesBatch=(e,t,r,a)=>{const o=(0,s.getSharingStatusItem)(t,r),c=(0,i.getCategory)(a);return(0,n.listView)(o,c,e)},t.getNotesBatch=(0,a.curry)(((e,t,r)=>(0,o.getBatch)(r,e,t)))},855498:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.noteMatch=t.searchGetters=t.limitedSearchGetters=void 0;const a=r(64455),o=r(382234);t.limitedSearchGetters=[(0,o.stringProp)("Title")],t.searchGetters=[...t.limitedSearchGetters,(0,o.stringProp)("Content")],t.noteMatch=(e,r)=>{const o=r.Secured?t.limitedSearchGetters:t.searchGetters;return(0,a.match)(o)(e,r)}},381438:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notesCountSelector=t.viewedQueriedNotesSelector=t.queryNotesSelector=t.getViewedNoteSelector=t.getLiveNotesSelector=t.getViewedNotesBatchSelector=t.notesQuerySelector=t.fieldMappersSelector=t.viewedNoteCategoriesSelector=t.notesPaginationTokenSelector=t.notesPageSelector=t.viewedNoteSelector=t.noteSelector=t.noteCategoriesSelector=void 0;const a=r(401067),o=r(432034),n=r(993534),s=r(403113),i=r(223875),c=r(920553),l=r(735893),d=r(691210),u=r(980993),p=r(749551),S=r(855498),g=r(324589),m=r(563566),y=r(352102),h=r(416593),f=r(497006),v=r(126703),T=r(675705),A=r(589698);t.noteCategoriesSelector=e=>e.userSession.personalData.noteCategories,t.noteSelector=(e,t)=>{const r=(0,T.notesSelector)(e);return(0,p.findDataModelObject)(t,r)},t.viewedNoteSelector=(e,r)=>{const a=(0,t.noteSelector)(e,r);if(!a)return;const o=(0,t.noteCategoriesSelector)(e),n=(0,y.sharingDataSelector)(e),s=(0,h.userIdSelector)(e),c=(0,d.limitedSharingItemsSelector)(e);return(0,i.viewNote)(a,n,s,c,o)},t.notesPageSelector=(e,r)=>{const a=(0,l.parseToken)(r),{sortToken:o,filterToken:n}=a,s={sortToken:o,filterToken:n},i=(0,t.fieldMappersSelector)(e),d=(0,t.notesQuerySelector)(e,s),u=I(e),p=(0,c.generateNextToken)(i,a,d),S=(0,c.generatePrevToken)(i,a,d),g=(0,c.getBatch)(i,a,d),m=(0,l.stringifyToken)(p),y=(0,l.stringifyToken)(S);return{batch:u(g),nextToken:m,prevToken:y}},t.notesPaginationTokenSelector=(e,r)=>{const a=(0,n.getNotesSortToken)(r),o=(0,n.getNotesFilterToken)(r),s=(0,t.fieldMappersSelector)(e),i={sortToken:a,filterToken:o},c=(0,t.notesQuerySelector)(e,i),d=(0,n.getNotesFirstToken)(s,i,r,c);return(0,l.stringifyToken)(d)},t.viewedNoteCategoriesSelector=(0,o.createSelector)(t.noteCategoriesSelector,(e=>({items:(0,v.listView)(e),matchingCount:e.length}))),t.fieldMappersSelector=(0,o.createSelector)(t.noteCategoriesSelector,d.limitedSharingItemsSelector,A.acceptedItemGroupsSelector,s.getNoteMappers);const P=(0,l.createOptimizedSortTokenSelector)(((e,{sortToken:t})=>t),a.identity),w=(0,l.createOptimizedFilterTokenSelector)(((e,{filterToken:t})=>t),a.identity),b=()=>S.noteMatch;t.notesQuerySelector=(0,o.createSelector)(t.fieldMappersSelector,b,P,w,T.notesSelector,l.queryData),t.getViewedNotesBatchSelector=e=>{const{sortToken:r,filterToken:a}=e,s={sortToken:r,filterToken:a},i=(0,n.getNotesBatch)(e),c=(0,o.createSelector)((e=>(0,t.notesQuerySelector)(e,s)),t.fieldMappersSelector,i),p=(0,l.optimizeBatchSelector)(c);return(0,o.createSelector)(p,u.sortedSharedItemIdsSelector,d.limitedSharingItemsSelector,t.noteCategoriesSelector,n.viewNotesBatch)};const I=e=>{const r=(0,u.sortedSharedItemIdsSelector)(e),a=(0,d.limitedSharingItemsSelector)(e),o=(0,t.noteCategoriesSelector)(e);return e=>(0,n.viewNotesBatch)(e,r,a,o)};t.getLiveNotesSelector=(0,f.makeLiveSelectorGetter)(T.notesSelector,I,b,t.fieldMappersSelector),t.getViewedNoteSelector=e=>{const r=(0,o.createSelector)(T.notesSelector,(t=>(0,p.findDataModelObject)(e,t)));return(0,o.createSelector)(r,y.sharingDataSelector,h.userIdSelector,d.limitedSharingItemsSelector,t.noteCategoriesSelector,i.viewNote)},t.queryNotesSelector=(0,g.getQuerySelector)(T.notesSelector,b,t.fieldMappersSelector),t.viewedQueriedNotesSelector=(e,r)=>{const a=(0,t.queryNotesSelector)(e,r),o=I(e);return(0,m.viewListResults)(o)(a)},t.notesCountSelector=(0,o.createSelector)(t.fieldMappersSelector,b,w,T.notesSelector,((e,t,r,a)=>(0,l.filterData)(e,t,r,a).length))},675705:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notesSelector=void 0;const a=r(432034),o=r(340602),n=r(657989);t.notesSelector=(0,a.createSelector)((e=>e.userSession.personalData.notes),n.quarantinedSpacesSelector,o.filterOutQuarantinedItems)},223875:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewNote=void 0;const a=r(183687),o=r(271141),n=r(883881);t.viewNote=function(e,t,r,s,i){if(!e)return;const c=(0,a.getSharingStatusDetail)(s,t,r),l=(0,o.getCategory)(i);return(0,n.detailView)(c,l,e)}},126703:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.detailView=void 0;const a=(0,r(401067).defaultTo)("");t.detailView=e=>{if(e)return{id:e.Id,categoryName:a(e.CategoryName)}},t.listView=e=>e.map(t.detailView)},883881:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.detailView=void 0;const a=r(401067),o=r(782043),n=r(126703),s=r(271141),i=(0,a.defaultTo)("");t.detailView=(0,a.curry)(((e,t,r)=>{const c=t(r.Category);return{...(0,o.dataModelDetailView)(r),category:(0,n.detailView)(c),color:r.Type,content:i(r.Content),createdAt:(0,s.createdAt)(r),secured:(0,a.defaultTo)(!1,r.Secured),sharingStatus:e(r.Id),title:i(r.Title),updatedAt:(0,s.updatedAt)(r)}}))},80010:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=void 0;const a=r(401067),o=r(782043),n=r(126703),s=r(271141),i=(0,a.defaultTo)("");t.itemView=(0,a.curry)(((e,t,r)=>{const a=t(r.Category),c=r.Secured?"*******":(e=>{if(e.length>30)return e.slice(0,27)+"…"})(i(r.Content));return{...(0,o.dataModelItemView)(r),abbrContent:c,category:(0,n.detailView)(a),color:r.Type,createdAt:(0,s.createdAt)(r),secured:r.Secured||!1,sharingStatus:e(r.Id),title:i(r.Title),updatedAt:(0,s.updatedAt)(r)}})),t.listView=(e,r,a)=>{const o=(0,t.itemView)(e,r);return a.map(o)}},460309:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(643767),o=r(416593),n=r(564717),s=r(717250);t.config={commands:{updateProtectPasswordsSetting:{handler:s.updateProtectPasswordsSettingHandler},toggleDashlane:{handler:s.toggleDashlaneHandler},updateAutofillSettings:{handler:s.updateAutofillSettingsHandler}},queries:{getAnonymousUserId:{selector:a.anonymousUserIdSelector},getIsUrlBanished:{selector:a.getIsUrlBanishedSelector},arePasswordsProtected:{selector:o.protectPasswordsSettingSelector}},liveQueries:{liveArePasswordsProtected:{operator:n.protectPasswordsSetting$}}}},717250:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateAutofillSettingsHandler=t.toggleDashlaneHandler=t.updateProtectPasswordsSettingHandler=void 0;const a=r(632626),o=r(700033),n=r(670252),s=r(823136),i=r(515868),c=r(886903),l=r(368857);t.updateProtectPasswordsSettingHandler=(e,t)=>{try{const r={ProtectPasswords:t};return(0,i.updatePersonalSettings)(e.storeService,e.sessionService,r),(0,c.sendUserSettingsLog)(e),Promise.resolve()}catch(e){const t=new Error(`updateProtectPasswordsSettingHandler: ${e}`);(0,n.sendExceptionLog)({error:t,code:a.ExceptionCriticality.WARNING})}},t.toggleDashlaneHandler=({sessionService:e,storeService:t},r)=>{const a=(0,s.getDebounceSync)(t,e),n=t.getPersonalSettings(),c=(0,l.toggleDashlaneOnSiteToPersonalSettingsPartial)(n,r);(0,i.updatePersonalSettings)(t,e,c),a({immediateCall:!0},o.Trigger.SettingsChange)},t.updateAutofillSettingsHandler=({sessionService:e,storeService:t},r)=>{const a=(0,s.getDebounceSync)(t,e);(0,i.updatePersonalSettings)(t,e,{AutofillSettings:r.AutofillSettings}),a({immediateCall:!0},o.Trigger.SettingsChange)}},564717:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.protectPasswordsSetting$=void 0;const a=r(518948),o=r(903343),n=r(416593);t.protectPasswordsSetting$=()=>(0,a.pipe)((0,o.map)(n.protectPasswordsSettingSelector),(0,o.distinctUntilChanged)())},368857:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toggleDashlaneOnSiteToPersonalSettingsPartial=void 0;const a=r(401067),o=r(421178);t.toggleDashlaneOnSiteToPersonalSettingsPartial=function(e,t){const r=new o.ParsedURL(t.url).getRootDomain();let n=e.AutofillSettings;return n={...n,disabledDomains:t.autofill?(0,a.without)([r],e.AutofillSettings.disabledDomains):(0,a.uniq)(e.AutofillSettings.disabledDomains.concat(r))},{AutofillSettings:n}}},515868:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.pickUpdatedPersonalSettings=t.isSaveCredentialDisabledOnDomain=t.signalSaveCredentialDisabled=t.updatePersonalSettings=void 0;const a=r(421178),o=r(795623),n=r(401067),s=r(827517);t.updatePersonalSettings=function(e,r,a){if(!e.isAuthenticated())return void o.default.log("No session available to updatePersonalSettings");const n=(0,t.pickUpdatedPersonalSettings)(e.getPersonalSettings(),a);e.dispatch((0,s.editPersonalSettings)(n)),r.getInstance().user.persistPersonalSettings()},t.signalSaveCredentialDisabled=function(e,t,r){if(!e.isAuthenticated())return void o.default.log("No session available, in theory this should not be called");const a=Array.isArray(e.getPersonalSettings().BanishedUrlsList)?e.getPersonalSettings().BanishedUrlsList:[];a.indexOf(r.fullDomain)>0||(e.dispatch((0,s.editPersonalSettings)({BanishedUrlsList:[...a,r.fullDomain]})),t.getInstance().user.persistPersonalSettings())},t.isSaveCredentialDisabledOnDomain=function(e,t){return e.isAuthenticated()?(Array.isArray(e.getPersonalSettings().BanishedUrlsList)?e.getPersonalSettings().BanishedUrlsList:[]).map((e=>new a.ParsedURL(e))).some((e=>e.getHostname()===t.fullDomain)):(o.default.log("No session available, save credential is enabled by default"),!1)},t.pickUpdatedPersonalSettings=(e,t)=>{const r=(0,n.pick)(Object.keys(t))(e),a=(0,n.unapply)(n.identity);return(0,n.mergeAll)((0,n.difference)(a(t),a(r)))}},643767:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getIsUrlBanishedSelector=t.banishedUrlsListSelector=t.securedDataAutofillCreditcardSelector=t.anonymousUserIdSelector=void 0;const a=r(421178),o=r(416593);t.anonymousUserIdSelector=e=>e.userSession.personalSettings.AnonymousUserId,t.securedDataAutofillCreditcardSelector=e=>{const t=e.userSession.personalSettings.SecuredDataAutofillCreditcard;return"boolean"!=typeof t||t},t.banishedUrlsListSelector=e=>(0,o.personalSettingsSelector)(e).BanishedUrlsList??[],t.getIsUrlBanishedSelector=(e,r)=>{const o=new a.ParsedURL(r).getHostname();return(0,t.banishedUrlsListSelector)(e).map((e=>new a.ParsedURL(e).getHostname())).some((e=>e===o))}},368979:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TeamDomainsMatchResult=void 0,r(584977),function(e){e[e.SomeFieldsMatch=0]="SomeFieldsMatch",e[e.NoFieldMatch=1]="NoFieldMatch"}(t.TeamDomainsMatchResult||(t.TeamDomainsMatchResult={}))},311700:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isItemToForceCategorize=t.isItemForceCategorizable=t.pickBestTeamSpaceForForcedCategorization=t.ForceCategorizableKWTypes=t.isTeamSpaceAfterGracePeriod=t.isTeamSpaceQuarantined=void 0;const a=r(401067),o=r(632626),n=r(368979),s=r(587496),i=r(443145),c=r(106205),l=(e,t)=>(t||[]).some((t=>{if("string"!=typeof t)return!1;const r=t.toLowerCase();return(e||[]).some((e=>"string"==typeof e&&e.toLowerCase().includes(r)))})),d=e=>[e.Login,e.SecondaryLogin,e.Email,(0,s.getBestUrl)(e),...(0,c.getUserAddedLinkedWebsiteDomains)(e)],u=(e,t)=>{const r=[e.Domain],a=(0,i.findAssociatedCredential)(e,t);return[...r,...a?d(a):[]]},p={[o.DataModelType.KWAuthentifiant]:d,[o.DataModelType.KWGeneratedPassword]:u,[o.DataModelType.KWEmail]:e=>[e.Email]};function S(e){const t=p[e.kwType];return t?t(e):[]}t.isTeamSpaceQuarantined=e=>"revoked"===e.status,t.isTeamSpaceAfterGracePeriod=e=>(0,t.isTeamSpaceQuarantined)(e)&&Boolean(e.shouldDelete),t.ForceCategorizableKWTypes=[o.DataModelType.KWAuthentifiant,o.DataModelType.KWEmail,o.DataModelType.KWGeneratedPassword],t.pickBestTeamSpaceForForcedCategorization=(e,r,s)=>{const i=r.SpaceId,c=(0,o.isGeneratedPassword)(r)?u(r,s):S(r),d=e.reduce(((e,t)=>{const r=l(c,t.info.teamDomains);return{...e,[t.teamId]:r}}),{}),p=e.filter((e=>d[e.teamId]||(0,t.isTeamSpaceQuarantined)(e)&&e.teamId===i)),[g,m]=(0,a.partition)(t.isTeamSpaceQuarantined,p),[y,h]=(0,a.partition)(t.isTeamSpaceAfterGracePeriod,g),[f,v]=(0,a.partition)((e=>t=>e.SpaceId===t.teamId)(r),m),T=[...y,...h,...f,...v];if(0===T.length)return null;const A=T[0];return A.teamId!==r.SpaceId||(0,t.isTeamSpaceQuarantined)(A)?{teamSpace:A,domainsMatchResult:d[A.teamId]?n.TeamDomainsMatchResult.SomeFieldsMatch:n.TeamDomainsMatchResult.NoFieldMatch}:null},t.isItemForceCategorizable=function(e){return e.kwType in p},t.isItemToForceCategorize=(e,t)=>{if(!t?.info)return!1;const{forcedDomainsEnabled:r,teamDomains:a}=t.info;if(!r)return!1;const o=S(e);return l(o,a)}},657989:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.quarantinedSpacesSelector=t.forceCategorizableItemsSelector=t.spacesWithForcedCategorizationEnabledSelector=void 0;const a=r(432034),o=r(807944),n=r(311700),s=r(395458),i=r(576330);t.spacesWithForcedCategorizationEnabledSelector=e=>(e.userSession?.spaceData?.spaces||[]).filter((e=>e?.details?.info&&Array.isArray(e.details.info.teamDomains)&&e.details.info.teamDomains.length>0&&Boolean(e.details.info.forcedDomainsEnabled))),t.forceCategorizableItemsSelector=e=>(0,i.personalDataItemsOfTypeSelector)(e,n.ForceCategorizableKWTypes),t.quarantinedSpacesSelector=(0,a.createSelector)(o.spacesSelector,(e=>e.filter(s.isQuarantined)))},292307:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSmartCategorizedSpace=t.getCategory=void 0;const a=r(401067),o=r(252578);t.getCategory=(0,a.curry)(((e,t)=>e.find((e=>e.Id===t)))),t.getSmartCategorizedSpace=e=>t=>{const r=(e=>e.filter((e=>"accepted"===e.details?.status&&e.details?.info?.forcedDomainsEnabled)))(e),a=r?.[0]?.details?.info?.teamDomains??[];return(0,o.isCredentialSmartCategorized)(t,a)?r[0]:null}},776226:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyTeamSpaceContentControlRules=void 0;const a=r(632626),o=r(670252),n=r(645291),s=r(224525),i=r(745962),c=r(290622);async function l(e,t,r){const{updates:a,deletions:o,changeHistories:s}=r,i=a.length>0,c=function({deletions:e}){return Object.keys(e).reduce(((t,r)=>t+e[r].length),0)}(r)>0;(i||c)&&(t.dispatch((0,n.teamSpaceContentControlApplied)(a,o,s)),await e.getInstance().user.persistPersonalData())}t.applyTeamSpaceContentControlRules=async function(e,t,r,n,d){try{const o=(0,s.teamSpaceContentControlStateSelector)(r.getState()),u=(0,i.controlTeamSpacesContent)(o),p=u.deletions.KWAuthentifiant||[],S=u.updates.filter(a.isCredential).map((e=>e.Id)),g=u.hiddenItemIds,m=[...p,...S,...g];if(await l(t,r,u),function(e,t,r){const a=e.getUserLogin(),o=(0,c.ukiSelector)(e.getState());r.forEach((e=>{t.teamPlans.spaceDeleted({login:a,uki:o,teamId:Number(e.teamId)})}))}(r,n,o.spaces.filter((e=>e.details.shouldDelete))),function(e,t){const{deletions:r,hiddenItemIds:a,updates:o}=t,n={deletedItemIds:Object.keys(r).reduce(((e,t)=>[...e,...r[t]]),[]),hiddenItemIds:a,updatedItemIds:o.map((e=>e.Id))};e.teamSpaceContentControlDone(n)}(e,u),m.length>0){const{commands:{recalculatePasswordHealth:e}}=d.createClients().passwordHealth;e()}}catch(e){const t=new Error(`[Spaces] - runTeamSpaceContentControlJob: ${e}`);(0,o.sendExceptionLog)({error:t})}}},745962:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.controlTeamSpacesContent=void 0;const a=r(632626),o=r(17825),n=r(249901),s=r(368979),i=r(311700),c=r(673566),l=r(885225);function d(e,t){return{...e,SpaceId:t}}function u(e,t,r,i){const{domainsMatchResult:u}=t;switch(u){case s.TeamDomainsMatchResult.SomeFieldsMatch:return function(e,t,r){const{deletions:o,changeHistories:n}=t,{deviceName:s,login:i,personalData:d,platformInfo:u}=e,{kwType:p}=r,S=(0,a.isCredential)(r)?(0,c.getUpdatedItemChangeHistory)({change:(0,l.makeRemovalChange)(r),deviceName:s,personalData:d,userLogin:i,platformInfo:u}):null;return{...t,deletions:{...o,[p]:o[p].concat(r.Id)},changeHistories:S?n.concat(S):n}}(e,i,r);case s.TeamDomainsMatchResult.NoFieldMatch:return function(e,t,r){const{updates:o,changeHistories:s}=t,{deviceName:i,login:u,personalData:p,platformInfo:S}=e,g=d(r,n.PERSONAL_SPACE_ID),m=(0,a.isCredential)(g)?(0,c.getUpdatedItemChangeHistory)({change:(0,l.makeUpdateChange)(g),deviceName:i,personalData:p,userLogin:u,platformInfo:S}):null;return{...t,updates:o.concat(g),changeHistories:m?s.concat(m):s}}(e,i,r);default:return(0,o.assertUnreachable)(u)}}const p=e=>e.info.removeForcedContentEnabled&&e.shouldDelete;t.controlTeamSpacesContent=function(e){const t={deletions:{KWAuthentifiant:[],KWEmail:[],KWGeneratedPassword:[]},updates:[],changeHistories:[],hiddenItemIds:[]};return 0===e.spaces.length?t:e.items.reduce(((t,r)=>function(e,t,r){const o=e.spaces.map((e=>e.details)),n=(0,i.pickBestTeamSpaceForForcedCategorization)(o,r,e.credentials);if(!n)return t;const{teamSpace:S}=n,{status:g}=S;switch(g){case"accepted":return function(e,t,r,o){const{updates:n,changeHistories:s}=t,{teamId:i}=r,{deviceName:u,login:p,personalData:S,platformInfo:g}=e,m=d(o,i),y=(0,a.isCredential)(m)?(0,c.getUpdatedItemChangeHistory)({change:(0,l.makeUpdateChange)(m),deviceName:u,personalData:S,userLogin:p,platformInfo:g}):null;return{...t,updates:n.concat(m),changeHistories:y?s.concat(y):s}}(e,t,S,r);case"revoked":return function(e,t,r,a){const{teamSpace:o,domainsMatchResult:n}=t,{hiddenItemIds:i}=a;return{...p(o)?u(e,t,r,a):a,hiddenItemIds:n===s.TeamDomainsMatchResult.SomeFieldsMatch?[...i,r.Id]:i}}(e,n,r,t);default:return t}}(e,t,r)),t)}},224525:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.teamSpaceContentControlStateSelector=void 0;const a=r(656915),o=r(416593),n=r(673299),s=r(576330),i=r(807944),c=r(992598),l=r(326147),d=r(774380),u=r(83659),p=r(657989),S=e=>({KWAuthentifiant:(0,d.countAllCredentialsSelector)(e),KWEmail:(0,l.countAllEmailsSelector)(e),KWGeneratedPassword:(0,c.countAllGeneratedPasswordsSelector)(e)});t.teamSpaceContentControlStateSelector=e=>({anonymousSpaceIds:(0,i.anonymousSpaceIdsSelector)(e),credentials:(0,u.unsafeAllCredentialsSelector)(e),itemCountByType:S(e),items:(0,p.forceCategorizableItemsSelector)(e),spaces:(0,p.spacesWithForcedCategorizationEnabledSelector)(e),personalData:(0,s.personalDataSelector)(e),platformInfo:(0,a.platformInfoSelector)(e),login:(0,o.userLoginSelector)(e),deviceName:(0,n.deviceNameSelector)(e)})},967631:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const a=r(776226);t.setupSubscriptions=async function(e,t){const{sessionService:r,storeService:o,wsService:n,applicationModulesAccess:s}=t;e.sessionOpened.on((()=>{(0,a.applyTeamSpaceContentControlRules)(e,r,o,n,s)}))}},345665:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(807944);t.config={commands:{},queries:{getSpace:{selector:a.viewedSpaceSelector},getSpaces:{selector:a.viewedSpacesSelector}},liveQueries:{}}},277163:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.associateTeamSpaceId=void 0;const a=r(311700);t.associateTeamSpaceId=function(e,t,r){if(!(0,a.isItemForceCategorizable)(e)||!t||0===t.length)return e;const o=(e=>e.filter((e=>e.info.forcedDomainsEnabled&&e.info.teamDomains.length&&!(0,a.isTeamSpaceQuarantined)(e))))(t);if(!o.length)return e;const n=(0,a.pickBestTeamSpaceForForcedCategorization)(o,e,r);return n?{...e,SpaceId:n.teamSpace.teamId}:e}},249901:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PERSONAL_SPACE_ID=void 0,t.PERSONAL_SPACE_ID=""},369105:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultPersonalSpace=t.isSpaceItem=void 0;const a=r(632626),o=r(249901);t.isSpaceItem=e=>"SpaceId"in e&&"string"==typeof e.SpaceId,t.getDefaultPersonalSpace=()=>({associatedEmail:null,billingAdmins:[],color:"",companyName:null,info:{name:"",forcedDomainsEnabled:!1,teamDomains:[]},invitationDate:null,isBillingAdmin:!1,isSSOUser:!1,isTeamAdmin:!1,joinDate:null,letter:"",membersNumber:null,planType:null,revokeDate:null,status:a.SpaceStatus.Accepted,teamAdmins:[],teamId:o.PERSONAL_SPACE_ID,teamName:null,tier:a.SpaceTiers.Free,shouldDelete:!1})},395458:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isQuarantined=t.isPremiumStatusSpaceQuarantined=void 0,t.isPremiumStatusSpaceQuarantined=e=>!!e?.status&&"accepted"!==e.status.toLowerCase()&&!!e.info&&Array.isArray(e.info.teamDomains)&&e.info.teamDomains.length>0&&Boolean(e.info.removeForcedContentEnabled),t.isQuarantined=e=>e&&(0,t.isPremiumStatusSpaceQuarantined)(e.details)},807944:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.anonymousSpaceIdsSelector=t.viewedSpaceSelector=t.viewedSpacesSelector=t.activeSpacesDetailsSelector=t.activeSpacesSelector=t.spacesSelector=void 0;const a=r(369105),o=r(700664);t.spacesSelector=e=>e.userSession?.spaceData?.spaces??[],t.activeSpacesSelector=e=>((0,t.spacesSelector)(e)||[]).filter((e=>e.details&&"accepted"===e.details.status)),t.activeSpacesDetailsSelector=e=>(0,t.activeSpacesSelector)(e).map((e=>e.details)),t.viewedSpacesSelector=e=>{const r=e.userSession.localSettings.nodePremiumStatus.b2bStatus;return r&&"in_team"===r.statusCode&&!r.currentTeam?.teamInfo.personalSpaceEnabled&&(0,t.activeSpacesDetailsSelector)(e).length?(0,o.listView)([...(0,t.activeSpacesDetailsSelector)(e)]):(0,o.listView)([...(0,t.activeSpacesDetailsSelector)(e),(0,a.getDefaultPersonalSpace)()])},t.viewedSpaceSelector=(e,r)=>(0,t.viewedSpacesSelector)(e).find((e=>e.spaceId===r)),t.anonymousSpaceIdsSelector=e=>e.userSession.personalSettings.SpaceAnonIds},700664:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=void 0,t.itemView=({color:e,letter:t,info:r,teamId:a,isSSOUser:o})=>({spaceId:a,displayName:r.name??"",color:e,letter:t,settings:{enableForcedCategorization:r.forcedDomainsEnabled,spaceForcedDomains:r.teamDomains},isSSOUser:o}),t.listView=e=>e.map(t.itemView)},616458:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.vaultConfig=void 0;const a=r(398518);t.vaultConfig={commands:{disableVaultItemProtection:{handler:a.disableVaultProtectionHandler}},queries:{},liveQueries:{}}},398518:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableVaultProtectionHandler=void 0;const a=r(719736),o=r(717250),n=r(18344),s=r(416593);t.disableVaultProtectionHandler=async(e,t)=>{const r=e.storeService.getState();if((0,a.credentialSelector)(r,t)){if((0,s.protectPasswordsSettingSelector)(r))return void(0,o.updateProtectPasswordsSettingHandler)(e,!1);(0,n.disableCredentialProtection)(e,t)}}},270660:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const a=r(276235);t.bootstrap=e=>{e.register(a.config)}},178163:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.computeAndSendCollectionImportActivityLog=t.computeAndSendCSVImportActivityLog=t.computeAndSendDeletedCredentialActivityLog=t.computeAndSendModifiedCredentialActivityLog=t.computeAndSendCreatedCredentialActivityLog=t.shouldSendCreateOrModifiedCredentialActivityLog=t.hasVaultAuditLogsFFActivated=t.notifySharersOnUpdate=t.makeNewPersonalDataItemBase=t.makeUpdatedPersonalDataItemBase=void 0;const a=r(518948),o=r(735088),n=r(632626),s=r(419562),i=r(624695),c=r(421178),l=r(310294),d=r(898892),u=r(658107),p=r(736513),S=r(656915),g=r(500053),m=r(278320),y=r(310360),h=r(692310),f=r(311700),v=r(416593),T=r(670252),A=r(288205);function P(e){const t="MANUAL"===e.updatedItem.origin?{UserModificationDatetime:e.itemUpdateDate}:{};return{LocaleFormat:(0,y.getLocaleFormat)(e.existingItem,e.updatedItem),SpaceId:void 0!==e.updatedItem.content.spaceId?e.updatedItem.content.spaceId:e.existingItem?.SpaceId??"",Attachments:e.updatedItem.content.attachments,...t}}async function w(e){return(await(0,A.makeFeatureFlipsSelectors)(e).featureFlipsSelector()).audit_logs_vault}function b(e){return async(t,r)=>{const a={domain_url:new c.ParsedURL(r.domainUrl).getRootDomain()??""},n={import_count:r.importCount??0};let s;s=e===i.ActivityLogType.UserImportedCredentials?n:e===i.ActivityLogType.UserImportedCollection?{collection_name:r.collectionName,credential_count:r.itemCount}:a;const l={category:i.ActivityLogCategory.VaultPasswords,log_type:e,properties:s,is_sensitive:e!==i.ActivityLogType.UserImportedCredentials||void 0,date_time:(new Date).getTime(),schema_version:"1.0.0",uuid:(0,o.v4)().toUpperCase()};await t.createClients().activityLogs.commands.storeActivityLogs({activityLogs:[l]})}}t.makeUpdatedPersonalDataItemBase=P,t.makeNewPersonalDataItemBase=function(e,t=(0,g.getUnixTimestamp)()){return{kwType:e.kwType,Id:(0,m.generateItemUuid)(),AnonId:(0,m.generateItemUuid)(),CreationDatetime:t,LastBackupTime:0,LastUse:t,...P({updatedItem:e,itemUpdateDate:t})}},t.notifySharersOnUpdate=async function(e,t,r){const o=(0,l.makeItemService)(),n=(0,d.makeItemWS)(),i=e.getSharingData(),c=e.getUserLogin(),g=(0,S.ukiSelector)(e.getState()),m=(i.items||[]).find((e=>e.itemId===t.Id));if(!m)return;if(r)try{const{queries:e}=r.createClients().sharingCollections,t=await(0,a.firstValueFrom)(e.getSharedCollections({}));i.collections=(0,s.isSuccess)(t)&&Array.isArray(t.data)?t.data:[]}catch(e){const t=new Error(`[SharingSync] - getSharedCollections failed: ${e}`);(0,T.sendExceptionLog)({error:t})}const y=(i.itemGroups||[]).find((e=>(e.items||[]).map((e=>e.itemId)).includes(t.Id)));if(!y)throw new Error("ItemGroup containing item not found in sharingData");const{timestamp:h}=m,{privateKey:f}=e.getUserSession().keyPair,v=await(0,u.getItemGroupKey)(y,i.userGroups,f,c,i.collections);if(!v)throw new Error("Could not decipher itemGroupKey for itemGroup");const A=y.items.find((e=>e.itemId===t.Id));if(!A)throw new Error("Could not find itemKey for item in itemGroup");const P=await(0,p.makeSymmetricEncryption)().decryptAES256(v,A.itemKey),w=await o.makeUpdateItemEvent(h,P,{item:t}),b=await n.updateItem(c,g,w);if(!b.items?.length)throw new Error("Shared item update failed");return b},t.hasVaultAuditLogsFFActivated=w,t.shouldSendCreateOrModifiedCredentialActivityLog=function(e,t,r,a){const o=(0,h.currentTeamIdSelector)(e.getState()),s=(0,v.activeSpacesSelector)(e.getState())[0],i=(0,f.isItemToForceCategorize)(r,s);return w(t)&&a!==n.SaveOrigin.IMPORT&&(r.SpaceId===o||i)},t.computeAndSendCreatedCredentialActivityLog=b(i.ActivityLogType.UserCreatedCredential),t.computeAndSendModifiedCredentialActivityLog=b(i.ActivityLogType.UserModifiedCredential),t.computeAndSendDeletedCredentialActivityLog=b(i.ActivityLogType.UserDeletedCredential),t.computeAndSendCSVImportActivityLog=b(i.ActivityLogType.UserImportedCredentials),t.computeAndSendCollectionImportActivityLog=b(i.ActivityLogType.UserImportedCollection)},699293:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=t.setupSubscriptions=void 0;const a=r(38390);Object.defineProperty(t,"setupSubscriptions",{enumerable:!0,get:function(){return a.setupSubscriptions}});var o=r(270660);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},497006:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeLiveSelectorGetter=void 0;const a=r(432034),o=r(563566),n=r(324589);t.makeLiveSelectorGetter=(e,t,r,s)=>i=>(0,a.createSelector)(e,s,r,t,((e,t,r,a)=>(0,o.viewListResults)(a)((0,n.applyQuery)(r,t,i,e))))},340602:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.filterOutQuarantinedItems=t.itemIsNotQuarantined=void 0,t.itemIsNotQuarantined=(e,t)=>{const r=((e,t)=>{const r=t.find((t=>t.details&&t.teamId===e.SpaceId));return r?r.details:null})(t,e);return!r||!((e,t)=>e.SpaceId===t.teamId)(t,r)},t.filterOutQuarantinedItems=(e,r)=>0===r.length?e:e.filter((e=>(0,t.itemIsNotQuarantined)(r,e)))},324589:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyQuery=t.getQuerySelector=void 0;const a=r(735893),o=r(732541);t.getQuerySelector=(e,r,a)=>(o,n)=>{const s=e(o),i=a(o),c=r(o);return(0,t.applyQuery)(c,i,n,s)},t.applyQuery=(e,t,r,n)=>{const{sortToken:s,filterToken:i,limit:c}=r,l=(r=>(0,a.filterData)(t,e,i,r))(n),d=(e=>(0,o.sortData)(t,s,e))(l);return{items:c?d.slice(0,c):d,matchingCount:d.length}}},310360:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getValidState=t.isProposedLocaleLocalized=t.getLocaleFormat=void 0;const a=r(632626),o=r(338495),n=r(786056),s=r(795623);function i(e){return!!a.Country[e]&&[a.Country.NO_TYPE,a.Country.UNIVERSAL].every((t=>t!==e))}t.getLocaleFormat=function(e,t){if(!a.isObjectLocalized(t))return a.Country.UNIVERSAL;const r=a.Country[t.content.localeFormat],o=i(r),s=e&&e.LocaleFormat?e.LocaleFormat:a.Country[(0,n.getPlatformInfo)().country]||a.Country.US;return r&&o?r:s},t.isProposedLocaleLocalized=i,t.getValidState=function(e,t){return(0,o.isStateValid)(e,t)?t:(s.default.log(`[Data] Given value (${t}) is not a valid state value for country code ${e}`),"")}},38390:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const a=r(967631),o=r(279405),n=r(108566);t.setupSubscriptions=async function(e,t){(0,a.setupSubscriptions)(e,t),(0,o.setupSubscriptions)(e,t),(0,n.setupSubscriptions)(e,t)}},72883:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isDataKeyVaultItem=t.PERSONAL_DATA_META_DATA=void 0,t.PERSONAL_DATA_META_DATA=["changeHistories","changesToUpload","generatedPasswords","securityBreaches","securityBreachesMetadata","breachesUpdaterStatus","versionedBreaches","secureFileInfo","noteCategories","paypalAccounts","credentialCategories"],t.isDataKeyVaultItem=function(e){return!t.PERSONAL_DATA_META_DATA.includes(e)}},823136:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultSpaceId=t.getCurrentItems=t.getDebounceSync=t.WAIT_MS_BEFORE_SYNC=t.nextTick=void 0,t.nextTick=r(928255);const a=r(263311),o=r(795623),n=r(958639),s=r(584977),i=r(926634),c=r(249901),l=r(807944);t.WAIT_MS_BEFORE_SYNC=6e4,t.getDebounceSync=(e,r)=>(0,a.debounce)((a=>{o.Debugger.log("DebounceSync called => informClientsAndSyncPersonalDataChange()"),function(e,r,a){(0,n.reportDataUpdate)(e),(0,t.nextTick)((()=>{r.getInstance().user.attemptSync(a)}))}(e,r,a)}),t.WAIT_MS_BEFORE_SYNC),t.getCurrentItems=(e,t)=>{const r=s.default[e];return t?.[r]||[]},t.getDefaultSpaceId=e=>{const t=e.getState(),r=(0,l.activeSpacesSelector)(t)[0];return(0,i.isPersonalSpaceEnabledSelector)(t)?c.PERSONAL_SPACE_ID:r.teamId}},782043:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.maybeDataModelDetailView=t.dataModelDetailView=t.dataModelItemView=void 0;const r=e=>({id:e.Id});t.dataModelItemView=e=>({...r(e),anonId:e.AnonId,hasAttachments:Array.isArray(e.Attachments)&&e.Attachments.length>0,kwType:e.kwType,lastUse:e.LastUse,localeFormat:e.LocaleFormat,spaceId:e.SpaceId});const a=e=>({id:e.Id});t.dataModelDetailView=e=>({...a(e),anonId:e.AnonId,attachments:e.Attachments||[],kwType:e.kwType,lastUse:e.LastUse,localeFormat:e.LocaleFormat,spaceId:e.SpaceId}),t.maybeDataModelDetailView=e=>t=>t?e(t):void 0},508581:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(105600),o=r(656915),n=r(461078);t.config={commands:{cleanRemotelyRemovedProfiles:{handler:n.cleanRemotelyRemovedProfilesHandler}},queries:{getAnonymousComputerId:{selector:a.anonymousComputerIdSelector},getPlatformInfo:{selector:o.platformInfoSelector}},liveQueries:{}}},509486:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.triggerABTestingChanged=void 0;const a=r(319697);t.triggerABTestingChanged=function(e){(0,a.default)().abTestingChanged({version:e.version})}},688322:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadAnonymousApplicationId=t.ANONYMOUS_APPLICATION_ID_KEY=void 0;const a=r(735088),o=r(693564),n=r(795623),s=r(670252),i=r(312995);async function c(e){const r=e.getLocalStorage();if(await r.itemExists(t.ANONYMOUS_APPLICATION_ID_KEY)){const e=await r.readItem(t.ANONYMOUS_APPLICATION_ID_KEY);if("string"==typeof e)return e}const n=await async function(e){const r=(0,o.getWindowLocalStorage)();if(!r)return null;const a=r.getItem(t.ANONYMOUS_APPLICATION_ID_KEY);if(!a)return null;const n=a.replaceAll('"',"");return await e.writeItem(t.ANONYMOUS_APPLICATION_ID_KEY,n),n}(r);return n||(0,a.v4)()}t.ANONYMOUS_APPLICATION_ID_KEY="anonymousApplicationId",t.loadAnonymousApplicationId=async(e,t)=>{(0,n.log)({message:"Load anonymousApplicationId"});try{const r=await c(e);(0,n.logInfo)({message:"anonymousApplicationId has been fetched successfully"}),t.dispatch((0,i.loadedAnonymousComputerId)(r))}catch(e){const t=`An error occurred when trying to load anonymousApplicationId ${e} `;(0,s.sendExceptionLog)({message:t})}}},191122:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.killswitchStateUpdated=void 0;const a=r(405307);t.killswitchStateUpdated=e=>({type:a.KILLSWITCH_STATE_UPDATED,killswitchState:e})},273651:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyKillswitchState=void 0,t.getEmptyKillswitchState=function(){return{disableAutofill:!1,disableLoginFlowMigration:!1,brazeContentCardsDisabled:!1,disableAutoSSOLogin:!1}},t.default=(e={disableAutofill:!1,disableLoginFlowMigration:!1,brazeContentCardsDisabled:!1,disableAutoSSOLogin:!1},t)=>({...e,...t.killswitchState})},405307:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KILLSWITCH_STATE_UPDATED=void 0,t.KILLSWITCH_STATE_UPDATED="KILLSWITCH_STATE_UPDATED"},353439:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.blacklistedDeviceKeys=void 0,t.blacklistedDeviceKeys=["remoteFile"]},303163:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const a=r(508581);t.bootstrap=e=>{e.register(a.config)}},478806:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cleanRemotelyRemovedProfilesHandler=void 0;const a=r(301965);t.cleanRemotelyRemovedProfilesHandler=async function(e){try{await(0,a.deviceRemoteDeletion)(e.storeService,e.storageService,e.applicationModulesAccess)}catch(e){throw new Error("Failed to perform device remote deletion")}}},461078:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(478806),t)},855861:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(303163);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},719399:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.secureDeviceName=void 0,t.secureDeviceName=function(e){return e?e.replace(/https?:\/\//g," "):e}},105600:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.anonymousComputerIdSelector=void 0;const a=r(802246);t.anonymousComputerIdSelector=()=>(0,a.getCommonAppSetting)("anonymousComputerId")},512787:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventBusConnectors=void 0;const a=r(330504);t.EventBusConnectors={sessionOpened:(0,a.slot)(),syncFailure:(0,a.slot)(),syncSuccess:(0,a.slot)(),teamSpaceContentControlDone:(0,a.slot)(),sessionClosed:(0,a.slot)(),familyMemberLeft:(0,a.slot)(),remoteFileChanged:(0,a.slot)(),appInitialized:(0,a.slot)(),coreServicesReady:(0,a.slot)()}},873297:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.makeEventBusService=void 0;const n=r(330504),s=r(512787);t.makeEventBusService=()=>(0,n.createEventBus)({events:s.EventBusConnectors}),o(r(206775),t)},206775:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},128207:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.carbonEventHooks=void 0;const a=r(250415);t.carbonEventHooks={iconsUpdates:a.iconsUpdatesHook}},715660:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultCarbonEventStore=void 0,t.defaultCarbonEventStore={iconsUpdates:[]}},986691:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearInstance=t.getInstance=t.setInstance=void 0;const a=r(942898),o=r(128207);let n=null;t.setInstance=e=>{n=new a.EventStoreConsumer(e,o.carbonEventHooks)},t.getInstance=()=>{if(!n)throw new Error("Cannot get EventStoreConsumer instance");return n},t.clearInstance=()=>{n&&n.teardown(),n=null}},412362:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearInstance=t.getInstance=t.setInstance=void 0;let r=null;t.setInstance=e=>{r=e},t.getInstance=()=>{if(!r)throw new Error("Cannot get EventStore instance");return r},t.clearInstance=()=>{r&&r.teardown(),r=null}},446414:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(808821),o=r(300306),n=r(399319);t.config={commands:{joinFamily:{handler:a.joinFamilyRequest},leaveFamily:{handler:n.leaveFamilyRequest},removeFamilyMember:{handler:a.removeFamilyMemberRequest},resetFamilyJoinToken:{handler:a.resetFamilyJoinTokenRequest},getFamilyDetails:{handler:o.getFamilyDetailsRequest}},queries:{},liveQueries:{}}},759047:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const a=r(446414);t.bootstrap=e=>{e.register(a.config)}},949409:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(759047);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},300306:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFamilyDetailsRequest=void 0;const a=r(632626),o=r(266374),n=r(795623),s=r(46298),i=r(416593),c=r(504933);t.getFamilyDetailsRequest=async function(e){const{storeService:t}=e,r=(0,i.userLoginSelector)(t.getState());try{const e=await(0,s.getFamilyDetails)(t,r);if((0,s.isApiError)(e))return{success:!1,error:{code:(0,s.getCode)(e.code,[c.UserMustBeFamilyAdmin])}};const{name:n,id:i,joinToken:l,statusCode:d,members:u,maxMembers:p}=e;return{success:!0,response:{name:n,id:i,joinToken:l,statusCode:d,members:{admin:(0,o.getAdmin)(u),regular:(0,o.getMembersByRole)(u,a.FamilyMemberRoles.REGULAR),removed:(0,o.getMembersByRole)(u,a.FamilyMemberRoles.REMOVED)},spots:(0,o.getSpots)(u,p)}}}catch(e){return n.Debugger.error(`[Family] getFamilyDetailsRequest - Failed: ${e}`),{success:!1,error:{code:s.UnknownError}}}}},266374:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSpots=t.getMembersCount=t.getMembersByRole=t.getAdmin=void 0;const a=r(632626);function o(e,t){return e.filter((e=>e.role===t))}function n(e){return o(e,a.FamilyMemberRoles.ADMIN).length+o(e,a.FamilyMemberRoles.REGULAR).length}t.getAdmin=function(e){return e.find((e=>e.role===a.FamilyMemberRoles.ADMIN))},t.getMembersByRole=o,t.getMembersCount=n,t.getSpots=function(e,t){return t-n(e)}},103698:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRenewalInformation=void 0;const a=r(632626),o=r(46298);t.getRenewalInformation=e=>{if(!e||e.state===o.FamilyStopRenewalStates.STOPPED)return{showRenewalMessage:!1};const t=(r=e.platform)===o.FamilyStopRenewalPlatforms.IOS_APP_STORE?a.FamilyRenewalPlatform.IOS_APP_STORE:r===o.FamilyStopRenewalPlatforms.MAC_STORE?a.FamilyRenewalPlatform.MAC_STORE:r===o.FamilyStopRenewalPlatforms.PLAY_STORE?a.FamilyRenewalPlatform.PLAY_STORE:null;var r;return t?{showRenewalMessage:!0,platform:t}:{showRenewalMessage:!1}}},768385:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUserStatus=void 0;const a=r(632626);t.getUserStatus=(e,t)=>{switch(e){case a.PremiumStatusCode.NEW_USER:return a.JoinFamilyUserStatus.NEW_USER;case a.PremiumStatusCode.NO_PREMIUM:return t?a.JoinFamilyUserStatus.EXISTING_FREE_USER:a.JoinFamilyUserStatus.NEW_USER;case a.PremiumStatusCode.OLD_ACCOUNT:return a.JoinFamilyUserStatus.EXISTING_FREE_USER;case a.PremiumStatusCode.PREMIUM:case a.PremiumStatusCode.PREMIUM_CANCELLED:return a.JoinFamilyUserStatus.EXISTING_PREMIUM_USER;default:throw new Error("Family getUserStatus: impossible to identify user status")}}},808821:function(e,t,r){var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(550794),t),o(r(398995),t),o(r(449828),t)},550794:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.joinFamilyRequest=void 0;const a=r(795623),o=r(46298),n=r(768385),s=r(103698),i=r(504933);t.joinFamilyRequest=async function(e,t){const{storeService:r}=e,{login:c,joinToken:l}=t;try{const e=await(0,o.joinFamily)(r,{login:c,joinToken:l});if((0,o.isApiError)(e))return{success:!1,error:{code:(0,o.getCode)(e.code,i.joinFamilyErrors)}};const{name:t,userExists:a,statusCode:d,stopRenewalResult:u}=e,p=(0,s.getRenewalInformation)(u);return{success:!0,response:{name:t,userExists:a,userStatus:(0,n.getUserStatus)(d,a),renewalInformation:p}}}catch(e){return a.Debugger.error(`[Family] joinFamilyRequest - Failed: ${e}`),{success:!1,error:{code:o.UnknownError}}}}},399319:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.leaveFamilyRequest=void 0;const a=r(795623),o=r(46298),n=r(416593),s=r(504933);t.leaveFamilyRequest=async function(e){const{storeService:t,eventBusService:r}=e,i=(0,n.userLoginSelector)(t.getState());try{const e=await(0,o.leaveFamily)(t,i);return(0,o.isApiError)(e)?{success:!1,error:{code:(0,o.getCode)(e.code,s.leaveFamilyErrors)}}:(r.familyMemberLeft(),{success:!0,response:{}})}catch(e){return a.Debugger.error(`[Family] leaveFamilyRequest - Failed: ${e}`),{success:!1,error:{code:o.UnknownError}}}}},398995:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeFamilyMemberRequest=void 0;const a=r(795623),o=r(46298),n=r(416593),s=r(504933);t.removeFamilyMemberRequest=async function(e,t){const{storeService:r}=e,i=(0,n.userLoginSelector)(r.getState());try{const e=await(0,o.removeFamilyMember)(r,i,{userId:t.userId});return(0,o.isApiError)(e)?{success:!1,error:{code:(0,o.getCode)(e.code,s.removeFamilyMemberErrors)}}:{success:!0,response:{}}}catch(e){return a.Debugger.error(`[Family] removeFamilyMemberRequest - Failed: ${e}`),{success:!1,error:{code:o.UnknownError}}}}},449828:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetFamilyJoinTokenRequest=void 0;const a=r(795623),o=r(46298),n=r(416593),s=r(504933);t.resetFamilyJoinTokenRequest=async function(e){const{storeService:t}=e,r=(0,n.userLoginSelector)(t.getState());try{const e=await(0,o.resetFamilyJoinToken)(t,r);if((0,o.isApiError)(e))return{success:!1,error:{code:(0,o.getCode)(e.code,[s.UserMustBeFamilyAdmin])}};const{joinToken:a}=e;return{success:!0,response:{joinToken:a}}}catch(e){return a.Debugger.error(`[Family] resetFamilyJoinTokenRequest - Failed: ${e}`),{success:!1,error:{code:o.UnknownError}}}}},657362:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(288205);t.config={commands:{},queries:{getHasFeature:{selectorFactory:async e=>(await(0,a.makeFeatureFlipsSelectors)(e.applicationModulesAccess)).getHasFeatureSelector},getFeatures:{selectorFactory:async e=>(await(0,a.makeFeatureFlipsSelectors)(e.applicationModulesAccess)).featureFlipsSelector}},liveQueries:{}}},972175:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const a=r(657362);t.bootstrap=e=>{e.register(a.config)}},150329:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(972175);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},288205:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeFeatureFlipsSelectors=t.makeGetHasFeatureSelector=t.makeFeatureFlipsSelector=void 0;const a=r(518948),o=r(419562);t.makeFeatureFlipsSelector=e=>async()=>{const{queries:t}=e.createClients().featureFlips,r=await(0,a.firstValueFrom)(t.userFeatureFlips());return(0,o.isSuccess)(r)?r.data:{}},t.makeGetHasFeatureSelector=e=>async(t,r)=>{const{queries:n}=e.createClients().featureFlips,s=await(0,a.firstValueFrom)(n.userFeatureFlips());if((0,o.isSuccess)(s))return s.data[r]},t.makeFeatureFlipsSelectors=e=>({featureFlipsSelector:(0,t.makeFeatureFlipsSelector)(e),getHasFeatureSelector:(0,t.makeGetHasFeatureSelector)(e)})},388485:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(578671);t.config={commands:{setGlobalExtensionSettings:{handler:a.setGlobalExtensionSettings},getGlobalExtensionSettings:{handler:a.getGlobalExtensionSettings}},queries:{},liveQueries:{}}},217644:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setGlobalExtensionSettingsState=t.SET_GLOBAL_EXTENSION_SETTINGS=void 0,t.SET_GLOBAL_EXTENSION_SETTINGS="SET_GLOBAL_EXTENSION_SETTINGS",t.setGlobalExtensionSettingsState=e=>({type:t.SET_GLOBAL_EXTENSION_SETTINGS,extensionSettings:e})},45316:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.globalExtensionSettingsReducer=void 0;var a=r(822018);Object.defineProperty(t,"globalExtensionSettingsReducer",{enumerable:!0,get:function(){return a.globalExtensionSettingsReducer}})},822018:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.globalExtensionSettingsReducer=void 0;const a=r(217644);t.globalExtensionSettingsReducer=(e={},t)=>t.type===a.SET_GLOBAL_EXTENSION_SETTINGS?Object.assign({},e,{extensionSettings:t.extensionSettings}):e},284838:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const a=r(388485);t.bootstrap=e=>{e.register(a.config)}},578671:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setGlobalExtensionSettings=t.getGlobalExtensionSettings=void 0;const a=r(566102),o=r(217644),n=r(670252),s="consents",i={interactionDataConsent:"interactionData",personalDataConsent:"personalData"},c={interactionDataConsent:null,personalDataConsent:null};t.getGlobalExtensionSettings=async e=>{const t=e.storageService.getLocalStorage();try{return((e=null)=>{const t=JSON.parse(e);return!t||"object"!=typeof t||Array.isArray(t)?c:Object.values(i).every((e=>Object.prototype.hasOwnProperty.call(t,e)))?{interactionDataConsent:t[i.interactionDataConsent],personalDataConsent:t[i.personalDataConsent]}:c})(await t.readItem(s))}catch{return console.warn("failed parsing user consent values; proceeding as if they haven't been set."),{interactionDataConsent:null,personalDataConsent:null}}},t.setGlobalExtensionSettings=async(e,t)=>{const r=e.storageService.getLocalStorage();try{await r.writeItem(s,JSON.stringify({[i.interactionDataConsent]:t.interactionDataConsent,[i.personalDataConsent]:t.personalDataConsent})),e.storeService.dispatch((0,o.setGlobalExtensionSettingsState)(t)),(0,n.setAllowedToSendExceptionLog)(!1!==t.interactionDataConsent),(0,a.logToggleAnalyticsEvent)(e)}catch{return{success:!1}}return{success:!0}}},844389:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(284838);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})},864090:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const a=r(947975);t.config={commands:{evaluatePassword:{handler:a.evaluatePassword}},queries:{},liveQueries:{}}},710925:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.load=void 0;const a=r(955539);t.load=async e=>{const{data:t}=await(0,a.httpGetUsingFetch)(`${e}assets/frequency_lists.json`);return t}},947975:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.evaluatePassword=t.evaluatePasswordStrength=t.loadFrequencyLists=void 0;const a=r(285465),o=r(502646),n=r(710925);let s=()=>{};const i=new Promise((e=>{s=e}));t.loadFrequencyLists=async()=>{const e=(0,o.getPublicPath)(),t=await(0,n.load)(e);(0,a.setFrequencyLists)(t),s()};const c=async e=>(await i,(0,a.evaluate)(e));t.evaluatePasswordStrength=async e=>(await c(e)).score,t.evaluatePassword=async(e,t)=>{const{score:r,feedback:a}=await c(t.password);return{score:r,feedback:a}}},664948:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.evaluatePasswordStrengthOutOfFive=void 0;const a=r(947975);t.evaluatePasswordStrengthOutOfFive=async e=>{if(e)return await(0,a.evaluatePasswordStrength)(e)/25}},861566:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const a=r(864090);t.bootstrap=e=>{e.register(a.config)}},716359:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var a=r(861566);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return a.bootstrap}})}}]);