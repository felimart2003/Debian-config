"use strict";(globalThis.webpackChunk_dashlane_leeloo=globalThis.webpackChunk_dashlane_leeloo||[]).push([[8636],{768636:(e,t,i)=>{i.r(t),i.d(t,{SecretEditPanel:()=>O});var s=i(696832),a=i(448430),n=i(382706),r=i(133354),l=i(488203),c=i(625078),d=i(615940),o=i(762042),u=i(682994),_=i(376452),p=i(99822),m=i(78047),S=i(620800),b=i(833090),g=i(806697),h=i(979808),I=i(482598),f=i(310789),w=i(86498),C=i(692077),T=i(45272),v=i(700033),A=i(803322);const{CONTENT:y,SHARED_ACCESS:D}=d.SecretsTabs,x=({location:e,secret:t,isShared:i,isAdmin:x,isSharedViaUserGroup:E,isLastAdmin:Z})=>{var L,U;const{translate:V}=(0,l.Z)(),{routes:q}=(0,C.Xo)(),[O,P]=(0,s.useState)(y),[N,k]=(0,s.useState)(!1),[F,R]=(0,s.useState)(!1),[B,H]=(0,s.useState)(!1),[X,z]=(0,s.useState)({id:t.id,limitedPermissions:i&&!x,title:t.title,content:t.content,spaceId:null!=(L=t.spaceId)?L:"",secured:null!=(U=t.isSecured)&&U}),{data:G,status:Y}=(0,h.r)(t.id),$=function(){const{translate:e}=(0,l.Z)(),{showAlert:t}=(0,w.V)(),{updateVaultItem:i}=(0,I.u)(a.L);return async(s,a)=>{try{await i({vaultItemType:n.U.Secret,content:s,id:a})}catch{t(e("_common_generic_error"),f.BLW.ERROR)}}}(),{shouldShowFrozenStateDialog:K}=(0,g.Ub)(),M=()=>{e?.state?.entity?(0,c.d)({routes:q,location:e}):(0,C.uX)(q.userSecrets)};if(!t)return M(),null;const W={confirmDeleteConfirm:V("webapp_secrets_edition_delete_confirm"),confirmDeleteDismiss:V("webapp_credential_edition_delete_dismiss"),confirmDeleteSubtitle:V("webapp_credential_edition_confirm_delete_subtitle"),confirmDeleteTitle:V("webapp_secrets_edition_delete_title"),lastAdminActionLabel:V("webapp_credential_edition_change_permissions"),lastAdminTitle:V("webapp_credential_edition_last_admin_title"),lastAdminSubtitle:V("webapp_credential_edition_last_admin_subtitle"),groupSharingTitle:V("webapp_secure_notes_edition_group_sharing_title"),groupSharingSubtitle:V("webapp_credential_edition_group_sharing_subtitle"),genericErrorTitle:"webapp_account_recovery_generic_error_title",genericErrorSubtitle:"webapp_account_recovery_generic_error_subtitle"};if(null===K)return null;const j=i&&Y===r.rq.Success&&null!=(J=G?.count)?J:0;var J;return(0,A.BX)(_.zI,{isUsingNewDesign:!0,isViewingExistingItem:!0,itemHasBeenEdited:N,onSubmit:async()=>{var e;H(!0),await $({title:X.title,content:X.content,spaceId:null!=(e=X.spaceId)?e:"",isSecured:X.secured},t.id),H(!1),M()},submitPending:B,secondaryActions:O===y?[(0,A.tZ)(o._,{id:t.id,isShared:i,isAdmin:x,isDiscontinuedUser:K,getSharing:p.fl},"shareaction"),K?null:(0,A.tZ)(b.q,{copyValue:X.content,buttonText:V("webapp_credential_edition_field_generic_action_copy"),onCopyToClipboard:()=>(0,T.Kz)(new v.UserCopyVaultItemFieldEvent({itemId:t.id,itemType:v.ItemType.Secret,field:v.Field.Secret,isProtected:t.isSecured}))},"copyaction")]:[],onNavigateOut:M,onClickDelete:()=>R(!0),ignoreCloseOnEscape:F,isSomeDialogOpen:F,formId:"edit_secret_panel",header:(0,A.tZ)(S.h,{title:X.title,tabs:[{active:O===y,label:V("webapp_secrets_edition_field_tab_title_details"),onClick:()=>P(y)},{active:O===D,label:`${V("webapp_secure_notes_edition_field_tab_title_shared_access")} (${j})`,onClick:()=>P(D)}]}),children:[(0,A.tZ)(m.e,{activeTab:O,isAdmin:x,secretValues:X,handleChange:(e,i)=>{if("spaceId"===e&&i===X.spaceId)return;const s={...X,[e]:i},a=t.title!==s.title||t.content!==s.content||t.spaceId!==s.spaceId||t.isSecured!==s.secured;a!==N&&k(a),z(s)}}),(0,A.tZ)(u.s,{isVisible:F,itemId:t.id,closeConfirmDeleteDialog:()=>R(!1),goToSharingAccess:()=>{P(d.SecretsTabs.SHARED_ACCESS)},onDeletionSuccess:M,translations:W,vaultItemType:n.U.Secret,isShared:i,isLastAdmin:Z,isSharedViaUserGroup:E})]})};var E=i(995445),Z=i(799852),L=i(348958),U=i(982466),V=i(830894);const q=e=>{const{secret:t}=e,i=(0,V.tY)();(0,s.useEffect)((()=>{(0,T.Nc)(v.PageView.ItemSecretDetails)}),[t]);const{getPermissionForItem:a,getSharingStatusForItem:n,getIsLastAdminForItem:l}=(0,E.Y)(L.X,{getPermissionForItem:{queryParam:{itemId:t.id}},getSharingStatusForItem:{queryParam:{itemId:t.id}},getIsLastAdminForItem:{queryParam:{itemId:t.id}}},[]);if(a.status!==r.rq.Success||n.status!==r.rq.Success||l.status!==r.rq.Success)return null;const{isShared:c,isSharedViaUserGroup:d}=n.data,{isLastAdmin:o}=l.data;return(0,A.tZ)(x,{...e,...i,isShared:c,isAdmin:c&&a.data.permission===U.y3.Admin,isSharedViaUserGroup:d,isLastAdmin:o})},O=e=>{const{data:t,status:i}=(0,Z.k)(a.L,"query",{vaultItemTypes:[n.U.Secret],ids:[`{${e.match.params.uuid}}`]});return i===r.rq.Loading?null:t?.secretsResult.items.length?(0,A.tZ)(q,{...e,secret:t.secretsResult.items[0]}):(e.onClose(),null)}},615940:(e,t,i)=>{i.d(t,{SecretsTabs:()=>s});let s=function(e){return e[e.CONTENT=0]="CONTENT",e[e.SHARED_ACCESS=1]="SHARED_ACCESS",e}({})},620800:(e,t,i)=>{i.d(t,{h:()=>l});var s,a=i(782579),n=i(376452),r=i(803322);const l=({title:e,titleColor:t,tabs:i})=>(0,r.tZ)(n.V9,{icon:(0,r.tZ)("div",{sx:{width:"168px",height:"108px",borderStyle:"solid",borderWidth:"1px",borderRadius:"4px",borderColor:"ds.border.neutral.quiet.idle",display:"flex",justifyContent:"center",alignItems:"center"},children:s||(s=(0,r.tZ)(a.JO,{name:"ItemSecretOutlined",color:"ds.text.neutral.standard",size:"xlarge"}))}),title:e,titleColor:t,tabs:i})},78047:(e,t,i)=>{i.d(t,{e:()=>f});var s=i(696832),a=i(782579),n=i(133354),r=i(980936),l=i(488203),c=i(555449),d=i(433988),o=i(154350),u=i(468037),_=i(167406),p=i(615940),m=i(806697),S=i(803322);const{CONTENT:b,SHARED_ACCESS:g}=p.SecretsTabs,h="webapp_secure_notes_edition_field_text_max_size_reached",I=1e4,f=({activeTab:e,isAdmin:t,secretValues:i,handleChange:p})=>{const{translate:f}=(0,l.Z)(),[w,C]=(0,s.useState)(""),{shouldShowFrozenStateDialog:T}=(0,m.Ub)(),v=(0,d.F)(),{isMPLessUser:A}=(0,o.Z)(),y=!v&&!A,D=(0,r.I)(),x=D.status===n.rq.Success&&!D.isDisabled,{id:E,limitedPermissions:Z,title:L,content:U,spaceId:V,secured:q}=i;return null===T?null:(0,S.BX)(S.HY,{children:[e===b&&(0,S.BX)(S.HY,{children:[(0,S.BX)(u.u,{title:f("webapp_secrets_box_title_details"),children:[(0,S.tZ)(a.qo,{"data-name":"title",label:f("webapp_secrets_title_field"),value:L,onChange:e=>p("title",e.target.value),disabled:Z,readOnly:T,sx:{marginBottom:"8px"}}),(0,S.tZ)(a.Kx,{"data-name":"content",label:f("webapp_secrets_content_field"),placeholder:f("webapp_secrets_content_field_placeholder"),value:U,onBeforeInput:e=>{const t=e.currentTarget.value;t.length>I&&(C(f(h,{charLeft:I-(t.length-1)})),e.preventDefault())},onPaste:e=>{const t=e.clipboardData.getData("text/plain");e.currentTarget.value.length+t.length>I&&(C(f(h,{charLeft:I-e.currentTarget.value.length})),e.preventDefault())},onChange:e=>{w&&C(""),p("content",e.target.value)},disabled:Z,readOnly:T,feedback:w?{text:w}:void 0,error:!!w})]}),x?(0,S.tZ)(u.u,{title:f("webapp_secrets_box_title_organization"),additionalSx:{marginTop:"16px"},children:(0,S.tZ)("div",{children:(0,S.tZ)(_.M,{disabled:T,isUsingNewDesign:!0,defaultSpaceId:null!=V?V:"",spaceId:null!=V?V:"",onChange:e=>p("spaceId",e)})})}):null,y?(0,S.tZ)(u.u,{title:f("webapp_secrets_box_title_preferences"),additionalSx:{marginTop:"16px"},children:(0,S.tZ)(a.XZ,{readOnly:T,label:f("webapp_secrets_preferences_mp_title"),description:f("webapp_secrets_preferences_mp_description"),checked:q,onChange:({target:e})=>p("secured",e.checked)})}):null]}),e===g&&(0,S.tZ)(c.u,{isAdmin:t,id:E})]})}}}]);