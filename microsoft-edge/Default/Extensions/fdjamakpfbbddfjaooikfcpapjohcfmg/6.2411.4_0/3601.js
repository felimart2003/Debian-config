"use strict";(globalThis.webpackChunk_dashlane_leeloo=globalThis.webpackChunk_dashlane_leeloo||[]).push([[3601],{682994:(e,i,t)=>{t.d(i,{s:()=>g}),t(696832);var n=t(782579),s=t(482598),r=t(133354),o=t(448430),a=t(488203);let l=function(e){return e.LastAdmin="LastAdmin",e.GroupSharing="GroupSharing",e.CollectionSharing="CollectionSharing",e.Generic="Generic",e}({});var c=t(365580),d=t(803322);const p=({reason:e,translations:i,goToSharingAccess:t,closeCantDeleteDialog:s})=>{const{translate:r}=(0,a.Z)(),o=((e,i)=>{const{groupSharingTitle:t,lastAdminTitle:n,collectionSharingTitle:s,genericErrorTitle:r}=e;switch(i){case l.LastAdmin:return n;case l.GroupSharing:return t;case l.CollectionSharing:return s;case l.Generic:return r;default:return(0,c.U)(i)}})(i,e),p=((e,i)=>{const{groupSharingSubtitle:t,lastAdminSubtitle:n,collectionSharingSubtitle:s,genericErrorSubtitle:r}=e;switch(i){case l.LastAdmin:return n;case l.GroupSharing:return t;case l.CollectionSharing:return s;case l.Generic:return r;default:return(0,c.U)(i)}})(i,e);return(0,d.tZ)(n.Vq,{isOpen:!0,onClose:s,title:null!=o?o:"",closeActionLabel:r("_common_dialog_dismiss_button"),actions:e===l.LastAdmin||l.GroupSharing||l.CollectionSharing?{primary:{children:i.lastAdminActionLabel,onClick:()=>{t(),s()}}}:void 0,children:p})};var u=t(837527);const m=({closeConfirmDeleteDialog:e,onDeleteConfirm:i,translations:t})=>{const{translate:s}=(0,a.Z)(),{confirmDeleteSubtitle:r,confirmDeleteTitle:o,confirmDeleteDismiss:l,confirmDeleteConfirm:c}=t;return(0,d.tZ)(n.Vq,{title:o,onClose:e,isOpen:!0,dialogClassName:u.Ht,closeActionLabel:s("_common_dialog_dismiss_button"),isDestructive:!0,actions:{primary:{children:c,onClick:i,id:"deletion-dialog-confirm-button"},secondary:{children:l,onClick:e,autoFocus:!0,id:"deletion-dialog-dismiss-button"}},children:r})},g=({closeConfirmDeleteDialog:e,goToSharingAccess:i,isVisible:t,itemId:c,onDeletionSuccess:u,sharingStatus:g,translations:_,vaultItemType:h,isShared:S,isSharedViaUserGroup:I,isItemInCollection:b,isLastAdmin:C})=>{const{showToast:f}=(0,n.pm)(),{translate:y}=(0,a.Z)(),{deleteVaultItems:v}=(0,s.u)(o.L);if(!t)return null;let w;return(S||g?.isShared)&&(I&&(w=l.GroupSharing),C&&(w=l.LastAdmin),b&&(w=l.CollectionSharing)),w&&i?(0,d.tZ)(p,{reason:w,translations:_,goToSharingAccess:i,closeCantDeleteDialog:e}):(0,d.tZ)(m,{closeConfirmDeleteDialog:e,onDeleteConfirm:async()=>{try{var e;(await v({ids:[c],vaultItemType:h})).tag===r.rq.Success?(f({description:null!=(e=_.deleteSuccessToast)?e:y("webapp_personal_info_edition_delete_success_toast")}),u()):f({description:y("_common_generic_error"),mood:"danger",isManualDismiss:!0})}catch(e){f({description:y("_common_generic_error"),mood:"danger",isManualDismiss:!0})}},translations:_})}},762042:(e,i,t)=>{t.d(i,{_:()=>l}),t(696832);var n=t(700033),s=t(488203),r=t(301639),o=t(803322);const a=({sharing:e})=>{const{translate:i}=(0,s.Z)();return(0,o.tZ)(r.Z,{tooltipPlacement:"top-start",sharing:e,text:i("webapp_sharing_invite_share"),origin:n.Origin.ItemDetailView})},l=({id:e,isShared:i,isAdmin:t,isDiscontinuedUser:n,getSharing:s})=>i&&!t||n?null:(0,o.tZ)(a,{sharing:s(e)})},979808:(e,i,t)=>{t.d(i,{r:()=>r});var n=t(799852),s=t(348958);const r=e=>(0,n.k)(s.X,"sharedAccessForItem",{itemId:e})},555449:(e,i,t)=>{t.d(i,{u:()=>V});var n,s,r=t(696832),o=t(310789),a=t(361607),l=t(482598),c=t(133354),d=t(172721),p=t(982466),u=t(287279),m=t(740300),g=t(488203),_=t(343194),h=t(448263),S=t(782579),I=t(232814),b=t(904967),C=t(873670),f=t(989572),y=t(58037),v=t(803322);const w=({cancelStatus:e,itemGroupId:i,setCancelStatus:t,recipientId:a})=>{const{translate:l}=(0,g.Z)(),c=e===h.V.Loading,d={type:"user",alias:a};(0,r.useEffect)((()=>{let i;return e===h.V.Failure&&(i=window.setTimeout((()=>t(null)),2e3)),()=>{clearTimeout(i)}}),[e,t]);const p=e?()=>t(null):()=>t(h.V.Confirm);return e===h.V.Failure?(0,v.BX)("div",{sx:{color:"ds.text.danger.standard",display:"flex",alignItems:"center"},children:[n||(n=(0,v.tZ)(o.aNP,{color:"ds.text.danger.standard"})),"Â ",l("webapp_shared_access_cancel_failure")]}):(0,v.BX)("div",{children:[(0,v.tZ)(S.zx,{intensity:e?"quiet":"supershy",disabled:c,onClick:p,size:"small",children:l(e?"webapp_shared_access_cancel":"webapp_shared_access_cancel_invitation")}),e?(0,v.tZ)(S.zx,{mood:"danger",intensity:"catchy",sx:{ml:"16px"},disabled:c,size:"small",onClick:()=>(async()=>{t(h.V.Loading);const e=await(async()=>{try{const{success:e}=await m.C.revokeSharing({itemGroupId:i,recipient:d});return e}catch(e){return!1}})();t(e?h.V.Success:h.V.Failure)})(),children:c?s||(s=(0,v.tZ)(o.HoD,{})):l("webapp_shared_access_confirm")}):null]})};var D;const Z="webapp_sharing_permissions_full_rights",x="webapp_sharing_permissions_limited_rights",P=e=>{const{status:i,permission:t}=e;return"pending"===i?"webapp_shared_access_pending_invitation":"accepted"===i?"admin"===t?Z:x:""},A=({itemGroupId:e,onUserSelected:i,openEditPermissionsDialog:t,member:n,isAdmin:s,isItemPermissionsEnabled:o=!1})=>{const[a,l]=(0,r.useState)(null),c=(0,y.j)()?.login,{translate:d}=(0,g.Z)();if(a===h.V.Success)return null;const{permission:u,status:m,recipientType:_}=n,A=c===n.recipientId,G=s&&c!==n.recipientId,T="pending"===m?(0,v.tZ)(w,{recipientId:n.recipientId,itemGroupId:e,cancelStatus:a,setCancelStatus:l}):(0,v.tZ)(C.M,{disabled:o&&!s||!o&&n.recipientType===p.IP.Collection,icon:"ActionEditOutlined",layout:"iconLeading",intensity:"supershy",onClick:()=>{i&&i(n.recipientId),t(n,u,_)},content:d("webapp_sharing_collection_access_description_tooltip"),tooltipSx:{textWrap:"wrap",maxWidth:"240px"},size:"small",children:d("webapp_shared_access_edit_permissions")});return(0,v.tZ)("li",{sx:{alignItems:"center",display:"flex",minHeight:"48px",position:"relative"},children:(0,v.tZ)(b.r,{infoAction:G?T:null,logo:n.recipientType===p.IP.Group?D||(D=(0,v.tZ)(f.Z,{})):(0,v.tZ)(I.q,{email:n.recipientName,size:36}),text:o?void 0:P(n)?d(P(n)):d("webapp_shared_permissions_dialog_revoke_success_title"),title:n.recipientName,permissionBadge:o?(0,v.tZ)(S.Ct,{mood:"admin"===u?"brand":"danger",label:d("admin"===u?Z:x)}):void 0,disabled:a===h.V.Loading,titleLogo:A?(0,v.tZ)(S.Ct,{label:d("webapp_shared_access_you_badge").toUpperCase(),layout:"labelOnly",sx:{marginLeft:"4px"}}):null})},n.recipientId)};var G=t(979808),T=t(468037),k=t(814341);const V=({id:e,isAdmin:i})=>{const{translate:t}=(0,g.Z)(),[n,s]=(0,r.useState)(!1),[S,I]=(0,r.useState)(null),[b,C]=(0,r.useState)(void 0),f=(0,a._)(),{data:y,status:w}=(0,G.r)(e),{updatePermissionForCollectionItem:D,removeItemFromCollections:Z}=(0,l.u)(d.a),x=Boolean(f.data?.sharingVault_web_Collection_Item_Permissions_dev)||Boolean(f.data?.sharingVault_web_Collection_Item_Permissions_prod);if(w!==c.rq.Success)return(0,v.tZ)(o.HoD,{color:"ds.container.expressive.brand.catchy.idle",size:50,sx:{alignSelf:"center",m:"20px"}});if(!y)return null;const{itemGroupId:P,users:V,groups:L,collections:E}=y,B=e=>{S&&I({...S,step:e})},U=async()=>{if(!S)return;const{recipient:i,permission:t,recipientType:n}=S;s(!0);const r="revoke"===t?await(async(i,t)=>{try{if(t===p.IP.Collection){const t=await Z({collectionIds:[i.recipientId],itemId:e});return!!(0,u.d6)(t)}const{success:n}=await m.C.revokeSharing({itemGroupId:null!=P?P:"",recipient:(0,k.d)(i)});return n}catch(e){return!1}})(i,n):await(async(e,i,t)=>{try{if(t===p.IP.Collection){const t=await D({groupId:P,collection:{collectionId:e.recipientId,permission:i}});return!!(0,u.d6)(t)}{const{success:t}=await m.C.updateSharingPermission({itemGroupId:null!=P?P:"",recipient:(0,k.d)(e),permission:i});return t}}catch(e){return!1}})(i,t,n);if(r){const e="revoke"===t?h.PermissionDialogStep.RevokeSuccess:h.PermissionDialogStep.Success;B(e)}else B(h.PermissionDialogStep.Failure);s(!1)},F=(e,i,t)=>{const n={recipient:e,recipientType:t,permission:i,originPermission:i,step:h.PermissionDialogStep.Permission,name:e.recipientName};I(n)},X=L?.length>0,z=E?.length>0,q=V?.length>0,O=!(b&&V.find((e=>e.recipientId!==b&&e.permission===p.y3.Admin)))&&S?.recipient.recipientType===p.IP.User,N="collection"===S?.recipientType;return(0,v.BX)("div",{sx:{flex:"1",overflowY:"auto"},children:[(0,v.BX)("ul",{sx:{flex:"1"},children:[z?(0,v.tZ)(T.u,{title:t("webapp_shared_access_collections"),additionalSx:{marginBottom:"16px"},children:E.map((e=>(0,v.tZ)(A,{isItemPermissionsEnabled:x,isAdmin:i,member:e,itemGroupId:null!=P?P:"",openEditPermissionsDialog:F},e.recipientId)))}):null,X?(0,v.tZ)(T.u,{title:t("webapp_shared_access_groups_card_title"),additionalSx:{marginBottom:"16px"},children:L.map((e=>(0,v.tZ)(A,{isAdmin:i,member:e,itemGroupId:null!=P?P:"",openEditPermissionsDialog:F},e.recipientId)))}):null,q?(0,v.tZ)(T.u,{title:t("webapp_shared_access_individuals_card_title"),children:V.map((e=>(0,v.tZ)(A,{isAdmin:i,member:e,onUserSelected:e=>C(e),itemGroupId:null!=P?P:"",openEditPermissionsDialog:F},e.recipientId)))}):null]}),S&&(0,v.tZ)(_.E,{isOpen:!0,isCollectionItemPermission:N,shouldRevokeBeDisabled:O||void 0,loading:n,onCancelRevoke:()=>{S&&I({...S,step:h.PermissionDialogStep.Permission})},onConfirmRevoke:U,onDismiss:()=>I(null),onSelectPermission:e=>{S&&I({...S,permission:e})},onValidatePermission:()=>{"revoke"===S?.permission?I({...S,step:h.PermissionDialogStep.ConfirmRevoke}):U()},permission:S.permission,recipient:S.recipient,step:S.step})]})}},625078:(e,i,t)=>{t.d(i,{d:()=>r});var n=t(384885),s=t(692077);const r=({routes:e,location:i})=>{i?.state?.entity?(0,n.y)(i?.state?.entity)?(0,s.uX)(e.userSharingGroupInfo(i?.state?.entity?.groupId)):(0,s.uX)(e.userSharingUserInfo(i?.state?.entity?.alias)):(0,s.uX)(e.userSharingCenter)}}}]);